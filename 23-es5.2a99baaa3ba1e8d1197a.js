!function(){function e(e,r){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,r)}(e))||r&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{LvDl:function(e,t,r){(function(e){var a;(function(){var n="Expected a function",i="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",c="[object Array]",u="[object Boolean]",l="[object Date]",h="[object Error]",p="[object Function]",g="[object GeneratorFunction]",b="[object Map]",f="[object Number]",d="[object Object]",m="[object RegExp]",v="[object Set]",y="[object String]",D="[object Symbol]",S="[object WeakMap]",w="[object ArrayBuffer]",F="[object DataView]",x="[object Float32Array]",W="[object Float64Array]",M="[object Int8Array]",P="[object Int16Array]",V="[object Int32Array]",O="[object Uint8Array]",C="[object Uint16Array]",k="[object Uint32Array]",R=/\b__p \+= '';/g,_=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,I=/&(?:amp|lt|gt|quot|#39);/g,N=/[&<>"']/g,L=RegExp(I.source),A=RegExp(N.source),j=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,E=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H=/^\w*$/,U=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,B=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(B.source),G=/^\s+/,q=/\s/,$=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,X=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,J=/[()=,{}\[\]\/\s]/,ee=/\\(\\)?/g,te=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,re=/\w*$/,ae=/^[-+]0x[0-9a-f]+$/i,ne=/^0b[01]+$/i,ie=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,oe=/^(?:0|[1-9]\d*)$/,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ue=/($^)/,le=/['\n\r\u2028\u2029\\]/g,he="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ge="["+pe+"]",be="["+he+"]",fe="\\d+",de="[a-z\\xdf-\\xf6\\xf8-\\xff]",me="[^\\ud800-\\udfff"+pe+fe+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ve="\\ud83c[\\udffb-\\udfff]",ye="[^\\ud800-\\udfff]",De="(?:\\ud83c[\\udde6-\\uddff]){2}",Se="[\\ud800-\\udbff][\\udc00-\\udfff]",we="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Fe="(?:"+de+"|"+me+")",xe="(?:"+we+"|"+me+")",We="(?:"+be+"|"+ve+")?",Me="[\\ufe0e\\ufe0f]?"+We+"(?:\\u200d(?:"+[ye,De,Se].join("|")+")[\\ufe0e\\ufe0f]?"+We+")*",Pe="(?:"+["[\\u2700-\\u27bf]",De,Se].join("|")+")"+Me,Ve="(?:"+[ye+be+"?",be,De,Se,"[\\ud800-\\udfff]"].join("|")+")",Oe=RegExp("['\u2019]","g"),Ce=RegExp(be,"g"),ke=RegExp(ve+"(?="+ve+")|"+Ve+Me,"g"),Re=RegExp([we+"?"+de+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[ge,we,"$"].join("|")+")",xe+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[ge,we+Fe,"$"].join("|")+")",we+"?"+Fe+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",we+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",fe,Pe].join("|"),"g"),_e=RegExp("[\\u200d\\ud800-\\udfff"+he+"\\ufe0e\\ufe0f]"),Te=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ne=-1,Le={};Le[x]=Le[W]=Le[M]=Le[P]=Le[V]=Le[O]=Le["[object Uint8ClampedArray]"]=Le[C]=Le[k]=!0,Le[o]=Le[c]=Le[w]=Le[u]=Le[F]=Le[l]=Le[h]=Le[p]=Le[b]=Le[f]=Le[d]=Le[m]=Le[v]=Le[y]=Le[S]=!1;var Ae={};Ae[o]=Ae[c]=Ae[w]=Ae[F]=Ae[u]=Ae[l]=Ae[x]=Ae[W]=Ae[M]=Ae[P]=Ae[V]=Ae[b]=Ae[f]=Ae[d]=Ae[m]=Ae[v]=Ae[y]=Ae[D]=Ae[O]=Ae["[object Uint8ClampedArray]"]=Ae[C]=Ae[k]=!0,Ae[h]=Ae[p]=Ae[S]=!1;var je={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ze=parseFloat,Ee=parseInt,Ye="object"==typeof global&&global&&global.Object===Object&&global,He="object"==typeof self&&self&&self.Object===Object&&self,Ue=Ye||He||Function("return this")(),Be=t&&!t.nodeType&&t,Qe=Be&&"object"==typeof e&&e&&!e.nodeType&&e,Ge=Qe&&Qe.exports===Be,qe=Ge&&Ye.process,$e=function(){try{return Qe&&Qe.require&&Qe.require("util").types||qe&&qe.binding&&qe.binding("util")}catch(e){}}(),Ke=$e&&$e.isArrayBuffer,Xe=$e&&$e.isDate,Ze=$e&&$e.isMap,Je=$e&&$e.isRegExp,et=$e&&$e.isSet,tt=$e&&$e.isTypedArray;function rt(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function at(e,t,r,a){for(var n=-1,i=null==e?0:e.length;++n<i;){var s=e[n];t(a,s,r(s),e)}return a}function nt(e,t){for(var r=-1,a=null==e?0:e.length;++r<a&&!1!==t(e[r],r,e););return e}function it(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function st(e,t){for(var r=-1,a=null==e?0:e.length;++r<a;)if(!t(e[r],r,e))return!1;return!0}function ot(e,t){for(var r=-1,a=null==e?0:e.length,n=0,i=[];++r<a;){var s=e[r];t(s,r,e)&&(i[n++]=s)}return i}function ct(e,t){return!(null==e||!e.length)&&vt(e,t,0)>-1}function ut(e,t,r){for(var a=-1,n=null==e?0:e.length;++a<n;)if(r(t,e[a]))return!0;return!1}function lt(e,t){for(var r=-1,a=null==e?0:e.length,n=Array(a);++r<a;)n[r]=t(e[r],r,e);return n}function ht(e,t){for(var r=-1,a=t.length,n=e.length;++r<a;)e[n+r]=t[r];return e}function pt(e,t,r,a){var n=-1,i=null==e?0:e.length;for(a&&i&&(r=e[++n]);++n<i;)r=t(r,e[n],n,e);return r}function gt(e,t,r,a){var n=null==e?0:e.length;for(a&&n&&(r=e[--n]);n--;)r=t(r,e[n],n,e);return r}function bt(e,t){for(var r=-1,a=null==e?0:e.length;++r<a;)if(t(e[r],r,e))return!0;return!1}var ft=wt("length");function dt(e,t,r){var a;return r(e,(function(e,r,n){if(t(e,r,n))return a=r,!1})),a}function mt(e,t,r,a){for(var n=e.length,i=r+(a?1:-1);a?i--:++i<n;)if(t(e[i],i,e))return i;return-1}function vt(e,t,r){return t==t?function(e,t,r){for(var a=r-1,n=e.length;++a<n;)if(e[a]===t)return a;return-1}(e,t,r):mt(e,Dt,r)}function yt(e,t,r,a){for(var n=r-1,i=e.length;++n<i;)if(a(e[n],t))return n;return-1}function Dt(e){return e!=e}function St(e,t){var r=null==e?0:e.length;return r?Wt(e,t)/r:NaN}function wt(e){return function(t){return null==t?void 0:t[e]}}function Ft(e){return function(t){return null==e?void 0:e[t]}}function xt(e,t,r,a,n){return n(e,(function(e,n,i){r=a?(a=!1,e):t(r,e,n,i)})),r}function Wt(e,t){for(var r,a=-1,n=e.length;++a<n;){var i=t(e[a]);void 0!==i&&(r=void 0===r?i:r+i)}return r}function Mt(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}function Pt(e){return e?e.slice(0,Bt(e)+1).replace(G,""):e}function Vt(e){return function(t){return e(t)}}function Ot(e,t){return lt(t,(function(t){return e[t]}))}function Ct(e,t){return e.has(t)}function kt(e,t){for(var r=-1,a=e.length;++r<a&&vt(t,e[r],0)>-1;);return r}function Rt(e,t){for(var r=e.length;r--&&vt(t,e[r],0)>-1;);return r}function _t(e,t){for(var r=e.length,a=0;r--;)e[r]===t&&++a;return a}var Tt=Ft({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),It=Ft({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Nt(e){return"\\"+je[e]}function Lt(e){return _e.test(e)}function At(e){var t=-1,r=Array(e.size);return e.forEach((function(e,a){r[++t]=[a,e]})),r}function jt(e,t){return function(r){return e(t(r))}}function zt(e,t){for(var r=-1,a=e.length,n=0,s=[];++r<a;){var o=e[r];o!==t&&o!==i||(e[r]=i,s[n++]=r)}return s}function Et(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function Yt(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}function Ht(e){return Lt(e)?function(e){for(var t=ke.lastIndex=0;ke.test(e);)++t;return t}(e):ft(e)}function Ut(e){return Lt(e)?function(e){return e.match(ke)||[]}(e):function(e){return e.split("")}(e)}function Bt(e){for(var t=e.length;t--&&q.test(e.charAt(t)););return t}var Qt=Ft({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Gt=function e(t){var r,a=(t=null==t?Ue:Gt.defaults(Ue.Object(),t,Gt.pick(Ue,Ie))).Array,q=t.Date,he=t.Error,pe=t.Function,ge=t.Math,be=t.Object,fe=t.RegExp,de=t.String,me=t.TypeError,ve=a.prototype,ye=be.prototype,De=t["__core-js_shared__"],Se=pe.prototype.toString,we=ye.hasOwnProperty,Fe=0,xe=(r=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",We=ye.toString,Me=Se.call(be),Pe=Ue._,Ve=fe("^"+Se.call(we).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ke=Ge?t.Buffer:void 0,_e=t.Symbol,je=t.Uint8Array,Ye=ke?ke.allocUnsafe:void 0,He=jt(be.getPrototypeOf,be),Be=be.create,Qe=ye.propertyIsEnumerable,qe=ve.splice,$e=_e?_e.isConcatSpreadable:void 0,ft=_e?_e.iterator:void 0,Ft=_e?_e.toStringTag:void 0,qt=function(){try{var e=Zn(be,"defineProperty");return e({},"",{}),e}catch(t){}}(),$t=t.clearTimeout!==Ue.clearTimeout&&t.clearTimeout,Kt=q&&q.now!==Ue.Date.now&&q.now,Xt=t.setTimeout!==Ue.setTimeout&&t.setTimeout,Zt=ge.ceil,Jt=ge.floor,er=be.getOwnPropertySymbols,tr=ke?ke.isBuffer:void 0,rr=t.isFinite,ar=ve.join,nr=jt(be.keys,be),ir=ge.max,sr=ge.min,or=q.now,cr=t.parseInt,ur=ge.random,lr=ve.reverse,hr=Zn(t,"DataView"),pr=Zn(t,"Map"),gr=Zn(t,"Promise"),br=Zn(t,"Set"),fr=Zn(t,"WeakMap"),dr=Zn(be,"create"),mr=fr&&new fr,vr={},yr=Pi(hr),Dr=Pi(pr),Sr=Pi(gr),wr=Pi(br),Fr=Pi(fr),xr=_e?_e.prototype:void 0,Wr=xr?xr.valueOf:void 0,Mr=xr?xr.toString:void 0;function Pr(e){if(Us(e)&&!_s(e)&&!(e instanceof kr)){if(e instanceof Cr)return e;if(we.call(e,"__wrapped__"))return Vi(e)}return new Cr(e)}var Vr=function(){function e(){}return function(t){if(!Hs(t))return{};if(Be)return Be(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function Or(){}function Cr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function kr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Rr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function _r(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function Tr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function Ir(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Tr;++t<r;)this.add(e[t])}function Nr(e){var t=this.__data__=new _r(e);this.size=t.size}function Lr(e,t){var r=_s(e),a=!r&&Rs(e),n=!r&&!a&&Ls(e),i=!r&&!a&&!n&&Zs(e),s=r||a||n||i,o=s?Mt(e.length,de):[],c=o.length;for(var u in e)!t&&!we.call(e,u)||s&&("length"==u||n&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ii(u,c))||o.push(u);return o}function Ar(e){var t=e.length;return t?e[Ta(0,t-1)]:void 0}function jr(e,t){return wi(dn(e),qr(t,0,e.length))}function zr(e){return wi(dn(e))}function Er(e,t,r){(void 0!==r&&!Os(e[t],r)||void 0===r&&!(t in e))&&Qr(e,t,r)}function Yr(e,t,r){var a=e[t];we.call(e,t)&&Os(a,r)&&(void 0!==r||t in e)||Qr(e,t,r)}function Hr(e,t){for(var r=e.length;r--;)if(Os(e[r][0],t))return r;return-1}function Ur(e,t,r,a){return Jr(e,(function(e,n,i){t(a,e,r(e),i)})),a}function Br(e,t){return e&&mn(t,So(t),e)}function Qr(e,t,r){"__proto__"==t&&qt?qt(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Gr(e,t){for(var r=-1,n=t.length,i=a(n),s=null==e;++r<n;)i[r]=s?void 0:fo(e,t[r]);return i}function qr(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}function $r(e,t,r,a,n,i){var s,c=1&t,h=2&t,S=4&t;if(r&&(s=n?r(e,a,n,i):r(e)),void 0!==s)return s;if(!Hs(e))return e;var R=_s(e);if(R){if(s=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&we.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!c)return dn(e,s)}else{var _=ti(e),T=_==p||_==g;if(Ls(e))return ln(e,c);if(_==d||_==o||T&&!n){if(s=h||T?{}:ai(e),!c)return h?function(e,t){return mn(e,ei(e),t)}(e,function(e,t){return e&&mn(t,wo(t),e)}(s,e)):function(e,t){return mn(e,Jn(e),t)}(e,Br(s,e))}else{if(!Ae[_])return n?e:{};s=function(e,t,r){var a=e.constructor;switch(t){case w:return hn(e);case u:case l:return new a(+e);case F:return function(e,t){var r=t?hn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case x:case W:case M:case P:case V:case O:case"[object Uint8ClampedArray]":case C:case k:return pn(e,r);case b:return new a;case f:case y:return new a(e);case m:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case v:return new a;case D:return Wr?be(Wr.call(e)):{}}}(e,_,c)}}i||(i=new Nr);var I=i.get(e);if(I)return I;i.set(e,s),$s(e)?e.forEach((function(a){s.add($r(a,t,r,a,e,i))})):Bs(e)&&e.forEach((function(a,n){s.set(n,$r(a,t,r,n,e,i))}));var N=R?void 0:(S?h?Bn:Un:h?wo:So)(e);return nt(N||e,(function(a,n){N&&(a=e[n=a]),Yr(s,n,$r(a,t,r,n,e,i))})),s}function Kr(e,t,r){var a=r.length;if(null==e)return!a;for(e=be(e);a--;){var n=r[a],i=e[n];if(void 0===i&&!(n in e)||!(0,t[n])(i))return!1}return!0}function Xr(e,t,r){if("function"!=typeof e)throw new me(n);return vi((function(){e.apply(void 0,r)}),t)}function Zr(e,t,r,a){var n=-1,i=ct,s=!0,o=e.length,c=[],u=t.length;if(!o)return c;r&&(t=lt(t,Vt(r))),a?(i=ut,s=!1):t.length>=200&&(i=Ct,s=!1,t=new Ir(t));e:for(;++n<o;){var l=e[n],h=null==r?l:r(l);if(l=a||0!==l?l:0,s&&h==h){for(var p=u;p--;)if(t[p]===h)continue e;c.push(l)}else i(t,h,a)||c.push(l)}return c}Pr.templateSettings={escape:j,evaluate:z,interpolate:E,variable:"",imports:{_:Pr}},(Pr.prototype=Or.prototype).constructor=Pr,(Cr.prototype=Vr(Or.prototype)).constructor=Cr,(kr.prototype=Vr(Or.prototype)).constructor=kr,Rr.prototype.clear=function(){this.__data__=dr?dr(null):{},this.size=0},Rr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Rr.prototype.get=function(e){var t=this.__data__;if(dr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return we.call(t,e)?t[e]:void 0},Rr.prototype.has=function(e){var t=this.__data__;return dr?void 0!==t[e]:we.call(t,e)},Rr.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=dr&&void 0===t?"__lodash_hash_undefined__":t,this},_r.prototype.clear=function(){this.__data__=[],this.size=0},_r.prototype.delete=function(e){var t=this.__data__,r=Hr(t,e);return!(r<0||(r==t.length-1?t.pop():qe.call(t,r,1),--this.size,0))},_r.prototype.get=function(e){var t=this.__data__,r=Hr(t,e);return r<0?void 0:t[r][1]},_r.prototype.has=function(e){return Hr(this.__data__,e)>-1},_r.prototype.set=function(e,t){var r=this.__data__,a=Hr(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this},Tr.prototype.clear=function(){this.size=0,this.__data__={hash:new Rr,map:new(pr||_r),string:new Rr}},Tr.prototype.delete=function(e){var t=Kn(this,e).delete(e);return this.size-=t?1:0,t},Tr.prototype.get=function(e){return Kn(this,e).get(e)},Tr.prototype.has=function(e){return Kn(this,e).has(e)},Tr.prototype.set=function(e,t){var r=Kn(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this},Ir.prototype.add=Ir.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ir.prototype.has=function(e){return this.__data__.has(e)},Nr.prototype.clear=function(){this.__data__=new _r,this.size=0},Nr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Nr.prototype.get=function(e){return this.__data__.get(e)},Nr.prototype.has=function(e){return this.__data__.has(e)},Nr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof _r){var a=r.__data__;if(!pr||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new Tr(a)}return r.set(e,t),this.size=r.size,this};var Jr=Dn(oa),ea=Dn(ca,!0);function ta(e,t){var r=!0;return Jr(e,(function(e,a,n){return r=!!t(e,a,n)})),r}function ra(e,t,r){for(var a=-1,n=e.length;++a<n;){var i=e[a],s=t(i);if(null!=s&&(void 0===o?s==s&&!Xs(s):r(s,o)))var o=s,c=i}return c}function aa(e,t){var r=[];return Jr(e,(function(e,a,n){t(e,a,n)&&r.push(e)})),r}function na(e,t,r,a,n){var i=-1,s=e.length;for(r||(r=ni),n||(n=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?na(o,t-1,r,a,n):ht(n,o):a||(n[n.length]=o)}return n}var ia=Sn(),sa=Sn(!0);function oa(e,t){return e&&ia(e,t,So)}function ca(e,t){return e&&sa(e,t,So)}function ua(e,t){return ot(t,(function(t){return zs(e[t])}))}function la(e,t){for(var r=0,a=(t=sn(t,e)).length;null!=e&&r<a;)e=e[Mi(t[r++])];return r&&r==a?e:void 0}function ha(e,t,r){var a=t(e);return _s(e)?a:ht(a,r(e))}function pa(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ft&&Ft in be(e)?function(e){var t=we.call(e,Ft),r=e[Ft];try{e[Ft]=void 0;var a=!0}catch(i){}var n=We.call(e);return a&&(t?e[Ft]=r:delete e[Ft]),n}(e):function(e){return We.call(e)}(e)}function ga(e,t){return e>t}function ba(e,t){return null!=e&&we.call(e,t)}function fa(e,t){return null!=e&&t in be(e)}function da(e,t,r){for(var n=r?ut:ct,i=e[0].length,s=e.length,o=s,c=a(s),u=1/0,l=[];o--;){var h=e[o];o&&t&&(h=lt(h,Vt(t))),u=sr(h.length,u),c[o]=!r&&(t||i>=120&&h.length>=120)?new Ir(o&&h):void 0}h=e[0];var p=-1,g=c[0];e:for(;++p<i&&l.length<u;){var b=h[p],f=t?t(b):b;if(b=r||0!==b?b:0,!(g?Ct(g,f):n(l,f,r))){for(o=s;--o;){var d=c[o];if(!(d?Ct(d,f):n(e[o],f,r)))continue e}g&&g.push(f),l.push(b)}}return l}function ma(e,t,r){var a=null==(e=bi(e,t=sn(t,e)))?e:e[Mi(ji(t))];return null==a?void 0:rt(a,e,r)}function va(e){return Us(e)&&pa(e)==o}function ya(e,t,r,a,n){return e===t||(null==e||null==t||!Us(e)&&!Us(t)?e!=e&&t!=t:function(e,t,r,a,n,i){var s=_s(e),p=_s(t),g=s?c:ti(e),S=p?c:ti(t),x=(g=g==o?d:g)==d,W=(S=S==o?d:S)==d,M=g==S;if(M&&Ls(e)){if(!Ls(t))return!1;s=!0,x=!1}if(M&&!x)return i||(i=new Nr),s||Zs(e)?Yn(e,t,r,a,n,i):function(e,t,r,a,n,i,s){switch(r){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!i(new je(e),new je(t)));case u:case l:case f:return Os(+e,+t);case h:return e.name==t.name&&e.message==t.message;case m:case y:return e==t+"";case b:var o=At;case v:if(o||(o=Et),e.size!=t.size&&!(1&a))return!1;var c=s.get(e);if(c)return c==t;a|=2,s.set(e,t);var p=Yn(o(e),o(t),a,n,i,s);return s.delete(e),p;case D:if(Wr)return Wr.call(e)==Wr.call(t)}return!1}(e,t,g,r,a,n,i);if(!(1&r)){var P=x&&we.call(e,"__wrapped__"),V=W&&we.call(t,"__wrapped__");if(P||V){var O=P?e.value():e,C=V?t.value():t;return i||(i=new Nr),n(O,C,r,a,i)}}return!!M&&(i||(i=new Nr),function(e,t,r,a,n,i){var s=1&r,o=Un(e),c=o.length;if(c!=Un(t).length&&!s)return!1;for(var u=c;u--;){var l=o[u];if(!(s?l in t:we.call(t,l)))return!1}var h=i.get(e),p=i.get(t);if(h&&p)return h==t&&p==e;var g=!0;i.set(e,t),i.set(t,e);for(var b=s;++u<c;){var f=e[l=o[u]],d=t[l];if(a)var m=s?a(d,f,l,t,e,i):a(f,d,l,e,t,i);if(!(void 0===m?f===d||n(f,d,r,a,i):m)){g=!1;break}b||(b="constructor"==l)}if(g&&!b){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(g=!1)}return i.delete(e),i.delete(t),g}(e,t,r,a,n,i))}(e,t,r,a,ya,n))}function Da(e,t,r,a){var n=r.length,i=n,s=!a;if(null==e)return!i;for(e=be(e);n--;){var o=r[n];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++n<i;){var c=(o=r[n])[0],u=e[c],l=o[1];if(s&&o[2]){if(void 0===u&&!(c in e))return!1}else{var h=new Nr;if(a)var p=a(u,l,c,e,t,h);if(!(void 0===p?ya(l,u,3,a,h):p))return!1}}return!0}function Sa(e){return!(!Hs(e)||(t=e,xe&&xe in t))&&(zs(e)?Ve:ie).test(Pi(e));var t}function wa(e){return"function"==typeof e?e:null==e?Go:"object"==typeof e?_s(e)?Pa(e[0],e[1]):Ma(e):rc(e)}function Fa(e){if(!li(e))return nr(e);var t=[];for(var r in be(e))we.call(e,r)&&"constructor"!=r&&t.push(r);return t}function xa(e,t){return e<t}function Wa(e,t){var r=-1,n=Is(e)?a(e.length):[];return Jr(e,(function(e,a,i){n[++r]=t(e,a,i)})),n}function Ma(e){var t=Xn(e);return 1==t.length&&t[0][2]?pi(t[0][0],t[0][1]):function(r){return r===e||Da(r,e,t)}}function Pa(e,t){return oi(e)&&hi(t)?pi(Mi(e),t):function(r){var a=fo(r,e);return void 0===a&&a===t?mo(r,e):ya(t,a,3)}}function Va(e,t,r,a,n){e!==t&&ia(t,(function(i,s){if(n||(n=new Nr),Hs(i))!function(e,t,r,a,n,i,s){var o=di(e,r),c=di(t,r),u=s.get(c);if(u)Er(e,r,u);else{var l=i?i(o,c,r+"",e,t,s):void 0,h=void 0===l;if(h){var p=_s(c),g=!p&&Ls(c),b=!p&&!g&&Zs(c);l=c,p||g||b?_s(o)?l=o:Ns(o)?l=dn(o):g?(h=!1,l=ln(c,!0)):b?(h=!1,l=pn(c,!0)):l=[]:Gs(c)||Rs(c)?(l=o,Rs(o)?l=so(o):Hs(o)&&!zs(o)||(l=ai(c))):h=!1}h&&(s.set(c,l),n(l,c,a,i,s),s.delete(c)),Er(e,r,l)}}(e,t,s,r,Va,a,n);else{var o=a?a(di(e,s),i,s+"",e,t,n):void 0;void 0===o&&(o=i),Er(e,s,o)}}),wo)}function Oa(e,t){var r=e.length;if(r)return ii(t+=t<0?r:0,r)?e[t]:void 0}function Ca(e,t,r){t=t.length?lt(t,(function(e){return _s(e)?function(t){return la(t,1===e.length?e[0]:e)}:e})):[Go];var a=-1;return t=lt(t,Vt($n())),function(e,t){var a=e.length;for(e.sort((function(e,t){return function(e,t,r){for(var a=-1,n=e.criteria,i=t.criteria,s=n.length,o=r.length;++a<s;){var c=gn(n[a],i[a]);if(c)return a>=o?c:c*("desc"==r[a]?-1:1)}return e.index-t.index}(e,t,r)}));a--;)e[a]=e[a].value;return e}(Wa(e,(function(e,r,n){return{criteria:lt(t,(function(t){return t(e)})),index:++a,value:e}})))}function ka(e,t,r){for(var a=-1,n=t.length,i={};++a<n;){var s=t[a],o=la(e,s);r(o,s)&&ja(i,sn(s,e),o)}return i}function Ra(e,t,r,a){var n=a?yt:vt,i=-1,s=t.length,o=e;for(e===t&&(t=dn(t)),r&&(o=lt(e,Vt(r)));++i<s;)for(var c=0,u=t[i],l=r?r(u):u;(c=n(o,l,c,a))>-1;)o!==e&&qe.call(o,c,1),qe.call(e,c,1);return e}function _a(e,t){for(var r=e?t.length:0,a=r-1;r--;){var n=t[r];if(r==a||n!==i){var i=n;ii(n)?qe.call(e,n,1):Xa(e,n)}}return e}function Ta(e,t){return e+Jt(ur()*(t-e+1))}function Ia(e,t){var r="";if(!e||t<1||t>9007199254740991)return r;do{t%2&&(r+=e),(t=Jt(t/2))&&(e+=e)}while(t);return r}function Na(e,t){return yi(gi(e,t,Go),e+"")}function La(e){return Ar(Co(e))}function Aa(e,t){var r=Co(e);return wi(r,qr(t,0,r.length))}function ja(e,t,r,a){if(!Hs(e))return e;for(var n=-1,i=(t=sn(t,e)).length,s=i-1,o=e;null!=o&&++n<i;){var c=Mi(t[n]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(n!=s){var l=o[c];void 0===(u=a?a(l,c,o):void 0)&&(u=Hs(l)?l:ii(t[n+1])?[]:{})}Yr(o,c,u),o=o[c]}return e}var za=mr?function(e,t){return mr.set(e,t),e}:Go,Ea=qt?function(e,t){return qt(e,"toString",{configurable:!0,enumerable:!1,value:Uo(t),writable:!0})}:Go;function Ya(e){return wi(Co(e))}function Ha(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=a(i);++n<i;)s[n]=e[n+t];return s}function Ua(e,t){var r;return Jr(e,(function(e,a,n){return!(r=t(e,a,n))})),!!r}function Ba(e,t,r){var a=0,n=null==e?a:e.length;if("number"==typeof t&&t==t&&n<=2147483647){for(;a<n;){var i=a+n>>>1,s=e[i];null!==s&&!Xs(s)&&(r?s<=t:s<t)?a=i+1:n=i}return n}return Qa(e,t,Go,r)}function Qa(e,t,r,a){var n=0,i=null==e?0:e.length;if(0===i)return 0;for(var s=(t=r(t))!=t,o=null===t,c=Xs(t),u=void 0===t;n<i;){var l=Jt((n+i)/2),h=r(e[l]),p=void 0!==h,g=null===h,b=h==h,f=Xs(h);if(s)var d=a||b;else d=u?b&&(a||p):o?b&&p&&(a||!g):c?b&&p&&!g&&(a||!f):!g&&!f&&(a?h<=t:h<t);d?n=l+1:i=l}return sr(i,4294967294)}function Ga(e,t){for(var r=-1,a=e.length,n=0,i=[];++r<a;){var s=e[r],o=t?t(s):s;if(!r||!Os(o,c)){var c=o;i[n++]=0===s?0:s}}return i}function qa(e){return"number"==typeof e?e:Xs(e)?NaN:+e}function $a(e){if("string"==typeof e)return e;if(_s(e))return lt(e,$a)+"";if(Xs(e))return Mr?Mr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ka(e,t,r){var a=-1,n=ct,i=e.length,s=!0,o=[],c=o;if(r)s=!1,n=ut;else if(i>=200){var u=t?null:Nn(e);if(u)return Et(u);s=!1,n=Ct,c=new Ir}else c=t?[]:o;e:for(;++a<i;){var l=e[a],h=t?t(l):l;if(l=r||0!==l?l:0,s&&h==h){for(var p=c.length;p--;)if(c[p]===h)continue e;t&&c.push(h),o.push(l)}else n(c,h,r)||(c!==o&&c.push(h),o.push(l))}return o}function Xa(e,t){return null==(e=bi(e,t=sn(t,e)))||delete e[Mi(ji(t))]}function Za(e,t,r,a){return ja(e,t,r(la(e,t)),a)}function Ja(e,t,r,a){for(var n=e.length,i=a?n:-1;(a?i--:++i<n)&&t(e[i],i,e););return r?Ha(e,a?0:i,a?i+1:n):Ha(e,a?i+1:0,a?n:i)}function en(e,t){var r=e;return r instanceof kr&&(r=r.value()),pt(t,(function(e,t){return t.func.apply(t.thisArg,ht([e],t.args))}),r)}function tn(e,t,r){var n=e.length;if(n<2)return n?Ka(e[0]):[];for(var i=-1,s=a(n);++i<n;)for(var o=e[i],c=-1;++c<n;)c!=i&&(s[i]=Zr(s[i]||o,e[c],t,r));return Ka(na(s,1),t,r)}function rn(e,t,r){for(var a=-1,n=e.length,i=t.length,s={};++a<n;)r(s,e[a],a<i?t[a]:void 0);return s}function an(e){return Ns(e)?e:[]}function nn(e){return"function"==typeof e?e:Go}function sn(e,t){return _s(e)?e:oi(e,t)?[e]:Wi(oo(e))}var on=Na;function cn(e,t,r){var a=e.length;return r=void 0===r?a:r,!t&&r>=a?e:Ha(e,t,r)}var un=$t||function(e){return Ue.clearTimeout(e)};function ln(e,t){if(t)return e.slice();var r=e.length,a=Ye?Ye(r):new e.constructor(r);return e.copy(a),a}function hn(e){var t=new e.constructor(e.byteLength);return new je(t).set(new je(e)),t}function pn(e,t){var r=t?hn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function gn(e,t){if(e!==t){var r=void 0!==e,a=null===e,n=e==e,i=Xs(e),s=void 0!==t,o=null===t,c=t==t,u=Xs(t);if(!o&&!u&&!i&&e>t||i&&s&&c&&!o&&!u||a&&s&&c||!r&&c||!n)return 1;if(!a&&!i&&!u&&e<t||u&&r&&n&&!a&&!i||o&&r&&n||!s&&n||!c)return-1}return 0}function bn(e,t,r,n){for(var i=-1,s=e.length,o=r.length,c=-1,u=t.length,l=ir(s-o,0),h=a(u+l),p=!n;++c<u;)h[c]=t[c];for(;++i<o;)(p||i<s)&&(h[r[i]]=e[i]);for(;l--;)h[c++]=e[i++];return h}function fn(e,t,r,n){for(var i=-1,s=e.length,o=-1,c=r.length,u=-1,l=t.length,h=ir(s-c,0),p=a(h+l),g=!n;++i<h;)p[i]=e[i];for(var b=i;++u<l;)p[b+u]=t[u];for(;++o<c;)(g||i<s)&&(p[b+r[o]]=e[i++]);return p}function dn(e,t){var r=-1,n=e.length;for(t||(t=a(n));++r<n;)t[r]=e[r];return t}function mn(e,t,r,a){var n=!r;r||(r={});for(var i=-1,s=t.length;++i<s;){var o=t[i],c=a?a(r[o],e[o],o,r,e):void 0;void 0===c&&(c=e[o]),n?Qr(r,o,c):Yr(r,o,c)}return r}function vn(e,t){return function(r,a){var n=_s(r)?at:Ur,i=t?t():{};return n(r,e,$n(a,2),i)}}function yn(e){return Na((function(t,r){var a=-1,n=r.length,i=n>1?r[n-1]:void 0,s=n>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(n--,i):void 0,s&&si(r[0],r[1],s)&&(i=n<3?void 0:i,n=1),t=be(t);++a<n;){var o=r[a];o&&e(t,o,a,i)}return t}))}function Dn(e,t){return function(r,a){if(null==r)return r;if(!Is(r))return e(r,a);for(var n=r.length,i=t?n:-1,s=be(r);(t?i--:++i<n)&&!1!==a(s[i],i,s););return r}}function Sn(e){return function(t,r,a){for(var n=-1,i=be(t),s=a(t),o=s.length;o--;){var c=s[e?o:++n];if(!1===r(i[c],c,i))break}return t}}function wn(e){return function(t){var r=Lt(t=oo(t))?Ut(t):void 0,a=r?r[0]:t.charAt(0),n=r?cn(r,1).join(""):t.slice(1);return a[e]()+n}}function Fn(e){return function(t){return pt(Eo(_o(t).replace(Oe,"")),e,"")}}function xn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Vr(e.prototype),a=e.apply(r,t);return Hs(a)?a:r}}function Wn(e){return function(t,r,a){var n=be(t);if(!Is(t)){var i=$n(r,3);t=So(t),r=function(e){return i(n[e],e,n)}}var s=e(t,r,a);return s>-1?n[i?t[s]:s]:void 0}}function Mn(e){return Hn((function(t){var r=t.length,a=r,i=Cr.prototype.thru;for(e&&t.reverse();a--;){var s=t[a];if("function"!=typeof s)throw new me(n);if(i&&!o&&"wrapper"==Gn(s))var o=new Cr([],!0)}for(a=o?a:r;++a<r;){var c=Gn(s=t[a]),u="wrapper"==c?Qn(s):void 0;o=u&&ci(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?o[Gn(u[0])].apply(o,u[3]):1==s.length&&ci(s)?o[c]():o.thru(s)}return function(){var e=arguments,a=e[0];if(o&&1==e.length&&_s(a))return o.plant(a).value();for(var n=0,i=r?t[n].apply(this,e):a;++n<r;)i=t[n].call(this,i);return i}}))}function Pn(e,t,r,n,i,s,o,c,u,l){var h=128&t,p=1&t,g=2&t,b=24&t,f=512&t,d=g?void 0:xn(e);return function m(){for(var v=arguments.length,y=a(v),D=v;D--;)y[D]=arguments[D];if(b)var S=qn(m),w=_t(y,S);if(n&&(y=bn(y,n,i,b)),s&&(y=fn(y,s,o,b)),v-=w,b&&v<l){var F=zt(y,S);return Tn(e,t,Pn,m.placeholder,r,y,F,c,u,l-v)}var x=p?r:this,W=g?x[e]:e;return v=y.length,c?y=fi(y,c):f&&v>1&&y.reverse(),h&&u<v&&(y.length=u),this&&this!==Ue&&this instanceof m&&(W=d||xn(W)),W.apply(x,y)}}function Vn(e,t){return function(r,a){return function(e,t,r,a){return oa(e,(function(e,n,i){t(a,r(e),n,i)})),a}(r,e,t(a),{})}}function On(e,t){return function(r,a){var n;if(void 0===r&&void 0===a)return t;if(void 0!==r&&(n=r),void 0!==a){if(void 0===n)return a;"string"==typeof r||"string"==typeof a?(r=$a(r),a=$a(a)):(r=qa(r),a=qa(a)),n=e(r,a)}return n}}function Cn(e){return Hn((function(t){return t=lt(t,Vt($n())),Na((function(r){var a=this;return e(t,(function(e){return rt(e,a,r)}))}))}))}function kn(e,t){var r=(t=void 0===t?" ":$a(t)).length;if(r<2)return r?Ia(t,e):t;var a=Ia(t,Zt(e/Ht(t)));return Lt(t)?cn(Ut(a),0,e).join(""):a.slice(0,e)}function Rn(e){return function(t,r,n){return n&&"number"!=typeof n&&si(t,r,n)&&(r=n=void 0),t=ro(t),void 0===r?(r=t,t=0):r=ro(r),function(e,t,r,n){for(var i=-1,s=ir(Zt((t-e)/(r||1)),0),o=a(s);s--;)o[n?s:++i]=e,e+=r;return o}(t,r,n=void 0===n?t<r?1:-1:ro(n),e)}}function _n(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=io(t),r=io(r)),e(t,r)}}function Tn(e,t,r,a,n,i,s,o,c,u){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var h=[e,t,n,l?i:void 0,l?s:void 0,l?void 0:i,l?void 0:s,o,c,u],p=r.apply(void 0,h);return ci(e)&&mi(p,h),p.placeholder=a,Di(p,e,t)}function In(e){var t=ge[e];return function(e,r){if(e=io(e),(r=null==r?0:sr(ao(r),292))&&rr(e)){var a=(oo(e)+"e").split("e");return+((a=(oo(t(a[0]+"e"+(+a[1]+r)))+"e").split("e"))[0]+"e"+(+a[1]-r))}return t(e)}}var Nn=br&&1/Et(new br([,-0]))[1]==1/0?function(e){return new br(e)}:Zo;function Ln(e){return function(t){var r=ti(t);return r==b?At(t):r==v?Yt(t):function(e,t){return lt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function An(e,t,r,s,o,c,u,l){var h=2&t;if(!h&&"function"!=typeof e)throw new me(n);var p=s?s.length:0;if(p||(t&=-97,s=o=void 0),u=void 0===u?u:ir(ao(u),0),l=void 0===l?l:ao(l),p-=o?o.length:0,64&t){var g=s,b=o;s=o=void 0}var f=h?void 0:Qn(e),d=[e,t,r,s,o,g,b,c,u,l];if(f&&function(e,t){var r=e[1],a=t[1],n=r|a;if(!(n<131||128==a&&8==r||128==a&&256==r&&e[7].length<=t[8]||384==a&&t[7].length<=t[8]&&8==r))return e;1&a&&(e[2]=t[2],n|=1&r?0:4);var s=t[3];if(s){var o=e[3];e[3]=o?bn(o,s,t[4]):s,e[4]=o?zt(e[3],i):t[4]}(s=t[5])&&(e[5]=(o=e[5])?fn(o,s,t[6]):s,e[6]=o?zt(e[5],i):t[6]),(s=t[7])&&(e[7]=s),128&a&&(e[8]=null==e[8]?t[8]:sr(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=n}(d,f),e=d[0],t=d[1],r=d[2],s=d[3],o=d[4],!(l=d[9]=void 0===d[9]?h?0:e.length:ir(d[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)m=8==t||16==t?function(e,t,r){var n=xn(e);return function i(){for(var s=arguments.length,o=a(s),c=s,u=qn(i);c--;)o[c]=arguments[c];var l=s<3&&o[0]!==u&&o[s-1]!==u?[]:zt(o,u);if((s-=l.length)<r)return Tn(e,t,Pn,i.placeholder,void 0,o,l,void 0,void 0,r-s);var h=this&&this!==Ue&&this instanceof i?n:e;return rt(h,this,o)}}(e,t,l):32!=t&&33!=t||o.length?Pn.apply(void 0,d):function(e,t,r,n){var i=1&t,s=xn(e);return function t(){for(var o=-1,c=arguments.length,u=-1,l=n.length,h=a(l+c),p=this&&this!==Ue&&this instanceof t?s:e;++u<l;)h[u]=n[u];for(;c--;)h[u++]=arguments[++o];return rt(p,i?r:this,h)}}(e,t,r,s);else var m=function(e,t,r){var a=1&t,n=xn(e);return function t(){var i=this&&this!==Ue&&this instanceof t?n:e;return i.apply(a?r:this,arguments)}}(e,t,r);return Di((f?za:mi)(m,d),e,t)}function jn(e,t,r,a){return void 0===e||Os(e,ye[r])&&!we.call(a,r)?t:e}function zn(e,t,r,a,n,i){return Hs(e)&&Hs(t)&&(i.set(t,e),Va(e,t,void 0,zn,i),i.delete(t)),e}function En(e){return Gs(e)?void 0:e}function Yn(e,t,r,a,n,i){var s=1&r,o=e.length,c=t.length;if(o!=c&&!(s&&c>o))return!1;var u=i.get(e),l=i.get(t);if(u&&l)return u==t&&l==e;var h=-1,p=!0,g=2&r?new Ir:void 0;for(i.set(e,t),i.set(t,e);++h<o;){var b=e[h],f=t[h];if(a)var d=s?a(f,b,h,t,e,i):a(b,f,h,e,t,i);if(void 0!==d){if(d)continue;p=!1;break}if(g){if(!bt(t,(function(e,t){if(!Ct(g,t)&&(b===e||n(b,e,r,a,i)))return g.push(t)}))){p=!1;break}}else if(b!==f&&!n(b,f,r,a,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function Hn(e){return yi(gi(e,void 0,Ti),e+"")}function Un(e){return ha(e,So,Jn)}function Bn(e){return ha(e,wo,ei)}var Qn=mr?function(e){return mr.get(e)}:Zo;function Gn(e){for(var t=e.name+"",r=vr[t],a=we.call(vr,t)?r.length:0;a--;){var n=r[a],i=n.func;if(null==i||i==e)return n.name}return t}function qn(e){return(we.call(Pr,"placeholder")?Pr:e).placeholder}function $n(){var e=Pr.iteratee||qo;return e=e===qo?wa:e,arguments.length?e(arguments[0],arguments[1]):e}function Kn(e,t){var r,a,n=e.__data__;return("string"==(a=typeof(r=t))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function Xn(e){for(var t=So(e),r=t.length;r--;){var a=t[r],n=e[a];t[r]=[a,n,hi(n)]}return t}function Zn(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Sa(r)?r:void 0}var Jn=er?function(e){return null==e?[]:(e=be(e),ot(er(e),(function(t){return Qe.call(e,t)})))}:ic,ei=er?function(e){for(var t=[];e;)ht(t,Jn(e)),e=He(e);return t}:ic,ti=pa;function ri(e,t,r){for(var a=-1,n=(t=sn(t,e)).length,i=!1;++a<n;){var s=Mi(t[a]);if(!(i=null!=e&&r(e,s)))break;e=e[s]}return i||++a!=n?i:!!(n=null==e?0:e.length)&&Ys(n)&&ii(s,n)&&(_s(e)||Rs(e))}function ai(e){return"function"!=typeof e.constructor||li(e)?{}:Vr(He(e))}function ni(e){return _s(e)||Rs(e)||!!($e&&e&&e[$e])}function ii(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&oe.test(e))&&e>-1&&e%1==0&&e<t}function si(e,t,r){if(!Hs(r))return!1;var a=typeof t;return!!("number"==a?Is(r)&&ii(t,r.length):"string"==a&&t in r)&&Os(r[t],e)}function oi(e,t){if(_s(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Xs(e))||H.test(e)||!Y.test(e)||null!=t&&e in be(t)}function ci(e){var t=Gn(e),r=Pr[t];if("function"!=typeof r||!(t in kr.prototype))return!1;if(e===r)return!0;var a=Qn(r);return!!a&&e===a[0]}(hr&&ti(new hr(new ArrayBuffer(1)))!=F||pr&&ti(new pr)!=b||gr&&"[object Promise]"!=ti(gr.resolve())||br&&ti(new br)!=v||fr&&ti(new fr)!=S)&&(ti=function(e){var t=pa(e),r=t==d?e.constructor:void 0,a=r?Pi(r):"";if(a)switch(a){case yr:return F;case Dr:return b;case Sr:return"[object Promise]";case wr:return v;case Fr:return S}return t});var ui=De?zs:sc;function li(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ye)}function hi(e){return e==e&&!Hs(e)}function pi(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in be(r))}}function gi(e,t,r){return t=ir(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=ir(n.length-t,0),o=a(s);++i<s;)o[i]=n[t+i];i=-1;for(var c=a(t+1);++i<t;)c[i]=n[i];return c[t]=r(o),rt(e,this,c)}}function bi(e,t){return t.length<2?e:la(e,Ha(t,0,-1))}function fi(e,t){for(var r=e.length,a=sr(t.length,r),n=dn(e);a--;){var i=t[a];e[a]=ii(i,r)?n[i]:void 0}return e}function di(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var mi=Si(za),vi=Xt||function(e,t){return Ue.setTimeout(e,t)},yi=Si(Ea);function Di(e,t,r){var a=t+"";return yi(e,function(e,t){var r=t.length;if(!r)return e;var a=r-1;return t[a]=(r>1?"& ":"")+t[a],t=t.join(r>2?", ":" "),e.replace($,"{\n/* [wrapped with "+t+"] */\n")}(a,function(e,t){return nt(s,(function(r){var a="_."+r[0];t&r[1]&&!ct(e,a)&&e.push(a)})),e.sort()}(function(e){var t=e.match(K);return t?t[1].split(X):[]}(a),r)))}function Si(e){var t=0,r=0;return function(){var a=or(),n=16-(a-r);if(r=a,n>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function wi(e,t){var r=-1,a=e.length,n=a-1;for(t=void 0===t?a:t;++r<t;){var i=Ta(r,n),s=e[i];e[i]=e[r],e[r]=s}return e.length=t,e}var Fi,xi,Wi=(Fi=Fs((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(U,(function(e,r,a,n){t.push(a?n.replace(ee,"$1"):r||e)})),t}),(function(e){return 500===xi.size&&xi.clear(),e})),xi=Fi.cache,Fi);function Mi(e){if("string"==typeof e||Xs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Pi(e){if(null!=e){try{return Se.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Vi(e){if(e instanceof kr)return e.clone();var t=new Cr(e.__wrapped__,e.__chain__);return t.__actions__=dn(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Oi=Na((function(e,t){return Ns(e)?Zr(e,na(t,1,Ns,!0)):[]})),Ci=Na((function(e,t){var r=ji(t);return Ns(r)&&(r=void 0),Ns(e)?Zr(e,na(t,1,Ns,!0),$n(r,2)):[]})),ki=Na((function(e,t){var r=ji(t);return Ns(r)&&(r=void 0),Ns(e)?Zr(e,na(t,1,Ns,!0),void 0,r):[]}));function Ri(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var n=null==r?0:ao(r);return n<0&&(n=ir(a+n,0)),mt(e,$n(t,3),n)}function _i(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var n=a-1;return void 0!==r&&(n=ao(r),n=r<0?ir(a+n,0):sr(n,a-1)),mt(e,$n(t,3),n,!0)}function Ti(e){return null!=e&&e.length?na(e,1):[]}function Ii(e){return e&&e.length?e[0]:void 0}var Ni=Na((function(e){var t=lt(e,an);return t.length&&t[0]===e[0]?da(t):[]})),Li=Na((function(e){var t=ji(e),r=lt(e,an);return t===ji(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?da(r,$n(t,2)):[]})),Ai=Na((function(e){var t=ji(e),r=lt(e,an);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?da(r,void 0,t):[]}));function ji(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var zi=Na(Ei);function Ei(e,t){return e&&e.length&&t&&t.length?Ra(e,t):e}var Yi=Hn((function(e,t){var r=null==e?0:e.length,a=Gr(e,t);return _a(e,lt(t,(function(e){return ii(e,r)?+e:e})).sort(gn)),a}));function Hi(e){return null==e?e:lr.call(e)}var Ui=Na((function(e){return Ka(na(e,1,Ns,!0))})),Bi=Na((function(e){var t=ji(e);return Ns(t)&&(t=void 0),Ka(na(e,1,Ns,!0),$n(t,2))})),Qi=Na((function(e){var t=ji(e);return t="function"==typeof t?t:void 0,Ka(na(e,1,Ns,!0),void 0,t)}));function Gi(e){if(!e||!e.length)return[];var t=0;return e=ot(e,(function(e){if(Ns(e))return t=ir(e.length,t),!0})),Mt(t,(function(t){return lt(e,wt(t))}))}function qi(e,t){if(!e||!e.length)return[];var r=Gi(e);return null==t?r:lt(r,(function(e){return rt(t,void 0,e)}))}var $i=Na((function(e,t){return Ns(e)?Zr(e,t):[]})),Ki=Na((function(e){return tn(ot(e,Ns))})),Xi=Na((function(e){var t=ji(e);return Ns(t)&&(t=void 0),tn(ot(e,Ns),$n(t,2))})),Zi=Na((function(e){var t=ji(e);return t="function"==typeof t?t:void 0,tn(ot(e,Ns),void 0,t)})),Ji=Na(Gi),es=Na((function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r="function"==typeof r?(e.pop(),r):void 0,qi(e,r)}));function ts(e){var t=Pr(e);return t.__chain__=!0,t}function rs(e,t){return t(e)}var as=Hn((function(e){var t=e.length,r=t?e[0]:0,a=this.__wrapped__,n=function(t){return Gr(t,e)};return!(t>1||this.__actions__.length)&&a instanceof kr&&ii(r)?((a=a.slice(r,+r+(t?1:0))).__actions__.push({func:rs,args:[n],thisArg:void 0}),new Cr(a,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(n)})),ns=vn((function(e,t,r){we.call(e,r)?++e[r]:Qr(e,r,1)})),is=Wn(Ri),ss=Wn(_i);function os(e,t){return(_s(e)?nt:Jr)(e,$n(t,3))}function cs(e,t){return(_s(e)?it:ea)(e,$n(t,3))}var us=vn((function(e,t,r){we.call(e,r)?e[r].push(t):Qr(e,r,[t])})),ls=Na((function(e,t,r){var n=-1,i="function"==typeof t,s=Is(e)?a(e.length):[];return Jr(e,(function(e){s[++n]=i?rt(t,e,r):ma(e,t,r)})),s})),hs=vn((function(e,t,r){Qr(e,r,t)}));function ps(e,t){return(_s(e)?lt:Wa)(e,$n(t,3))}var gs=vn((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]})),bs=Na((function(e,t){if(null==e)return[];var r=t.length;return r>1&&si(e,t[0],t[1])?t=[]:r>2&&si(t[0],t[1],t[2])&&(t=[t[0]]),Ca(e,na(t,1),[])})),fs=Kt||function(){return Ue.Date.now()};function ds(e,t,r){return t=r?void 0:t,An(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function ms(e,t){var r;if("function"!=typeof t)throw new me(n);return e=ao(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var vs=Na((function(e,t,r){var a=1;if(r.length){var n=zt(r,qn(vs));a|=32}return An(e,a,t,r,n)})),ys=Na((function(e,t,r){var a=3;if(r.length){var n=zt(r,qn(ys));a|=32}return An(t,a,e,r,n)}));function Ds(e,t,r){var a,i,s,o,c,u,l=0,h=!1,p=!1,g=!0;if("function"!=typeof e)throw new me(n);function b(t){var r=a,n=i;return a=i=void 0,l=t,o=e.apply(n,r)}function f(e){return l=e,c=vi(m,t),h?b(e):o}function d(e){var r=e-u;return void 0===u||r>=t||r<0||p&&e-l>=s}function m(){var e=fs();if(d(e))return v(e);c=vi(m,function(e){var r=t-(e-u);return p?sr(r,s-(e-l)):r}(e))}function v(e){return c=void 0,g&&a?b(e):(a=i=void 0,o)}function y(){var e=fs(),r=d(e);if(a=arguments,i=this,u=e,r){if(void 0===c)return f(u);if(p)return un(c),c=vi(m,t),b(u)}return void 0===c&&(c=vi(m,t)),o}return t=io(t)||0,Hs(r)&&(h=!!r.leading,s=(p="maxWait"in r)?ir(io(r.maxWait)||0,t):s,g="trailing"in r?!!r.trailing:g),y.cancel=function(){void 0!==c&&un(c),l=0,a=u=i=c=void 0},y.flush=function(){return void 0===c?o:v(fs())},y}var Ss=Na((function(e,t){return Xr(e,1,t)})),ws=Na((function(e,t,r){return Xr(e,io(t)||0,r)}));function Fs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new me(n);var r=function r(){var a=arguments,n=t?t.apply(this,a):a[0],i=r.cache;if(i.has(n))return i.get(n);var s=e.apply(this,a);return r.cache=i.set(n,s)||i,s};return r.cache=new(Fs.Cache||Tr),r}function xs(e){if("function"!=typeof e)throw new me(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Fs.Cache=Tr;var Ws=on((function(e,t){var r=(t=1==t.length&&_s(t[0])?lt(t[0],Vt($n())):lt(na(t,1),Vt($n()))).length;return Na((function(a){for(var n=-1,i=sr(a.length,r);++n<i;)a[n]=t[n].call(this,a[n]);return rt(e,this,a)}))})),Ms=Na((function(e,t){return An(e,32,void 0,t,zt(t,qn(Ms)))})),Ps=Na((function(e,t){return An(e,64,void 0,t,zt(t,qn(Ps)))})),Vs=Hn((function(e,t){return An(e,256,void 0,void 0,void 0,t)}));function Os(e,t){return e===t||e!=e&&t!=t}var Cs=_n(ga),ks=_n((function(e,t){return e>=t})),Rs=va(function(){return arguments}())?va:function(e){return Us(e)&&we.call(e,"callee")&&!Qe.call(e,"callee")},_s=a.isArray,Ts=Ke?Vt(Ke):function(e){return Us(e)&&pa(e)==w};function Is(e){return null!=e&&Ys(e.length)&&!zs(e)}function Ns(e){return Us(e)&&Is(e)}var Ls=tr||sc,As=Xe?Vt(Xe):function(e){return Us(e)&&pa(e)==l};function js(e){if(!Us(e))return!1;var t=pa(e);return t==h||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Gs(e)}function zs(e){if(!Hs(e))return!1;var t=pa(e);return t==p||t==g||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Es(e){return"number"==typeof e&&e==ao(e)}function Ys(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Hs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Us(e){return null!=e&&"object"==typeof e}var Bs=Ze?Vt(Ze):function(e){return Us(e)&&ti(e)==b};function Qs(e){return"number"==typeof e||Us(e)&&pa(e)==f}function Gs(e){if(!Us(e)||pa(e)!=d)return!1;var t=He(e);if(null===t)return!0;var r=we.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Se.call(r)==Me}var qs=Je?Vt(Je):function(e){return Us(e)&&pa(e)==m},$s=et?Vt(et):function(e){return Us(e)&&ti(e)==v};function Ks(e){return"string"==typeof e||!_s(e)&&Us(e)&&pa(e)==y}function Xs(e){return"symbol"==typeof e||Us(e)&&pa(e)==D}var Zs=tt?Vt(tt):function(e){return Us(e)&&Ys(e.length)&&!!Le[pa(e)]},Js=_n(xa),eo=_n((function(e,t){return e<=t}));function to(e){if(!e)return[];if(Is(e))return Ks(e)?Ut(e):dn(e);if(ft&&e[ft])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[ft]());var t=ti(e);return(t==b?At:t==v?Et:Co)(e)}function ro(e){return e?(e=io(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ao(e){var t=ro(e),r=t%1;return t==t?r?t-r:t:0}function no(e){return e?qr(ao(e),0,4294967295):0}function io(e){if("number"==typeof e)return e;if(Xs(e))return NaN;if(Hs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Hs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Pt(e);var r=ne.test(e);return r||se.test(e)?Ee(e.slice(2),r?2:8):ae.test(e)?NaN:+e}function so(e){return mn(e,wo(e))}function oo(e){return null==e?"":$a(e)}var co=yn((function(e,t){if(li(t)||Is(t))mn(t,So(t),e);else for(var r in t)we.call(t,r)&&Yr(e,r,t[r])})),uo=yn((function(e,t){mn(t,wo(t),e)})),lo=yn((function(e,t,r,a){mn(t,wo(t),e,a)})),ho=yn((function(e,t,r,a){mn(t,So(t),e,a)})),po=Hn(Gr),go=Na((function(e,t){e=be(e);var r=-1,a=t.length,n=a>2?t[2]:void 0;for(n&&si(t[0],t[1],n)&&(a=1);++r<a;)for(var i=t[r],s=wo(i),o=-1,c=s.length;++o<c;){var u=s[o],l=e[u];(void 0===l||Os(l,ye[u])&&!we.call(e,u))&&(e[u]=i[u])}return e})),bo=Na((function(e){return e.push(void 0,zn),rt(xo,void 0,e)}));function fo(e,t,r){var a=null==e?void 0:la(e,t);return void 0===a?r:a}function mo(e,t){return null!=e&&ri(e,t,fa)}var vo=Vn((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=We.call(t)),e[t]=r}),Uo(Go)),yo=Vn((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=We.call(t)),we.call(e,t)?e[t].push(r):e[t]=[r]}),$n),Do=Na(ma);function So(e){return Is(e)?Lr(e):Fa(e)}function wo(e){return Is(e)?Lr(e,!0):function(e){if(!Hs(e))return function(e){var t=[];if(null!=e)for(var r in be(e))t.push(r);return t}(e);var t=li(e),r=[];for(var a in e)("constructor"!=a||!t&&we.call(e,a))&&r.push(a);return r}(e)}var Fo=yn((function(e,t,r){Va(e,t,r)})),xo=yn((function(e,t,r,a){Va(e,t,r,a)})),Wo=Hn((function(e,t){var r={};if(null==e)return r;var a=!1;t=lt(t,(function(t){return t=sn(t,e),a||(a=t.length>1),t})),mn(e,Bn(e),r),a&&(r=$r(r,7,En));for(var n=t.length;n--;)Xa(r,t[n]);return r})),Mo=Hn((function(e,t){return null==e?{}:function(e,t){return ka(e,t,(function(t,r){return mo(e,r)}))}(e,t)}));function Po(e,t){if(null==e)return{};var r=lt(Bn(e),(function(e){return[e]}));return t=$n(t),ka(e,r,(function(e,r){return t(e,r[0])}))}var Vo=Ln(So),Oo=Ln(wo);function Co(e){return null==e?[]:Ot(e,So(e))}var ko=Fn((function(e,t,r){return t=t.toLowerCase(),e+(r?Ro(t):t)}));function Ro(e){return zo(oo(e).toLowerCase())}function _o(e){return(e=oo(e))&&e.replace(ce,Tt).replace(Ce,"")}var To=Fn((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()})),Io=Fn((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()})),No=wn("toLowerCase"),Lo=Fn((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()})),Ao=Fn((function(e,t,r){return e+(r?" ":"")+zo(t)})),jo=Fn((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()})),zo=wn("toUpperCase");function Eo(e,t,r){return e=oo(e),void 0===(t=r?void 0:t)?function(e){return Te.test(e)}(e)?function(e){return e.match(Re)||[]}(e):function(e){return e.match(Z)||[]}(e):e.match(t)||[]}var Yo=Na((function(e,t){try{return rt(e,void 0,t)}catch(r){return js(r)?r:new he(r)}})),Ho=Hn((function(e,t){return nt(t,(function(t){t=Mi(t),Qr(e,t,vs(e[t],e))})),e}));function Uo(e){return function(){return e}}var Bo=Mn(),Qo=Mn(!0);function Go(e){return e}function qo(e){return wa("function"==typeof e?e:$r(e,1))}var $o=Na((function(e,t){return function(r){return ma(r,e,t)}})),Ko=Na((function(e,t){return function(r){return ma(e,r,t)}}));function Xo(e,t,r){var a=So(t),n=ua(t,a);null!=r||Hs(t)&&(n.length||!a.length)||(r=t,t=e,e=this,n=ua(t,So(t)));var i=!(Hs(r)&&"chain"in r&&!r.chain),s=zs(e);return nt(n,(function(r){var a=t[r];e[r]=a,s&&(e.prototype[r]=function(){var t=this.__chain__;if(i||t){var r=e(this.__wrapped__),n=r.__actions__=dn(this.__actions__);return n.push({func:a,args:arguments,thisArg:e}),r.__chain__=t,r}return a.apply(e,ht([this.value()],arguments))})})),e}function Zo(){}var Jo=Cn(lt),ec=Cn(st),tc=Cn(bt);function rc(e){return oi(e)?wt(Mi(e)):function(e){return function(t){return la(t,e)}}(e)}var ac=Rn(),nc=Rn(!0);function ic(){return[]}function sc(){return!1}var oc,cc=On((function(e,t){return e+t}),0),uc=In("ceil"),lc=On((function(e,t){return e/t}),1),hc=In("floor"),pc=On((function(e,t){return e*t}),1),gc=In("round"),bc=On((function(e,t){return e-t}),0);return Pr.after=function(e,t){if("function"!=typeof t)throw new me(n);return e=ao(e),function(){if(--e<1)return t.apply(this,arguments)}},Pr.ary=ds,Pr.assign=co,Pr.assignIn=uo,Pr.assignInWith=lo,Pr.assignWith=ho,Pr.at=po,Pr.before=ms,Pr.bind=vs,Pr.bindAll=Ho,Pr.bindKey=ys,Pr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return _s(e)?e:[e]},Pr.chain=ts,Pr.chunk=function(e,t,r){t=(r?si(e,t,r):void 0===t)?1:ir(ao(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,s=0,o=a(Zt(n/t));i<n;)o[s++]=Ha(e,i,i+=t);return o},Pr.compact=function(e){for(var t=-1,r=null==e?0:e.length,a=0,n=[];++t<r;){var i=e[t];i&&(n[a++]=i)}return n},Pr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=a(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return ht(_s(r)?dn(r):[r],na(t,1))},Pr.cond=function(e){var t=null==e?0:e.length,r=$n();return e=t?lt(e,(function(e){if("function"!=typeof e[1])throw new me(n);return[r(e[0]),e[1]]})):[],Na((function(r){for(var a=-1;++a<t;){var n=e[a];if(rt(n[0],this,r))return rt(n[1],this,r)}}))},Pr.conforms=function(e){return function(e){var t=So(e);return function(r){return Kr(r,e,t)}}($r(e,1))},Pr.constant=Uo,Pr.countBy=ns,Pr.create=function(e,t){var r=Vr(e);return null==t?r:Br(r,t)},Pr.curry=function e(t,r,a){var n=An(t,8,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=e.placeholder,n},Pr.curryRight=function e(t,r,a){var n=An(t,16,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=e.placeholder,n},Pr.debounce=Ds,Pr.defaults=go,Pr.defaultsDeep=bo,Pr.defer=Ss,Pr.delay=ws,Pr.difference=Oi,Pr.differenceBy=Ci,Pr.differenceWith=ki,Pr.drop=function(e,t,r){var a=null==e?0:e.length;return a?Ha(e,(t=r||void 0===t?1:ao(t))<0?0:t,a):[]},Pr.dropRight=function(e,t,r){var a=null==e?0:e.length;return a?Ha(e,0,(t=a-(t=r||void 0===t?1:ao(t)))<0?0:t):[]},Pr.dropRightWhile=function(e,t){return e&&e.length?Ja(e,$n(t,3),!0,!0):[]},Pr.dropWhile=function(e,t){return e&&e.length?Ja(e,$n(t,3),!0):[]},Pr.fill=function(e,t,r,a){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&si(e,t,r)&&(r=0,a=n),function(e,t,r,a){var n=e.length;for((r=ao(r))<0&&(r=-r>n?0:n+r),(a=void 0===a||a>n?n:ao(a))<0&&(a+=n),a=r>a?0:no(a);r<a;)e[r++]=t;return e}(e,t,r,a)):[]},Pr.filter=function(e,t){return(_s(e)?ot:aa)(e,$n(t,3))},Pr.flatMap=function(e,t){return na(ps(e,t),1)},Pr.flatMapDeep=function(e,t){return na(ps(e,t),1/0)},Pr.flatMapDepth=function(e,t,r){return r=void 0===r?1:ao(r),na(ps(e,t),r)},Pr.flatten=Ti,Pr.flattenDeep=function(e){return null!=e&&e.length?na(e,1/0):[]},Pr.flattenDepth=function(e,t){return null!=e&&e.length?na(e,t=void 0===t?1:ao(t)):[]},Pr.flip=function(e){return An(e,512)},Pr.flow=Bo,Pr.flowRight=Qo,Pr.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,a={};++t<r;){var n=e[t];a[n[0]]=n[1]}return a},Pr.functions=function(e){return null==e?[]:ua(e,So(e))},Pr.functionsIn=function(e){return null==e?[]:ua(e,wo(e))},Pr.groupBy=us,Pr.initial=function(e){return null!=e&&e.length?Ha(e,0,-1):[]},Pr.intersection=Ni,Pr.intersectionBy=Li,Pr.intersectionWith=Ai,Pr.invert=vo,Pr.invertBy=yo,Pr.invokeMap=ls,Pr.iteratee=qo,Pr.keyBy=hs,Pr.keys=So,Pr.keysIn=wo,Pr.map=ps,Pr.mapKeys=function(e,t){var r={};return t=$n(t,3),oa(e,(function(e,a,n){Qr(r,t(e,a,n),e)})),r},Pr.mapValues=function(e,t){var r={};return t=$n(t,3),oa(e,(function(e,a,n){Qr(r,a,t(e,a,n))})),r},Pr.matches=function(e){return Ma($r(e,1))},Pr.matchesProperty=function(e,t){return Pa(e,$r(t,1))},Pr.memoize=Fs,Pr.merge=Fo,Pr.mergeWith=xo,Pr.method=$o,Pr.methodOf=Ko,Pr.mixin=Xo,Pr.negate=xs,Pr.nthArg=function(e){return e=ao(e),Na((function(t){return Oa(t,e)}))},Pr.omit=Wo,Pr.omitBy=function(e,t){return Po(e,xs($n(t)))},Pr.once=function(e){return ms(2,e)},Pr.orderBy=function(e,t,r,a){return null==e?[]:(_s(t)||(t=null==t?[]:[t]),_s(r=a?void 0:r)||(r=null==r?[]:[r]),Ca(e,t,r))},Pr.over=Jo,Pr.overArgs=Ws,Pr.overEvery=ec,Pr.overSome=tc,Pr.partial=Ms,Pr.partialRight=Ps,Pr.partition=gs,Pr.pick=Mo,Pr.pickBy=Po,Pr.property=rc,Pr.propertyOf=function(e){return function(t){return null==e?void 0:la(e,t)}},Pr.pull=zi,Pr.pullAll=Ei,Pr.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Ra(e,t,$n(r,2)):e},Pr.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Ra(e,t,void 0,r):e},Pr.pullAt=Yi,Pr.range=ac,Pr.rangeRight=nc,Pr.rearg=Vs,Pr.reject=function(e,t){return(_s(e)?ot:aa)(e,xs($n(t,3)))},Pr.remove=function(e,t){var r=[];if(!e||!e.length)return r;var a=-1,n=[],i=e.length;for(t=$n(t,3);++a<i;){var s=e[a];t(s,a,e)&&(r.push(s),n.push(a))}return _a(e,n),r},Pr.rest=function(e,t){if("function"!=typeof e)throw new me(n);return Na(e,t=void 0===t?t:ao(t))},Pr.reverse=Hi,Pr.sampleSize=function(e,t,r){return t=(r?si(e,t,r):void 0===t)?1:ao(t),(_s(e)?jr:Aa)(e,t)},Pr.set=function(e,t,r){return null==e?e:ja(e,t,r)},Pr.setWith=function(e,t,r,a){return a="function"==typeof a?a:void 0,null==e?e:ja(e,t,r,a)},Pr.shuffle=function(e){return(_s(e)?zr:Ya)(e)},Pr.slice=function(e,t,r){var a=null==e?0:e.length;return a?(r&&"number"!=typeof r&&si(e,t,r)?(t=0,r=a):(t=null==t?0:ao(t),r=void 0===r?a:ao(r)),Ha(e,t,r)):[]},Pr.sortBy=bs,Pr.sortedUniq=function(e){return e&&e.length?Ga(e):[]},Pr.sortedUniqBy=function(e,t){return e&&e.length?Ga(e,$n(t,2)):[]},Pr.split=function(e,t,r){return r&&"number"!=typeof r&&si(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=oo(e))&&("string"==typeof t||null!=t&&!qs(t))&&!(t=$a(t))&&Lt(e)?cn(Ut(e),0,r):e.split(t,r):[]},Pr.spread=function(e,t){if("function"!=typeof e)throw new me(n);return t=null==t?0:ir(ao(t),0),Na((function(r){var a=r[t],n=cn(r,0,t);return a&&ht(n,a),rt(e,this,n)}))},Pr.tail=function(e){var t=null==e?0:e.length;return t?Ha(e,1,t):[]},Pr.take=function(e,t,r){return e&&e.length?Ha(e,0,(t=r||void 0===t?1:ao(t))<0?0:t):[]},Pr.takeRight=function(e,t,r){var a=null==e?0:e.length;return a?Ha(e,(t=a-(t=r||void 0===t?1:ao(t)))<0?0:t,a):[]},Pr.takeRightWhile=function(e,t){return e&&e.length?Ja(e,$n(t,3),!1,!0):[]},Pr.takeWhile=function(e,t){return e&&e.length?Ja(e,$n(t,3)):[]},Pr.tap=function(e,t){return t(e),e},Pr.throttle=function(e,t,r){var a=!0,i=!0;if("function"!=typeof e)throw new me(n);return Hs(r)&&(a="leading"in r?!!r.leading:a,i="trailing"in r?!!r.trailing:i),Ds(e,t,{leading:a,maxWait:t,trailing:i})},Pr.thru=rs,Pr.toArray=to,Pr.toPairs=Vo,Pr.toPairsIn=Oo,Pr.toPath=function(e){return _s(e)?lt(e,Mi):Xs(e)?[e]:dn(Wi(oo(e)))},Pr.toPlainObject=so,Pr.transform=function(e,t,r){var a=_s(e),n=a||Ls(e)||Zs(e);if(t=$n(t,4),null==r){var i=e&&e.constructor;r=n?a?new i:[]:Hs(e)&&zs(i)?Vr(He(e)):{}}return(n?nt:oa)(e,(function(e,a,n){return t(r,e,a,n)})),r},Pr.unary=function(e){return ds(e,1)},Pr.union=Ui,Pr.unionBy=Bi,Pr.unionWith=Qi,Pr.uniq=function(e){return e&&e.length?Ka(e):[]},Pr.uniqBy=function(e,t){return e&&e.length?Ka(e,$n(t,2)):[]},Pr.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Ka(e,void 0,t):[]},Pr.unset=function(e,t){return null==e||Xa(e,t)},Pr.unzip=Gi,Pr.unzipWith=qi,Pr.update=function(e,t,r){return null==e?e:Za(e,t,nn(r))},Pr.updateWith=function(e,t,r,a){return a="function"==typeof a?a:void 0,null==e?e:Za(e,t,nn(r),a)},Pr.values=Co,Pr.valuesIn=function(e){return null==e?[]:Ot(e,wo(e))},Pr.without=$i,Pr.words=Eo,Pr.wrap=function(e,t){return Ms(nn(t),e)},Pr.xor=Ki,Pr.xorBy=Xi,Pr.xorWith=Zi,Pr.zip=Ji,Pr.zipObject=function(e,t){return rn(e||[],t||[],Yr)},Pr.zipObjectDeep=function(e,t){return rn(e||[],t||[],ja)},Pr.zipWith=es,Pr.entries=Vo,Pr.entriesIn=Oo,Pr.extend=uo,Pr.extendWith=lo,Xo(Pr,Pr),Pr.add=cc,Pr.attempt=Yo,Pr.camelCase=ko,Pr.capitalize=Ro,Pr.ceil=uc,Pr.clamp=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=io(r))==r?r:0),void 0!==t&&(t=(t=io(t))==t?t:0),qr(io(e),t,r)},Pr.clone=function(e){return $r(e,4)},Pr.cloneDeep=function(e){return $r(e,5)},Pr.cloneDeepWith=function(e,t){return $r(e,5,t="function"==typeof t?t:void 0)},Pr.cloneWith=function(e,t){return $r(e,4,t="function"==typeof t?t:void 0)},Pr.conformsTo=function(e,t){return null==t||Kr(e,t,So(t))},Pr.deburr=_o,Pr.defaultTo=function(e,t){return null==e||e!=e?t:e},Pr.divide=lc,Pr.endsWith=function(e,t,r){e=oo(e),t=$a(t);var a=e.length,n=r=void 0===r?a:qr(ao(r),0,a);return(r-=t.length)>=0&&e.slice(r,n)==t},Pr.eq=Os,Pr.escape=function(e){return(e=oo(e))&&A.test(e)?e.replace(N,It):e},Pr.escapeRegExp=function(e){return(e=oo(e))&&Q.test(e)?e.replace(B,"\\$&"):e},Pr.every=function(e,t,r){var a=_s(e)?st:ta;return r&&si(e,t,r)&&(t=void 0),a(e,$n(t,3))},Pr.find=is,Pr.findIndex=Ri,Pr.findKey=function(e,t){return dt(e,$n(t,3),oa)},Pr.findLast=ss,Pr.findLastIndex=_i,Pr.findLastKey=function(e,t){return dt(e,$n(t,3),ca)},Pr.floor=hc,Pr.forEach=os,Pr.forEachRight=cs,Pr.forIn=function(e,t){return null==e?e:ia(e,$n(t,3),wo)},Pr.forInRight=function(e,t){return null==e?e:sa(e,$n(t,3),wo)},Pr.forOwn=function(e,t){return e&&oa(e,$n(t,3))},Pr.forOwnRight=function(e,t){return e&&ca(e,$n(t,3))},Pr.get=fo,Pr.gt=Cs,Pr.gte=ks,Pr.has=function(e,t){return null!=e&&ri(e,t,ba)},Pr.hasIn=mo,Pr.head=Ii,Pr.identity=Go,Pr.includes=function(e,t,r,a){e=Is(e)?e:Co(e),r=r&&!a?ao(r):0;var n=e.length;return r<0&&(r=ir(n+r,0)),Ks(e)?r<=n&&e.indexOf(t,r)>-1:!!n&&vt(e,t,r)>-1},Pr.indexOf=function(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var n=null==r?0:ao(r);return n<0&&(n=ir(a+n,0)),vt(e,t,n)},Pr.inRange=function(e,t,r){return t=ro(t),void 0===r?(r=t,t=0):r=ro(r),function(e,t,r){return e>=sr(t,r)&&e<ir(t,r)}(e=io(e),t,r)},Pr.invoke=Do,Pr.isArguments=Rs,Pr.isArray=_s,Pr.isArrayBuffer=Ts,Pr.isArrayLike=Is,Pr.isArrayLikeObject=Ns,Pr.isBoolean=function(e){return!0===e||!1===e||Us(e)&&pa(e)==u},Pr.isBuffer=Ls,Pr.isDate=As,Pr.isElement=function(e){return Us(e)&&1===e.nodeType&&!Gs(e)},Pr.isEmpty=function(e){if(null==e)return!0;if(Is(e)&&(_s(e)||"string"==typeof e||"function"==typeof e.splice||Ls(e)||Zs(e)||Rs(e)))return!e.length;var t=ti(e);if(t==b||t==v)return!e.size;if(li(e))return!Fa(e).length;for(var r in e)if(we.call(e,r))return!1;return!0},Pr.isEqual=function(e,t){return ya(e,t)},Pr.isEqualWith=function(e,t,r){var a=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===a?ya(e,t,void 0,r):!!a},Pr.isError=js,Pr.isFinite=function(e){return"number"==typeof e&&rr(e)},Pr.isFunction=zs,Pr.isInteger=Es,Pr.isLength=Ys,Pr.isMap=Bs,Pr.isMatch=function(e,t){return e===t||Da(e,t,Xn(t))},Pr.isMatchWith=function(e,t,r){return r="function"==typeof r?r:void 0,Da(e,t,Xn(t),r)},Pr.isNaN=function(e){return Qs(e)&&e!=+e},Pr.isNative=function(e){if(ui(e))throw new he("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sa(e)},Pr.isNil=function(e){return null==e},Pr.isNull=function(e){return null===e},Pr.isNumber=Qs,Pr.isObject=Hs,Pr.isObjectLike=Us,Pr.isPlainObject=Gs,Pr.isRegExp=qs,Pr.isSafeInteger=function(e){return Es(e)&&e>=-9007199254740991&&e<=9007199254740991},Pr.isSet=$s,Pr.isString=Ks,Pr.isSymbol=Xs,Pr.isTypedArray=Zs,Pr.isUndefined=function(e){return void 0===e},Pr.isWeakMap=function(e){return Us(e)&&ti(e)==S},Pr.isWeakSet=function(e){return Us(e)&&"[object WeakSet]"==pa(e)},Pr.join=function(e,t){return null==e?"":ar.call(e,t)},Pr.kebabCase=To,Pr.last=ji,Pr.lastIndexOf=function(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var n=a;return void 0!==r&&(n=(n=ao(r))<0?ir(a+n,0):sr(n,a-1)),t==t?function(e,t,r){for(var a=r+1;a--;)if(e[a]===t)return a;return a}(e,t,n):mt(e,Dt,n,!0)},Pr.lowerCase=Io,Pr.lowerFirst=No,Pr.lt=Js,Pr.lte=eo,Pr.max=function(e){return e&&e.length?ra(e,Go,ga):void 0},Pr.maxBy=function(e,t){return e&&e.length?ra(e,$n(t,2),ga):void 0},Pr.mean=function(e){return St(e,Go)},Pr.meanBy=function(e,t){return St(e,$n(t,2))},Pr.min=function(e){return e&&e.length?ra(e,Go,xa):void 0},Pr.minBy=function(e,t){return e&&e.length?ra(e,$n(t,2),xa):void 0},Pr.stubArray=ic,Pr.stubFalse=sc,Pr.stubObject=function(){return{}},Pr.stubString=function(){return""},Pr.stubTrue=function(){return!0},Pr.multiply=pc,Pr.nth=function(e,t){return e&&e.length?Oa(e,ao(t)):void 0},Pr.noConflict=function(){return Ue._===this&&(Ue._=Pe),this},Pr.noop=Zo,Pr.now=fs,Pr.pad=function(e,t,r){e=oo(e);var a=(t=ao(t))?Ht(e):0;if(!t||a>=t)return e;var n=(t-a)/2;return kn(Jt(n),r)+e+kn(Zt(n),r)},Pr.padEnd=function(e,t,r){e=oo(e);var a=(t=ao(t))?Ht(e):0;return t&&a<t?e+kn(t-a,r):e},Pr.padStart=function(e,t,r){e=oo(e);var a=(t=ao(t))?Ht(e):0;return t&&a<t?kn(t-a,r)+e:e},Pr.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),cr(oo(e).replace(G,""),t||0)},Pr.random=function(e,t,r){if(r&&"boolean"!=typeof r&&si(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=ro(e),void 0===t?(t=e,e=0):t=ro(t)),e>t){var a=e;e=t,t=a}if(r||e%1||t%1){var n=ur();return sr(e+n*(t-e+ze("1e-"+((n+"").length-1))),t)}return Ta(e,t)},Pr.reduce=function(e,t,r){var a=_s(e)?pt:xt,n=arguments.length<3;return a(e,$n(t,4),r,n,Jr)},Pr.reduceRight=function(e,t,r){var a=_s(e)?gt:xt,n=arguments.length<3;return a(e,$n(t,4),r,n,ea)},Pr.repeat=function(e,t,r){return t=(r?si(e,t,r):void 0===t)?1:ao(t),Ia(oo(e),t)},Pr.replace=function(){var e=arguments,t=oo(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Pr.result=function(e,t,r){var a=-1,n=(t=sn(t,e)).length;for(n||(n=1,e=void 0);++a<n;){var i=null==e?void 0:e[Mi(t[a])];void 0===i&&(a=n,i=r),e=zs(i)?i.call(e):i}return e},Pr.round=gc,Pr.runInContext=e,Pr.sample=function(e){return(_s(e)?Ar:La)(e)},Pr.size=function(e){if(null==e)return 0;if(Is(e))return Ks(e)?Ht(e):e.length;var t=ti(e);return t==b||t==v?e.size:Fa(e).length},Pr.snakeCase=Lo,Pr.some=function(e,t,r){var a=_s(e)?bt:Ua;return r&&si(e,t,r)&&(t=void 0),a(e,$n(t,3))},Pr.sortedIndex=function(e,t){return Ba(e,t)},Pr.sortedIndexBy=function(e,t,r){return Qa(e,t,$n(r,2))},Pr.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var a=Ba(e,t);if(a<r&&Os(e[a],t))return a}return-1},Pr.sortedLastIndex=function(e,t){return Ba(e,t,!0)},Pr.sortedLastIndexBy=function(e,t,r){return Qa(e,t,$n(r,2),!0)},Pr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var r=Ba(e,t,!0)-1;if(Os(e[r],t))return r}return-1},Pr.startCase=Ao,Pr.startsWith=function(e,t,r){return e=oo(e),r=null==r?0:qr(ao(r),0,e.length),t=$a(t),e.slice(r,r+t.length)==t},Pr.subtract=bc,Pr.sum=function(e){return e&&e.length?Wt(e,Go):0},Pr.sumBy=function(e,t){return e&&e.length?Wt(e,$n(t,2)):0},Pr.template=function(e,t,r){var a=Pr.templateSettings;r&&si(e,t,r)&&(t=void 0),e=oo(e),t=lo({},t,a,jn);var n,i,s=lo({},t.imports,a.imports,jn),o=So(s),c=Ot(s,o),u=0,l=t.interpolate||ue,h="__p += '",p=fe((t.escape||ue).source+"|"+l.source+"|"+(l===E?te:ue).source+"|"+(t.evaluate||ue).source+"|$","g"),g="//# sourceURL="+(we.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ne+"]")+"\n";e.replace(p,(function(t,r,a,s,o,c){return a||(a=s),h+=e.slice(u,c).replace(le,Nt),r&&(n=!0,h+="' +\n__e("+r+") +\n'"),o&&(i=!0,h+="';\n"+o+";\n__p += '"),a&&(h+="' +\n((__t = ("+a+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),h+="';\n";var b=we.call(t,"variable")&&t.variable;if(b){if(J.test(b))throw new he("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(i?h.replace(R,""):h).replace(_,"$1").replace(T,"$1;"),h="function("+(b||"obj")+") {\n"+(b?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(n?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var f=Yo((function(){return pe(o,g+"return "+h).apply(void 0,c)}));if(f.source=h,js(f))throw f;return f},Pr.times=function(e,t){if((e=ao(e))<1||e>9007199254740991)return[];var r=4294967295,a=sr(e,4294967295);e-=4294967295;for(var n=Mt(a,t=$n(t));++r<e;)t(r);return n},Pr.toFinite=ro,Pr.toInteger=ao,Pr.toLength=no,Pr.toLower=function(e){return oo(e).toLowerCase()},Pr.toNumber=io,Pr.toSafeInteger=function(e){return e?qr(ao(e),-9007199254740991,9007199254740991):0===e?e:0},Pr.toString=oo,Pr.toUpper=function(e){return oo(e).toUpperCase()},Pr.trim=function(e,t,r){if((e=oo(e))&&(r||void 0===t))return Pt(e);if(!e||!(t=$a(t)))return e;var a=Ut(e),n=Ut(t);return cn(a,kt(a,n),Rt(a,n)+1).join("")},Pr.trimEnd=function(e,t,r){if((e=oo(e))&&(r||void 0===t))return e.slice(0,Bt(e)+1);if(!e||!(t=$a(t)))return e;var a=Ut(e);return cn(a,0,Rt(a,Ut(t))+1).join("")},Pr.trimStart=function(e,t,r){if((e=oo(e))&&(r||void 0===t))return e.replace(G,"");if(!e||!(t=$a(t)))return e;var a=Ut(e);return cn(a,kt(a,Ut(t))).join("")},Pr.truncate=function(e,t){var r=30,a="...";if(Hs(t)){var n="separator"in t?t.separator:n;r="length"in t?ao(t.length):r,a="omission"in t?$a(t.omission):a}var i=(e=oo(e)).length;if(Lt(e)){var s=Ut(e);i=s.length}if(r>=i)return e;var o=r-Ht(a);if(o<1)return a;var c=s?cn(s,0,o).join(""):e.slice(0,o);if(void 0===n)return c+a;if(s&&(o+=c.length-o),qs(n)){if(e.slice(o).search(n)){var u,l=c;for(n.global||(n=fe(n.source,oo(re.exec(n))+"g")),n.lastIndex=0;u=n.exec(l);)var h=u.index;c=c.slice(0,void 0===h?o:h)}}else if(e.indexOf($a(n),o)!=o){var p=c.lastIndexOf(n);p>-1&&(c=c.slice(0,p))}return c+a},Pr.unescape=function(e){return(e=oo(e))&&L.test(e)?e.replace(I,Qt):e},Pr.uniqueId=function(e){var t=++Fe;return oo(e)+t},Pr.upperCase=jo,Pr.upperFirst=zo,Pr.each=os,Pr.eachRight=cs,Pr.first=Ii,Xo(Pr,(oc={},oa(Pr,(function(e,t){we.call(Pr.prototype,t)||(oc[t]=e)})),oc),{chain:!1}),Pr.VERSION="4.17.21",nt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Pr[e].placeholder=Pr})),nt(["drop","take"],(function(e,t){kr.prototype[e]=function(r){r=void 0===r?1:ir(ao(r),0);var a=this.__filtered__&&!t?new kr(this):this.clone();return a.__filtered__?a.__takeCount__=sr(r,a.__takeCount__):a.__views__.push({size:sr(r,4294967295),type:e+(a.__dir__<0?"Right":"")}),a},kr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),nt(["filter","map","takeWhile"],(function(e,t){var r=t+1,a=1==r||3==r;kr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:$n(e,3),type:r}),t.__filtered__=t.__filtered__||a,t}})),nt(["head","last"],(function(e,t){var r="take"+(t?"Right":"");kr.prototype[e]=function(){return this[r](1).value()[0]}})),nt(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");kr.prototype[e]=function(){return this.__filtered__?new kr(this):this[r](1)}})),kr.prototype.compact=function(){return this.filter(Go)},kr.prototype.find=function(e){return this.filter(e).head()},kr.prototype.findLast=function(e){return this.reverse().find(e)},kr.prototype.invokeMap=Na((function(e,t){return"function"==typeof e?new kr(this):this.map((function(r){return ma(r,e,t)}))})),kr.prototype.reject=function(e){return this.filter(xs($n(e)))},kr.prototype.slice=function(e,t){e=ao(e);var r=this;return r.__filtered__&&(e>0||t<0)?new kr(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),void 0!==t&&(r=(t=ao(t))<0?r.dropRight(-t):r.take(t-e)),r)},kr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},kr.prototype.toArray=function(){return this.take(4294967295)},oa(kr.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),n=Pr[a?"take"+("last"==t?"Right":""):t],i=a||/^find/.test(t);n&&(Pr.prototype[t]=function(){var t=this.__wrapped__,s=a?[1]:arguments,o=t instanceof kr,c=s[0],u=o||_s(t),l=function(e){var t=n.apply(Pr,ht([e],s));return a&&h?t[0]:t};u&&r&&"function"==typeof c&&1!=c.length&&(o=u=!1);var h=this.__chain__,p=!!this.__actions__.length,g=i&&!h,b=o&&!p;if(!i&&u){t=b?t:new kr(this);var f=e.apply(t,s);return f.__actions__.push({func:rs,args:[l],thisArg:void 0}),new Cr(f,h)}return g&&b?e.apply(this,s):(f=this.thru(l),g?a?f.value()[0]:f.value():f)})})),nt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ve[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);Pr.prototype[e]=function(){var e=arguments;if(a&&!this.__chain__){var n=this.value();return t.apply(_s(n)?n:[],e)}return this[r]((function(r){return t.apply(_s(r)?r:[],e)}))}})),oa(kr.prototype,(function(e,t){var r=Pr[t];if(r){var a=r.name+"";we.call(vr,a)||(vr[a]=[]),vr[a].push({name:t,func:r})}})),vr[Pn(void 0,2).name]=[{name:"wrapper",func:void 0}],kr.prototype.clone=function(){var e=new kr(this.__wrapped__);return e.__actions__=dn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=dn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=dn(this.__views__),e},kr.prototype.reverse=function(){if(this.__filtered__){var e=new kr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},kr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=_s(e),a=t<0,n=r?e.length:0,i=function(e,t,r){for(var a=-1,n=r.length;++a<n;){var i=r[a],s=i.size;switch(i.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=sr(t,e+s);break;case"takeRight":e=ir(e,t-s)}}return{start:e,end:t}}(0,n,this.__views__),s=i.start,o=i.end,c=o-s,u=a?o:s-1,l=this.__iteratees__,h=l.length,p=0,g=sr(c,this.__takeCount__);if(!r||!a&&n==c&&g==c)return en(e,this.__actions__);var b=[];e:for(;c--&&p<g;){for(var f=-1,d=e[u+=t];++f<h;){var m=l[f],v=m.type,y=(0,m.iteratee)(d);if(2==v)d=y;else if(!y){if(1==v)continue e;break e}}b[p++]=d}return b},Pr.prototype.at=as,Pr.prototype.chain=function(){return ts(this)},Pr.prototype.commit=function(){return new Cr(this.value(),this.__chain__)},Pr.prototype.next=function(){void 0===this.__values__&&(this.__values__=to(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},Pr.prototype.plant=function(e){for(var t,r=this;r instanceof Or;){var a=Vi(r);a.__index__=0,a.__values__=void 0,t?n.__wrapped__=a:t=a;var n=a;r=r.__wrapped__}return n.__wrapped__=e,t},Pr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof kr){var t=e;return this.__actions__.length&&(t=new kr(this)),(t=t.reverse()).__actions__.push({func:rs,args:[Hi],thisArg:void 0}),new Cr(t,this.__chain__)}return this.thru(Hi)},Pr.prototype.toJSON=Pr.prototype.valueOf=Pr.prototype.value=function(){return en(this.__wrapped__,this.__actions__)},Pr.prototype.first=Pr.prototype.head,ft&&(Pr.prototype[ft]=function(){return this}),Pr}();Ue._=Gt,void 0===(a=(function(){return Gt}).call(t,r,t,e))||(e.exports=a)}).call(this)}).call(this,r("YuTi")(e))},pJjZ:function(t,a,i){"use strict";i.r(a),i.d(a,"AdminReportingModule",(function(){return Xu}));var s,o=i("ofXK"),c=i("tyNb"),u=i("mrSG"),l=i("LvDl"),h=i("wd/R"),p=i("fXoL"),g=i("oabR"),b=i("aNep"),f=i("3awX"),d=i("/X+5"),m=i("kmnG"),v=i("d3UM"),y=i("3Pt+"),D=i("FKr1"),S=i("lDzL"),w=i("bv9b"),F=i("MT78"),x=((s=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}},{key:"ngOnChanges",value:function(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}},{key:"setChartOptions",value:function(t,r,a,n,i,s){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom);var o,c=[],u=e(n);try{for(u.s();!(o=u.n()).done;){var l=o.value,h=Object.keys(l)[0];h&&c.push({name:h,type:"bar",stack:"Ad",data:l[h].map((function(e){return parseFloat(e).toFixed(2)}))})}}catch(p){u.e(p)}finally{u.f()}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(e){var t=function(e){return'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e+'"></span>'},r="<p>"+e[0].axisValue+"</p>",a=0;return e.forEach((function(e){var n="<p>"+t(e.color)+" "+e.seriesName+":  $ "+e.data+"</p>";r+=n,a+=parseFloat(e.data)})),r+="<p>"+t("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:i},xAxis:[{type:"category",data:a,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:c},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}},{key:"convertTimeStampArryToDate",value:function(e){for(var t=[],r=0;r<e.length;r++)t.push(h(e[r]).format("MM-DD-YYYY"));return t}},{key:"getChartData",value:function(e){if(e)return e}}]),t}()).\u0275fac=function(e){return new(e||s)},s.\u0275cmp=p.Kb({type:s,selectors:[["app-reporting-revenue-chart"]],inputs:{chartData:"chartData"},features:[p.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(e,t){1&e&&p.Rb(0,"div",0)},styles:[".demo-chart[_ngcontent-%COMP%]{height:400px}"]}),s),W=i("MutI"),M=i("f0Cb");function P(e,t){if(1&e&&(p.Wb(0,"div",1),p.Wb(1,"div",2),p.Wb(2,"div",3),p.Wb(3,"div",4),p.Wb(4,"div",5),p.Wb(5,"h2",6),p.Oc(6,"Selected Statistics"),p.Vb(),p.Vb(),p.Vb(),p.Wb(7,"div",7),p.Wb(8,"mat-list"),p.Wb(9,"mat-list-item"),p.Oc(10),p.mc(11,"number"),p.Vb(),p.Rb(12,"mat-divider"),p.Rb(13,"mat-divider"),p.Wb(14,"mat-list-item"),p.Oc(15),p.mc(16,"number"),p.Vb(),p.Rb(17,"mat-divider"),p.Wb(18,"mat-list-item"),p.Oc(19),p.Vb(),p.Rb(20,"mat-divider"),p.Wb(21,"mat-list-item"),p.Oc(22),p.Vb(),p.Rb(23,"mat-divider"),p.Rb(24,"mat-list-item"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(25,"div",2),p.Wb(26,"div",3),p.Wb(27,"div",4),p.Wb(28,"div",5),p.Wb(29,"h2",6),p.Oc(30,"Month to Date Statistics"),p.Vb(),p.Vb(),p.Vb(),p.Wb(31,"div",7),p.Wb(32,"mat-list"),p.Wb(33,"mat-list-item"),p.Oc(34),p.mc(35,"number"),p.Vb(),p.Rb(36,"mat-divider"),p.Wb(37,"mat-list-item"),p.Oc(38),p.mc(39,"number"),p.Vb(),p.Rb(40,"mat-divider"),p.Wb(41,"mat-list-item"),p.Oc(42),p.mc(43,"number"),p.Vb(),p.Rb(44,"mat-divider"),p.Wb(45,"mat-list-item"),p.Oc(46),p.mc(47,"number"),p.Vb(),p.Rb(48,"mat-divider"),p.Wb(49,"mat-list-item"),p.Oc(50),p.mc(51,"number"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(52,"div",2),p.Wb(53,"div",3),p.Wb(54,"div",4),p.Wb(55,"div",5),p.Wb(56,"h2",6),p.Oc(57,"Last Month Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(58,"div",7),p.Wb(59,"mat-list"),p.Wb(60,"mat-list-item"),p.Oc(61),p.mc(62,"number"),p.Vb(),p.Rb(63,"mat-divider"),p.Wb(64,"mat-list-item"),p.Oc(65),p.mc(66,"number"),p.Vb(),p.Rb(67,"mat-divider"),p.Wb(68,"mat-list-item"),p.Oc(69),p.mc(70,"number"),p.Vb(),p.Rb(71,"mat-divider"),p.Wb(72,"mat-list-item"),p.Oc(73),p.mc(74,"number"),p.Vb(),p.Rb(75,"mat-divider"),p.Wb(76,"mat-list-item"),p.Oc(77),p.mc(78,"number"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc();p.Db(10),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].selectedStat[0].revenue?p.oc(11,14,r.summaryMetricsData.summary[0].selectedStat[0].revenue,"1.2-2"):"0.00",""),p.Db(5),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].selectedStat[0].profit?p.oc(16,17,r.summaryMetricsData.summary[0].selectedStat[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Start Date: ",r.summaryMetricsData.summary[0].selectedStat[0].selectedStartDate,""),p.Db(3),p.Qc("End Date: ",r.summaryMetricsData.summary[0].selectedStat[0].selectedEndDate,""),p.Db(12),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].revenue?p.oc(35,20,r.summaryMetricsData.summary[0].summaryMetrics[0].revenue,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Revenue Pace: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace?p.oc(39,23,r.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].profit?p.oc(43,26,r.summaryMetricsData.summary[0].summaryMetrics[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit Pace: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].profitPace?p.oc(47,29,r.summaryMetricsData.summary[0].summaryMetrics[0].profitPace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Percentage Change: ",r.summaryMetricsData.summary[0].summaryMetrics[0].percentPace?p.oc(51,32,r.summaryMetricsData.summary[0].summaryMetrics[0].percentPace,"1.2-2"):"0.00"," %"),p.Db(11),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].revenue?p.oc(62,35,r.summaryMetricsData.summary[0].lastMonthStat[0].revenue,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Revenue Pace: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace?p.oc(66,38,r.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace,"2.2-2"):"0.00",""),p.Db(4),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].profit?p.oc(70,41,r.summaryMetricsData.summary[0].lastMonthStat[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit Pace: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].profitPace?p.oc(74,44,r.summaryMetricsData.summary[0].lastMonthStat[0].profitPace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Percentage Change: ",r.summaryMetricsData.summary[0].lastMonthStat[0].percentPace?p.oc(78,47,r.summaryMetricsData.summary[0].lastMonthStat[0].percentPace,"1.2-2"):"0.00"," %")}}var V,O=((V=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){this.summaryMetricsData=this.getSummaryData(this.summaryMetricsData)}},{key:"getSummaryData",value:function(e){if(e)return e}}]),e}()).\u0275fac=function(e){return new(e||V)},V.\u0275cmp=p.Kb({type:V,selectors:[["app-summary-metrics"]],inputs:{summaryMetricsData:"summaryMetricsData"},decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-xl-4"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"]],template:function(e,t){1&e&&p.Mc(0,P,79,50,"div",0),2&e&&p.rc("ngIf",t.summaryMetricsData)},directives:[o.p,W.a,W.c,M.a],pipes:[o.g],styles:[""]}),V),C=["expandableTable"];function k(e,t){1&e&&(p.Wb(0,"div",32),p.Rb(1,"mat-progress-bar",33),p.Vb())}function R(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",34),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function _(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",35),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function T(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function I(e,t){if(1&e&&(p.Wb(0,"div",38),p.Wb(1,"table",39),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,T,27,35,"tr",40),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function N(e,t){1&e&&(p.Wb(0,"div",41),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function L(e,t){if(1&e&&(p.Mc(0,I,22,1,"div",36),p.Mc(1,N,6,0,"div",37)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function A(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",42),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function j(e,t){1&e&&p.Oc(0," Date ")}function z(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function E(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,j,1,0,"ng-template",24),p.Mc(2,z,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Y(e,t){1&e&&p.Oc(0," Subid ")}function H(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function U(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,Y,1,0,"ng-template",24),p.Mc(2,H,2,1,"ng-template",17),p.Vb())}function B(e,t){1&e&&p.Oc(0," Publisher ")}function Q(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function G(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,B,1,0,"ng-template",24),p.Mc(2,Q,2,1,"ng-template",17),p.Vb())}function q(e,t){1&e&&p.Oc(0," Clicks ")}function $(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function K(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,q,1,0,"ng-template",24),p.Mc(2,$,3,3,"ng-template",17),p.Vb())}function X(e,t){1&e&&p.Oc(0," Searches ")}function Z(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function J(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,X,1,0,"ng-template",24),p.Mc(2,Z,3,3,"ng-template",17),p.Vb())}function ee(e,t){1&e&&p.Oc(0," Filtering ")}function te(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function re(e,t){1&e&&p.Oc(0," Impressions ")}function ae(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ne(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,re,1,0,"ng-template",24),p.Mc(2,ae,3,3,"ng-template",17),p.Vb())}function ie(e,t){1&e&&p.Oc(0," CPC ")}function se(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function oe(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,ie,1,0,"ng-template",24),p.Mc(2,se,3,4,"ng-template",17),p.Vb())}function ce(e,t){1&e&&p.Oc(0," CTR ")}function ue(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function le(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,ce,1,0,"ng-template",24),p.Mc(2,ue,3,4,"ng-template",17),p.Vb())}function he(e,t){1&e&&p.Oc(0," Split ")}function pe(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ge(e,t){1&e&&p.Oc(0," Publisher Net ")}function be(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function fe(e,t){1&e&&p.Oc(0," Profit ")}function de(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function me(e,t){1&e&&p.Oc(0," Revenue ")}function ve(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var ye,De=((ye=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.apptitudeService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.cdr.detectChanges();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getAllApptitudeStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.apptitudeService.getApptitudeStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("apptitude"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.cdr.detectChanges();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].filtering+=parseFloat(t.filtering?t.filtering:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.detectChanges()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].filtering+=parseFloat(t.filtering?t.filtering:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].filtering+=parseFloat(t.filtering?t.filtering:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].impressions+=parseFloat(t.impressions?t.impressions:0),a[r].filtering+=parseFloat(t.filtering?t.filtering:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].impressions+=parseFloat(t.impressions?t.impressions:0),a[r].filtering+=parseFloat(t.filtering?t.filtering:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.apptitudeService.getApptitudeStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("apptitude"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher")}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].searches+=parseInt(t.searches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var a,n,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.apptitudeService.getSummaryMetrics(this.selectedCompany,t,r).toPromise();case 2:return a=e.sent,n={},i=0,s=0,o=0,e.abrupt("return",(0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=t,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}}]),t}()).\u0275fac=function(e){return new(e||ye)(p.Qb(p.i),p.Qb(g.a),p.Qb(b.a),p.Qb(f.a))},ye.\u0275cmp=p.Kb({type:ye,selectors:[["app-apptitude"]],viewQuery:function(e,t){var r;1&e&&p.Tc(C,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:47,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","clicks",4,"ngIf"],["name","searches",4,"ngIf"],["name","filtering"],["ngx-datatable-header-template",""],["name","impressions",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","split"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher"],["name","clicks"],["name","searches"],["name","impressions"],["name","cpc"],["name","ctr"]],template:function(e,t){1&e&&(p.Mc(0,k,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,R,1,1,"app-reporting-revenue-chart",2),p.Mc(3,_,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,L,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,A,1,4,"ng-template",17),p.Vb(),p.Mc(24,E,3,1,"ngx-datatable-column",18),p.Mc(25,U,3,0,"ngx-datatable-column",19),p.Mc(26,G,3,0,"ngx-datatable-column",20),p.Mc(27,K,3,0,"ngx-datatable-column",21),p.Mc(28,J,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,ee,1,0,"ng-template",24),p.Mc(31,te,3,3,"ng-template",17),p.Vb(),p.Mc(32,ne,3,0,"ngx-datatable-column",25),p.Mc(33,oe,3,0,"ngx-datatable-column",26),p.Mc(34,le,3,0,"ngx-datatable-column",27),p.Wb(35,"ngx-datatable-column",28),p.Mc(36,he,1,0,"ng-template",24),p.Mc(37,pe,3,3,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",29),p.Mc(39,ge,1,0,"ng-template",24),p.Mc(40,be,3,4,"ng-template",17),p.Vb(),p.Wb(41,"ngx-datatable-column",30),p.Mc(42,fe,1,0,"ng-template",24),p.Mc(43,de,3,4,"ng-template",17),p.Vb(),p.Wb(44,"ngx-datatable-column",31),p.Mc(45,me,1,0,"ng-template",24),p.Mc(46,ve,3,4,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(4),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),ye),Se=i("XJ1K"),we=["expandableTable"];function Fe(e,t){1&e&&(p.Wb(0,"div",27),p.Rb(1,"mat-progress-bar",28),p.Vb())}function xe(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",29),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function We(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",30),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Me(e,t){1&e&&(p.Wb(0,"div",31),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Pe(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",32),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Ve(e,t){1&e&&p.Oc(0," Date ")}function Oe(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ce(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",33),p.Mc(1,Ve,1,0,"ng-template",17),p.Mc(2,Oe,3,3,"ng-template",13),p.Vb()),2&e&&p.rc("minWidth",100)}function ke(e,t){1&e&&p.Oc(0," Subid ")}function Re(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function _e(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",34),p.Mc(1,ke,1,0,"ng-template",17),p.Mc(2,Re,2,1,"ng-template",13),p.Vb())}function Te(e,t){1&e&&p.Oc(0," Publisher ")}function Ie(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Ne(e,t){1&e&&p.Oc(0," Searches ")}function Le(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ae(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",35),p.Mc(1,Ne,1,0,"ng-template",17),p.Mc(2,Le,3,3,"ng-template",13),p.Vb())}function je(e,t){1&e&&p.Oc(0," Clicks ")}function ze(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ee(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",36),p.Mc(1,je,1,0,"ng-template",17),p.Mc(2,ze,3,3,"ng-template",13),p.Vb())}function Ye(e,t){1&e&&p.Oc(0," Coverage ")}function He(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ue(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",37),p.Mc(1,Ye,1,0,"ng-template",17),p.Mc(2,He,3,3,"ng-template",13),p.Vb())}function Be(e,t){1&e&&p.Oc(0," PPC ")}function Qe(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ge(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",38),p.Mc(1,Be,1,0,"ng-template",17),p.Mc(2,Qe,3,3,"ng-template",13),p.Vb())}function qe(e,t){1&e&&p.Oc(0," TQ ")}function $e(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ke(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,qe,1,0,"ng-template",17),p.Mc(2,$e,3,3,"ng-template",13),p.Vb())}function Xe(e,t){1&e&&p.Oc(0," Split ")}function Ze(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function Je(e,t){1&e&&p.Oc(0," Publisher Net ")}function et(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function tt(e,t){1&e&&p.Oc(0," Profit ")}function rt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function at(e,t){1&e&&p.Oc(0," Revenue ")}function nt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var it,st=((it=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.hopkinService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.expanded={},this.tagList=[],this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getAllHopkinStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.hopkinService.getHopkinStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("hopkins"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].ppc+=parseFloat(t.ppc?t.ppc:0),r[a].tq+=parseFloat(t.tq?t.tq:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.cdr.markForCheck()}},{key:"backProvider",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.cdr.markForCheck()}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.loadingIndicator=!1,this.refreshTable();case 16:case"end":return t.stop()}}),t,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.hopkinService.getHopkinStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("hopkins"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].searches+=parseInt(t.searches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.hopkinService.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),t}()).\u0275fac=function(e){return new(e||it)(p.Qb(p.i),p.Qb(g.a),p.Qb(Se.a),p.Qb(f.a))},it.\u0275cmp=p.Kb({type:it,selectors:[["app-hopkins"]],viewQuery:function(e,t){var r;1&e&&p.Tc(we,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:38,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row","px-6"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"btn","btn-sm","btn-dark","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ppc",4,"ngIf"],["name","tq",4,"ngIf"],["name","split",3,"minWidth"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","searches"],["name","clicks"],["name","coverage"],["name","ppc"],["name","tq"]],template:function(e,t){1&e&&(p.Mc(0,Fe,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,xe,1,1,"app-reporting-revenue-chart",2),p.Mc(3,We,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"button",5),p.hc("click",(function(){return t.groupProvider()})),p.Oc(6," Group "),p.Vb(),p.Wb(7,"button",6),p.hc("click",(function(){return t.backProvider()})),p.Oc(8," Back "),p.Vb(),p.Vb(),p.Wb(9,"ngx-datatable",7,8),p.Wb(11,"ngx-datatable-row-detail",9,10),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(13,Me,6,0,"ng-template",11),p.Vb(),p.Wb(14,"ngx-datatable-column",12),p.Mc(15,Pe,1,4,"ng-template",13),p.Vb(),p.Mc(16,Ce,3,1,"ngx-datatable-column",14),p.Mc(17,_e,3,0,"ngx-datatable-column",15),p.Wb(18,"ngx-datatable-column",16),p.Mc(19,Te,1,0,"ng-template",17),p.Mc(20,Ie,2,1,"ng-template",13),p.Vb(),p.Mc(21,Ae,3,0,"ngx-datatable-column",18),p.Mc(22,Ee,3,0,"ngx-datatable-column",19),p.Mc(23,Ue,3,0,"ngx-datatable-column",20),p.Mc(24,Ge,3,0,"ngx-datatable-column",21),p.Mc(25,Ke,3,0,"ngx-datatable-column",22),p.Wb(26,"ngx-datatable-column",23),p.Mc(27,Xe,1,0,"ng-template",17),p.Mc(28,Ze,4,6,"ng-template",13),p.Vb(),p.Wb(29,"ngx-datatable-column",24),p.Mc(30,Je,1,0,"ng-template",17),p.Mc(31,et,3,4,"ng-template",13),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,tt,1,0,"ng-template",17),p.Mc(34,rt,3,4,"ng-template",13),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,at,1,0,"ng-template",17),p.Mc(37,nt,3,4,"ng-template",13),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("minWidth",100),p.Db(3),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag),p.Db(1),p.rc("minWidth",35))},directives:[o.p,d.a,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O],pipes:[o.f,o.g,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),it),ot=["expandableTable"];function ct(e,t){1&e&&(p.Wb(0,"div",23),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function ut(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",24),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function lt(e,t){1&e&&p.Oc(0," Publisher ")}function ht(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function pt(e,t){1&e&&p.Oc(0," Tag ")}function gt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function bt(e,t){1&e&&p.Oc(0," Total Searches ")}function ft(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function dt(e,t){1&e&&p.Oc(0," Monetized Searches ")}function mt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function vt(e,t){1&e&&p.Oc(0," Clicks ")}function yt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Dt(e,t){1&e&&p.Oc(0," Follow On ")}function St(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function wt(e,t){if(1&e&&(p.Wb(0,"span"),p.Oc(1),p.Vb()),2&e){var r=t.column;p.Db(1),p.Pc(r.name)}}function Ft(e,t){if(1&e&&(p.Rb(0,"strong",25),p.mc(1,"percent")),2&e){var r=t.row;p.rc("innerHTML",p.oc(1,1,r.clicks/r.totalSearches,"2.2-2"),p.Ec)}}function xt(e,t){1&e&&p.Oc(0," Revenue ")}function Wt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var Mt,Pt,Vt=((Pt=function(){function e(){r(this,e),this.rows=[{name:"Greg",tag:"YHS Organic",totalSearches:"536412",monetizedSearches:"501235",revenue:"52623",clicks:50351,followOn:"13%"}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}return n(e,[{key:"ngOnInit",value:function(){}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}}]),e}()).\u0275fac=function(e){return new(e||Pt)},Pt.\u0275cmp=p.Kb({type:Pt,selectors:[["app-imgage-advantage"]],viewQuery:function(e,t){var r;1&e&&p.Tc(ot,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:70,vars:13,consts:[[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","followOn"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"h2",5),p.Oc(6,"Month to Date Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(7,"div",6),p.Wb(8,"mat-list"),p.Wb(9,"mat-list-item"),p.Oc(10,"Revenue: $103,201.26"),p.Vb(),p.Rb(11,"mat-divider"),p.Wb(12,"mat-list-item"),p.Oc(13,"Revenue Pace: $131,285.19"),p.Vb(),p.Rb(14,"mat-divider"),p.Wb(15,"mat-list-item"),p.Oc(16,"Profit: $21,109.59"),p.Vb(),p.Rb(17,"mat-divider"),p.Wb(18,"mat-list-item"),p.Oc(19,"Profit Pace: $173,121.45"),p.Vb(),p.Rb(20,"mat-divider"),p.Wb(21,"mat-list-item"),p.Oc(22,"Percentage Change: +27%"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(23,"div",1),p.Wb(24,"div",2),p.Wb(25,"div",3),p.Wb(26,"div",4),p.Wb(27,"h2",5),p.Oc(28,"Last Month Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(29,"div",6),p.Wb(30,"mat-list"),p.Wb(31,"mat-list-item"),p.Oc(32,"Revenue: $113,542.23"),p.Vb(),p.Rb(33,"mat-divider"),p.Wb(34,"mat-list-item"),p.Oc(35,"Profit: $14,121.39"),p.Vb(),p.Rb(36,"mat-divider"),p.Wb(37,"mat-list-item"),p.Oc(38,"Percentage Change: +11%"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(39,"ngx-datatable",7,8),p.Wb(41,"ngx-datatable-row-detail",9,10),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(43,ct,6,0,"ng-template",11),p.Vb(),p.Wb(44,"ngx-datatable-column",12),p.Mc(45,ut,1,4,"ng-template",13),p.Vb(),p.Wb(46,"ngx-datatable-column",14),p.Mc(47,lt,1,0,"ng-template",15),p.Mc(48,ht,2,1,"ng-template",13),p.Vb(),p.Wb(49,"ngx-datatable-column",16),p.Mc(50,pt,1,0,"ng-template",15),p.Mc(51,gt,2,1,"ng-template",13),p.Vb(),p.Wb(52,"ngx-datatable-column",17),p.Mc(53,bt,1,0,"ng-template",15),p.Mc(54,ft,3,3,"ng-template",13),p.Vb(),p.Wb(55,"ngx-datatable-column",18),p.Mc(56,dt,1,0,"ng-template",15),p.Mc(57,mt,3,3,"ng-template",13),p.Vb(),p.Wb(58,"ngx-datatable-column",19),p.Mc(59,vt,1,0,"ng-template",15),p.Mc(60,yt,3,3,"ng-template",13),p.Vb(),p.Wb(61,"ngx-datatable-column",20),p.Mc(62,Dt,1,0,"ng-template",15),p.Mc(63,St,2,1,"ng-template",13),p.Vb(),p.Wb(64,"ngx-datatable-column",21),p.Mc(65,wt,2,1,"ng-template",15),p.Mc(66,Ft,2,4,"ng-template",13),p.Vb(),p.Wb(67,"ngx-datatable-column",22),p.Mc(68,xt,1,0,"ng-template",15),p.Mc(69,Wt,3,4,"ng-template",13),p.Vb(),p.Vb()),2&e&&(p.Db(39),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",t.rows),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[W.a,W.c,M.a,S.d,S.e,S.f,S.b,S.a,S.c],pipes:[o.g,o.w,o.d],styles:[""]}),Pt),Ot=((Mt=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Mt)},Mt.\u0275cmp=p.Kb({type:Mt,selectors:[["app-media-net"]],decls:2,vars:0,template:function(e,t){1&e&&(p.Wb(0,"p"),p.Oc(1,"media-net works!"),p.Vb())},styles:[""]}),Mt),Ct=i("0TA1"),kt=i("SHm6"),Rt=i("qFsG"),_t=["expandableTable"];function Tt(e,t){1&e&&(p.Wb(0,"div",34),p.Rb(1,"mat-progress-bar",35),p.Vb())}function It(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",36),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function Nt(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",37),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Lt(e,t){if(1&e&&(p.Wb(0,"mat-option",38),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.label," ")}}function At(e,t){if(1&e){var r=p.Xb();p.Wb(0,"div",5),p.Wb(1,"mat-form-field",6),p.Wb(2,"mat-label"),p.Oc(3,"Condition"),p.Vb(),p.Wb(4,"mat-select",7),p.hc("selectionChange",(function(e){return p.Dc(r),p.lc().filterConditionHandle(e)}))("ngModelChange",(function(e){return p.Dc(r),p.lc().filterCondition=e})),p.Wb(5,"mat-option",39),p.Oc(6,"Greater Than"),p.Vb(),p.Wb(7,"mat-option",40),p.Oc(8,"Less Than"),p.Vb(),p.Vb(),p.Vb(),p.Vb()}if(2&e){var a=p.lc();p.Db(4),p.rc("ngModel",a.filterCondition)}}function jt(e,t){if(1&e){var r=p.Xb();p.Wb(0,"div",5),p.Wb(1,"mat-form-field",41),p.Wb(2,"mat-label"),p.Oc(3,"Filter Amount"),p.Vb(),p.Wb(4,"input",42),p.hc("ngModelChange",(function(e){return p.Dc(r),p.lc().filterAmount=e}))("input",(function(){return p.Dc(r),p.lc().updateFilterAmount()})),p.Vb(),p.Vb(),p.Vb()}if(2&e){var a=p.lc();p.Db(4),p.rc("ngModel",a.filterAmount)}}function zt(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"number"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"percent"),p.mc(16,"percent"),p.Vb(),p.Wb(17,"td"),p.Oc(18),p.mc(19,"currency"),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Wb(27,"td"),p.Oc(28),p.mc(29,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,9,r.date)),p.Db(3),p.Pc(p.nc(6,11,r.totalsearches)),p.Db(3),p.Pc(p.nc(9,13,r.impressions)),p.Db(3),p.Pc(p.nc(12,15,r.clicks)),p.Db(3),p.Pc(p.oc(15,17,r.ctr,"2.2-2")||p.oc(16,20,0,"2.2-2")),p.Db(4),p.Pc(p.oc(19,23,r.cpc,"USD")||p.oc(20,26,0,"USD")),p.Db(4),p.Pc(p.oc(23,29,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.profit,"USD")),p.Db(3),p.Pc(p.oc(29,35,r.revenue,"USD"))}}function Et(e,t){if(1&e&&(p.Wb(0,"div",45),p.Wb(1,"table",46),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Impressions"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"Clicks"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CTR"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"CPC"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Publisher Net"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Profit"),p.Vb(),p.Wb(20,"th"),p.Oc(21,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(22,"tbody"),p.Mc(23,zt,30,38,"tr",47),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(23),p.rc("ngForOf",r.subReportingForDate)}}function Yt(e,t){1&e&&(p.Wb(0,"div",48),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Ht(e,t){if(1&e&&(p.Mc(0,Et,24,1,"div",43),p.Mc(1,Yt,6,0,"div",44)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Ut(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",49),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Bt(e,t){1&e&&p.Oc(0," Date ")}function Qt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Gt(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,Bt,1,0,"ng-template",32),p.Mc(2,Qt,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function qt(e,t){1&e&&p.Oc(0," Subid ")}function $t(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Kt(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,qt,1,0,"ng-template",32),p.Mc(2,$t,2,1,"ng-template",17),p.Vb())}function Xt(e,t){1&e&&p.Oc(0," Publisher ")}function Zt(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Jt(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,Xt,1,0,"ng-template",32),p.Mc(2,Zt,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function er(e,t){1&e&&p.Oc(0," Searches ")}function tr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function rr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,er,1,0,"ng-template",32),p.Mc(2,tr,3,3,"ng-template",17),p.Vb())}function ar(e,t){1&e&&p.Oc(0," Impressions ")}function nr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ir(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,ar,1,0,"ng-template",32),p.Mc(2,nr,3,3,"ng-template",17),p.Vb())}function sr(e,t){1&e&&p.Oc(0," Clicks ")}function or(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function cr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,sr,1,0,"ng-template",32),p.Mc(2,or,3,3,"ng-template",17),p.Vb())}function ur(e,t){1&e&&p.Oc(0," CPC ")}function lr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.mc(3,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD")||p.oc(3,4,0,"USD"))}}function hr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,ur,1,0,"ng-template",32),p.Mc(2,lr,4,7,"ng-template",17),p.Vb())}function pr(e,t){1&e&&p.Oc(0," CTR ")}function gr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.mc(3,"percent"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function br(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,pr,1,0,"ng-template",32),p.Mc(2,gr,4,7,"ng-template",17),p.Vb())}function fr(e,t){1&e&&p.Oc(0," Bing Coverage ")}function dr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Qc("",p.nc(2,1,r)," %")}}function mr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",58),p.Mc(1,fr,1,0,"ng-template",32),p.Mc(2,dr,3,3,"ng-template",17),p.Vb())}function vr(e,t){1&e&&p.Oc(0," CF Coverage ")}function yr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Qc("",p.nc(2,1,r)," %")}}function Dr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",59),p.Mc(1,vr,1,0,"ng-template",32),p.Mc(2,yr,3,3,"ng-template",17),p.Vb())}function Sr(e,t){1&e&&p.Oc(0," Follow On ")}function wr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function Fr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",60),p.Mc(1,Sr,1,0,"ng-template",32),p.Mc(2,wr,3,4,"ng-template",17),p.Vb())}function xr(e,t){1&e&&p.Oc(0," Publisher Net ")}function Wr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Mr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",61),p.Mc(1,xr,1,0,"ng-template",32),p.Mc(2,Wr,3,4,"ng-template",17),p.Vb())}function Pr(e,t){1&e&&p.Oc(0," Profit ")}function Vr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Or(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",62),p.Mc(1,Pr,1,0,"ng-template",32),p.Mc(2,Vr,3,4,"ng-template",17),p.Vb())}function Cr(e,t){1&e&&p.Oc(0," Revenue ")}function kr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Rr(e,t){1&e&&p.Oc(0," Split ")}function _r(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function Tr(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",63),p.Mc(1,Rr,1,0,"ng-template",32),p.Mc(2,_r,4,6,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",35)}var Ir,Nr,Lr=((Nr=function(){function t(e,a,n,i,s,o,c,u){r(this,t),this.perionService=e,this.cdr=a,this.userService=n,this.tagService=i,this.exportDataService=s,this.datePipe=o,this.currencyPipe=c,this.percentPipe=u,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.summary={revenue:0,profit:0},this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.showFilterAmount=!1,this.filterCondition="",this.groupType="",this.groupbyList=[{value:"date",label:"Date"},{value:"publisher",label:"Publisher"},{value:"subid",label:"Subid"},{value:"bestBingCoverage",label:"Best Bing Coverage"},{value:"worstBingCoverage",label:"Worst Bing Coverage"},{value:"bestCFCoverage",label:"Best CF Coverage"},{value:"worstCFCoverage",label:"Worst CF Coverage"},{value:"reset",label:"Reset"}],this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"updateAllPerionStats",value:function(e,t,r){this.perionService.updateAllPerionStats(e,t,r).subscribe((function(e){}))}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 22:case"end":return t.stop()}}),t,this)})))}},{key:"getAllPerionStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.perionService.getAllPerionStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.loadingIndicator=!1,this.allStat=i.stats,this.allStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("perion"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStat.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStat.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStat.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStat.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStat);case 9:return n.prev=9,n.t0=n.catch(0),n.abrupt("return",n.t0);case 12:case"end":return n.stop()}}),n,this,[[0,9]])})))}},{key:"groupDate",value:function(){var t,r={},a=this.allStat.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].totalsearches+=parseFloat(t.totalsearches?t.totalsearches:0),r[a].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),r[a].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].followon+=parseFloat(t.followon?t.followon:0),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupDateShowFlag=!0,this.groupPublishFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStat.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].totalsearches+=parseFloat(t.totalsearches?t.totalsearches:0),r[a].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),r[a].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].followon+=parseFloat(t.followon?t.followon:0),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStat.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].impressions+=parseFloat(t.impressions?t.impressions:0),r[a].totalsearches+=parseFloat(t.totalsearches?t.totalsearches:0),r[a].profit+=parseFloat(t.profit),r[a].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),r[a].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].followon+=parseFloat(t.followon?t.followon:0),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStat.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].impressions+=parseFloat(t.impressions?t.impressions:0),a[r].totalsearches+=parseFloat(t.totalsearches?t.totalsearches:0),a[r].profit+=parseFloat(t.profit),a[r].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),a[r].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].followon+=parseFloat(t.followon?t.followon:0),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.followon=t.followon/t.counter,t.ctr=t.clicks/t.impressions,t.cpc=t.revenue/t.clicks,t.bingCoverage=t.bingCoverage/t.counter,t.cfCoverage=t.cfCoverage/t.counter}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStat.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].impressions+=parseFloat(t.impressions?t.impressions:0),a[r].totalsearches+=parseFloat(t.totalsearches?t.totalsearches:0),a[r].profit+=parseFloat(t.profit),a[r].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),a[r].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].followon+=parseFloat(t.followon?t.followon:0),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.followon=t.followon/t.counter,t.ctr=t.clicks/t.impressions,t.cpc=t.revenue/t.clicks,t.bingCoverage=t.bingCoverage/t.counter,t.cfCoverage=t.cfCoverage/t.counter}catch(s){i.e(s)}finally{i.f()}return n}},{key:"updateFilterAmount",value:function(){this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition)}},{key:"groupCoverageCondition",value:function(t,r,a){var n,i={},s=this.allStat.reduce((function(e,t){var r=t.date+"-"+t.subid+"-"+t.publisher;return i[r]?(i[r].bingCoverage+=parseFloat(t.bingCoverage?t.bingCoverage:0),i[r].cfCoverage+=parseFloat(t.cfCoverage?t.cfCoverage:0),i[r].revenue+=parseFloat(t.revenue),i[r].counter++):(i[r]=Object.assign({},t),i[r].counter=1,e.push(i[r])),e}),[]),o=e(s);try{for(o.s();!(n=o.n()).done;){var c=n.value;c.bingCoverage=c.bingCoverage/c.counter,c.cfCoverage=c.cfCoverage/c.counter}}catch(u){o.e(u)}finally{o.f()}"worstBingCoverage"==t?(this.rows=r>0&&""!=a?"greater"==a?s.sort((function(e,t){return e.bingCoverage-t.bingCoverage})).filter((function(e){return e.revenue>=r})):s.sort((function(e,t){return e.bingCoverage-t.bingCoverage})).filter((function(e){return e.revenue<=r})):s.sort((function(e,t){return e.bingCoverage-t.bingCoverage})),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestBingCoverage"==t?(this.rows=r>0&&""!=a?"greater"==a?s.sort((function(e,t){return t.bingCoverage-e.bingCoverage})).filter((function(e){return e.revenue>=r})):s.sort((function(e,t){return t.bingCoverage-e.bingCoverage})).filter((function(e){return e.revenue<=r})):s.sort((function(e,t){return t.bingCoverage-e.bingCoverage})),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestCFCoverage"==t?(this.rows=r>0&&""!=a?"greater"==a?s.sort((function(e,t){return t.cfCoverage-e.cfCoverage})).filter((function(e){return e.revenue>=r})):s.sort((function(e,t){return t.cfCoverage-e.cfCoverage})).filter((function(e){return e.revenue<=r})):s.sort((function(e,t){return t.cfCoverage-e.cfCoverage})),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0):(this.rows=r>0&&""!=a?"greater"==a?s.sort((function(e,t){return e.cfCoverage-t.cfCoverage})).filter((function(e){return e.revenue>=r})):s.sort((function(e,t){return e.cfCoverage-t.cfCoverage})).filter((function(e){return e.revenue<=r})):s.sort((function(e,t){return e.cfCoverage-t.cfCoverage})),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!0,this.cdr.markForCheck()}},{key:"filterConditionHandle",value:function(e){this.filterCondition=e.value,this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition),this.cdr.markForCheck()}},{key:"groupHandle",value:function(e){this.groupType=e.value,this.showFilterAmount=!1,this.filterAmount=0,this.filterCondition="","date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():"worstBingCoverage"==e.value||"bestBingCoverage"==e.value||"bestCFCoverage"==e.value||"worstCFCoverage"==e.value?(this.showFilterAmount=!0,this.groupCoverageCondition(e.value,this.filterAmount,this.filterCondition)):this.backGroup(),this.cdr.markForCheck()}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"exportToCsv",value:function(){var t=[];if("date"==this.groupType){var r,a=e(this.rows);try{for(a.s();!(r=a.n()).done;){var n=r.value,i={date:this.datePipe.transform(n.date,"dd MMM yyyy"),followOn:n.followon,publisherNet:this.currencyPipe.transform(n.publisherNet?n.publisherNet:0),profit:this.currencyPipe.transform(n.profit?n.profit:0),revenue:this.currencyPipe.transform(n.revenue?n.revenue:0),split:n.split};t.push(i)}}catch(M){a.e(M)}finally{a.f()}}else if("publisher"==this.groupType){var s,o=e(this.rows);try{for(o.s();!(s=o.n()).done;){var c=s.value,u={publisher:c.publisher,followOn:c.followon,publisherNet:this.currencyPipe.transform(c.publisherNet?c.publisherNet:0),profit:this.currencyPipe.transform(c.profit?c.profit:0),revenue:this.currencyPipe.transform(c.revenue?c.revenue:0),split:c.split};t.push(u)}}catch(M){o.e(M)}finally{o.f()}}else if("subid"==this.groupType){var l,h=e(this.rows);try{for(h.s();!(l=h.n()).done;){var p=l.value,g={subid:p.subid,followOn:p.followon,publisherNet:this.currencyPipe.transform(p.publisherNet?p.publisherNet:0),profit:this.currencyPipe.transform(p.profit?p.profit:0),revenue:this.currencyPipe.transform(p.revenue?p.revenue:0),split:p.split};t.push(g)}}catch(M){h.e(M)}finally{h.f()}}else if("worstBingCoverage"==this.groupType||"bestBingCoverage"==this.groupType){var b,f=e(this.rows);try{for(f.s();!(b=f.n()).done;){var d=b.value,m={date:this.datePipe.transform(d.date,"dd MMM yyyy"),subid:d.subid,publisher:d.publisher,bingCoverage:d.bingCoverage+"%",revenue:this.currencyPipe.transform(d.revenue?d.revenue:0)};t.push(m)}}catch(M){f.e(M)}finally{f.f()}}else if("worstCFCoverage"==this.groupType||"bestCFCoverage"==this.groupType){var v,y=e(this.rows);try{for(y.s();!(v=y.n()).done;){var D=v.value,S={date:this.datePipe.transform(D.date,"dd MMM yyyy"),subid:D.subid,publisher:D.publisher,cfCoverage:D.cfCoverage+"%",revenue:this.currencyPipe.transform(D.revenue?D.revenue:0)};t.push(S)}}catch(M){y.e(M)}finally{y.f()}}else{var w,F=e(this.rows);try{for(F.s();!(w=F.n()).done;){var x=w.value;x.date=this.datePipe.transform(x.date,"dd MMM yyyy"),x.bingCoverage=x.bingCoverage+"%",x.cfCoverage=x.cfCoverage+"%"}}catch(M){F.e(M)}finally{F.f()}t=this.rows}var W=t.length>0?Object.keys(t[0]):[];this.exportDataService.exportToCsv(t,""!==this.groupType?"perion-".concat(this.selectedCompany,"-").concat(this.groupType):"perion-"+this.selectedCompany,W)}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.perionService.getSummaryMetrics(e,t,r).toPromise();case 3:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 8:return a.prev=8,a.t0=a.catch(0),a.abrupt("return",a.t0);case 11:case"end":return a.stop()}}),a,this,[[0,8]])})))}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.perionService.getAllPerionStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("perion"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].totalsearches+=parseInt(t.totalsearches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"combineSummaryMetrics",value:function(e){var t=this;e.summary.keys.forEach((function(e){console.log(e.revenue),t.summary.revenue+=e.revenue,t.summary.profit+=e.revenue*(.01*(100-e.split))}))}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}}]),t}()).\u0275fac=function(e){return new(e||Nr)(p.Qb(Ct.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a),p.Qb(kt.a),p.Qb(o.f),p.Qb(o.d),p.Qb(o.w))},Nr.\u0275cmp=p.Kb({type:Nr,selectors:[["app-perion"]],viewQuery:function(e,t){var r;1&e&&p.Tc(_t,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:39,vars:34,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-xl-4",4,"ngIf"],[1,"row","py-2"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","totalsearches",4,"ngIf"],["name","impressions",4,"ngIf"],["name","clicks",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","bingCoverage",4,"ngIf"],["name","cfCoverage",4,"ngIf"],["name","followon",4,"ngIf"],["name","publisherNet",4,"ngIf"],["name","profit",4,"ngIf"],["name","revenue"],["ngx-datatable-header-template",""],["name","split",3,"minWidth",4,"ngIf"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[3,"value"],["value","greater"],["value","less"],["appearance","outline",1,"custom-mat-input"],["matInput","","type","number","min","0",3,"ngModel","ngModelChange","input"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","totalsearches"],["name","impressions"],["name","clicks"],["name","cpc"],["name","ctr"],["name","bingCoverage"],["name","cfCoverage"],["name","followon"],["name","publisherNet"],["name","profit"],["name","split",3,"minWidth"]],template:function(e,t){1&e&&(p.Mc(0,Tt,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,It,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Nt,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Mc(10,Lt,2,2,"mat-option",8),p.Vb(),p.Vb(),p.Vb(),p.Mc(11,At,9,1,"div",9),p.Mc(12,jt,5,1,"div",9),p.Vb(),p.Wb(13,"div",10),p.Wb(14,"button",11),p.hc("click",(function(){return t.exportToCsv()})),p.Oc(15," Export Stats "),p.Vb(),p.Vb(),p.Wb(16,"ngx-datatable",12,13),p.Wb(18,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(19,Ht,2,2,"ng-template",15),p.Vb(),p.Wb(20,"ngx-datatable-column",16),p.Mc(21,Ut,1,4,"ng-template",17),p.Vb(),p.Mc(22,Gt,3,1,"ngx-datatable-column",18),p.Mc(23,Kt,3,0,"ngx-datatable-column",19),p.Mc(24,Jt,3,1,"ngx-datatable-column",20),p.Mc(25,rr,3,0,"ngx-datatable-column",21),p.Mc(26,ir,3,0,"ngx-datatable-column",22),p.Mc(27,cr,3,0,"ngx-datatable-column",23),p.Mc(28,hr,3,0,"ngx-datatable-column",24),p.Mc(29,br,3,0,"ngx-datatable-column",25),p.Mc(30,mr,3,0,"ngx-datatable-column",26),p.Mc(31,Dr,3,0,"ngx-datatable-column",27),p.Mc(32,Fr,3,0,"ngx-datatable-column",28),p.Mc(33,Mr,3,0,"ngx-datatable-column",29),p.Mc(34,Or,3,0,"ngx-datatable-column",30),p.Wb(35,"ngx-datatable-column",31),p.Mc(36,Cr,1,0,"ng-template",32),p.Mc(37,kr,3,4,"ng-template",17),p.Vb(),p.Mc(38,Tr,3,1,"ngx-datatable-column",33),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(1),p.rc("ngForOf",t.groupbyList),p.Db(1),p.rc("ngIf",t.showFilterAmount),p.Db(1),p.rc("ngIf",t.showFilterAmount),p.Db(4),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupCFCoverageFlag)),p.Db(1),p.rc("ngIf",!(t.groupPublishFlag||t.groupDateShowFlag||t.groupSubidShowFlag||t.groupBingCoverageFlag)),p.Db(1),p.rc("ngIf",!t.groupCoverageFlag),p.Db(1),p.rc("ngIf",!t.groupCoverageFlag),p.Db(1),p.rc("ngIf",!t.groupCoverageFlag),p.Db(4),p.rc("ngIf",!t.groupCoverageFlag))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,o.o,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,D.p,Rt.b,y.v,y.d],pipes:[o.f,o.g,o.w,o.d],styles:[".mat-form-field-appearance-outline .mat-form-field-outline{background-color:#fff;border-radius:5px}.loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Nr),Ar=((Ir=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ir)},Ir.\u0275cmp=p.Kb({type:Ir,selectors:[["app-reporting"]],decls:1,vars:0,template:function(e,t){1&e&&p.Rb(0,"router-outlet")},directives:[c.l],encapsulation:2}),Ir),jr=["expandableTable"];function zr(e,t){1&e&&(p.Wb(0,"div",17),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Er(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",18),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Yr(e,t){1&e&&p.Oc(0," Publisher ")}function Hr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Ur(e,t){1&e&&p.Oc(0," Tag ")}function Br(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Qr(e,t){1&e&&p.Oc(0," Total Searches ")}function Gr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function qr(e,t){1&e&&p.Oc(0," Monetized Searches ")}function $r(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Kr(e,t){1&e&&p.Oc(0," Clicks ")}function Xr(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Zr(e,t){if(1&e&&(p.Wb(0,"span"),p.Oc(1),p.Vb()),2&e){var r=t.column;p.Db(1),p.Pc(r.name)}}function Jr(e,t){if(1&e&&(p.Rb(0,"strong",19),p.mc(1,"percent")),2&e){var r=t.row;p.rc("innerHTML",p.oc(1,1,r.clicks/r.totalSearches,"2.2-2"),p.Ec)}}function ea(e,t){1&e&&p.Oc(0," Revenue ")}function ta(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var ra,aa,na=((aa=function(){function e(){r(this,e),this.rows=[{name:"Datalox",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Hopkins Branded",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Datalox 2",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}return n(e,[{key:"ngOnInit",value:function(){var e=Array.from({length:20},(function(){return Math.floor(4e3*Math.random()+4e3)})),t=Array.from({length:20},(function(){return Math.floor(6e4*Math.random()+4e4)}));this.setChartOptions(1e4,1e5,["Nov 1, Nov 2, Nov 3, Nov 4","Nov 5","Nov 5","Nov 6","Nov 7","Nov 8","Nov 9","Nov 10","Nov 11","Nov 12","Nov 13","Nov 14","Nov 15","Nov 16","Nov 17","Nov 18","Nov 19","Nov 20"],e,t)}},{key:"updateReportingFiltering",value:function(e){console.log("Report")}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"setChartOptions",value:function(e,t,r,a,n){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom),this.option={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:["Revenue","Searches"]},xAxis:[{type:"category",data:r,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",min:0,max:e,interval:25e3,axisLabel:{formatter:"${value}"}},{type:"value",name:"Searches",min:0,max:t,interval:1e5,axisLabel:{formatter:"{value}"}}],series:[{name:"Revenue",type:"bar",data:a},{name:"Searches",type:"line",yAxisIndex:1,data:n}]},this.option&&this.myChart.setOption(this.option)}}]),e}()).\u0275fac=function(e){return new(e||aa)},aa.\u0275cmp=p.Kb({type:aa,selectors:[["app-third-party"]],viewQuery:function(e,t){var r;1&e&&p.Tc(jr,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:30,vars:13,consts:[[3,"onDatesPicked"],["id","main",2,"width","100%","height","300px"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(p.Wb(0,"app-reporting-filtering",0),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Rb(1,"div",1),p.Wb(2,"ngx-datatable",2,3),p.Wb(4,"ngx-datatable-row-detail",4,5),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(6,zr,6,0,"ng-template",6),p.Vb(),p.Wb(7,"ngx-datatable-column",7),p.Mc(8,Er,1,4,"ng-template",8),p.Vb(),p.Wb(9,"ngx-datatable-column",9),p.Mc(10,Yr,1,0,"ng-template",10),p.Mc(11,Hr,2,1,"ng-template",8),p.Vb(),p.Wb(12,"ngx-datatable-column",11),p.Mc(13,Ur,1,0,"ng-template",10),p.Mc(14,Br,2,1,"ng-template",8),p.Vb(),p.Wb(15,"ngx-datatable-column",12),p.Mc(16,Qr,1,0,"ng-template",10),p.Mc(17,Gr,3,3,"ng-template",8),p.Vb(),p.Wb(18,"ngx-datatable-column",13),p.Mc(19,qr,1,0,"ng-template",10),p.Mc(20,$r,3,3,"ng-template",8),p.Vb(),p.Wb(21,"ngx-datatable-column",14),p.Mc(22,Kr,1,0,"ng-template",10),p.Mc(23,Xr,3,3,"ng-template",8),p.Vb(),p.Wb(24,"ngx-datatable-column",15),p.Mc(25,Zr,2,1,"ng-template",10),p.Mc(26,Jr,2,4,"ng-template",8),p.Vb(),p.Wb(27,"ngx-datatable-column",16),p.Mc(28,ea,1,0,"ng-template",10),p.Mc(29,ta,3,4,"ng-template",8),p.Vb(),p.Vb()),2&e&&(p.Db(2),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",t.rows),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[d.a,S.d,S.e,S.f,S.b,S.a,S.c],pipes:[o.g,o.w,o.d],styles:[""]}),aa),ia=((ra=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ra)},ra.\u0275cmp=p.Kb({type:ra,selectors:[["app-bing-direct"]],decls:2,vars:0,template:function(e,t){1&e&&(p.Wb(0,"p"),p.Oc(1,"bing-direct works!"),p.Vb())},styles:[""]}),ra),sa=i("d9f2"),oa=["expandableTable"];function ca(e,t){1&e&&(p.Wb(0,"div",31),p.Rb(1,"mat-progress-bar",32),p.Vb())}function ua(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",33),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function la(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",34),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetricsData)}}function ha(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function pa(e,t){if(1&e&&(p.Wb(0,"div",37),p.Wb(1,"table",38),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,ha,27,35,"tr",39),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function ga(e,t){1&e&&(p.Wb(0,"div",40),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function ba(e,t){if(1&e&&(p.Mc(0,pa,22,1,"div",35),p.Mc(1,ga,6,0,"div",36)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function fa(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",41),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function da(e,t){1&e&&p.Oc(0," Date ")}function ma(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function va(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,da,1,0,"ng-template",27),p.Mc(2,ma,3,3,"ng-template",17),p.Vb())}function ya(e,t){1&e&&p.Oc(0," Subid ")}function Da(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Sa(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,ya,1,0,"ng-template",27),p.Mc(2,Da,2,1,"ng-template",17),p.Vb())}function wa(e,t){1&e&&p.Oc(0," Publisher ")}function Fa(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function xa(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,wa,1,0,"ng-template",27),p.Mc(2,Fa,2,1,"ng-template",17),p.Vb())}function Wa(e,t){1&e&&p.Oc(0," Searches ")}function Ma(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Pa(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,Wa,1,0,"ng-template",27),p.Mc(2,Ma,3,3,"ng-template",17),p.Vb())}function Va(e,t){1&e&&p.Oc(0," Bid Searches ")}function Oa(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ca(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,Va,1,0,"ng-template",27),p.Mc(2,Oa,3,3,"ng-template",17),p.Vb())}function ka(e,t){1&e&&p.Oc(0," Clicks ")}function Ra(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function _a(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,ka,1,0,"ng-template",27),p.Mc(2,Ra,3,3,"ng-template",17),p.Vb())}function Ta(e,t){1&e&&p.Oc(0," BiddedCTR ")}function Ia(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function Na(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,Ta,1,0,"ng-template",27),p.Mc(2,Ia,4,7,"ng-template",17),p.Vb())}function La(e,t){1&e&&p.Oc(0," CTR ")}function Aa(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function ja(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,La,1,0,"ng-template",27),p.Mc(2,Aa,4,7,"ng-template",17),p.Vb())}function za(e,t){1&e&&p.Oc(0," Publisher Net ")}function Ea(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ya(e,t){1&e&&p.Oc(0," Profit ")}function Ha(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ua(e,t){1&e&&p.Oc(0," Revenue ")}function Ba(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Qa(e,t){1&e&&p.Oc(0," Spilt ")}function Ga(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var qa,$a=((qa=function(){function t(e,a,n,i){r(this,t),this.lyonService=e,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.summary={revenue:0,profit:0},this.loadingIndicator=!0,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.filteredLyonStat=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllLyonStats(this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetricsData=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"getAllLyonStats",value:function(t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c,u,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.lyonService.getAllStats(t,r).toPromise();case 3:n=a.sent,i=e((this.loadingIndicator=!1,this.allstat=n,this.allstat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(i.s();!(s=i.n()).done;)if("lyons"==(o=s.value).tag.advertiser){c=e(o.tag.subids);try{for(c.s();!(u=c.n()).done;)"Contains"==(l=u.value).filterTag?this.allstat.map((function(e){e.subid.includes(l.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"StartsWith"==l.filterTag?this.allstat.map((function(e){e.subid.startsWith(l.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"EndsWith"==l.filterTag?this.allstat.map((function(e){e.subid.endsWith(l.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"ExactValue"==l.filterTag&&this.allstat.map((function(e){e.subid==l.subid&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)}))}catch(h){c.e(h)}finally{c.f()}}}catch(h){i.e(h)}finally{i.f()}return a.abrupt("return",this.allstat);case 9:return a.prev=9,a.t0=a.catch(0),a.abrupt("return",a.t0);case 12:case"end":return a.stop()}}),a,this,[[0,9]])})))}},{key:"groupDate",value:function(){var t,r={},a=this.allstat.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].biddedCtr+=parseFloat(t.biddedCtr?t.biddedCtr:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allstat.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].biddedCtr+=parseFloat(t.biddedCtr?t.biddedCtr:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allstat.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].biddedCtr+=parseFloat(t.biddedCtr?t.biddedCtr:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allstat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"updateAllLyonStats",value:function(e,t,r){this.lyonService.updateAllLyonStats(e,t,r).subscribe((function(e){}))}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),t.next=5,this.getAllLyonStats(this.range.startDate,this.range.endDate);case 5:return this.rows=t.sent,t.next=8,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 8:return this.chartData=t.sent,t.next=11,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 11:this.summaryMetricsData=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 18:case"end":return t.stop()}}),t,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.lyonService.getSummaryMetrics(e,t,r).toPromise();case 3:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 8:return a.prev=8,a.t0=a.catch(0),a.abrupt("return",a.t0);case 11:case"end":return a.stop()}}),a,this,[[0,8]])})))}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.lyonService.getAllStats(r,a).toPromise();case 3:n=t.sent,i=e((this.loadingIndicator=!1,this.allChart=n,this.allChart.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(i.s();!(s=i.n()).done;)if("lyons"==(o=s.value).tag.advertiser){c=e(o.tag.subids);try{for(c.s();!(u=c.n()).done;)"Contains"==(h=u.value).filterTag?this.allChart.map((function(e){e.subid.includes(h.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"StartsWith"==h.filterTag?this.allChart.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"EndsWith"==h.filterTag?this.allChart.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)})):"ExactValue"==h.filterTag&&this.allChart.map((function(e){e.subid==h.subid&&(e.publisher=o.user.length?o.user[0].fullname:"No Publisher",e.tagname=o.tag.name)}))}catch(j){c.e(j)}finally{c.f()}}}catch(j){i.e(j)}finally{i.f()}for(f in p=l.chain(this.allChart).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),g=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(p,["date","publisher"]),b=[],g)if(g.hasOwnProperty(f))for(d in g[f])m={date:g[f][d][0].date,publisher:g[f][d][0].publisher,revenue:l.reduce(g[f][d],(function(e,t){return e+t.revenue}),0)},b.push(m);for(v=[],y=0,D=b;y<D.length;y++)S=D[y],v.push(S.publisher);w=v.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChart=this.allChart.slice().sort((function(e,t){return e.date-t.date})),F={},x=this.allChart.reduce((function(e,t){var r=t.date;return F[r]?F[r].searches+=parseInt(t.searches):(F[r]=Object.assign({},t),e.push(F[r])),e}),[]),W=[],M=[],P={},V=e(this.daysList);try{for(V.s();!(O=V.n()).done;)if(C=O.value,0==(k=x.filter((function(e){return e.date==C}))).length)W.push(C),M.push(0);else{R=e(k);try{for(R.s();!(_=R.n()).done;)T=_.value,W.push(T.date),M.push(T.searches)}catch(j){R.e(j)}finally{R.f()}}}catch(j){V.e(j)}finally{V.f()}I=[],N=e(w);try{for(A=function(){var t,r=L.value,a=[],n=e(W);try{var i=function(){var e=t.value,n=b.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(j){n.e(j)}finally{n.f()}var s={};s[r]=a,I.push(s)},N.s();!(L=N.n()).done;)A()}catch(j){N.e(j)}finally{N.f()}return t.abrupt("return",(P.revenuePerDay=I,P.datesOfRevenue=W,P.searchesPerDay=M,P.publisherName=w,P));case 22:return t.prev=22,t.t0=t.catch(0),t.abrupt("return",t.t0);case 25:case"end":return t.stop()}}),t,this,[[0,22]])})))}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allstat.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].biddedCtr+=parseFloat(t.biddedCtr?t.biddedCtr:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.biddedCtr=t.biddedCtr/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allstat.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].cpc+=parseFloat(t.cpc?t.cpc:0),a[r].ctr+=parseFloat(t.ctr?t.ctr:0),a[r].biddedCtr+=parseFloat(t.biddedCtr?t.biddedCtr:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.biddedCtr=t.biddedCtr/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"combineSummaryMetrics",value:function(e){var t=this;e.summary.keys.forEach((function(e){t.summary.revenue+=e.revenue,t.summary.profit+=e.revenue*(.01*(100-e.split))}))}}]),t}()).\u0275fac=function(e){return new(e||qa)(p.Qb(sa.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},qa.\u0275cmp=p.Kb({type:qa,selectors:[["app-lyons"]],viewQuery:function(e,t){var r;1&e&&p.Tc(oa,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:44,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","biddedCtr",4,"ngIf"],["name","ctr",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date"],["name","subid"],["name","publisher"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","biddedCtr"],["name","ctr"]],template:function(e,t){1&e&&(p.Mc(0,ca,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,ua,1,1,"app-reporting-revenue-chart",2),p.Mc(3,la,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,ba,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,fa,1,4,"ng-template",17),p.Vb(),p.Mc(24,va,3,0,"ngx-datatable-column",18),p.Mc(25,Sa,3,0,"ngx-datatable-column",19),p.Mc(26,xa,3,0,"ngx-datatable-column",20),p.Mc(27,Pa,3,0,"ngx-datatable-column",21),p.Mc(28,Ca,3,0,"ngx-datatable-column",22),p.Mc(29,_a,3,0,"ngx-datatable-column",23),p.Mc(30,Na,3,0,"ngx-datatable-column",24),p.Mc(31,ja,3,0,"ngx-datatable-column",25),p.Wb(32,"ngx-datatable-column",26),p.Mc(33,za,1,0,"ng-template",27),p.Mc(34,Ea,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",28),p.Mc(36,Ya,1,0,"ng-template",27),p.Mc(37,Ha,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",29),p.Mc(39,Ua,1,0,"ng-template",27),p.Mc(40,Ba,3,4,"ng-template",17),p.Vb(),p.Wb(41,"ngx-datatable-column",30),p.Mc(42,Qa,1,0,"ng-template",27),p.Mc(43,Ga,4,6,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetricsData&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),qa),Ka=i("Wxo5"),Xa=["expandableTable"];function Za(e,t){1&e&&(p.Wb(0,"div",28),p.Rb(1,"mat-progress-bar",29),p.Vb())}function Ja(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",30),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function en(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",31),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function tn(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function rn(e,t){if(1&e&&(p.Wb(0,"div",34),p.Wb(1,"table",35),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,tn,27,35,"tr",36),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function an(e,t){1&e&&(p.Wb(0,"div",37),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function nn(e,t){if(1&e&&(p.Mc(0,rn,22,1,"div",32),p.Mc(1,an,6,0,"div",33)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function sn(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",38),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function on(e,t){1&e&&p.Oc(0," Date ")}function cn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function un(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,on,1,0,"ng-template",24),p.Mc(2,cn,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function ln(e,t){1&e&&p.Oc(0," Subid ")}function hn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function pn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,ln,1,0,"ng-template",24),p.Mc(2,hn,2,1,"ng-template",17),p.Vb())}function gn(e,t){1&e&&p.Oc(0," Publisher ")}function bn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function fn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,gn,1,0,"ng-template",24),p.Mc(2,bn,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function dn(e,t){1&e&&p.Oc(0," Searches ")}function mn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function vn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,dn,1,0,"ng-template",24),p.Mc(2,mn,3,3,"ng-template",17),p.Vb())}function yn(e,t){1&e&&p.Oc(0," Clicks ")}function Dn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Sn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,yn,1,0,"ng-template",24),p.Mc(2,Dn,3,3,"ng-template",17),p.Vb())}function wn(e,t){1&e&&p.Oc(0," Split ")}function Fn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function xn(e,t){1&e&&p.Oc(0," Publisher Net ")}function Wn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Mn(e,t){1&e&&p.Oc(0," Profit ")}function Pn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Vn(e,t){1&e&&p.Oc(0," Revenue ")}function On(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var Cn,kn=((Cn=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.rubiService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getAllRubiStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.rubiService.getRubiStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("rubi"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].monetized_searches+=parseFloat(t.monetized_searches?t.monetized_searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].monetized_searches+=parseFloat(t.monetized_searches?t.monetized_searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].monetized_searches+=parseFloat(t.monetized_searches?t.monetized_searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].monetized_searches+=parseFloat(t.monetized_searches?t.monetized_searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].monetized_searches+=parseFloat(t.monetized_searches?t.monetized_searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.rubiService.getRubiStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("rubi"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].searches+=parseInt(t.searches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.rubiService.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}}]),t}()).\u0275fac=function(e){return new(e||Cn)(p.Qb(p.i),p.Qb(g.a),p.Qb(Ka.a),p.Qb(f.a))},Cn.\u0275cmp=p.Kb({type:Cn,selectors:[["app-rubi"]],viewQuery:function(e,t){var r;1&e&&p.Tc(Xa,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(e,t){1&e&&(p.Mc(0,Za,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,Ja,1,1,"app-reporting-revenue-chart",2),p.Mc(3,en,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,nn,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,sn,1,4,"ng-template",17),p.Vb(),p.Mc(24,un,3,1,"ngx-datatable-column",18),p.Mc(25,pn,3,0,"ngx-datatable-column",19),p.Mc(26,fn,3,1,"ngx-datatable-column",20),p.Mc(27,vn,3,0,"ngx-datatable-column",21),p.Mc(28,Sn,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,wn,1,0,"ng-template",24),p.Mc(31,Fn,4,6,"ng-template",17),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,xn,1,0,"ng-template",24),p.Mc(34,Wn,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,Mn,1,0,"ng-template",24),p.Mc(37,Pn,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",27),p.Mc(39,Vn,1,0,"ng-template",24),p.Mc(40,On,3,4,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Cn),Rn=i("uJD8"),_n=["expandableTable"];function Tn(e,t){1&e&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function In(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",37),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function Nn(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",38),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Ln(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function An(e,t){if(1&e&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Ln,25,29,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function jn(e,t){1&e&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function zn(e,t){if(1&e&&(p.Mc(0,An,22,1,"div",39),p.Mc(1,jn,6,0,"div",40)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function En(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Yn(e,t){1&e&&p.Oc(0," Date ")}function Hn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Un(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,Yn,1,0,"ng-template",31),p.Mc(2,Hn,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Bn(e,t){1&e&&p.Oc(0," Subid ")}function Qn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Gn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,Bn,1,0,"ng-template",31),p.Mc(2,Qn,2,1,"ng-template",17),p.Vb())}function qn(e,t){1&e&&p.Oc(0," Publisher ")}function $n(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Kn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,qn,1,0,"ng-template",31),p.Mc(2,$n,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Xn(e,t){1&e&&p.Oc(0," Searches ")}function Zn(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Jn(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,Xn,1,0,"ng-template",31),p.Mc(2,Zn,3,3,"ng-template",17),p.Vb())}function ei(e,t){1&e&&p.Oc(0," Bid Searches ")}function ti(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ri(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,ei,1,0,"ng-template",31),p.Mc(2,ti,3,3,"ng-template",17),p.Vb())}function ai(e,t){1&e&&p.Oc(0," Bid Searches Result ")}function ni(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ii(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,ai,1,0,"ng-template",31),p.Mc(2,ni,3,3,"ng-template",17),p.Vb())}function si(e,t){1&e&&p.Oc(0," Clicks ")}function oi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ci(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,si,1,0,"ng-template",31),p.Mc(2,oi,3,3,"ng-template",17),p.Vb())}function ui(e,t){1&e&&p.Oc(0," Coverage ")}function li(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,ui,1,0,"ng-template",31),p.Mc(2,li,3,3,"ng-template",17),p.Vb())}function pi(e,t){1&e&&p.Oc(0," CTR ")}function gi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function bi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,pi,1,0,"ng-template",31),p.Mc(2,gi,3,4,"ng-template",17),p.Vb())}function fi(e,t){1&e&&p.Oc(0," CPC ")}function di(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function mi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,fi,1,0,"ng-template",31),p.Mc(2,di,3,4,"ng-template",17),p.Vb())}function vi(e,t){1&e&&p.Oc(0," RN ")}function yi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Di(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,vi,1,0,"ng-template",31),p.Mc(2,yi,3,3,"ng-template",17),p.Vb())}function Si(e,t){1&e&&p.Oc(0," TQ ")}function wi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Fi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,Si,1,0,"ng-template",31),p.Mc(2,wi,3,3,"ng-template",17),p.Vb())}function xi(e,t){1&e&&p.Oc(0," Publisher Net ")}function Wi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Mi(e,t){1&e&&p.Oc(0," Profit ")}function Pi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Vi(e,t){1&e&&p.Oc(0," Revenue ")}function Oi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ci(e,t){1&e&&p.Oc(0," Split ")}function ki(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Ri,_i=((Ri=function(){function t(e,a,n,i){r(this,t),this.verizonService=e,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(e){this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,n,i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=e((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct"==(n=a.value).tag.advertiser){i=e(n.tag.subids);try{for(i.s();!(s=i.n()).done;)"Contains"==(o=s.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"StartsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"EndsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"ExactValue"==o.filterTag&&this.allChartStat.map((function(e){e.subid==o.subid&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),u=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(e,t){return e+t.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),D={},S=this.allChartStat.reduce((function(e,t){var r=t.date;return D[r]?(D[r].searches+=parseInt(t.searches),t.revenue&&(D[r].revenue+=t.revenue)):(D[r]=Object.assign({},t),e.push(D[r])),e}),[]),w=[],F=[],x={},W=e(this.daysList);try{for(W.s();!(M=W.n()).done;)if(P=M.value,0==(V=S.filter((function(e){return e.date==P}))).length)w.push(P),F.push(0);else{O=e(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){W.e(N)}finally{W.f()}R=[],_=e(y);try{for(I=function(){var t,r=T.value,a=[],n=e(w);try{var i=function(){var e=t.value,n=h.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var s={};s[r]=a,R.push(s)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return t.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return t.prev=19,t.t0=t.catch(0),t.abrupt("return",t.t0);case 22:case"end":return t.stop()}}),t,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonService.getAllVerizonStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("verizon-direct"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonService.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),t}()).\u0275fac=function(e){return new(e||Ri)(p.Qb(Rn.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},Ri.\u0275cmp=p.Kb({type:Ri,selectors:[["app-verizon-direct"]],viewQuery:function(e,t){var r;1&e&&p.Tc(_n,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(e,t){1&e&&(p.Mc(0,Tn,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,In,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Nn,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,zn,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,En,1,4,"ng-template",17),p.Vb(),p.Mc(24,Un,3,1,"ngx-datatable-column",18),p.Mc(25,Gn,3,0,"ngx-datatable-column",19),p.Mc(26,Kn,3,1,"ngx-datatable-column",20),p.Mc(27,Jn,3,0,"ngx-datatable-column",21),p.Mc(28,ri,3,0,"ngx-datatable-column",22),p.Mc(29,ii,3,0,"ngx-datatable-column",23),p.Mc(30,ci,3,0,"ngx-datatable-column",24),p.Mc(31,hi,3,0,"ngx-datatable-column",25),p.Mc(32,bi,3,0,"ngx-datatable-column",26),p.Mc(33,mi,3,0,"ngx-datatable-column",27),p.Mc(34,Di,3,0,"ngx-datatable-column",28),p.Mc(35,Fi,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,xi,1,0,"ng-template",31),p.Mc(38,Wi,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Mi,1,0,"ng-template",31),p.Mc(41,Pi,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,Vi,1,0,"ng-template",31),p.Mc(44,Oi,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Ci,1,0,"ng-template",31),p.Mc(47,ki,4,6,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Ri),Ti=i("m5p0"),Ii=["expandableTable"];function Ni(e,t){1&e&&(p.Wb(0,"div",29),p.Rb(1,"mat-progress-bar",30),p.Vb())}function Li(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",31),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function Ai(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",32),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function ji(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function zi(e,t){if(1&e&&(p.Wb(0,"div",35),p.Wb(1,"table",36),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,ji,25,29,"tr",37),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Ei(e,t){1&e&&(p.Wb(0,"div",38),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Yi(e,t){if(1&e&&(p.Mc(0,zi,22,1,"div",33),p.Mc(1,Ei,6,0,"div",34)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Hi(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",39),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Ui(e,t){1&e&&p.Oc(0," Date ")}function Bi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Qi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,Ui,1,0,"ng-template",25),p.Mc(2,Bi,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Gi(e,t){1&e&&p.Oc(0," Subid ")}function qi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function $i(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,Gi,1,0,"ng-template",25),p.Mc(2,qi,2,1,"ng-template",17),p.Vb())}function Ki(e,t){1&e&&p.Oc(0," Publisher ")}function Xi(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Zi(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,Ki,1,0,"ng-template",25),p.Mc(2,Xi,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Ji(e,t){1&e&&p.Oc(0," Device ")}function es(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function ts(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,Ji,1,0,"ng-template",25),p.Mc(2,es,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function rs(e,t){1&e&&p.Oc(0," Searches ")}function as(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ns(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,rs,1,0,"ng-template",25),p.Mc(2,as,3,3,"ng-template",17),p.Vb())}function is(e,t){1&e&&p.Oc(0," Clicks ")}function ss(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function os(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,is,1,0,"ng-template",25),p.Mc(2,ss,3,3,"ng-template",17),p.Vb())}function cs(e,t){1&e&&p.Oc(0," Split ")}function us(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function ls(e,t){1&e&&p.Oc(0," Publisher Net ")}function hs(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function ps(e,t){1&e&&p.Oc(0," Profit ")}function gs(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function bs(e,t){1&e&&p.Oc(0," Revenue ")}function fs(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var ds,ms,vs=((ds=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.system1Service=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.system1Service.getAllSystem1Stats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("system1"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].searches+=parseInt(t.searches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getAllSystem1Stats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.system1Service.getAllSystem1Stats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("system1"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.system1Service.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=t.clicks?parseFloat(t.clicks):0,r[a].searches+=t.searches?parseFloat(t.searches):0,r[a].ctr+=t.ctr?parseFloat(t.ctr):0,r[a].revenue+=t.revenue?parseFloat(t.revenue):0,r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=t.clicks?parseFloat(t.clicks):0,r[a].searches+=t.searches?parseFloat(t.searches):0,r[a].ctr+=t.ctr?parseFloat(t.ctr):0,r[a].revenue+=t.revenue?parseFloat(t.revenue):0,r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=t.clicks?parseFloat(t.clicks):0,r[a].searches+=t.searches?parseFloat(t.searches):0,r[a].revenue+=t.revenue?parseFloat(t.revenue):0,r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i.publisher),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=t.clicks?parseFloat(t.clicks):0,a[r].searches+=t.searches?parseFloat(t.searches):0,a[r].revenue+=t.revenue?parseFloat(t.revenue):0,a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;){var s=r.value;s.split=s.split/s.counter,s.ctr=s.clicks/s.searches,s.cpc=s.revenue/s.clicks}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=t.clicks?parseFloat(t.clicks):0,a[r].searches+=t.searches?parseFloat(t.searches):0,a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"refreshTable",value:function(){this.cdr.detectChanges()}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}}]),t}()).\u0275fac=function(e){return new(e||ds)(p.Qb(p.i),p.Qb(g.a),p.Qb(Ti.a),p.Qb(f.a))},ds.\u0275cmp=p.Kb({type:ds,selectors:[["app-system1"]],viewQuery:function(e,t){var r;1&e&&p.Tc(Ii,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:42,vars:24,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","device",3,"minWidth",4,"ngIf"],["name","Searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","device",3,"minWidth"],["name","Searches"],["name","clicks"]],template:function(e,t){1&e&&(p.Mc(0,Ni,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,Li,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Ai,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,Yi,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Hi,1,4,"ng-template",17),p.Vb(),p.Mc(24,Qi,3,1,"ngx-datatable-column",18),p.Mc(25,$i,3,0,"ngx-datatable-column",19),p.Mc(26,Zi,3,1,"ngx-datatable-column",20),p.Mc(27,ts,3,1,"ngx-datatable-column",21),p.Mc(28,ns,3,0,"ngx-datatable-column",22),p.Mc(29,os,3,0,"ngx-datatable-column",23),p.Wb(30,"ngx-datatable-column",24),p.Mc(31,cs,1,0,"ng-template",25),p.Mc(32,us,4,6,"ng-template",17),p.Vb(),p.Wb(33,"ngx-datatable-column",26),p.Mc(34,ls,1,0,"ng-template",25),p.Mc(35,hs,3,4,"ng-template",17),p.Vb(),p.Wb(36,"ngx-datatable-column",27),p.Mc(37,ps,1,0,"ng-template",25),p.Mc(38,gs,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",28),p.Mc(40,bs,1,0,"ng-template",25),p.Mc(41,fs,3,4,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),ds),ys=i("AytR"),Ds=i("tk/3"),Ss=ys.a.apiUrl+"/stats/admin/manual-update",ws=((ms=function(){function e(t){r(this,e),this.http=t}return n(e,[{key:"updateManualStats",value:function(e){var t=e.company,r=e.reportType,a=e.startDate,n=e.endDate,i={company:t,reportType:r,startDate:h(a).format("YYYY-MM-DD"),endDate:h(n).format("YYYY-MM-DD")};return this.http.put(Ss+"/stat-update",i)}},{key:"updateManualSplit",value:function(e){var t=e.company,r=e.reportType,a=e.tag,n=e.startDate,i=e.endDate;return this.http.put(Ss+"/split-update",{company:t,reportType:r,tag:a,startDate:n,endDate:i})}}]),e}()).\u0275fac=function(e){return new(e||ms)(p.ec(Ds.c))},ms.\u0275prov=p.Mb({token:ms,factory:ms.\u0275fac,providedIn:"root"}),ms),Fs=i("9xcm"),xs=i("+BVi"),Ws=i("soTd"),Ms=i("iadO"),Ps=i("bTqV");function Vs(e,t){if(1&e&&(p.Wb(0,"mat-option",18),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function Os(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid start date "),p.Vb())}function Cs(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid end date"),p.Vb())}function ks(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Start Date Required"),p.Vb())}function Rs(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"End Date Required"),p.Vb())}function _s(e,t){if(1&e&&(p.Wb(0,"mat-option",18),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}var Ts,Is=((Ts=function(){function e(t,a,n,i,s,o){r(this,e),this.manualUpdateService=t,this.fb=a,this.companyService=n,this.authService=i,this.userService=s,this.notification=o,this.reportUpdateTitle="Report Stat Update",this.reportTypeData=[],this.message=null,this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}return n(e,[{key:"ngOnInit",value:function(){this.getReportingProviderList(),this.manaulUpFG=this.fb.group({reportType:new y.g("",y.z.required),preSelectValue:new y.g("",y.z.required),startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new y.j({startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}},{key:"getReportingProviderList",value:function(){var e=this;this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe((function(t){t.reportingProviders.map((function(t){e.reportTypeData.push({value:t.reportingProvider,viewValue:t.reportingProvider})}))}))}},{key:"getSelectedCompanyLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"onReportSubmit",value:function(){var e=this;if(this.manaulUpFG.valid){this.manaulUpFG.addControl("company",new y.g("",y.z.required)),this.manaulUpFG.patchValue({company:this.companySelected});var t=this.manaulUpFG.value.reportType;this.manualUpdateService.updateManualStats(this.manaulUpFG.value).subscribe((function(r){e.isObjectEmpty(r)?e.notification.showWarning(t+" data not existed!",""):"ok"==r.stats?e.notification.showSuccess(t+" data stats successfully updated!",""):"warn"==r.stats&&e.notification.showWarning(t+" data not existed!","")}))}}},{key:"isObjectEmpty",value:function(e){return 0===Object.keys(e).length}},{key:"getDateRanges",value:function(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}},{key:"changeDatePicker",value:function(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:h(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:h(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}},{key:"onPreSetRangeSelectChange",value:function(e){"custom"!==e.value&&(this.preSelectValue=e.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}},{key:"updateDatePickerRange",value:function(e,t){this.manaulUpFG.patchValue({startDate:h(e,"MM-DD-YYYY").toDate(),endDate:h(t,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:h(e,"MM-DD-YYYY").toDate(),endDate:h(t,"MM-DD-YYYY").toDate()})}},{key:"getPreSetDateRange",value:function(e){switch(e){case"today":return{startDate:h().utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:h().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:h().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:h().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:h().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:h().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}},{key:"handleReport",value:function(e){if(e.value.length>0){var t=e.value.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()}));this.reportUpdateTitle=t+" Stat Update"}}}]),e}()).\u0275fac=function(e){return new(e||Ts)(p.Qb(ws),p.Qb(y.f),p.Qb(Fs.a),p.Qb(xs.a),p.Qb(g.a),p.Qb(Ws.a))},Ts.\u0275cmp=p.Kb({type:Ts,selectors:[["app-manual-update"]],decls:36,vars:12,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Report","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(e,t){if(1&e&&(p.Wb(0,"form",0),p.hc("ngSubmit",(function(){return t.onReportSubmit()})),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"h3",6),p.Oc(7),p.Vb(),p.Vb(),p.Vb(),p.Wb(8,"div",7),p.Wb(9,"mat-form-field"),p.Wb(10,"mat-label"),p.Oc(11,"Report Type"),p.Vb(),p.Wb(12,"mat-select",8),p.hc("selectionChange",(function(e){return t.handleReport(e)})),p.Mc(13,Vs,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(14,"mat-form-field"),p.Wb(15,"mat-label"),p.Oc(16,"Enter a custom date range"),p.Vb(),p.Wb(17,"mat-date-range-input",10),p.hc("dateChange",(function(){return t.changeDatePicker()})),p.Rb(18,"input",11),p.Wb(19,"input",12),p.hc("dateChange",(function(){return t.changeDatePicker()})),p.Vb(),p.Vb(),p.Rb(20,"mat-datepicker-toggle",13),p.Rb(21,"mat-date-range-picker",null,14),p.Mc(23,Os,2,0,"mat-error",15),p.Mc(24,Cs,2,0,"mat-error",15),p.Mc(25,ks,2,0,"mat-error",15),p.Mc(26,Rs,2,0,"mat-error",15),p.Vb(),p.Wb(27,"mat-form-field"),p.Wb(28,"mat-label"),p.Oc(29,"Preset Date Range"),p.Vb(),p.Wb(30,"mat-select",16),p.hc("ngModelChange",(function(e){return t.preSelectValue=e}))("selectionChange",(function(e){return t.onPreSetRangeSelectChange(e)})),p.Mc(31,_s,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(32,"div",1),p.Wb(33,"div",2),p.Wb(34,"button",17),p.Oc(35,"Update Stats"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.Ac(22);p.rc("formGroup",t.manaulUpFG),p.Db(7),p.Pc(t.reportUpdateTitle),p.Db(6),p.rc("ngForOf",t.reportTypeData),p.Db(4),p.rc("rangePicker",r)("formGroup",t.range),p.Db(3),p.rc("for",r),p.Db(3),p.rc("ngIf",t.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),p.Db(1),p.rc("ngIf",t.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),p.Db(1),p.rc("ngIf",null==t.manaulUpFG.controls.startDate.errors?null:t.manaulUpFG.controls.startDate.errors.required),p.Db(1),p.rc("ngIf",null==t.manaulUpFG.controls.endDate.errors?null:t.manaulUpFG.controls.endDate.errors.required),p.Db(4),p.rc("ngModel",t.preSelectValue),p.Db(1),p.rc("ngForOf",t.preSetDateRanges)}},directives:[y.B,y.r,y.k,m.c,m.g,v.a,y.q,y.i,o.o,Ms.a,Ms.h,y.d,y.x,Ms.g,Ms.f,m.j,Ms.b,o.p,Ps.b,D.p,m.b],styles:[""]}),Ts);function Ns(e,t){if(1&e&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function Ls(e,t){if(1&e&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function As(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid start date "),p.Vb())}function js(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid end date"),p.Vb())}function zs(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"Start Date Required"),p.Vb())}function Es(e,t){1&e&&(p.Wb(0,"mat-error"),p.Oc(1,"End Date Required"),p.Vb())}function Ys(e,t){if(1&e&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&e){var r=t.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}var Hs,Us=((Hs=function(){function e(t,a,n,i,s,o,c,u){r(this,e),this.manualUpdateService=t,this.fb=a,this.companyService=n,this.authService=i,this.userService=s,this.notification=o,this.tagService=c,this.cdr=u,this.reportProviderData=[],this.tagData=[],this.selectedTagData=[],this.reportUpdateTitle="Report Split Update",this.selectedTagName="",this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}return n(e,[{key:"ngOnInit",value:function(){this.getReportingProviderList(),this.getAllTags(),this.manaulUpFG=this.fb.group({reportType:new y.g("",y.z.required),tag:new y.g("",y.z.required),preSelectValue:new y.g("",y.z.required),startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new y.j({startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}},{key:"getSelectedCompanyLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getAllTags",value:function(){var e=this;this.tagService.getAllTags().subscribe((function(t){var r=[];e.companySelected&&(r=t.filter((function(t){return t.company[0]._id==e.companySelected}))),r.map((function(t){e.tagData.push({value:t._id,viewValue:t.name,advertiser:t.advertiser})})),e.selectedTagData=e.tagData,e.cdr.detectChanges()}))}},{key:"handleTag",value:function(e){this.selectedTagName="updateAll"===e.value?"All":this.tagData.filter((function(t){return t.value==e.value}))[0].viewValue}},{key:"getReportingProviderList",value:function(){var e=this;this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe((function(t){t.reportingProviders.map((function(t){e.reportProviderData.push({value:t.reportingProvider,viewValue:t.reportingProvider})}))}))}},{key:"updateDatePickerRange",value:function(e,t){this.manaulUpFG.patchValue({startDate:h(e,"MM-DD-YYYY").toDate(),endDate:h(t,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:h(e,"MM-DD-YYYY").toDate(),endDate:h(t,"MM-DD-YYYY").toDate()})}},{key:"getDateRanges",value:function(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}},{key:"onPreSetRangeSelectChange",value:function(e){"custom"!==e.value&&(this.preSelectValue=e.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}},{key:"getPreSetDateRange",value:function(e){switch(e){case"today":return{startDate:h().utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:h().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:h().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:h().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:h().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:h().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}},{key:"handleReport",value:function(e){if(e.value.length>0){var t=e.value.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()}));this.reportUpdateTitle=t+" Split Update",this.selectedTagData=[];var r=[];r.push({value:"updateAll",viewValue:"update all",advertiser:e.value});var a=this.tagData.filter((function(t){return t.advertiser==e.value}));this.selectedTagData=r.concat(a),this.cdr.detectChanges()}}},{key:"onReportSubmit",value:function(){var e=this;this.manaulUpFG.valid&&(this.manaulUpFG.addControl("company",new y.g("",y.z.required)),this.manaulUpFG.patchValue({company:this.companySelected}),this.manualUpdateService.updateManualSplit(this.manaulUpFG.value).subscribe((function(t){e.isObjectEmpty(t)?e.notification.showWarning(e.selectedTagName+" data not existed!",""):e.notification.showSuccess(e.selectedTagName+" data splits  successfully updated!","")})))}},{key:"isObjectEmpty",value:function(e){return 0===Object.keys(e).length}},{key:"changeDatePicker",value:function(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:h(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:h(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}}]),e}()).\u0275fac=function(e){return new(e||Hs)(p.Qb(ws),p.Qb(y.f),p.Qb(Fs.a),p.Qb(xs.a),p.Qb(g.a),p.Qb(Ws.a),p.Qb(f.a),p.Qb(p.i))},Hs.\u0275cmp=p.Kb({type:Hs,selectors:[["app-manual-split-update"]],decls:41,vars:13,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Provider","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matNativeControl","","placeholder","Select Report","formControlName","tag",3,"selectionChange"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(e,t){if(1&e&&(p.Wb(0,"form",0),p.hc("ngSubmit",(function(){return t.onReportSubmit()})),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"h3",6),p.Oc(7),p.Vb(),p.Vb(),p.Vb(),p.Wb(8,"div",7),p.Wb(9,"mat-form-field"),p.Wb(10,"mat-label"),p.Oc(11,"Provider"),p.Vb(),p.Wb(12,"mat-select",8),p.hc("selectionChange",(function(e){return t.handleReport(e)})),p.Mc(13,Ns,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(14,"mat-form-field"),p.Wb(15,"mat-label"),p.Oc(16,"Tag"),p.Vb(),p.Wb(17,"mat-select",10),p.hc("selectionChange",(function(e){return t.handleTag(e)})),p.Mc(18,Ls,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(19,"mat-form-field"),p.Wb(20,"mat-label"),p.Oc(21,"Enter a custom date range"),p.Vb(),p.Wb(22,"mat-date-range-input",11),p.hc("dateChange",(function(){return t.changeDatePicker()})),p.Rb(23,"input",12),p.Wb(24,"input",13),p.hc("dateChange",(function(){return t.changeDatePicker()})),p.Vb(),p.Vb(),p.Rb(25,"mat-datepicker-toggle",14),p.Rb(26,"mat-date-range-picker",null,15),p.Mc(28,As,2,0,"mat-error",16),p.Mc(29,js,2,0,"mat-error",16),p.Mc(30,zs,2,0,"mat-error",16),p.Mc(31,Es,2,0,"mat-error",16),p.Vb(),p.Wb(32,"mat-form-field"),p.Wb(33,"mat-label"),p.Oc(34,"Preset Date Range"),p.Vb(),p.Wb(35,"mat-select",17),p.hc("ngModelChange",(function(e){return t.preSelectValue=e}))("selectionChange",(function(e){return t.onPreSetRangeSelectChange(e)})),p.Mc(36,Ys,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(37,"div",1),p.Wb(38,"div",2),p.Wb(39,"button",18),p.Oc(40,"Update Splits"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.Ac(27);p.rc("formGroup",t.manaulUpFG),p.Db(7),p.Pc(t.reportUpdateTitle),p.Db(6),p.rc("ngForOf",t.reportProviderData),p.Db(5),p.rc("ngForOf",t.selectedTagData),p.Db(4),p.rc("rangePicker",r)("formGroup",t.range),p.Db(3),p.rc("for",r),p.Db(3),p.rc("ngIf",t.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),p.Db(1),p.rc("ngIf",t.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),p.Db(1),p.rc("ngIf",null==t.manaulUpFG.controls.startDate.errors?null:t.manaulUpFG.controls.startDate.errors.required),p.Db(1),p.rc("ngIf",null==t.manaulUpFG.controls.endDate.errors?null:t.manaulUpFG.controls.endDate.errors.required),p.Db(4),p.rc("ngModel",t.preSelectValue),p.Db(1),p.rc("ngForOf",t.preSetDateRanges)}},directives:[y.B,y.r,y.k,m.c,m.g,v.a,y.q,y.i,o.o,Ms.a,Ms.h,y.d,y.x,Ms.g,Ms.f,m.j,Ms.b,o.p,Ps.b,D.p,m.b],styles:[""]}),Hs),Bs=i("mPAa"),Qs=["expandableTable"];function Gs(e,t){1&e&&(p.Wb(0,"div",28),p.Rb(1,"mat-progress-bar",29),p.Vb())}function qs(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",30),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function $s(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",31),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Ks(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function Xs(e,t){if(1&e&&(p.Wb(0,"div",34),p.Wb(1,"table",35),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Ks,27,35,"tr",36),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Zs(e,t){1&e&&(p.Wb(0,"div",37),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Js(e,t){if(1&e&&(p.Mc(0,Xs,22,1,"div",32),p.Mc(1,Zs,6,0,"div",33)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function eo(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",38),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function to(e,t){1&e&&p.Oc(0," Date ")}function ro(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ao(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,to,1,0,"ng-template",24),p.Mc(2,ro,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function no(e,t){1&e&&p.Oc(0," Subid ")}function io(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function so(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,no,1,0,"ng-template",24),p.Mc(2,io,2,1,"ng-template",17),p.Vb())}function oo(e,t){1&e&&p.Oc(0," Publisher ")}function co(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function uo(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,oo,1,0,"ng-template",24),p.Mc(2,co,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function lo(e,t){1&e&&p.Oc(0," Searches ")}function ho(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function po(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,lo,1,0,"ng-template",24),p.Mc(2,ho,3,3,"ng-template",17),p.Vb())}function go(e,t){1&e&&p.Oc(0," Clicks ")}function bo(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function fo(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,go,1,0,"ng-template",24),p.Mc(2,bo,3,3,"ng-template",17),p.Vb())}function mo(e,t){1&e&&p.Oc(0," Split ")}function vo(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function yo(e,t){1&e&&p.Oc(0," Publisher Net ")}function Do(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function So(e,t){1&e&&p.Oc(0," Profit ")}function wo(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Fo(e,t){1&e&&p.Oc(0," Revenue ")}function xo(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var Wo,Mo,Po=((Wo=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.solexBCService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getAllSolexBCStats",value:function(t,r,a){var n=this;return this.solexBCService.getSolexBCStats(t,r,a).toPromise().then((function(t){var r,a=e((n.loadingIndicator=!1,n.allStats=t.stats,n.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),n.tagList));try{for(a.s();!(r=a.n()).done;){var i=r.value;if("solex-bc"==i.tag.advertiser){var s,o=e(i.tag.subids);try{for(o.s();!(s=o.n()).done;){var c=s.value;"Contains"==c.filterTag?n.allStats.map((function(e){e.subid.includes(c.subid)&&(e.publisher=i.user.length?i.user[0].fullname:"No Publisher",e.tagname=i.tag.name)})):"StartsWith"==c.filterTag?n.allStats.map((function(e){e.subid.startsWith(c.subid)&&(e.publisher=i.user.length?i.user[0].fullname:"No Publisher",e.tagname=i.tag.name)})):"EndsWith"==c.filterTag?n.allStats.map((function(e){e.subid.endsWith(c.subid)&&(e.publisher=i.user.length?i.user[0].fullname:"No Publisher",e.tagname=i.tag.name)})):"ExactValue"==c.filterTag&&n.allStats.map((function(e){e.subid==c.subid&&(e.publisher=i.user.length?i.user[0].fullname:"No Publisher",e.tagname=i.tag.name)}))}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){a.e(u)}finally{a.f()}return n.allStats}))}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.solexBCService.getSolexBCStats(t,r,a).toPromise();case 3:i=n.sent,s=e((this.allChartStat=i.stats,this.allChartStat.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("solex-bc"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(p.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(e){e.subid==p.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){s.e(z)}finally{s.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),b=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(e,t){return e+t.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),x={},W=this.allChartStat.reduce((function(e,t){var r=t.date;return x[r]?x[r].searches+=parseInt(t.searches):(x[r]=Object.assign({},t),e.push(x[r])),e}),[]),M=[],P=[],V={},O=e(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=W.filter((function(e){return e.date==k}))).length)M.push(k),P.push(0);else{_=e(R);try{for(_.s();!(T=_.n()).done;)I=T.value,M.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=e(F);try{for(j=function(){var t,r=A.value,a=[],n=e(M);try{var i=function(){var e=t.value,n=f.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var s={};s[r]=a,N.push(s)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=M,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getSummaryMetrics",value:function(e,t,r){return this.solexBCService.getSummaryMetrics(e,t,r).toPromise().then((function(e){var a={},n=0,i=0,s=0;return 0!=e.summary[0].lastMonthStat[0].profitPace&&(n=(e.summary[0].summaryMetrics[0].profitPace-e.summary[0].lastMonthStat[0].profitPace)/e.summary[0].lastMonthStat[0].profitPace*100),0!=e.summary[0].twoLastMonthStat[0].profitPace&&(i=(e.summary[0].lastMonthStat[0].profitPace-e.summary[0].twoLastMonthStat[0].profitPace)/e.summary[0].twoLastMonthStat[0].profitPace*100),0!=e.summary[0].prevSelectedStat[0].profitPace&&(s=(e.summary[0].selectedStat[0].profitPace-e.summary[0].prevSelectedStat[0].profitPace)/e.summary[0].prevSelectedStat[0].profitPace*100),e.summary[0].summaryMetrics[0].percentPace=n,e.summary[0].lastMonthStat[0].percentPace=i,e.summary[0].selectedStat[0].percentPace=s,e.summary[0].selectedStat[0].selectedStartDate=t,e.summary[0].selectedStat[0].selectedEndDate=r,a.summary=e.summary,a}))}},{key:"getCompanyTags",value:function(e){var t=e.split("/")[1];return this.tagService.getCompanyTags(t).toPromise().then((function(e){return e})).catch((function(e){return e}))}}]),t}()).\u0275fac=function(e){return new(e||Wo)(p.Qb(p.i),p.Qb(g.a),p.Qb(Bs.a),p.Qb(f.a))},Wo.\u0275cmp=p.Kb({type:Wo,selectors:[["app-solex-bc"]],viewQuery:function(e,t){var r;1&e&&p.Tc(Qs,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(e,t){1&e&&(p.Mc(0,Gs,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,qs,1,1,"app-reporting-revenue-chart",2),p.Mc(3,$s,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,Js,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,eo,1,4,"ng-template",17),p.Vb(),p.Mc(24,ao,3,1,"ngx-datatable-column",18),p.Mc(25,so,3,0,"ngx-datatable-column",19),p.Mc(26,uo,3,1,"ngx-datatable-column",20),p.Mc(27,po,3,0,"ngx-datatable-column",21),p.Mc(28,fo,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,mo,1,0,"ng-template",24),p.Mc(31,vo,4,6,"ng-template",17),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,yo,1,0,"ng-template",24),p.Mc(34,Do,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,So,1,0,"ng-template",24),p.Mc(37,wo,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",27),p.Mc(39,Fo,1,0,"ng-template",24),p.Mc(40,xo,3,4,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Wo),Vo=ys.a.apiUrl+"/stats/admin/accounting",Oo=((Mo=function(){function e(t){r(this,e),this.http=t}return n(e,[{key:"getRubiStats",value:function(e,t,r){return this.http.get(Vo+"/rubi",{params:{company:e,startDate:t,endDate:r}})}},{key:"getPerionStats",value:function(e,t,r){return this.http.get(Vo+"/perion",{params:{company:e,startDate:t,endDate:r}})}},{key:"getLyonStats",value:function(e,t,r){return this.http.get(Vo+"/lyons",{params:{company:e,startDate:t,endDate:r}})}},{key:"getApptitudeStats",value:function(e,t,r){return this.http.get(Vo+"/apptitude",{params:{company:e,startDate:t,endDate:r}})}},{key:"getSolexBCStats",value:function(e,t,r){return this.http.get(Vo+"/solex-bc",{params:{company:e,startDate:t,endDate:r}})}},{key:"getVerizonDirectStats",value:function(e,t,r){return this.http.get(Vo+"/verizon-direct",{params:{company:e,startDate:t,endDate:r}})}},{key:"getSystem1Stats",value:function(e,t,r){return this.http.get(Vo+"/system1",{params:{company:e,startDate:t,endDate:r}})}}]),e}()).\u0275fac=function(e){return new(e||Mo)(p.ec(Ds.c))},Mo.\u0275prov=p.Mb({token:Mo,factory:Mo.\u0275fac,providedIn:"root"}),Mo),Co=["expandableTable"];function ko(e,t){if(1&e&&(p.Wb(0,"div"),p.Wb(1,"div",12),p.Wb(2,"div",13),p.Wb(3,"span"),p.Oc(4),p.Vb(),p.Vb(),p.Wb(5,"div",15),p.Wb(6,"span"),p.Oc(7),p.mc(8,"currency"),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&e){var r=t.$implicit,a=t.index,n=p.lc().row;p.Db(4),p.Qc("",r," : "),p.Db(3),p.Pc(p.oc(8,2,n.everyrevenue[a],"USD"))}}function Ro(e,t){if(1&e&&(p.Wb(0,"div",9),p.Mc(1,ko,9,5,"div",10),p.Vb(),p.Wb(2,"div",11),p.Wb(3,"div",12),p.Wb(4,"div",13),p.Wb(5,"strong",14),p.Oc(6,"Total : "),p.Vb(),p.Vb(),p.Wb(7,"div",15),p.Wb(8,"strong",14),p.Oc(9),p.mc(10,"currency"),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&e){var r=t.row;p.Db(1),p.rc("ngForOf",r.reporting),p.Db(8),p.Pc(p.oc(10,2,r.total,"USD"))}}function _o(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",16),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function To(e,t){1&e&&p.Oc(0," Publisher Name ")}function Io(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}var No,Lo=((No=function(){function t(e,a,n,i,s){r(this,t),this.cdr=e,this.userService=a,this.accountingService=n,this.tagService=i,this.companyService=s,this.rows=[],this.loadingIndicator=!0,this.range={startDate:"",endDate:""},this.allRubiStats=[],this.allLyonStats=[],this.allPerionStats=[],this.allSystem1Stats=[],this.allVerizonStats=[],this.allSolexBCStats=[],this.allApptitudeStats=[],this.tagList=[],this.tempStatData=[],this.tempUpdateStatData=[],this.reportTypeData=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,e.next=5,this.getReportingProviderList();case 5:if(this.reportTypeData=e.sent,this.rows=[],this.tempStatData=[],e.t0=this.reportTypeData.includes("perion"),!e.t0){e.next=14;break}return e.next=12,this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.PerionData=e.sent,this.tempStatData=this.tempStatData.concat(this.PerionData);case 14:if(e.t1=this.reportTypeData.includes("lyons"),!e.t1){e.next=20;break}return e.next=18,this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 18:this.LyonData=e.sent,this.tempStatData=this.tempStatData.concat(this.LyonData);case 20:if(e.t2=this.reportTypeData.includes("rubi"),!e.t2){e.next=26;break}return e.next=24,this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 24:this.RubiData=e.sent,this.tempStatData=this.tempStatData.concat(this.RubiData);case 26:if(e.t3=this.reportTypeData.includes("apptitude"),!e.t3){e.next=32;break}return e.next=30,this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 30:this.ApptitudeData=e.sent,this.tempStatData=this.tempStatData.concat(this.ApptitudeData);case 32:if(e.t4=this.reportTypeData.includes("solex-bc"),!e.t4){e.next=38;break}return e.next=36,this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 36:this.SolexBCData=e.sent,this.tempStatData=this.tempStatData.concat(this.SolexBCData);case 38:if(e.t5=this.reportTypeData.includes("verizon-direct"),!e.t5){e.next=44;break}return e.next=42,this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 42:this.VerizonData=e.sent,this.tempStatData=this.tempStatData.concat(this.VerizonData);case 44:if(e.t6=this.reportTypeData.includes("system1"),!e.t6){e.next=50;break}return e.next=48,this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 48:this.System1Data=e.sent,this.tempStatData=this.tempStatData.concat(this.System1Data);case 50:for(t=[],r=0,this.tempStatData.forEach((function(e){var r=t.filter((function(t){return t.publisher==e.publisher}));if(r.length){var a=t.indexOf(r[0]);t[a].reporting=t[a].reporting.concat(e.reporting),t[a].everyrevenue=t[a].everyrevenue.concat(String(e.revenue)),t[a].total=t[a].total+e.revenue}else"string"==typeof e.reporting&&(e.reporting=[e.reporting]),"number"==typeof e.revenue&&(e.everyrevenue=[String(e.revenue)],e.total=e.revenue),t.push(e)})),a=t;r<a.length;r++)(n=a[r]).detailHeight=30*(n.reporting.length+1);this.rows=t,this.loadingIndicator=!1,this.cdr.detectChanges();case 53:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,n,i,s,o,c,u,l,h,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loadingIndicator=!0,this.range=e,this.rows=[],this.tempUpdateStatData=[],r=[],a=[],n=[],i=[],s=[],o=[],c=[],t.t0=this.reportTypeData.includes("perion"),!t.t0){t.next=8;break}return t.next=6,this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:r=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(r);case 8:if(t.t1=this.reportTypeData.includes("lyons"),!t.t1){t.next=14;break}return t.next=12,this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:a=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(a);case 14:if(t.t2=this.reportTypeData.includes("rubi"),!t.t2){t.next=20;break}return t.next=18,this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 18:n=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(n);case 20:if(t.t3=this.reportTypeData.includes("apptitude"),!t.t3){t.next=26;break}return t.next=24,this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 24:i=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(i);case 26:if(t.t4=this.reportTypeData.includes("solex-bc"),!t.t4){t.next=32;break}return t.next=30,this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 30:s=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(s);case 32:if(t.t5=this.reportTypeData.includes("verizon-direct"),!t.t5){t.next=38;break}return t.next=36,this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 36:o=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(o);case 38:if(t.t6=this.reportTypeData.includes("system1"),!t.t6){t.next=44;break}return t.next=42,this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 42:c=t.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(c);case 44:for(u=[],l=0,this.tempUpdateStatData.forEach((function(e){var t=u.filter((function(t){return t.publisher==e.publisher}));if(t.length){var r=u.indexOf(t[0]);u[r].reporting=u[r].reporting.concat(e.reporting),u[r].everyrevenue=u[r].everyrevenue.concat(String(e.revenue)),u[r].total=u[r].total+e.revenue}else"string"==typeof e.reporting&&(e.reporting=[e.reporting]),"number"==typeof e.revenue&&(e.everyrevenue=[String(e.revenue)],e.total=e.revenue),u.push(e)})),h=u;l<h.length;l++)(p=h[l]).detailHeight=30*(p.reporting.length+1);this.rows=u,this.loadingIndicator=!1,this.cdr.detectChanges();case 47:case"end":return t.stop()}}),t,this)})))}},{key:"getReportingProviderList",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.selectedCompany){e.next=12;break}return e.prev=1,e.next=4,this.companyService.getReportCompany(this.selectedCompany.split("/")[1]).toPromise();case 4:return t=e.sent,r=[],e.abrupt("return",(t.reportingProviders.map((function(e){r.push(e.reportingProvider)})),r));case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getRubiStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getRubiStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allRubiStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("rubi"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allRubiStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Rubi")})):"StartsWith"==h.filterTag?this.allRubiStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Rubi")})):"EndsWith"==h.filterTag?this.allRubiStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Rubi")})):"ExactValue"==h.filterTag&&this.allRubiStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Rubi")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allRubiStats.length>0&&this.allRubiStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getSolexBCStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getSolexBCStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allSolexBCStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("solex-bc"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allSolexBCStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Solex BC")})):"StartsWith"==h.filterTag?this.allSolexBCStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Solex BC")})):"EndsWith"==h.filterTag?this.allSolexBCStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Solex BC")})):"ExactValue"==h.filterTag&&this.allSolexBCStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Solex BC")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allSolexBCStats.length>0&&this.allSolexBCStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getVerizonDirectStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getVerizonDirectStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allVerizonStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("verizon-direct"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allVerizonStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Verizon Direct")})):"StartsWith"==h.filterTag?this.allVerizonStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Verizon Direct")})):"EndsWith"==h.filterTag?this.allVerizonStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Verizon Direct")})):"ExactValue"==h.filterTag&&this.allVerizonStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Verizon Direct")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allVerizonStats.length>0&&this.allVerizonStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getLyonStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getLyonStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allLyonStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("lyons"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allLyonStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Lyons")})):"StartsWith"==h.filterTag?this.allLyonStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Lyons")})):"EndsWith"==h.filterTag?this.allLyonStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Lyons")})):"ExactValue"==h.filterTag&&this.allLyonStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Lyons")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allLyonStats.length>0&&this.allLyonStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getPerionStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getPerionStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allPerionStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("perion"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allPerionStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Perion")})):"StartsWith"==h.filterTag?this.allPerionStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Perion")})):"EndsWith"==h.filterTag?this.allPerionStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Perion")})):"ExactValue"==h.filterTag&&this.allPerionStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Perion")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allPerionStats.length>0&&this.allPerionStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getApptitudeStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getApptitudeStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allApptitudeStats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("apptitude"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allApptitudeStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Apptitude")})):"StartsWith"==h.filterTag?this.allApptitudeStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Apptitude")})):"EndsWith"==h.filterTag?this.allApptitudeStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Apptitude")})):"ExactValue"==h.filterTag&&this.allApptitudeStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="Apptitude")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allApptitudeStats.length>0&&this.allApptitudeStats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getSystem1Stats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getSystem1Stats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.allSystem1Stats=i.stats,this.tagList));try{for(s.s();!(o=s.n()).done;)if("system1"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allSystem1Stats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="System1")})):"StartsWith"==h.filterTag?this.allSystem1Stats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="System1")})):"EndsWith"==h.filterTag?this.allSystem1Stats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="System1")})):"ExactValue"==h.filterTag&&this.allSystem1Stats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.reporting="System1")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){s.e(b)}finally{s.f()}return p=[],g={},n.abrupt("return",(this.allSystem1Stats.length>0&&this.allSystem1Stats.reduce((function(e,t){var r=t.publisher;return g[r]?g[r].revenue+=parseFloat(t.revenue):(g[r]=Object.assign({},t),e.push(g[r])),e}),[]).map((function(e){p.push({publisher:e.publisher?e.publisher:"No Publisher",reporting:e.reporting?e.reporting:"No Reporting",revenue:e.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}}]),t}()).\u0275fac=function(e){return new(e||No)(p.Qb(p.i),p.Qb(g.a),p.Qb(Oo),p.Qb(f.a),p.Qb(Fs.a))},No.\u0275cmp=p.Kb({type:No,selectors:[["app-accounting"]],viewQuery:function(e,t){var r;1&e&&p.Tc(Co,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:10,vars:14,consts:[[3,"onDatesPicked"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],[2,"padding-left","36px"],[4,"ngFor","ngForOf"],[2,"padding-left","36px","margin-top","5px"],[2,"display","flex"],[2,"min-width","20%"],[2,"font-size","14px"],[2,"min-width","80%"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"]],template:function(e,t){1&e&&(p.Wb(0,"app-reporting-filtering",0),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Wb(1,"ngx-datatable",1,2),p.Wb(3,"ngx-datatable-row-detail",3),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(4,Ro,11,5,"ng-template",4),p.Vb(),p.Wb(5,"ngx-datatable-column",5),p.Mc(6,_o,1,4,"ng-template",6),p.Vb(),p.Wb(7,"ngx-datatable-column",7),p.Mc(8,To,1,0,"ng-template",8),p.Mc(9,Io,2,1,"ng-template",6),p.Vb(),p.Vb()),2&e&&(p.Db(1),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight",t.getDetailRowHeight),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("minWidth",100))},directives:[d.a,S.d,S.e,S.f,S.b,S.a,S.c,o.o],pipes:[o.d],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:hidden!important}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{border-top:1px solid #222!important}"]}),No),Ao=i("2Q/2"),jo=["expandableTable"];function zo(e,t){1&e&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function Eo(e,t){if(1&e&&p.Rb(0,"app-reporting-revenue-chart",37),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function Yo(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",38),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Ho(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function Uo(e,t){if(1&e&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Ho,25,29,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Bo(e,t){1&e&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Qo(e,t){if(1&e&&(p.Mc(0,Uo,22,1,"div",39),p.Mc(1,Bo,6,0,"div",40)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Go(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function qo(e,t){1&e&&p.Oc(0," Date ")}function $o(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ko(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,qo,1,0,"ng-template",31),p.Mc(2,$o,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function Xo(e,t){1&e&&p.Oc(0," Subid ")}function Zo(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function Jo(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,Xo,1,0,"ng-template",31),p.Mc(2,Zo,2,1,"ng-template",17),p.Vb())}function ec(e,t){1&e&&p.Oc(0," Publisher ")}function tc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function rc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,ec,1,0,"ng-template",31),p.Mc(2,tc,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function ac(e,t){1&e&&p.Oc(0," Searches ")}function nc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ic(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,ac,1,0,"ng-template",31),p.Mc(2,nc,3,3,"ng-template",17),p.Vb())}function sc(e,t){1&e&&p.Oc(0," Bid Searches ")}function oc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function cc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,sc,1,0,"ng-template",31),p.Mc(2,oc,3,3,"ng-template",17),p.Vb())}function uc(e,t){1&e&&p.Oc(0," Bid Searches Result ")}function lc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,uc,1,0,"ng-template",31),p.Mc(2,lc,3,3,"ng-template",17),p.Vb())}function pc(e,t){1&e&&p.Oc(0," Clicks ")}function gc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function bc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,pc,1,0,"ng-template",31),p.Mc(2,gc,3,3,"ng-template",17),p.Vb())}function fc(e,t){1&e&&p.Oc(0," Coverage ")}function dc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function mc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,fc,1,0,"ng-template",31),p.Mc(2,dc,3,3,"ng-template",17),p.Vb())}function vc(e,t){1&e&&p.Oc(0," CTR ")}function yc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function Dc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,vc,1,0,"ng-template",31),p.Mc(2,yc,3,4,"ng-template",17),p.Vb())}function Sc(e,t){1&e&&p.Oc(0," CPC ")}function wc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function Fc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,Sc,1,0,"ng-template",31),p.Mc(2,wc,3,4,"ng-template",17),p.Vb())}function xc(e,t){1&e&&p.Oc(0," RN ")}function Wc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Mc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,xc,1,0,"ng-template",31),p.Mc(2,Wc,3,3,"ng-template",17),p.Vb())}function Pc(e,t){1&e&&p.Oc(0," TQ ")}function Vc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Oc(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,Pc,1,0,"ng-template",31),p.Mc(2,Vc,3,3,"ng-template",17),p.Vb())}function Cc(e,t){1&e&&p.Oc(0," Publisher Net ")}function kc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Rc(e,t){1&e&&p.Oc(0," Profit ")}function _c(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Tc(e,t){1&e&&p.Oc(0," Revenue ")}function Ic(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Nc(e,t){1&e&&p.Oc(0," Split ")}function Lc(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Ac,jc,zc,Ec=((Ac=function(){function t(e,a,n,i){r(this,t),this.verizonarbService=e,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,n,i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=e((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct-arb"==(n=a.value).tag.advertiser){i=e(n.tag.subids);try{for(i.s();!(s=i.n()).done;)"Contains"==(o=s.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"StartsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"EndsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"ExactValue"==o.filterTag&&this.allChartStat.map((function(e){e.subid==o.subid&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),u=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(e,t){return e+t.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),D={},S=this.allChartStat.reduce((function(e,t){var r=t.date;return D[r]?(D[r].searches+=parseInt(t.searches),t.revenue&&(D[r].revenue+=t.revenue)):(D[r]=Object.assign({},t),e.push(D[r])),e}),[]),w=[],F=[],x={},W=e(this.daysList);try{for(W.s();!(M=W.n()).done;)if(P=M.value,0==(V=S.filter((function(e){return e.date==P}))).length)w.push(P),F.push(0);else{O=e(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){W.e(N)}finally{W.f()}R=[],_=e(y);try{for(I=function(){var t,r=T.value,a=[],n=e(w);try{var i=function(){var e=t.value,n=h.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var s={};s[r]=a,R.push(s)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return t.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return t.prev=19,t.t0=t.catch(0),t.abrupt("return",t.t0);case 22:case"end":return t.stop()}}),t,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonarbService.getAllVerizonArbStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("verizon-direct-arb"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonarbService.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),t}()).\u0275fac=function(e){return new(e||Ac)(p.Qb(Ao.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},Ac.\u0275cmp=p.Kb({type:Ac,selectors:[["app-verizon-direct-arb"]],viewQuery:function(e,t){var r;1&e&&p.Tc(jo,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(e,t){1&e&&(p.Mc(0,zo,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,Eo,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Yo,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,Qo,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Go,1,4,"ng-template",17),p.Vb(),p.Mc(24,Ko,3,1,"ngx-datatable-column",18),p.Mc(25,Jo,3,0,"ngx-datatable-column",19),p.Mc(26,rc,3,1,"ngx-datatable-column",20),p.Mc(27,ic,3,0,"ngx-datatable-column",21),p.Mc(28,cc,3,0,"ngx-datatable-column",22),p.Mc(29,hc,3,0,"ngx-datatable-column",23),p.Mc(30,bc,3,0,"ngx-datatable-column",24),p.Mc(31,mc,3,0,"ngx-datatable-column",25),p.Mc(32,Dc,3,0,"ngx-datatable-column",26),p.Mc(33,Fc,3,0,"ngx-datatable-column",27),p.Mc(34,Mc,3,0,"ngx-datatable-column",28),p.Mc(35,Oc,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,Cc,1,0,"ng-template",31),p.Mc(38,kc,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Rc,1,0,"ng-template",31),p.Mc(41,_c,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,Tc,1,0,"ng-template",31),p.Mc(44,Ic,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Nc,1,0,"ng-template",31),p.Mc(47,Lc,4,6,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Ac),Yc=ys.a.apiUrl+"/stats/admin/verizon-arb-hourly",Hc=((zc=function(){function e(t){r(this,e),this.http=t}return n(e,[{key:"getChartMetrics",value:function(e,t,r){return this.http.get(Yc+"/chart_metrics",{params:{company:e,startDate:t,endDate:r}})}},{key:"getAllVerizonArbHourlyStats",value:function(e,t,r){return this.http.get(Yc+"/",{params:{company:e,startDate:t,endDate:r}})}},{key:"getAllPublisherVerizonArbHourlyStats",value:function(e,t,r){return this.http.get(Yc+"/all-publishers",{params:{company:e,startDate:t,endDate:r}})}},{key:"getSummaryMetrics",value:function(e,t,r){return this.http.get(Yc+"/summary_metrics",{params:{company:e,startDate:t,endDate:r}})}},{key:"getAllDashboardStats",value:function(){return this.http.get(Yc+"/all-stat")}}]),e}()).\u0275fac=function(e){return new(e||zc)(p.ec(Ds.c))},zc.\u0275prov=p.Mb({token:zc,factory:zc.\u0275fac,providedIn:"root"}),zc),Uc=((jc=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}},{key:"ngOnChanges",value:function(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}},{key:"setChartOptions",value:function(t,r,a,n,i,s){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom);var o,c=[],u=e(n);try{for(u.s();!(o=u.n()).done;){var l=o.value,h=Object.keys(l)[0];h&&c.push({name:h,type:"bar",stack:"Ad",data:l[h].map((function(e){return parseFloat(e).toFixed(2)}))})}}catch(p){u.e(p)}finally{u.f()}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(e){var t=function(e){return'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e+'"></span>'},r="<p>"+e[0].axisValue+"</p>",a=0;return e.forEach((function(e){var n="<p>"+t(e.color)+" "+e.seriesName+":  $ "+e.data+"</p>";r+=n,a+=parseFloat(e.data)})),r+="<p>"+t("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:i},xAxis:[{type:"category",data:a,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:c},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}},{key:"convertTimeStampArryToDate",value:function(e){for(var t=[],r=0;r<e.length;r++)t.push(h(e[r]).format("MM-DD-YYYY hha"));return t}},{key:"getChartData",value:function(e){if(e)return e}}]),t}()).\u0275fac=function(e){return new(e||jc)},jc.\u0275cmp=p.Kb({type:jc,selectors:[["app-reporting-hourly-revenue-chart"]],inputs:{chartData:"chartData"},features:[p.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(e,t){1&e&&p.Rb(0,"div",0)},styles:[""]}),jc),Bc=["expandableTable"];function Qc(e,t){1&e&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function Gc(e,t){if(1&e&&p.Rb(0,"app-reporting-hourly-revenue-chart",37),2&e){var r=p.lc();p.rc("chartData",r.chartData)}}function qc(e,t){if(1&e&&p.Rb(0,"app-summary-metrics",38),2&e){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function $c(e,t){if(1&e&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&e){var r=t.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function Kc(e,t){if(1&e&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,$c,25,29,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&e){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Xc(e,t){1&e&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Zc(e,t){if(1&e&&(p.Mc(0,Kc,22,1,"div",39),p.Mc(1,Xc,6,0,"div",40)),2&e){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Jc(e,t){if(1&e){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var e=t.row;return p.lc().toggleExpandRow(e)})),p.Vb()}if(2&e){var a=t.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function eu(e,t){1&e&&p.Oc(0," Date ")}function tu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ru(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,eu,1,0,"ng-template",31),p.Mc(2,tu,3,3,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function au(e,t){1&e&&p.Oc(0," Subid ")}function nu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function iu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,au,1,0,"ng-template",31),p.Mc(2,nu,2,1,"ng-template",17),p.Vb())}function su(e,t){1&e&&p.Oc(0," Publisher ")}function ou(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(r)}}function cu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,su,1,0,"ng-template",31),p.Mc(2,ou,2,1,"ng-template",17),p.Vb()),2&e&&p.rc("minWidth",100)}function uu(e,t){1&e&&p.Oc(0," Searches ")}function lu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,uu,1,0,"ng-template",31),p.Mc(2,lu,3,3,"ng-template",17),p.Vb())}function pu(e,t){1&e&&p.Oc(0," Bid Searches ")}function gu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function bu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,pu,1,0,"ng-template",31),p.Mc(2,gu,3,3,"ng-template",17),p.Vb())}function fu(e,t){1&e&&p.Oc(0," Bid Searches Result ")}function du(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function mu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,fu,1,0,"ng-template",31),p.Mc(2,du,3,3,"ng-template",17),p.Vb())}function vu(e,t){1&e&&p.Oc(0," Clicks ")}function yu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Du(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,vu,1,0,"ng-template",31),p.Mc(2,yu,3,3,"ng-template",17),p.Vb())}function Su(e,t){1&e&&p.Oc(0," Coverage ")}function wu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Fu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,Su,1,0,"ng-template",31),p.Mc(2,wu,3,3,"ng-template",17),p.Vb())}function xu(e,t){1&e&&p.Oc(0," CTR ")}function Wu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function Mu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,xu,1,0,"ng-template",31),p.Mc(2,Wu,3,4,"ng-template",17),p.Vb())}function Pu(e,t){1&e&&p.Oc(0," CPC ")}function Vu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function Ou(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,Pu,1,0,"ng-template",31),p.Mc(2,Vu,3,4,"ng-template",17),p.Vb())}function Cu(e,t){1&e&&p.Oc(0," RN ")}function ku(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ru(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,Cu,1,0,"ng-template",31),p.Mc(2,ku,3,3,"ng-template",17),p.Vb())}function _u(e,t){1&e&&p.Oc(0," TQ ")}function Tu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Iu(e,t){1&e&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,_u,1,0,"ng-template",31),p.Mc(2,Tu,3,3,"ng-template",17),p.Vb())}function Nu(e,t){1&e&&p.Oc(0," Publisher Net ")}function Lu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Au(e,t){1&e&&p.Oc(0," Profit ")}function ju(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function zu(e,t){1&e&&p.Oc(0," Revenue ")}function Eu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Yu(e,t){1&e&&p.Oc(0," Split ")}function Hu(e,t){if(1&e&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&e){var r=t.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Uu,Bu,Qu,Gu=[{path:"",component:Ar,children:[{path:"accounting",component:Lo},{path:"perion",component:Lr},{path:"image-advantage",component:Vt},{path:"hopkins",component:st},{path:"apptitude",component:De},{path:"media-net",component:Ot},{path:"bing-direct",component:ia},{path:"lyons",component:$a},{path:"rubi",component:kn},{path:"system1",component:vs},{path:"verizon-direct",component:_i},{path:"verizon-direct-arb",component:Ec},{path:"verizon-direct-arb-hourly",component:(Uu=function(){function t(e,a,n,i){r(this,t),this.cdr=e,this.userService=a,this.tagService=n,this.verizonarbHourlyService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(t,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=e.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=e.sent,e.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=e.sent,e.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=e.sent,this.refreshTable();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingIndicator=!0,this.range=e,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=t.sent,t.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=t.sent,t.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=t.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return t.stop()}}),t,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.date;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.subid;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var t,r={},a=this.allStats.reduce((function(e,t){var a=t.publisher;return r[a]?(r[a].clicks+=parseFloat(t.clicks),r[a].ctr+=parseFloat(t.ctr?t.ctr:0),r[a].rn+=parseFloat(t.rn?t.rn:0),r[a].coverage+=parseFloat(t.coverage?t.coverage:0),r[a].searches+=parseFloat(t.searches?t.searches:0),r[a].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),r[a].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),r[a].profit+=parseFloat(t.profit),r[a].publisherNet+=parseFloat(t.publisherNet),r[a].revenue+=parseFloat(t.revenue),r[a].split+=parseFloat(t.split),r[a].counter++):(r[a]=Object.assign({},t),r[a].counter=1,e.push(r[a])),e}),[]),n=e(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(s){n.e(s)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.publisher===t.publisher})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(t){var r,a={},n=this.allStats.filter((function(e){return e.subid===t.subid})).reduce((function(e,t){var r=t.date;return a[r]?(a[r].clicks+=parseFloat(t.clicks),a[r].rn+=parseFloat(t.rn?t.rn:0),a[r].coverage+=parseFloat(t.coverage?t.coverage:0),a[r].searches+=parseFloat(t.searches?t.searches:0),a[r].biddedSearches+=parseFloat(t.biddedSearches?t.biddedSearches:0),a[r].biddedResults+=parseFloat(t.biddedResults?t.biddedResults:0),a[r].profit+=parseFloat(t.profit),a[r].publisherNet+=parseFloat(t.publisherNet),a[r].revenue+=parseFloat(t.revenue),a[r].split+=parseFloat(t.split),a[r].counter++):(a[r]=Object.assign({},t),a[r].counter=1,e.push(a[r])),e}),[]),i=e(n);try{for(i.s();!(r=i.n()).done;)(t=r.value).split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches}catch(s){i.e(s)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(e){console.log("Toggled Expand Row!",e),this.table.rowDetail.toggleExpandRow(e)}},{key:"onDetailToggle",value:function(e){console.log("Detail Toggled",e)}},{key:"remove_element",value:function(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return void e.splice(r,1)}},{key:"groupHandle",value:function(e){this.groupType=e.value,"date"==e.value?this.groupDate():"publisher"==e.value?this.groupProvider():"subid"==e.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,n,i,s,o,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,W,M,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=e((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct-arb-hourly"==(n=a.value).tag.advertiser){i=e(n.tag.subids);try{for(i.s();!(s=i.n()).done;)"Contains"==(o=s.value).filterTag?this.allChartStat.map((function(e){e.subid.includes(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"StartsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.startsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"EndsWith"==o.filterTag?this.allChartStat.map((function(e){e.subid.endsWith(o.subid)&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)})):"ExactValue"==o.filterTag&&this.allChartStat.map((function(e){e.subid==o.subid&&(e.publisher=n.user.length?n.user[0].fullname:"No Publisher",e.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(e){return e.date})).sortBy((function(e){return e.publisher})).value(),u=function e(t,r){if(!r.length)return t;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(t,a),(function(t){return e(t,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(e,t){return e+t.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(e,t,r){return t===r.indexOf(e)})),this.allChartStat=this.allChartStat.slice().sort((function(e,t){return e.date-t.date})),D={},S=this.allChartStat.reduce((function(e,t){var r=t.date;return D[r]?(D[r].searches+=parseInt(t.searches),t.revenue&&(D[r].revenue+=t.revenue)):(D[r]=Object.assign({},t),e.push(D[r])),e}),[]),w=[],F=[],x={},W=e(this.daysList);try{for(W.s();!(M=W.n()).done;)if(P=M.value,0==(V=S.filter((function(e){return e.date==P}))).length)w.push(P),F.push(0);else{O=e(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){W.e(N)}finally{W.f()}R=[],_=e(y);try{for(I=function(){var t,r=T.value,a=[],n=e(w);try{var i=function(){var e=t.value,n=h.filter((function(t){return t.date==e&&t.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(t=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var s={};s[r]=a,R.push(s)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return t.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return t.prev=19,t.t0=t.catch(0),t.abrupt("return",t.t0);case 22:case"end":return t.stop()}}),t,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(t,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,o,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonarbHourlyService.getAllVerizonArbHourlyStats(t,r,a).toPromise();case 2:i=n.sent,s=e((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(e){e.publisher="No Publisher",e.tagname="No Tag"})),this.tagList));try{for(s.s();!(o=s.n()).done;)if("verizon-direct-arb-hourly"==(c=o.value).tag.advertiser){u=e(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(e){e.subid.includes(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(e){e.subid.startsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(e){e.subid.endsWith(h.subid)&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(e){e.subid==h.subid&&(e.publisher=c.user.length?c.user[0].fullname:"No Publisher",e.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){s.e(p)}finally{s.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,s,o,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonarbHourlyService.getSummaryMetrics(e,t,r).toPromise();case 2:return n=a.sent,i={},s=0,o=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(s=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(o=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=s,n.summary[0].lastMonthStat[0].percentPace=o,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=t,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"getCompanyTags",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.split("/")[1],t.prev=1,t.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(e,t){var r;return e&&(r=e.detailHeight),r}},{key:"getDateRangeList",value:function(e,t){for(var r=[],a=h(e),n=h(t);a<=n;)r.push(h.utc(a).toDate().getTime()),a=h(a).add(1,"hour");return r}}]),t}(),Uu.\u0275fac=function(e){return new(e||Uu)(p.Qb(p.i),p.Qb(g.a),p.Qb(f.a),p.Qb(Hc))},Uu.\u0275cmp=p.Kb({type:Uu,selectors:[["app-verizon-direct-arb-hourly"]],viewQuery:function(e,t){var r;1&e&&p.Tc(Bc,!0),2&e&&p.zc(r=p.ic())&&(t.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(e,t){1&e&&(p.Mc(0,Qc,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(e){return t.updateReportingFiltering(e)})),p.Vb(),p.Mc(2,Gc,1,1,"app-reporting-hourly-revenue-chart",2),p.Mc(3,qc,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(e){return t.groupHandle(e)}))("ngModelChange",(function(e){return t.groupType=e})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(e){return t.onDetailToggle(e)})),p.Mc(21,Zc,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Jc,1,4,"ng-template",17),p.Vb(),p.Mc(24,ru,3,1,"ngx-datatable-column",18),p.Mc(25,iu,3,0,"ngx-datatable-column",19),p.Mc(26,cu,3,1,"ngx-datatable-column",20),p.Mc(27,hu,3,0,"ngx-datatable-column",21),p.Mc(28,bu,3,0,"ngx-datatable-column",22),p.Mc(29,mu,3,0,"ngx-datatable-column",23),p.Mc(30,Du,3,0,"ngx-datatable-column",24),p.Mc(31,Fu,3,0,"ngx-datatable-column",25),p.Mc(32,Mu,3,0,"ngx-datatable-column",26),p.Mc(33,Ou,3,0,"ngx-datatable-column",27),p.Mc(34,Ru,3,0,"ngx-datatable-column",28),p.Mc(35,Iu,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,Nu,1,0,"ng-template",31),p.Mc(38,Lu,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Au,1,0,"ng-template",31),p.Mc(41,ju,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,zu,1,0,"ng-template",31),p.Mc(44,Eu,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Yu,1,0,"ng-template",31),p.Mc(47,Hu,4,6,"ng-template",17),p.Vb(),p.Vb()),2&e&&(p.rc("ngIf",t.loadingIndicator),p.Db(2),p.rc("ngIf",t.chartData&&!t.loadingIndicator),p.Db(1),p.rc("ngIf",t.summaryMetrics&&!t.loadingIndicator),p.Db(6),p.rc("ngModel",t.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",t.rows)("loadingIndicator",t.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===t.groupType||"subid"===t.groupType?t.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!t.groupPublishFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag),p.Db(1),p.rc("ngIf",!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!t.groupPublishFlag&&!t.groupDateShowFlag&&!t.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[o.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,Uc,O,o.o],pipes:[o.f,o.g,o.w,o.d],styles:[""]}),Uu)},{path:"third-party",component:na},{path:"solex-bc",component:Po},{path:"manual-stat-update",component:Is},{path:"manual-split-update",component:Us},{path:"",redirectTo:"",pathMatch:"full"},{path:"**",redirectTo:"",pathMatch:"full"}]}],qu=((Bu=function e(){r(this,e)}).\u0275mod=p.Ob({type:Bu}),Bu.\u0275inj=p.Nb({factory:function(e){return new(e||Bu)},imports:[[c.k.forChild(Gu)],c.k]}),Bu),$u=i("UKGz"),Ku=i("e8Ap"),Xu=((Qu=function e(){r(this,e)}).\u0275mod=p.Ob({type:Qu}),Qu.\u0275inj=p.Nb({factory:function(e){return new(e||Qu)},providers:[o.f,o.w,o.d],imports:[[c.k,o.c,qu,S.g,y.w,y.m,W.d,Ms.e,m.e,D.n,v.b,$u.a,D.q,Rt.c,Ps.c,Ku.b,w.b]]}),Qu)}}])}();