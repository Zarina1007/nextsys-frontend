(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"/X+5":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r("fXoL"),i=r("3Pt+"),o=r("wd/R"),n=r("kmnG"),s=r("iadO"),c=r("ofXK"),l=r("d3UM"),h=r("FKr1");function d(e,t){1&e&&(a.Wb(0,"mat-error"),a.Oc(1,"Invalid start date"),a.Vb())}function b(e,t){1&e&&(a.Wb(0,"mat-error"),a.Oc(1,"Invalid end date"),a.Vb())}function g(e,t){if(1&e&&(a.Wb(0,"mat-option",15),a.Oc(1),a.Vb()),2&e){const e=t.$implicit;a.rc("value",e.value),a.Db(1),a.Qc(" ",e.viewValue," ")}}let u=(()=>{class e{constructor(){this.onDatesPicked=new a.p}ngOnInit(){this.preSetDateRanges=this.getDateRanges(),this.range=new i.j({startDate:new i.g,endDate:new i.g}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate),this.emitSelectedRange()}getDateRanges(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}getPreSetDateRange(e){switch(e){case"today":return{startDate:o().utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:o().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:o().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:o().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:o().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:o().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}onPreSetRangeSelectChange(e){"custom"!==e.value&&(this.preSelectValue=e.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate),this.emitSelectedRange())}updateDatePickerRange(e,t){this.range.patchValue({startDate:o(e,"MM-DD-YYYY").toDate(),endDate:o(t,"MM-DD-YYYY").toDate()})}changeDatePicker(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.preSelectValue="custom",this.emitSelectedRange())}emitSelectedRange(){if(this.range.valid){this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate;let e=this.selectedRange;e.startDate=o(this.selectedRange.startDate).startOf("day").format("MM-DD-YYYY"),e.endDate=o(this.selectedRange.endDate).endOf("day").format("MM-DD-YYYY"),this.onDatesPicked.emit(e)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Kb({type:e,selectors:[["app-reporting-filtering"]],outputs:{onDatesPicked:"onDatesPicked"},decls:24,vars:7,consts:[[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[3,"formGroup","rangePicker","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Wb(2,"div",2),a.Wb(3,"div",3),a.Wb(4,"div",4),a.Wb(5,"h2",5),a.Oc(6,"Filter Date Range"),a.Vb(),a.Vb(),a.Vb(),a.Wb(7,"div",6),a.Wb(8,"mat-form-field"),a.Wb(9,"mat-label"),a.Oc(10,"Enter a custom date range"),a.Vb(),a.Wb(11,"mat-date-range-input",7),a.hc("dateChange",(function(){return t.changeDatePicker()})),a.Rb(12,"input",8),a.Wb(13,"input",9),a.hc("dateChange",(function(){return t.changeDatePicker()})),a.Vb(),a.Vb(),a.Rb(14,"mat-datepicker-toggle",10),a.Rb(15,"mat-date-range-picker",null,11),a.Mc(17,d,2,0,"mat-error",12),a.Mc(18,b,2,0,"mat-error",12),a.Vb(),a.Wb(19,"mat-form-field"),a.Wb(20,"mat-label"),a.Oc(21,"Preset Date Range"),a.Vb(),a.Wb(22,"mat-select",13),a.hc("ngModelChange",(function(e){return t.preSelectValue=e}))("selectionChange",(function(e){return t.onPreSetRangeSelectChange(e)})),a.Mc(23,g,2,2,"mat-option",14),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb()),2&e){const e=a.Ac(16);a.Db(11),a.rc("formGroup",t.range)("rangePicker",e),a.Db(3),a.rc("for",e),a.Db(3),a.rc("ngIf",t.range.controls.startDate.hasError("matStartDateInvalid")),a.Db(1),a.rc("ngIf",t.range.controls.endDate.hasError("matEndDateInvalid")),a.Db(4),a.rc("ngModel",t.preSelectValue),a.Db(1),a.rc("ngForOf",t.preSetDateRanges)}},directives:[n.c,n.g,s.a,i.r,i.k,s.h,i.d,i.q,i.i,i.x,s.g,s.f,n.j,s.b,c.p,l.a,i.t,c.o,n.b,h.p],styles:[""]}),e})()},"4R8J":function(e,t,r){"use strict";r.r(t),r.d(t,"GoogleSheetReportingModule",(function(){return q}));var a=r("ofXK"),i=r("tyNb"),o=r("fXoL"),n=r("aoJj"),s=r("oabR"),c=r("soTd"),l=r("Dvla"),h=r("lDzL"),d=r("e8Ap");function b(e,t){1&e&&o.Oc(0," Sheet Name ")}function g(e,t){1&e&&o.Oc(0),2&e&&o.Qc(" ",t.value," ")}function u(e,t){1&e&&o.Oc(0," Sheet Url ")}function m(e,t){1&e&&o.Oc(0),2&e&&o.Qc(" ",t.value," ")}function p(e,t){1&e&&o.Oc(0,"Action")}function f(e,t){if(1&e){const e=o.Xb();o.Wb(0,"a",15),o.hc("click",(function(){o.Dc(e);const r=t.row;return o.lc(2).editSheet(r._key)})),o.Rb(1,"span",16),o.Vb(),o.Wb(2,"a",17),o.hc("click",(function(){o.Dc(e);const r=t.row;return o.lc(2).deleteSheet(r._key)})),o.Rb(3,"span",18),o.Vb(),o.Wb(4,"a",19),o.hc("click",(function(){o.Dc(e);const r=t.row;return o.lc(2).copyToGoogleSheetAPIClipboard(r)})),o.Rb(5,"span",20),o.Vb()}if(2&e){const e=t.row;o.Db(1),o.rc("inlineSVG","./assets/media/svg/icons/Communication/Write.svg"),o.Db(2),o.rc("inlineSVG","./assets/media/svg/icons/General/Trash.svg"),o.Db(2),o.rc("inlineSVG",e.copy?"./assets/media/svg/icons/General/copied.svg":"./assets/media/svg/icons/General/Clipboard.svg")}}function v(e,t){if(1&e&&(o.Wb(0,"div",2),o.Wb(1,"div",3),o.Wb(2,"div",4),o.Wb(3,"div",5),o.Wb(4,"div",6),o.Wb(5,"h3",7),o.Oc(6,"Google Sheet Reporting"),o.Vb(),o.Vb(),o.Vb(),o.Wb(7,"div",8),o.Wb(8,"ngx-datatable",9),o.Wb(9,"ngx-datatable-column",10),o.Mc(10,b,1,0,"ng-template",11),o.Mc(11,g,1,1,"ng-template",12),o.Vb(),o.Wb(12,"ngx-datatable-column",13),o.Mc(13,u,1,0,"ng-template",11),o.Mc(14,m,1,1,"ng-template",12),o.Vb(),o.Wb(15,"ngx-datatable-column",14),o.Mc(16,p,1,0,"ng-template",11),o.Mc(17,f,6,3,"ng-template",12),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb()),2&e){const e=o.lc();o.Db(8),o.rc("rows",e.rows)("columnMode","force")("loadingIndicator",e.loadingIndicator)("footerHeight",50)("rowHeight",50)("scrollbarH",!0)("headerHeight",50)("limit",10),o.Db(1),o.rc("width",150),o.Db(6),o.rc("width",100)}}function D(e,t){1&e&&(o.Wb(0,"div",21),o.Wb(1,"div",22),o.Wb(2,"p",23),o.Oc(3," How did you get here "),o.Vb(),o.Wb(4,"p",24),o.Oc(5," Sorry you can't access the page you're looking for. "),o.Vb(),o.Wb(6,"p",25),o.Oc(7," There may be a misspelling in the URL entered,"),o.Rb(8,"br"),o.Oc(9,"or the page you are looking for may no longer exist. "),o.Vb(),o.Vb(),o.Vb())}let S=(()=>{class e{constructor(e,t,r,a,i,o){this.googlesheetService=e,this.cdr=t,this.router=r,this.userService=a,this.notification=i,this.clipboardService=o,this.loadingIndicator=!0,this.hidden=!1}ngOnInit(){this.localStorageCompany=this.getSelectedCompanyFromLocalStorage(),this.localStorageCompany?this.hidden=!1:(this.hidden=!0,this.notification.showError("Please select your Company!","")),this.googlesheetService.getSheetList().subscribe(e=>{this.rows=e,this.loadingIndicator=!1,this.cdr.detectChanges()},e=>{this.notification.showError(e.error,"")})}editSheet(e){this.router.navigateByUrl("/google-sheet-reporting/edit/"+e)}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}deleteSheet(e){window.confirm("Do you want to go ahead?")&&this.googlesheetService.deleteSheet(e).subscribe(e=>{this.router.navigate(["/google-sheet-reporting/all-sheets"]).then(()=>{window.location.reload()}),this.notification.showSuccess("Successfully deleted sheet.","")},e=>{console.log(e),this.notification.showError("Error deleting sheet: "+e,"")})}copyToGoogleSheetAPIClipboard(e){const t=e.sheetUrl.split("/")&&e.sheetUrl.split("/")[5]?e.sheetUrl.split("/")[5]:"";e.copy=!0,this.clipboardService.copyFromContent(`http://api.nextsys.io/api/googlesheet/${t}/stats?startDate=MM/DD/YYYY&endDate=MM/DD/YYYY`),setTimeout(()=>{e.copy=!1,this.cdr.detectChanges()},3e3)}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(n.a),o.Qb(o.i),o.Qb(i.h),o.Qb(s.a),o.Qb(c.a),o.Qb(l.b))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-all-sheets"]],decls:2,vars:2,consts:[["class","row",4,"ngIf"],["class","error error-3 d-flex flex-row-fluid bgi-size-cover bgi-position-center","style","background-image: url('./assets/media/error/bg3.jpg'); height: 100%;zoom: 1;\n    display: block;\n    min-height: 80vh;\n    font-size: 14px;\n    line-height: 1.4;\n    color: #0e1724;",4,"ngIf"],[1,"row"],[1,"col-xl-12"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"material","fullscreen",3,"rows","columnMode","loadingIndicator","footerHeight","rowHeight","scrollbarH","headerHeight","limit"],["name","SheetName",3,"width"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["name","SheetUrl"],["name","id",3,"width"],["title","Edit Sheet",1,"btn","btn-icon","btn-light","btn-hover-primary","btn-sm","mx-2",3,"click"],["cacheSVG","true",1,"svg-icon","svg-icon-md","svg-icon-primary",3,"inlineSVG"],["title","Delete Sheet",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm","mx-2",3,"click"],["cacheSVG","false",1,"svg-icon","svg-icon-md","svg-icon-danger",3,"inlineSVG"],["title","COPY GOOGLE SHEET API",1,"btn","btn-icon","btn-light","btn-hover-info","btn-sm","mx-2",3,"click"],["cacheSVG","false",1,"svg-icon","svg-icon-md","svg-icon-info",3,"inlineSVG"],[1,"error","error-3","d-flex","flex-row-fluid","bgi-size-cover","bgi-position-center",2,"background-image","url('./assets/media/error/bg3.jpg')","height","100%","zoom","1","display","block","min-height","80vh","font-size","14px","line-height","1.4","color","#0e1724"],[1,"px-10","px-md-30","py-10","py-md-0","d-flex","flex-column","justify-content-md-center"],[1,"display-4","font-weight-boldest","text-white","mb-12"],[1,"font-size-h1","font-weight-boldest","text-dark-75"],[1,"font-size-h4","line-height-md"]],template:function(e,t){1&e&&(o.Mc(0,v,18,10,"div",0),o.Mc(1,D,10,0,"div",1)),2&e&&(o.rc("ngIf",!t.hidden),o.Db(1),o.rc("ngIf",t.hidden))},directives:[a.p,h.d,h.b,h.c,h.a,d.a],styles:[""]}),e})(),y=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Kb({type:e,selectors:[["app-google-sheet-reporting"]],decls:1,vars:0,template:function(e,t){1&e&&o.Rb(0,"router-outlet")},directives:[i.l],styles:[""]}),e})();var V=r("3Pt+"),w=r("kmnG"),W=r("qFsG"),O=r("bTqV");function x(e,t){1&e&&(o.Wb(0,"mat-error"),o.Oc(1,"Sheet Name is required. "),o.Vb())}function M(e,t){1&e&&(o.Wb(0,"mat-error"),o.Oc(1,"Sheet Url is required. "),o.Vb())}function Y(e,t){if(1&e){const e=o.Xb();o.Wb(0,"form",2),o.hc("submit",(function(){return o.Dc(e),o.lc().submitHandle()})),o.Wb(1,"div",3),o.Wb(2,"div",4),o.Wb(3,"div",3),o.Wb(4,"div",5),o.Wb(5,"div",6),o.Wb(6,"div",7),o.Wb(7,"div",8),o.Wb(8,"h3",9),o.Oc(9,"Create New Google Sheet"),o.Vb(),o.Vb(),o.Vb(),o.Wb(10,"div",10),o.Oc(11),o.mc(12,"json"),o.Wb(13,"div",11),o.Wb(14,"div",12),o.Wb(15,"mat-form-field"),o.Rb(16,"input",13),o.Mc(17,x,2,0,"mat-error",14),o.Vb(),o.Vb(),o.Vb(),o.Wb(18,"div",11),o.Wb(19,"div",12),o.Wb(20,"mat-form-field"),o.Rb(21,"input",15),o.Wb(22,"mat-hint",16),o.Oc(23,"e.g. https://docs.google.com/spreadsheets/d/1taJZ7W-sds54"),o.Vb(),o.Mc(24,M,2,0,"mat-error",14),o.Vb(),o.Vb(),o.Vb(),o.Wb(25,"div",17),o.Wb(26,"div",12),o.Wb(27,"button",18),o.Oc(28,"Save"),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb()}if(2&e){const e=o.lc();o.rc("formGroup",e.sheetFG),o.Db(11),o.Qc(" ",o.nc(12,4,e.sheetFG.value)," "),o.Db(6),o.rc("ngIf",null==e.sheetFG.get("sheetName").errors?null:e.sheetFG.get("sheetName").errors.required),o.Db(7),o.rc("ngIf",null==e.sheetFG.get("sheetUrl").errors?null:e.sheetFG.get("sheetUrl").errors.required)}}function k(e,t){1&e&&(o.Wb(0,"div",19),o.Wb(1,"div",20),o.Wb(2,"p",21),o.Oc(3," How did you get here "),o.Vb(),o.Wb(4,"p",22),o.Oc(5," Sorry you can't access the page you're looking for. "),o.Vb(),o.Wb(6,"p",23),o.Oc(7," There may be a misspelling in the URL entered,"),o.Rb(8,"br"),o.Oc(9,"or the page you are looking for may no longer exist. "),o.Vb(),o.Vb(),o.Vb())}let I=(()=>{class e{constructor(e,t,r,a){this.userService=e,this.googleSheetReportingServie=t,this.router=r,this.notification=a,this.hidden=!1,this.localStorageCompany=this.getSelectedCompanyFromLocalStorage()}ngOnInit(){this.localStorageCompany?this.hidden=!1:(this.hidden=!0,this.notification.showError("Please select your Company!","")),this.sheetFG=new V.j({sheetName:new V.g("",V.z.required),sheetUrl:new V.g("",V.z.required)})}submitHandle(){this.sheetFG.markAllAsTouched(),this.sheetFG.valid&&this.googleSheetReportingServie.addSheet(this.sheetFG.value).subscribe(e=>{this.notification.showSuccess("Successfully added a new Sheet.",""),this.router.navigate(["/google-sheet-reporting/all-sheets"])},e=>{this.notification.showError(JSON.stringify(e.error),"")})}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(s.a),o.Qb(n.a),o.Qb(i.h),o.Qb(c.a))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-new-sheet"]],viewQuery:function(e,t){var r;1&e&&o.Tc(V.k,!0),2&e&&o.zc(r=o.ic())&&(t.formGroupDirective=r.first)},decls:2,vars:2,consts:[["class","example-container",3,"formGroup","submit",4,"ngIf"],["class","error error-3 d-flex flex-row-fluid bgi-size-cover bgi-position-center","style","background-image: url('./assets/media/error/bg3.jpg'); height: 100%;zoom: 1;\n  display: block;\n  min-height: 80vh;\n  font-size: 14px;\n  line-height: 1.4;\n  color: #0e1724;",4,"ngIf"],[1,"example-container",3,"formGroup","submit"],[1,"row"],[1,"col-xl-8"],[1,"col-xl-12"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"row","pb-2","pt-2"],[1,"col-md-12"],["matInput","","formControlName","sheetName","placeholder","Sheet Name"],[4,"ngIf"],["matInput","","formControlName","sheetUrl","placeholder","Sheet Url","type","url"],["align","start"],[1,"row","pt-2"],["mat-raised-button","","color","primary","type","submit",1,"save-button"],[1,"error","error-3","d-flex","flex-row-fluid","bgi-size-cover","bgi-position-center",2,"background-image","url('./assets/media/error/bg3.jpg')","height","100%","zoom","1","display","block","min-height","80vh","font-size","14px","line-height","1.4","color","#0e1724"],[1,"px-10","px-md-30","py-10","py-md-0","d-flex","flex-column","justify-content-md-center"],[1,"display-4","font-weight-boldest","text-white","mb-12"],[1,"font-size-h1","font-weight-boldest","text-dark-75"],[1,"font-size-h4","line-height-md"]],template:function(e,t){1&e&&(o.Mc(0,Y,29,6,"form",0),o.Mc(1,k,10,0,"div",1)),2&e&&(o.rc("ngIf",!t.hidden),o.Db(1),o.rc("ngIf",t.hidden))},directives:[a.p,V.B,V.r,V.k,w.c,W.b,V.d,V.q,V.i,w.f,O.b,w.b],pipes:[a.j],styles:[""]}),e})();function G(e,t){1&e&&(o.Wb(0,"mat-error"),o.Oc(1,"Sheet Name is required. "),o.Vb())}function R(e,t){1&e&&(o.Wb(0,"mat-error"),o.Oc(1,"Sheet Url is required. "),o.Vb())}function C(e,t){if(1&e){const e=o.Xb();o.Wb(0,"form",2),o.hc("submit",(function(){return o.Dc(e),o.lc().submitHandle()})),o.Wb(1,"div",3),o.Wb(2,"div",4),o.Wb(3,"div",3),o.Wb(4,"div",5),o.Wb(5,"div",6),o.Wb(6,"div",7),o.Wb(7,"div",8),o.Wb(8,"h3",9),o.Oc(9,"Edit Google Sheet"),o.Vb(),o.Vb(),o.Vb(),o.Wb(10,"div",10),o.Oc(11),o.mc(12,"json"),o.Wb(13,"div",11),o.Wb(14,"div",12),o.Wb(15,"mat-form-field"),o.Rb(16,"input",13),o.Mc(17,G,2,0,"mat-error",14),o.Vb(),o.Vb(),o.Vb(),o.Wb(18,"div",11),o.Wb(19,"div",12),o.Wb(20,"mat-form-field"),o.Rb(21,"input",15),o.Wb(22,"mat-hint",16),o.Oc(23,"e.g. https://docs.google.com/spreadsheets/d/1taJZ7W-sds54"),o.Vb(),o.Mc(24,R,2,0,"mat-error",14),o.Vb(),o.Vb(),o.Vb(),o.Wb(25,"div",17),o.Wb(26,"div",12),o.Wb(27,"button",18),o.Oc(28,"Save"),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb()}if(2&e){const e=o.lc();o.rc("formGroup",e.editSheetFG),o.Db(11),o.Qc(" ",o.nc(12,4,e.editSheetFG.value)," "),o.Db(6),o.rc("ngIf",null==e.editSheetFG.get("sheetName").errors?null:e.editSheetFG.get("sheetName").errors.required),o.Db(7),o.rc("ngIf",null==e.editSheetFG.get("sheetUrl").errors?null:e.editSheetFG.get("sheetUrl").errors.required)}}function F(e,t){1&e&&(o.Wb(0,"div",19),o.Wb(1,"div",20),o.Wb(2,"p",21),o.Oc(3," How did you get here "),o.Vb(),o.Wb(4,"p",22),o.Oc(5," Sorry you can't access the page you're looking for. "),o.Vb(),o.Wb(6,"p",23),o.Oc(7," There may be a misspelling in the URL entered,"),o.Rb(8,"br"),o.Oc(9,"or the page you are looking for may no longer exist. "),o.Vb(),o.Vb(),o.Vb())}let z=(()=>{class e{constructor(e,t,r,a,i,o){this.cdr=e,this.router=t,this.route=r,this.userService=a,this.notification=i,this.googleSheetReportingServie=o,this.hidden=!1,this.localStorageCompany=this.getSelectedCompanyFromLocalStorage()}ngOnInit(){this.localStorageCompany?this.hidden=!1:(this.hidden=!0,this.notification.showError("Please select your Company!","")),this.editSheetFG=new V.j({sheetName:new V.g("",V.z.required),sheetUrl:new V.g("",V.z.required)}),this.route.snapshot.params.id&&this.googleSheetReportingServie.getOneSheet(this.route.snapshot.params.id).subscribe(e=>{this.sheet=e,this.editSheetFG.setValue({sheetName:e.sheetName,sheetUrl:e.sheetUrl})})}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}submitHandle(){this.editSheetFG.markAllAsTouched(),this.editSheetFG.valid&&(this.sheet=Object.assign(Object.assign({},this.sheet),this.editSheetFG.value),this.googleSheetReportingServie.updateSheet(this.sheet).subscribe(e=>{this.notification.showSuccess("Successfully updated the Sheet.","")},e=>{this.notification.showError("Error updating sheet: "+e.statusText,"")}))}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(o.i),o.Qb(i.h),o.Qb(i.a),o.Qb(s.a),o.Qb(c.a),o.Qb(n.a))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-edit-sheet"]],viewQuery:function(e,t){var r;1&e&&o.Tc(V.k,!0),2&e&&o.zc(r=o.ic())&&(t.formGroupDirective=r.first)},decls:2,vars:2,consts:[["class","example-container",3,"formGroup","submit",4,"ngIf"],["class","error error-3 d-flex flex-row-fluid bgi-size-cover bgi-position-center","style","background-image: url('./assets/media/error/bg3.jpg'); height: 100%;zoom: 1;\n  display: block;\n  min-height: 80vh;\n  font-size: 14px;\n  line-height: 1.4;\n  color: #0e1724;",4,"ngIf"],[1,"example-container",3,"formGroup","submit"],[1,"row"],[1,"col-xl-8"],[1,"col-xl-12"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"row","pb-2","pt-2"],[1,"col-md-12"],["matInput","","formControlName","sheetName","placeholder","Sheet Name"],[4,"ngIf"],["matInput","","formControlName","sheetUrl","placeholder","Sheet Url","type","url"],["align","start"],[1,"row","pt-2"],["mat-raised-button","","color","primary","type","submit",1,"save-button"],[1,"error","error-3","d-flex","flex-row-fluid","bgi-size-cover","bgi-position-center",2,"background-image","url('./assets/media/error/bg3.jpg')","height","100%","zoom","1","display","block","min-height","80vh","font-size","14px","line-height","1.4","color","#0e1724"],[1,"px-10","px-md-30","py-10","py-md-0","d-flex","flex-column","justify-content-md-center"],[1,"display-4","font-weight-boldest","text-white","mb-12"],[1,"font-size-h1","font-weight-boldest","text-dark-75"],[1,"font-size-h4","line-height-md"]],template:function(e,t){1&e&&(o.Mc(0,C,29,6,"form",0),o.Mc(1,F,10,0,"div",1)),2&e&&(o.rc("ngIf",!t.hidden),o.Db(1),o.rc("ngIf",t.hidden))},directives:[a.p,V.B,V.r,V.k,w.c,W.b,V.d,V.q,V.i,w.f,O.b,w.b],pipes:[a.j],styles:[""]}),e})();var P=r("mrSG"),N=r("/X+5");const j=["expandableTable"],Q=[{path:"",component:y,children:[{path:"all-sheets",component:S},{path:"new-sheet",component:I},{path:"edit/:id",component:z,pathMatch:"full"},{path:"sheet/:sheetId",component:(()=>{class e{constructor(e,t,r,a,i){this.route=e,this.userService=t,this.cdr=r,this.googleSheetReportingService=a,this.notification=i,this.loadingIndicator=!0,this.sheetData=[],this.range={startDate:"",endDate:""},this.rows=[],this.columns=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(P.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.route.params.subscribe(e=>Object(P.a)(this,void 0,void 0,(function*(){this.googlesheetId=e.sheetId,this.sheetData=[],this.sheetData=yield this.getSheetInformation(this.googlesheetId,this.range.startDate,this.range.endDate),this.columns=this.sheetData.length>0?Object.keys(this.sheetData[0]).map(e=>({prop:e})):[],this.cdr.markForCheck()})))}))}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}sheetFiltering(e){return Object(P.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=e,this.sheetData=[],this.route.params.subscribe(e=>Object(P.a)(this,void 0,void 0,(function*(){this.sheetData=[],this.sheetData=yield this.getSheetInformation(e.sheetId,this.range.startDate,this.range.endDate),this.columns=this.sheetData.length>0?Object.keys(this.sheetData[0]).map(e=>({prop:e})):[],this.loadingIndicator=!1,this.cdr.detectChanges()})))}))}getSheetInformation(e,t,r){return this.loadingIndicator=!0,this.googleSheetReportingService.getSheetData(e,t,r).toPromise().then(e=>(this.loadingIndicator=!1,e)).catch(e=>e)}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(i.a),o.Qb(s.a),o.Qb(o.i),o.Qb(n.a),o.Qb(c.a))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-sheet"]],viewQuery:function(e,t){var r;1&e&&o.Tc(j,!0),2&e&&o.zc(r=o.ic())&&(t.table=r.first)},decls:2,vars:9,consts:[[3,"onDatesPicked"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"loadingIndicator","rows","columns","columnMode","headerHeight","footerHeight","scrollbarV","scrollbarH","rowHeight"]],template:function(e,t){1&e&&(o.Wb(0,"app-reporting-filtering",0),o.hc("onDatesPicked",(function(e){return t.sheetFiltering(e)})),o.Vb(),o.Rb(1,"ngx-datatable",1)),2&e&&(o.Db(1),o.rc("loadingIndicator",t.loadingIndicator)("rows",t.sheetData)("columns",t.columns)("columnMode","force")("headerHeight",50)("footerHeight",0)("scrollbarV",!0)("scrollbarH",!0)("rowHeight",50))},directives:[N.a,h.d],styles:[""]}),e})(),pathMatch:"full"},{path:"",redirectTo:"",pathMatch:"full"},{path:"**",redirectTo:"",pathMatch:"full"}]}];let U=(()=>{class e{}return e.\u0275mod=o.Ob({type:e}),e.\u0275inj=o.Nb({factory:function(t){return new(t||e)},imports:[[i.k.forChild(Q)],i.k]}),e})();var H=r("NFeN"),L=r("iadO"),T=r("UKGz");let q=(()=>{class e{}return e.\u0275mod=o.Ob({type:e}),e.\u0275inj=o.Nb({factory:function(t){return new(t||e)},imports:[[a.c,U,V.m,V.w,w.e,W.c,O.c,L.e,H.b,h.g,T.a,d.b.forRoot()]]}),e})()},UKGz:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var a=r("ofXK"),i=r("3Pt+"),o=r("d3UM"),n=r("FKr1"),s=r("iadO"),c=r("MutI"),l=r("kmnG"),h=r("e8Ap"),d=r("fXoL");let b=(()=>{class e{}return e.\u0275mod=d.Ob({type:e}),e.\u0275inj=d.Nb({factory:function(t){return new(t||e)},imports:[[a.c,i.w,i.m,l.e,n.n,o.b,n.q,s.e,c.d,h.b]]}),e})()}}]);