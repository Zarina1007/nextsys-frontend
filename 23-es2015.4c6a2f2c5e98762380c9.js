(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{LvDl:function(t,e,r){(function(t){var a;(function(){var n="Expected a function",i="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",c="[object Array]",l="[object Boolean]",u="[object Date]",h="[object Error]",g="[object Function]",p="[object GeneratorFunction]",b="[object Map]",d="[object Number]",f="[object Object]",m="[object RegExp]",v="[object Set]",y="[object String]",D="[object Symbol]",S="[object WeakMap]",F="[object ArrayBuffer]",w="[object DataView]",M="[object Float32Array]",W="[object Float64Array]",P="[object Int8Array]",V="[object Int16Array]",O="[object Int32Array]",C="[object Uint8Array]",x="[object Uint16Array]",_="[object Uint32Array]",T=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g,I=/&(?:amp|lt|gt|quot|#39);/g,N=/[&<>"']/g,L=RegExp(I.source),j=RegExp(N.source),A=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,E=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H=/^\w*$/,U=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,B=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(B.source),G=/^\s+/,q=/\s/,$=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,X=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,J=/[()=,{}\[\]\/\s]/,tt=/\\(\\)?/g,et=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,at=/^[-+]0x[0-9a-f]+$/i,nt=/^0b[01]+$/i,it=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,ot=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,ut=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",gt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="["+gt+"]",bt="["+ht+"]",dt="\\d+",ft="[a-z\\xdf-\\xf6\\xf8-\\xff]",mt="[^\\ud800-\\udfff"+gt+dt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",vt="\\ud83c[\\udffb-\\udfff]",yt="[^\\ud800-\\udfff]",Dt="(?:\\ud83c[\\udde6-\\uddff]){2}",St="[\\ud800-\\udbff][\\udc00-\\udfff]",Ft="[A-Z\\xc0-\\xd6\\xd8-\\xde]",wt="(?:"+ft+"|"+mt+")",Mt="(?:"+Ft+"|"+mt+")",Wt="(?:"+bt+"|"+vt+")?",Pt="[\\ufe0e\\ufe0f]?"+Wt+"(?:\\u200d(?:"+[yt,Dt,St].join("|")+")[\\ufe0e\\ufe0f]?"+Wt+")*",Vt="(?:"+["[\\u2700-\\u27bf]",Dt,St].join("|")+")"+Pt,Ot="(?:"+[yt+bt+"?",bt,Dt,St,"[\\ud800-\\udfff]"].join("|")+")",Ct=RegExp("['\u2019]","g"),xt=RegExp(bt,"g"),_t=RegExp(vt+"(?="+vt+")|"+Ot+Pt,"g"),Tt=RegExp([Ft+"?"+ft+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[pt,Ft,"$"].join("|")+")",Mt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[pt,Ft+wt,"$"].join("|")+")",Ft+"?"+wt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ft+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",dt,Vt].join("|"),"g"),Rt=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),kt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,It=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Nt=-1,Lt={};Lt[M]=Lt[W]=Lt[P]=Lt[V]=Lt[O]=Lt[C]=Lt["[object Uint8ClampedArray]"]=Lt[x]=Lt[_]=!0,Lt[o]=Lt[c]=Lt[F]=Lt[l]=Lt[w]=Lt[u]=Lt[h]=Lt[g]=Lt[b]=Lt[d]=Lt[f]=Lt[m]=Lt[v]=Lt[y]=Lt[S]=!1;var jt={};jt[o]=jt[c]=jt[F]=jt[w]=jt[l]=jt[u]=jt[M]=jt[W]=jt[P]=jt[V]=jt[O]=jt[b]=jt[d]=jt[f]=jt[m]=jt[v]=jt[y]=jt[D]=jt[C]=jt["[object Uint8ClampedArray]"]=jt[x]=jt[_]=!0,jt[h]=jt[g]=jt[S]=!1;var At={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zt=parseFloat,Et=parseInt,Yt="object"==typeof global&&global&&global.Object===Object&&global,Ht="object"==typeof self&&self&&self.Object===Object&&self,Ut=Yt||Ht||Function("return this")(),Bt=e&&!e.nodeType&&e,Qt=Bt&&"object"==typeof t&&t&&!t.nodeType&&t,Gt=Qt&&Qt.exports===Bt,qt=Gt&&Yt.process,$t=function(){try{return Qt&&Qt.require&&Qt.require("util").types||qt&&qt.binding&&qt.binding("util")}catch(t){}}(),Kt=$t&&$t.isArrayBuffer,Xt=$t&&$t.isDate,Zt=$t&&$t.isMap,Jt=$t&&$t.isRegExp,te=$t&&$t.isSet,ee=$t&&$t.isTypedArray;function re(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function ae(t,e,r,a){for(var n=-1,i=null==t?0:t.length;++n<i;){var s=t[n];e(a,s,r(s),t)}return a}function ne(t,e){for(var r=-1,a=null==t?0:t.length;++r<a&&!1!==e(t[r],r,t););return t}function ie(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function se(t,e){for(var r=-1,a=null==t?0:t.length;++r<a;)if(!e(t[r],r,t))return!1;return!0}function oe(t,e){for(var r=-1,a=null==t?0:t.length,n=0,i=[];++r<a;){var s=t[r];e(s,r,t)&&(i[n++]=s)}return i}function ce(t,e){return!(null==t||!t.length)&&ve(t,e,0)>-1}function le(t,e,r){for(var a=-1,n=null==t?0:t.length;++a<n;)if(r(e,t[a]))return!0;return!1}function ue(t,e){for(var r=-1,a=null==t?0:t.length,n=Array(a);++r<a;)n[r]=e(t[r],r,t);return n}function he(t,e){for(var r=-1,a=e.length,n=t.length;++r<a;)t[n+r]=e[r];return t}function ge(t,e,r,a){var n=-1,i=null==t?0:t.length;for(a&&i&&(r=t[++n]);++n<i;)r=e(r,t[n],n,t);return r}function pe(t,e,r,a){var n=null==t?0:t.length;for(a&&n&&(r=t[--n]);n--;)r=e(r,t[n],n,t);return r}function be(t,e){for(var r=-1,a=null==t?0:t.length;++r<a;)if(e(t[r],r,t))return!0;return!1}var de=Fe("length");function fe(t,e,r){var a;return r(t,(function(t,r,n){if(e(t,r,n))return a=r,!1})),a}function me(t,e,r,a){for(var n=t.length,i=r+(a?1:-1);a?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function ve(t,e,r){return e==e?function(t,e,r){for(var a=r-1,n=t.length;++a<n;)if(t[a]===e)return a;return-1}(t,e,r):me(t,De,r)}function ye(t,e,r,a){for(var n=r-1,i=t.length;++n<i;)if(a(t[n],e))return n;return-1}function De(t){return t!=t}function Se(t,e){var r=null==t?0:t.length;return r?We(t,e)/r:NaN}function Fe(t){return function(e){return null==e?void 0:e[t]}}function we(t){return function(e){return null==t?void 0:t[e]}}function Me(t,e,r,a,n){return n(t,(function(t,n,i){r=a?(a=!1,t):e(r,t,n,i)})),r}function We(t,e){for(var r,a=-1,n=t.length;++a<n;){var i=e(t[a]);void 0!==i&&(r=void 0===r?i:r+i)}return r}function Pe(t,e){for(var r=-1,a=Array(t);++r<t;)a[r]=e(r);return a}function Ve(t){return t?t.slice(0,Be(t)+1).replace(G,""):t}function Oe(t){return function(e){return t(e)}}function Ce(t,e){return ue(e,(function(e){return t[e]}))}function xe(t,e){return t.has(e)}function _e(t,e){for(var r=-1,a=t.length;++r<a&&ve(e,t[r],0)>-1;);return r}function Te(t,e){for(var r=t.length;r--&&ve(e,t[r],0)>-1;);return r}function Re(t,e){for(var r=t.length,a=0;r--;)t[r]===e&&++a;return a}var ke=we({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Ie=we({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ne(t){return"\\"+At[t]}function Le(t){return Rt.test(t)}function je(t){var e=-1,r=Array(t.size);return t.forEach((function(t,a){r[++e]=[a,t]})),r}function Ae(t,e){return function(r){return t(e(r))}}function ze(t,e){for(var r=-1,a=t.length,n=0,s=[];++r<a;){var o=t[r];o!==e&&o!==i||(t[r]=i,s[n++]=r)}return s}function Ee(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function Ye(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=[t,t]})),r}function He(t){return Le(t)?function(t){for(var e=_t.lastIndex=0;_t.test(t);)++e;return e}(t):de(t)}function Ue(t){return Le(t)?function(t){return t.match(_t)||[]}(t):function(t){return t.split("")}(t)}function Be(t){for(var e=t.length;e--&&q.test(t.charAt(e)););return e}var Qe=we({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ge=function t(e){var r,a=(e=null==e?Ut:Ge.defaults(Ut.Object(),e,Ge.pick(Ut,It))).Array,q=e.Date,ht=e.Error,gt=e.Function,pt=e.Math,bt=e.Object,dt=e.RegExp,ft=e.String,mt=e.TypeError,vt=a.prototype,yt=bt.prototype,Dt=e["__core-js_shared__"],St=gt.prototype.toString,Ft=yt.hasOwnProperty,wt=0,Mt=(r=/[^.]+$/.exec(Dt&&Dt.keys&&Dt.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",Wt=yt.toString,Pt=St.call(bt),Vt=Ut._,Ot=dt("^"+St.call(Ft).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_t=Gt?e.Buffer:void 0,Rt=e.Symbol,At=e.Uint8Array,Yt=_t?_t.allocUnsafe:void 0,Ht=Ae(bt.getPrototypeOf,bt),Bt=bt.create,Qt=yt.propertyIsEnumerable,qt=vt.splice,$t=Rt?Rt.isConcatSpreadable:void 0,de=Rt?Rt.iterator:void 0,we=Rt?Rt.toStringTag:void 0,qe=function(){try{var t=Zn(bt,"defineProperty");return t({},"",{}),t}catch(e){}}(),$e=e.clearTimeout!==Ut.clearTimeout&&e.clearTimeout,Ke=q&&q.now!==Ut.Date.now&&q.now,Xe=e.setTimeout!==Ut.setTimeout&&e.setTimeout,Ze=pt.ceil,Je=pt.floor,tr=bt.getOwnPropertySymbols,er=_t?_t.isBuffer:void 0,rr=e.isFinite,ar=vt.join,nr=Ae(bt.keys,bt),ir=pt.max,sr=pt.min,or=q.now,cr=e.parseInt,lr=pt.random,ur=vt.reverse,hr=Zn(e,"DataView"),gr=Zn(e,"Map"),pr=Zn(e,"Promise"),br=Zn(e,"Set"),dr=Zn(e,"WeakMap"),fr=Zn(bt,"create"),mr=dr&&new dr,vr={},yr=Vi(hr),Dr=Vi(gr),Sr=Vi(pr),Fr=Vi(br),wr=Vi(dr),Mr=Rt?Rt.prototype:void 0,Wr=Mr?Mr.valueOf:void 0,Pr=Mr?Mr.toString:void 0;function Vr(t){if(Us(t)&&!Rs(t)&&!(t instanceof _r)){if(t instanceof xr)return t;if(Ft.call(t,"__wrapped__"))return Oi(t)}return new xr(t)}var Or=function(){function t(){}return function(e){if(!Hs(e))return{};if(Bt)return Bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function Cr(){}function xr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function _r(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Tr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function Rr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function kr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function Ir(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new kr;++e<r;)this.add(t[e])}function Nr(t){var e=this.__data__=new Rr(t);this.size=e.size}function Lr(t,e){var r=Rs(t),a=!r&&Ts(t),n=!r&&!a&&Ls(t),i=!r&&!a&&!n&&Zs(t),s=r||a||n||i,o=s?Pe(t.length,ft):[],c=o.length;for(var l in t)!e&&!Ft.call(t,l)||s&&("length"==l||n&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ii(l,c))||o.push(l);return o}function jr(t){var e=t.length;return e?t[ka(0,e-1)]:void 0}function Ar(t,e){return Fi(fn(t),qr(e,0,t.length))}function zr(t){return Fi(fn(t))}function Er(t,e,r){(void 0!==r&&!Cs(t[e],r)||void 0===r&&!(e in t))&&Qr(t,e,r)}function Yr(t,e,r){var a=t[e];Ft.call(t,e)&&Cs(a,r)&&(void 0!==r||e in t)||Qr(t,e,r)}function Hr(t,e){for(var r=t.length;r--;)if(Cs(t[r][0],e))return r;return-1}function Ur(t,e,r,a){return Jr(t,(function(t,n,i){e(a,t,r(t),i)})),a}function Br(t,e){return t&&mn(e,So(e),t)}function Qr(t,e,r){"__proto__"==e&&qe?qe(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Gr(t,e){for(var r=-1,n=e.length,i=a(n),s=null==t;++r<n;)i[r]=s?void 0:fo(t,e[r]);return i}function qr(t,e,r){return t==t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t}function $r(t,e,r,a,n,i){var s,c=1&e,h=2&e,S=4&e;if(r&&(s=n?r(t,a,n,i):r(t)),void 0!==s)return s;if(!Hs(t))return t;var T=Rs(t);if(T){if(s=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Ft.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return fn(t,s)}else{var R=ei(t),k=R==g||R==p;if(Ls(t))return un(t,c);if(R==f||R==o||k&&!n){if(s=h||k?{}:ai(t),!c)return h?function(t,e){return mn(t,ti(t),e)}(t,function(t,e){return t&&mn(e,Fo(e),t)}(s,t)):function(t,e){return mn(t,Jn(t),e)}(t,Br(s,t))}else{if(!jt[R])return n?t:{};s=function(t,e,r){var a=t.constructor;switch(e){case F:return hn(t);case l:case u:return new a(+t);case w:return function(t,e){var r=e?hn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case M:case W:case P:case V:case O:case C:case"[object Uint8ClampedArray]":case x:case _:return gn(t,r);case b:return new a;case d:case y:return new a(t);case m:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return new a;case D:return Wr?bt(Wr.call(t)):{}}}(t,R,c)}}i||(i=new Nr);var I=i.get(t);if(I)return I;i.set(t,s),$s(t)?t.forEach((function(a){s.add($r(a,e,r,a,t,i))})):Bs(t)&&t.forEach((function(a,n){s.set(n,$r(a,e,r,n,t,i))}));var N=T?void 0:(S?h?Bn:Un:h?Fo:So)(t);return ne(N||t,(function(a,n){N&&(a=t[n=a]),Yr(s,n,$r(a,e,r,n,t,i))})),s}function Kr(t,e,r){var a=r.length;if(null==t)return!a;for(t=bt(t);a--;){var n=r[a],i=t[n];if(void 0===i&&!(n in t)||!(0,e[n])(i))return!1}return!0}function Xr(t,e,r){if("function"!=typeof t)throw new mt(n);return vi((function(){t.apply(void 0,r)}),e)}function Zr(t,e,r,a){var n=-1,i=ce,s=!0,o=t.length,c=[],l=e.length;if(!o)return c;r&&(e=ue(e,Oe(r))),a?(i=le,s=!1):e.length>=200&&(i=xe,s=!1,e=new Ir(e));t:for(;++n<o;){var u=t[n],h=null==r?u:r(u);if(u=a||0!==u?u:0,s&&h==h){for(var g=l;g--;)if(e[g]===h)continue t;c.push(u)}else i(e,h,a)||c.push(u)}return c}Vr.templateSettings={escape:A,evaluate:z,interpolate:E,variable:"",imports:{_:Vr}},(Vr.prototype=Cr.prototype).constructor=Vr,(xr.prototype=Or(Cr.prototype)).constructor=xr,(_r.prototype=Or(Cr.prototype)).constructor=_r,Tr.prototype.clear=function(){this.__data__=fr?fr(null):{},this.size=0},Tr.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Tr.prototype.get=function(t){var e=this.__data__;if(fr){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Ft.call(e,t)?e[t]:void 0},Tr.prototype.has=function(t){var e=this.__data__;return fr?void 0!==e[t]:Ft.call(e,t)},Tr.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=fr&&void 0===e?"__lodash_hash_undefined__":e,this},Rr.prototype.clear=function(){this.__data__=[],this.size=0},Rr.prototype.delete=function(t){var e=this.__data__,r=Hr(e,t);return!(r<0||(r==e.length-1?e.pop():qt.call(e,r,1),--this.size,0))},Rr.prototype.get=function(t){var e=this.__data__,r=Hr(e,t);return r<0?void 0:e[r][1]},Rr.prototype.has=function(t){return Hr(this.__data__,t)>-1},Rr.prototype.set=function(t,e){var r=this.__data__,a=Hr(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this},kr.prototype.clear=function(){this.size=0,this.__data__={hash:new Tr,map:new(gr||Rr),string:new Tr}},kr.prototype.delete=function(t){var e=Kn(this,t).delete(t);return this.size-=e?1:0,e},kr.prototype.get=function(t){return Kn(this,t).get(t)},kr.prototype.has=function(t){return Kn(this,t).has(t)},kr.prototype.set=function(t,e){var r=Kn(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this},Ir.prototype.add=Ir.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Ir.prototype.has=function(t){return this.__data__.has(t)},Nr.prototype.clear=function(){this.__data__=new Rr,this.size=0},Nr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Nr.prototype.get=function(t){return this.__data__.get(t)},Nr.prototype.has=function(t){return this.__data__.has(t)},Nr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Rr){var a=r.__data__;if(!gr||a.length<199)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new kr(a)}return r.set(t,e),this.size=r.size,this};var Jr=Dn(oa),ta=Dn(ca,!0);function ea(t,e){var r=!0;return Jr(t,(function(t,a,n){return r=!!e(t,a,n)})),r}function ra(t,e,r){for(var a=-1,n=t.length;++a<n;){var i=t[a],s=e(i);if(null!=s&&(void 0===o?s==s&&!Xs(s):r(s,o)))var o=s,c=i}return c}function aa(t,e){var r=[];return Jr(t,(function(t,a,n){e(t,a,n)&&r.push(t)})),r}function na(t,e,r,a,n){var i=-1,s=t.length;for(r||(r=ni),n||(n=[]);++i<s;){var o=t[i];e>0&&r(o)?e>1?na(o,e-1,r,a,n):he(n,o):a||(n[n.length]=o)}return n}var ia=Sn(),sa=Sn(!0);function oa(t,e){return t&&ia(t,e,So)}function ca(t,e){return t&&sa(t,e,So)}function la(t,e){return oe(e,(function(e){return zs(t[e])}))}function ua(t,e){for(var r=0,a=(e=sn(e,t)).length;null!=t&&r<a;)t=t[Pi(e[r++])];return r&&r==a?t:void 0}function ha(t,e,r){var a=e(t);return Rs(t)?a:he(a,r(t))}function ga(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":we&&we in bt(t)?function(t){var e=Ft.call(t,we),r=t[we];try{t[we]=void 0;var a=!0}catch(i){}var n=Wt.call(t);return a&&(e?t[we]=r:delete t[we]),n}(t):function(t){return Wt.call(t)}(t)}function pa(t,e){return t>e}function ba(t,e){return null!=t&&Ft.call(t,e)}function da(t,e){return null!=t&&e in bt(t)}function fa(t,e,r){for(var n=r?le:ce,i=t[0].length,s=t.length,o=s,c=a(s),l=1/0,u=[];o--;){var h=t[o];o&&e&&(h=ue(h,Oe(e))),l=sr(h.length,l),c[o]=!r&&(e||i>=120&&h.length>=120)?new Ir(o&&h):void 0}h=t[0];var g=-1,p=c[0];t:for(;++g<i&&u.length<l;){var b=h[g],d=e?e(b):b;if(b=r||0!==b?b:0,!(p?xe(p,d):n(u,d,r))){for(o=s;--o;){var f=c[o];if(!(f?xe(f,d):n(t[o],d,r)))continue t}p&&p.push(d),u.push(b)}}return u}function ma(t,e,r){var a=null==(t=bi(t,e=sn(e,t)))?t:t[Pi(Ai(e))];return null==a?void 0:re(a,t,r)}function va(t){return Us(t)&&ga(t)==o}function ya(t,e,r,a,n){return t===e||(null==t||null==e||!Us(t)&&!Us(e)?t!=t&&e!=e:function(t,e,r,a,n,i){var s=Rs(t),g=Rs(e),p=s?c:ei(t),S=g?c:ei(e),M=(p=p==o?f:p)==f,W=(S=S==o?f:S)==f,P=p==S;if(P&&Ls(t)){if(!Ls(e))return!1;s=!0,M=!1}if(P&&!M)return i||(i=new Nr),s||Zs(t)?Yn(t,e,r,a,n,i):function(t,e,r,a,n,i,s){switch(r){case w:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case F:return!(t.byteLength!=e.byteLength||!i(new At(t),new At(e)));case l:case u:case d:return Cs(+t,+e);case h:return t.name==e.name&&t.message==e.message;case m:case y:return t==e+"";case b:var o=je;case v:if(o||(o=Ee),t.size!=e.size&&!(1&a))return!1;var c=s.get(t);if(c)return c==e;a|=2,s.set(t,e);var g=Yn(o(t),o(e),a,n,i,s);return s.delete(t),g;case D:if(Wr)return Wr.call(t)==Wr.call(e)}return!1}(t,e,p,r,a,n,i);if(!(1&r)){var V=M&&Ft.call(t,"__wrapped__"),O=W&&Ft.call(e,"__wrapped__");if(V||O){var C=V?t.value():t,x=O?e.value():e;return i||(i=new Nr),n(C,x,r,a,i)}}return!!P&&(i||(i=new Nr),function(t,e,r,a,n,i){var s=1&r,o=Un(t),c=o.length;if(c!=Un(e).length&&!s)return!1;for(var l=c;l--;){var u=o[l];if(!(s?u in e:Ft.call(e,u)))return!1}var h=i.get(t),g=i.get(e);if(h&&g)return h==e&&g==t;var p=!0;i.set(t,e),i.set(e,t);for(var b=s;++l<c;){var d=t[u=o[l]],f=e[u];if(a)var m=s?a(f,d,u,e,t,i):a(d,f,u,t,e,i);if(!(void 0===m?d===f||n(d,f,r,a,i):m)){p=!1;break}b||(b="constructor"==u)}if(p&&!b){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,r,a,n,i))}(t,e,r,a,ya,n))}function Da(t,e,r,a){var n=r.length,i=n,s=!a;if(null==t)return!i;for(t=bt(t);n--;){var o=r[n];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<i;){var c=(o=r[n])[0],l=t[c],u=o[1];if(s&&o[2]){if(void 0===l&&!(c in t))return!1}else{var h=new Nr;if(a)var g=a(l,u,c,t,e,h);if(!(void 0===g?ya(u,l,3,a,h):g))return!1}}return!0}function Sa(t){return!(!Hs(t)||(e=t,Mt&&Mt in e))&&(zs(t)?Ot:it).test(Vi(t));var e}function Fa(t){return"function"==typeof t?t:null==t?Go:"object"==typeof t?Rs(t)?Va(t[0],t[1]):Pa(t):rc(t)}function wa(t){if(!ui(t))return nr(t);var e=[];for(var r in bt(t))Ft.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Ma(t,e){return t<e}function Wa(t,e){var r=-1,n=Is(t)?a(t.length):[];return Jr(t,(function(t,a,i){n[++r]=e(t,a,i)})),n}function Pa(t){var e=Xn(t);return 1==e.length&&e[0][2]?gi(e[0][0],e[0][1]):function(r){return r===t||Da(r,t,e)}}function Va(t,e){return oi(t)&&hi(e)?gi(Pi(t),e):function(r){var a=fo(r,t);return void 0===a&&a===e?mo(r,t):ya(e,a,3)}}function Oa(t,e,r,a,n){t!==e&&ia(e,(function(i,s){if(n||(n=new Nr),Hs(i))!function(t,e,r,a,n,i,s){var o=fi(t,r),c=fi(e,r),l=s.get(c);if(l)Er(t,r,l);else{var u=i?i(o,c,r+"",t,e,s):void 0,h=void 0===u;if(h){var g=Rs(c),p=!g&&Ls(c),b=!g&&!p&&Zs(c);u=c,g||p||b?Rs(o)?u=o:Ns(o)?u=fn(o):p?(h=!1,u=un(c,!0)):b?(h=!1,u=gn(c,!0)):u=[]:Gs(c)||Ts(c)?(u=o,Ts(o)?u=so(o):Hs(o)&&!zs(o)||(u=ai(c))):h=!1}h&&(s.set(c,u),n(u,c,a,i,s),s.delete(c)),Er(t,r,u)}}(t,e,s,r,Oa,a,n);else{var o=a?a(fi(t,s),i,s+"",t,e,n):void 0;void 0===o&&(o=i),Er(t,s,o)}}),Fo)}function Ca(t,e){var r=t.length;if(r)return ii(e+=e<0?r:0,r)?t[e]:void 0}function xa(t,e,r){e=e.length?ue(e,(function(t){return Rs(t)?function(e){return ua(e,1===t.length?t[0]:t)}:t})):[Go];var a=-1;return e=ue(e,Oe($n())),function(t,e){var a=t.length;for(t.sort((function(t,e){return function(t,e,r){for(var a=-1,n=t.criteria,i=e.criteria,s=n.length,o=r.length;++a<s;){var c=pn(n[a],i[a]);if(c)return a>=o?c:c*("desc"==r[a]?-1:1)}return t.index-e.index}(t,e,r)}));a--;)t[a]=t[a].value;return t}(Wa(t,(function(t,r,n){return{criteria:ue(e,(function(e){return e(t)})),index:++a,value:t}})))}function _a(t,e,r){for(var a=-1,n=e.length,i={};++a<n;){var s=e[a],o=ua(t,s);r(o,s)&&Aa(i,sn(s,t),o)}return i}function Ta(t,e,r,a){var n=a?ye:ve,i=-1,s=e.length,o=t;for(t===e&&(e=fn(e)),r&&(o=ue(t,Oe(r)));++i<s;)for(var c=0,l=e[i],u=r?r(l):l;(c=n(o,u,c,a))>-1;)o!==t&&qt.call(o,c,1),qt.call(t,c,1);return t}function Ra(t,e){for(var r=t?e.length:0,a=r-1;r--;){var n=e[r];if(r==a||n!==i){var i=n;ii(n)?qt.call(t,n,1):Xa(t,n)}}return t}function ka(t,e){return t+Je(lr()*(e-t+1))}function Ia(t,e){var r="";if(!t||e<1||e>9007199254740991)return r;do{e%2&&(r+=t),(e=Je(e/2))&&(t+=t)}while(e);return r}function Na(t,e){return yi(pi(t,e,Go),t+"")}function La(t){return jr(xo(t))}function ja(t,e){var r=xo(t);return Fi(r,qr(e,0,r.length))}function Aa(t,e,r,a){if(!Hs(t))return t;for(var n=-1,i=(e=sn(e,t)).length,s=i-1,o=t;null!=o&&++n<i;){var c=Pi(e[n]),l=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(n!=s){var u=o[c];void 0===(l=a?a(u,c,o):void 0)&&(l=Hs(u)?u:ii(e[n+1])?[]:{})}Yr(o,c,l),o=o[c]}return t}var za=mr?function(t,e){return mr.set(t,e),t}:Go,Ea=qe?function(t,e){return qe(t,"toString",{configurable:!0,enumerable:!1,value:Uo(e),writable:!0})}:Go;function Ya(t){return Fi(xo(t))}function Ha(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=a(i);++n<i;)s[n]=t[n+e];return s}function Ua(t,e){var r;return Jr(t,(function(t,a,n){return!(r=e(t,a,n))})),!!r}function Ba(t,e,r){var a=0,n=null==t?a:t.length;if("number"==typeof e&&e==e&&n<=2147483647){for(;a<n;){var i=a+n>>>1,s=t[i];null!==s&&!Xs(s)&&(r?s<=e:s<e)?a=i+1:n=i}return n}return Qa(t,e,Go,r)}function Qa(t,e,r,a){var n=0,i=null==t?0:t.length;if(0===i)return 0;for(var s=(e=r(e))!=e,o=null===e,c=Xs(e),l=void 0===e;n<i;){var u=Je((n+i)/2),h=r(t[u]),g=void 0!==h,p=null===h,b=h==h,d=Xs(h);if(s)var f=a||b;else f=l?b&&(a||g):o?b&&g&&(a||!p):c?b&&g&&!p&&(a||!d):!p&&!d&&(a?h<=e:h<e);f?n=u+1:i=u}return sr(i,4294967294)}function Ga(t,e){for(var r=-1,a=t.length,n=0,i=[];++r<a;){var s=t[r],o=e?e(s):s;if(!r||!Cs(o,c)){var c=o;i[n++]=0===s?0:s}}return i}function qa(t){return"number"==typeof t?t:Xs(t)?NaN:+t}function $a(t){if("string"==typeof t)return t;if(Rs(t))return ue(t,$a)+"";if(Xs(t))return Pr?Pr.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ka(t,e,r){var a=-1,n=ce,i=t.length,s=!0,o=[],c=o;if(r)s=!1,n=le;else if(i>=200){var l=e?null:Nn(t);if(l)return Ee(l);s=!1,n=xe,c=new Ir}else c=e?[]:o;t:for(;++a<i;){var u=t[a],h=e?e(u):u;if(u=r||0!==u?u:0,s&&h==h){for(var g=c.length;g--;)if(c[g]===h)continue t;e&&c.push(h),o.push(u)}else n(c,h,r)||(c!==o&&c.push(h),o.push(u))}return o}function Xa(t,e){return null==(t=bi(t,e=sn(e,t)))||delete t[Pi(Ai(e))]}function Za(t,e,r,a){return Aa(t,e,r(ua(t,e)),a)}function Ja(t,e,r,a){for(var n=t.length,i=a?n:-1;(a?i--:++i<n)&&e(t[i],i,t););return r?Ha(t,a?0:i,a?i+1:n):Ha(t,a?i+1:0,a?n:i)}function tn(t,e){var r=t;return r instanceof _r&&(r=r.value()),ge(e,(function(t,e){return e.func.apply(e.thisArg,he([t],e.args))}),r)}function en(t,e,r){var n=t.length;if(n<2)return n?Ka(t[0]):[];for(var i=-1,s=a(n);++i<n;)for(var o=t[i],c=-1;++c<n;)c!=i&&(s[i]=Zr(s[i]||o,t[c],e,r));return Ka(na(s,1),e,r)}function rn(t,e,r){for(var a=-1,n=t.length,i=e.length,s={};++a<n;)r(s,t[a],a<i?e[a]:void 0);return s}function an(t){return Ns(t)?t:[]}function nn(t){return"function"==typeof t?t:Go}function sn(t,e){return Rs(t)?t:oi(t,e)?[t]:Wi(oo(t))}var on=Na;function cn(t,e,r){var a=t.length;return r=void 0===r?a:r,!e&&r>=a?t:Ha(t,e,r)}var ln=$e||function(t){return Ut.clearTimeout(t)};function un(t,e){if(e)return t.slice();var r=t.length,a=Yt?Yt(r):new t.constructor(r);return t.copy(a),a}function hn(t){var e=new t.constructor(t.byteLength);return new At(e).set(new At(t)),e}function gn(t,e){var r=e?hn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function pn(t,e){if(t!==e){var r=void 0!==t,a=null===t,n=t==t,i=Xs(t),s=void 0!==e,o=null===e,c=e==e,l=Xs(e);if(!o&&!l&&!i&&t>e||i&&s&&c&&!o&&!l||a&&s&&c||!r&&c||!n)return 1;if(!a&&!i&&!l&&t<e||l&&r&&n&&!a&&!i||o&&r&&n||!s&&n||!c)return-1}return 0}function bn(t,e,r,n){for(var i=-1,s=t.length,o=r.length,c=-1,l=e.length,u=ir(s-o,0),h=a(l+u),g=!n;++c<l;)h[c]=e[c];for(;++i<o;)(g||i<s)&&(h[r[i]]=t[i]);for(;u--;)h[c++]=t[i++];return h}function dn(t,e,r,n){for(var i=-1,s=t.length,o=-1,c=r.length,l=-1,u=e.length,h=ir(s-c,0),g=a(h+u),p=!n;++i<h;)g[i]=t[i];for(var b=i;++l<u;)g[b+l]=e[l];for(;++o<c;)(p||i<s)&&(g[b+r[o]]=t[i++]);return g}function fn(t,e){var r=-1,n=t.length;for(e||(e=a(n));++r<n;)e[r]=t[r];return e}function mn(t,e,r,a){var n=!r;r||(r={});for(var i=-1,s=e.length;++i<s;){var o=e[i],c=a?a(r[o],t[o],o,r,t):void 0;void 0===c&&(c=t[o]),n?Qr(r,o,c):Yr(r,o,c)}return r}function vn(t,e){return function(r,a){var n=Rs(r)?ae:Ur,i=e?e():{};return n(r,t,$n(a,2),i)}}function yn(t){return Na((function(e,r){var a=-1,n=r.length,i=n>1?r[n-1]:void 0,s=n>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(n--,i):void 0,s&&si(r[0],r[1],s)&&(i=n<3?void 0:i,n=1),e=bt(e);++a<n;){var o=r[a];o&&t(e,o,a,i)}return e}))}function Dn(t,e){return function(r,a){if(null==r)return r;if(!Is(r))return t(r,a);for(var n=r.length,i=e?n:-1,s=bt(r);(e?i--:++i<n)&&!1!==a(s[i],i,s););return r}}function Sn(t){return function(e,r,a){for(var n=-1,i=bt(e),s=a(e),o=s.length;o--;){var c=s[t?o:++n];if(!1===r(i[c],c,i))break}return e}}function Fn(t){return function(e){var r=Le(e=oo(e))?Ue(e):void 0,a=r?r[0]:e.charAt(0),n=r?cn(r,1).join(""):e.slice(1);return a[t]()+n}}function wn(t){return function(e){return ge(Eo(Ro(e).replace(Ct,"")),t,"")}}function Mn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Or(t.prototype),a=t.apply(r,e);return Hs(a)?a:r}}function Wn(t){return function(e,r,a){var n=bt(e);if(!Is(e)){var i=$n(r,3);e=So(e),r=function(t){return i(n[t],t,n)}}var s=t(e,r,a);return s>-1?n[i?e[s]:s]:void 0}}function Pn(t){return Hn((function(e){var r=e.length,a=r,i=xr.prototype.thru;for(t&&e.reverse();a--;){var s=e[a];if("function"!=typeof s)throw new mt(n);if(i&&!o&&"wrapper"==Gn(s))var o=new xr([],!0)}for(a=o?a:r;++a<r;){var c=Gn(s=e[a]),l="wrapper"==c?Qn(s):void 0;o=l&&ci(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?o[Gn(l[0])].apply(o,l[3]):1==s.length&&ci(s)?o[c]():o.thru(s)}return function(){var t=arguments,a=t[0];if(o&&1==t.length&&Rs(a))return o.plant(a).value();for(var n=0,i=r?e[n].apply(this,t):a;++n<r;)i=e[n].call(this,i);return i}}))}function Vn(t,e,r,n,i,s,o,c,l,u){var h=128&e,g=1&e,p=2&e,b=24&e,d=512&e,f=p?void 0:Mn(t);return function m(){for(var v=arguments.length,y=a(v),D=v;D--;)y[D]=arguments[D];if(b)var S=qn(m),F=Re(y,S);if(n&&(y=bn(y,n,i,b)),s&&(y=dn(y,s,o,b)),v-=F,b&&v<u){var w=ze(y,S);return kn(t,e,Vn,m.placeholder,r,y,w,c,l,u-v)}var M=g?r:this,W=p?M[t]:t;return v=y.length,c?y=di(y,c):d&&v>1&&y.reverse(),h&&l<v&&(y.length=l),this&&this!==Ut&&this instanceof m&&(W=f||Mn(W)),W.apply(M,y)}}function On(t,e){return function(r,a){return function(t,e,r,a){return oa(t,(function(t,n,i){e(a,r(t),n,i)})),a}(r,t,e(a),{})}}function Cn(t,e){return function(r,a){var n;if(void 0===r&&void 0===a)return e;if(void 0!==r&&(n=r),void 0!==a){if(void 0===n)return a;"string"==typeof r||"string"==typeof a?(r=$a(r),a=$a(a)):(r=qa(r),a=qa(a)),n=t(r,a)}return n}}function xn(t){return Hn((function(e){return e=ue(e,Oe($n())),Na((function(r){var a=this;return t(e,(function(t){return re(t,a,r)}))}))}))}function _n(t,e){var r=(e=void 0===e?" ":$a(e)).length;if(r<2)return r?Ia(e,t):e;var a=Ia(e,Ze(t/He(e)));return Le(e)?cn(Ue(a),0,t).join(""):a.slice(0,t)}function Tn(t){return function(e,r,n){return n&&"number"!=typeof n&&si(e,r,n)&&(r=n=void 0),e=ro(e),void 0===r?(r=e,e=0):r=ro(r),function(t,e,r,n){for(var i=-1,s=ir(Ze((e-t)/(r||1)),0),o=a(s);s--;)o[n?s:++i]=t,t+=r;return o}(e,r,n=void 0===n?e<r?1:-1:ro(n),t)}}function Rn(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=io(e),r=io(r)),t(e,r)}}function kn(t,e,r,a,n,i,s,o,c,l){var u=8&e;e|=u?32:64,4&(e&=~(u?64:32))||(e&=-4);var h=[t,e,n,u?i:void 0,u?s:void 0,u?void 0:i,u?void 0:s,o,c,l],g=r.apply(void 0,h);return ci(t)&&mi(g,h),g.placeholder=a,Di(g,t,e)}function In(t){var e=pt[t];return function(t,r){if(t=io(t),(r=null==r?0:sr(ao(r),292))&&rr(t)){var a=(oo(t)+"e").split("e");return+((a=(oo(e(a[0]+"e"+(+a[1]+r)))+"e").split("e"))[0]+"e"+(+a[1]-r))}return e(t)}}var Nn=br&&1/Ee(new br([,-0]))[1]==1/0?function(t){return new br(t)}:Zo;function Ln(t){return function(e){var r=ei(e);return r==b?je(e):r==v?Ye(e):function(t,e){return ue(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function jn(t,e,r,s,o,c,l,u){var h=2&e;if(!h&&"function"!=typeof t)throw new mt(n);var g=s?s.length:0;if(g||(e&=-97,s=o=void 0),l=void 0===l?l:ir(ao(l),0),u=void 0===u?u:ao(u),g-=o?o.length:0,64&e){var p=s,b=o;s=o=void 0}var d=h?void 0:Qn(t),f=[t,e,r,s,o,p,b,c,l,u];if(d&&function(t,e){var r=t[1],a=e[1],n=r|a;if(!(n<131||128==a&&8==r||128==a&&256==r&&t[7].length<=e[8]||384==a&&e[7].length<=e[8]&&8==r))return t;1&a&&(t[2]=e[2],n|=1&r?0:4);var s=e[3];if(s){var o=t[3];t[3]=o?bn(o,s,e[4]):s,t[4]=o?ze(t[3],i):e[4]}(s=e[5])&&(t[5]=(o=t[5])?dn(o,s,e[6]):s,t[6]=o?ze(t[5],i):e[6]),(s=e[7])&&(t[7]=s),128&a&&(t[8]=null==t[8]?e[8]:sr(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=n}(f,d),t=f[0],e=f[1],r=f[2],s=f[3],o=f[4],!(u=f[9]=void 0===f[9]?h?0:t.length:ir(f[9]-g,0))&&24&e&&(e&=-25),e&&1!=e)m=8==e||16==e?function(t,e,r){var n=Mn(t);return function i(){for(var s=arguments.length,o=a(s),c=s,l=qn(i);c--;)o[c]=arguments[c];var u=s<3&&o[0]!==l&&o[s-1]!==l?[]:ze(o,l);if((s-=u.length)<r)return kn(t,e,Vn,i.placeholder,void 0,o,u,void 0,void 0,r-s);var h=this&&this!==Ut&&this instanceof i?n:t;return re(h,this,o)}}(t,e,u):32!=e&&33!=e||o.length?Vn.apply(void 0,f):function(t,e,r,n){var i=1&e,s=Mn(t);return function e(){for(var o=-1,c=arguments.length,l=-1,u=n.length,h=a(u+c),g=this&&this!==Ut&&this instanceof e?s:t;++l<u;)h[l]=n[l];for(;c--;)h[l++]=arguments[++o];return re(g,i?r:this,h)}}(t,e,r,s);else var m=function(t,e,r){var a=1&e,n=Mn(t);return function e(){var i=this&&this!==Ut&&this instanceof e?n:t;return i.apply(a?r:this,arguments)}}(t,e,r);return Di((d?za:mi)(m,f),t,e)}function An(t,e,r,a){return void 0===t||Cs(t,yt[r])&&!Ft.call(a,r)?e:t}function zn(t,e,r,a,n,i){return Hs(t)&&Hs(e)&&(i.set(e,t),Oa(t,e,void 0,zn,i),i.delete(e)),t}function En(t){return Gs(t)?void 0:t}function Yn(t,e,r,a,n,i){var s=1&r,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var l=i.get(t),u=i.get(e);if(l&&u)return l==e&&u==t;var h=-1,g=!0,p=2&r?new Ir:void 0;for(i.set(t,e),i.set(e,t);++h<o;){var b=t[h],d=e[h];if(a)var f=s?a(d,b,h,e,t,i):a(b,d,h,t,e,i);if(void 0!==f){if(f)continue;g=!1;break}if(p){if(!be(e,(function(t,e){if(!xe(p,e)&&(b===t||n(b,t,r,a,i)))return p.push(e)}))){g=!1;break}}else if(b!==d&&!n(b,d,r,a,i)){g=!1;break}}return i.delete(t),i.delete(e),g}function Hn(t){return yi(pi(t,void 0,ki),t+"")}function Un(t){return ha(t,So,Jn)}function Bn(t){return ha(t,Fo,ti)}var Qn=mr?function(t){return mr.get(t)}:Zo;function Gn(t){for(var e=t.name+"",r=vr[e],a=Ft.call(vr,e)?r.length:0;a--;){var n=r[a],i=n.func;if(null==i||i==t)return n.name}return e}function qn(t){return(Ft.call(Vr,"placeholder")?Vr:t).placeholder}function $n(){var t=Vr.iteratee||qo;return t=t===qo?Fa:t,arguments.length?t(arguments[0],arguments[1]):t}function Kn(t,e){var r,a,n=t.__data__;return("string"==(a=typeof(r=e))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==r:null===r)?n["string"==typeof e?"string":"hash"]:n.map}function Xn(t){for(var e=So(t),r=e.length;r--;){var a=e[r],n=t[a];e[r]=[a,n,hi(n)]}return e}function Zn(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Sa(r)?r:void 0}var Jn=tr?function(t){return null==t?[]:(t=bt(t),oe(tr(t),(function(e){return Qt.call(t,e)})))}:ic,ti=tr?function(t){for(var e=[];t;)he(e,Jn(t)),t=Ht(t);return e}:ic,ei=ga;function ri(t,e,r){for(var a=-1,n=(e=sn(e,t)).length,i=!1;++a<n;){var s=Pi(e[a]);if(!(i=null!=t&&r(t,s)))break;t=t[s]}return i||++a!=n?i:!!(n=null==t?0:t.length)&&Ys(n)&&ii(s,n)&&(Rs(t)||Ts(t))}function ai(t){return"function"!=typeof t.constructor||ui(t)?{}:Or(Ht(t))}function ni(t){return Rs(t)||Ts(t)||!!($t&&t&&t[$t])}function ii(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&ot.test(t))&&t>-1&&t%1==0&&t<e}function si(t,e,r){if(!Hs(r))return!1;var a=typeof e;return!!("number"==a?Is(r)&&ii(e,r.length):"string"==a&&e in r)&&Cs(r[e],t)}function oi(t,e){if(Rs(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Xs(t))||H.test(t)||!Y.test(t)||null!=e&&t in bt(e)}function ci(t){var e=Gn(t),r=Vr[e];if("function"!=typeof r||!(e in _r.prototype))return!1;if(t===r)return!0;var a=Qn(r);return!!a&&t===a[0]}(hr&&ei(new hr(new ArrayBuffer(1)))!=w||gr&&ei(new gr)!=b||pr&&"[object Promise]"!=ei(pr.resolve())||br&&ei(new br)!=v||dr&&ei(new dr)!=S)&&(ei=function(t){var e=ga(t),r=e==f?t.constructor:void 0,a=r?Vi(r):"";if(a)switch(a){case yr:return w;case Dr:return b;case Sr:return"[object Promise]";case Fr:return v;case wr:return S}return e});var li=Dt?zs:sc;function ui(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||yt)}function hi(t){return t==t&&!Hs(t)}function gi(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in bt(r))}}function pi(t,e,r){return e=ir(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=ir(n.length-e,0),o=a(s);++i<s;)o[i]=n[e+i];i=-1;for(var c=a(e+1);++i<e;)c[i]=n[i];return c[e]=r(o),re(t,this,c)}}function bi(t,e){return e.length<2?t:ua(t,Ha(e,0,-1))}function di(t,e){for(var r=t.length,a=sr(e.length,r),n=fn(t);a--;){var i=e[a];t[a]=ii(i,r)?n[i]:void 0}return t}function fi(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var mi=Si(za),vi=Xe||function(t,e){return Ut.setTimeout(t,e)},yi=Si(Ea);function Di(t,e,r){var a=e+"";return yi(t,function(t,e){var r=e.length;if(!r)return t;var a=r-1;return e[a]=(r>1?"& ":"")+e[a],e=e.join(r>2?", ":" "),t.replace($,"{\n/* [wrapped with "+e+"] */\n")}(a,function(t,e){return ne(s,(function(r){var a="_."+r[0];e&r[1]&&!ce(t,a)&&t.push(a)})),t.sort()}(function(t){var e=t.match(K);return e?e[1].split(X):[]}(a),r)))}function Si(t){var e=0,r=0;return function(){var a=or(),n=16-(a-r);if(r=a,n>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Fi(t,e){var r=-1,a=t.length,n=a-1;for(e=void 0===e?a:e;++r<e;){var i=ka(r,n),s=t[i];t[i]=t[r],t[r]=s}return t.length=e,t}var wi,Mi,Wi=(wi=ws((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(U,(function(t,r,a,n){e.push(a?n.replace(tt,"$1"):r||t)})),e}),(function(t){return 500===Mi.size&&Mi.clear(),t})),Mi=wi.cache,wi);function Pi(t){if("string"==typeof t||Xs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Vi(t){if(null!=t){try{return St.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Oi(t){if(t instanceof _r)return t.clone();var e=new xr(t.__wrapped__,t.__chain__);return e.__actions__=fn(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ci=Na((function(t,e){return Ns(t)?Zr(t,na(e,1,Ns,!0)):[]})),xi=Na((function(t,e){var r=Ai(e);return Ns(r)&&(r=void 0),Ns(t)?Zr(t,na(e,1,Ns,!0),$n(r,2)):[]})),_i=Na((function(t,e){var r=Ai(e);return Ns(r)&&(r=void 0),Ns(t)?Zr(t,na(e,1,Ns,!0),void 0,r):[]}));function Ti(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=null==r?0:ao(r);return n<0&&(n=ir(a+n,0)),me(t,$n(e,3),n)}function Ri(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=a-1;return void 0!==r&&(n=ao(r),n=r<0?ir(a+n,0):sr(n,a-1)),me(t,$n(e,3),n,!0)}function ki(t){return null!=t&&t.length?na(t,1):[]}function Ii(t){return t&&t.length?t[0]:void 0}var Ni=Na((function(t){var e=ue(t,an);return e.length&&e[0]===t[0]?fa(e):[]})),Li=Na((function(t){var e=Ai(t),r=ue(t,an);return e===Ai(r)?e=void 0:r.pop(),r.length&&r[0]===t[0]?fa(r,$n(e,2)):[]})),ji=Na((function(t){var e=Ai(t),r=ue(t,an);return(e="function"==typeof e?e:void 0)&&r.pop(),r.length&&r[0]===t[0]?fa(r,void 0,e):[]}));function Ai(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var zi=Na(Ei);function Ei(t,e){return t&&t.length&&e&&e.length?Ta(t,e):t}var Yi=Hn((function(t,e){var r=null==t?0:t.length,a=Gr(t,e);return Ra(t,ue(e,(function(t){return ii(t,r)?+t:t})).sort(pn)),a}));function Hi(t){return null==t?t:ur.call(t)}var Ui=Na((function(t){return Ka(na(t,1,Ns,!0))})),Bi=Na((function(t){var e=Ai(t);return Ns(e)&&(e=void 0),Ka(na(t,1,Ns,!0),$n(e,2))})),Qi=Na((function(t){var e=Ai(t);return e="function"==typeof e?e:void 0,Ka(na(t,1,Ns,!0),void 0,e)}));function Gi(t){if(!t||!t.length)return[];var e=0;return t=oe(t,(function(t){if(Ns(t))return e=ir(t.length,e),!0})),Pe(e,(function(e){return ue(t,Fe(e))}))}function qi(t,e){if(!t||!t.length)return[];var r=Gi(t);return null==e?r:ue(r,(function(t){return re(e,void 0,t)}))}var $i=Na((function(t,e){return Ns(t)?Zr(t,e):[]})),Ki=Na((function(t){return en(oe(t,Ns))})),Xi=Na((function(t){var e=Ai(t);return Ns(e)&&(e=void 0),en(oe(t,Ns),$n(e,2))})),Zi=Na((function(t){var e=Ai(t);return e="function"==typeof e?e:void 0,en(oe(t,Ns),void 0,e)})),Ji=Na(Gi),ts=Na((function(t){var e=t.length,r=e>1?t[e-1]:void 0;return r="function"==typeof r?(t.pop(),r):void 0,qi(t,r)}));function es(t){var e=Vr(t);return e.__chain__=!0,e}function rs(t,e){return e(t)}var as=Hn((function(t){var e=t.length,r=e?t[0]:0,a=this.__wrapped__,n=function(e){return Gr(e,t)};return!(e>1||this.__actions__.length)&&a instanceof _r&&ii(r)?((a=a.slice(r,+r+(e?1:0))).__actions__.push({func:rs,args:[n],thisArg:void 0}),new xr(a,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(n)})),ns=vn((function(t,e,r){Ft.call(t,r)?++t[r]:Qr(t,r,1)})),is=Wn(Ti),ss=Wn(Ri);function os(t,e){return(Rs(t)?ne:Jr)(t,$n(e,3))}function cs(t,e){return(Rs(t)?ie:ta)(t,$n(e,3))}var ls=vn((function(t,e,r){Ft.call(t,r)?t[r].push(e):Qr(t,r,[e])})),us=Na((function(t,e,r){var n=-1,i="function"==typeof e,s=Is(t)?a(t.length):[];return Jr(t,(function(t){s[++n]=i?re(e,t,r):ma(t,e,r)})),s})),hs=vn((function(t,e,r){Qr(t,r,e)}));function gs(t,e){return(Rs(t)?ue:Wa)(t,$n(e,3))}var ps=vn((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]})),bs=Na((function(t,e){if(null==t)return[];var r=e.length;return r>1&&si(t,e[0],e[1])?e=[]:r>2&&si(e[0],e[1],e[2])&&(e=[e[0]]),xa(t,na(e,1),[])})),ds=Ke||function(){return Ut.Date.now()};function fs(t,e,r){return e=r?void 0:e,jn(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function ms(t,e){var r;if("function"!=typeof e)throw new mt(n);return t=ao(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}var vs=Na((function(t,e,r){var a=1;if(r.length){var n=ze(r,qn(vs));a|=32}return jn(t,a,e,r,n)})),ys=Na((function(t,e,r){var a=3;if(r.length){var n=ze(r,qn(ys));a|=32}return jn(e,a,t,r,n)}));function Ds(t,e,r){var a,i,s,o,c,l,u=0,h=!1,g=!1,p=!0;if("function"!=typeof t)throw new mt(n);function b(e){var r=a,n=i;return a=i=void 0,u=e,o=t.apply(n,r)}function d(t){return u=t,c=vi(m,e),h?b(t):o}function f(t){var r=t-l;return void 0===l||r>=e||r<0||g&&t-u>=s}function m(){var t=ds();if(f(t))return v(t);c=vi(m,function(t){var r=e-(t-l);return g?sr(r,s-(t-u)):r}(t))}function v(t){return c=void 0,p&&a?b(t):(a=i=void 0,o)}function y(){var t=ds(),r=f(t);if(a=arguments,i=this,l=t,r){if(void 0===c)return d(l);if(g)return ln(c),c=vi(m,e),b(l)}return void 0===c&&(c=vi(m,e)),o}return e=io(e)||0,Hs(r)&&(h=!!r.leading,s=(g="maxWait"in r)?ir(io(r.maxWait)||0,e):s,p="trailing"in r?!!r.trailing:p),y.cancel=function(){void 0!==c&&ln(c),u=0,a=l=i=c=void 0},y.flush=function(){return void 0===c?o:v(ds())},y}var Ss=Na((function(t,e){return Xr(t,1,e)})),Fs=Na((function(t,e,r){return Xr(t,io(e)||0,r)}));function ws(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(n);var r=function(){var a=arguments,n=e?e.apply(this,a):a[0],i=r.cache;if(i.has(n))return i.get(n);var s=t.apply(this,a);return r.cache=i.set(n,s)||i,s};return r.cache=new(ws.Cache||kr),r}function Ms(t){if("function"!=typeof t)throw new mt(n);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ws.Cache=kr;var Ws=on((function(t,e){var r=(e=1==e.length&&Rs(e[0])?ue(e[0],Oe($n())):ue(na(e,1),Oe($n()))).length;return Na((function(a){for(var n=-1,i=sr(a.length,r);++n<i;)a[n]=e[n].call(this,a[n]);return re(t,this,a)}))})),Ps=Na((function(t,e){return jn(t,32,void 0,e,ze(e,qn(Ps)))})),Vs=Na((function(t,e){return jn(t,64,void 0,e,ze(e,qn(Vs)))})),Os=Hn((function(t,e){return jn(t,256,void 0,void 0,void 0,e)}));function Cs(t,e){return t===e||t!=t&&e!=e}var xs=Rn(pa),_s=Rn((function(t,e){return t>=e})),Ts=va(function(){return arguments}())?va:function(t){return Us(t)&&Ft.call(t,"callee")&&!Qt.call(t,"callee")},Rs=a.isArray,ks=Kt?Oe(Kt):function(t){return Us(t)&&ga(t)==F};function Is(t){return null!=t&&Ys(t.length)&&!zs(t)}function Ns(t){return Us(t)&&Is(t)}var Ls=er||sc,js=Xt?Oe(Xt):function(t){return Us(t)&&ga(t)==u};function As(t){if(!Us(t))return!1;var e=ga(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Gs(t)}function zs(t){if(!Hs(t))return!1;var e=ga(t);return e==g||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Es(t){return"number"==typeof t&&t==ao(t)}function Ys(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Hs(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Us(t){return null!=t&&"object"==typeof t}var Bs=Zt?Oe(Zt):function(t){return Us(t)&&ei(t)==b};function Qs(t){return"number"==typeof t||Us(t)&&ga(t)==d}function Gs(t){if(!Us(t)||ga(t)!=f)return!1;var e=Ht(t);if(null===e)return!0;var r=Ft.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&St.call(r)==Pt}var qs=Jt?Oe(Jt):function(t){return Us(t)&&ga(t)==m},$s=te?Oe(te):function(t){return Us(t)&&ei(t)==v};function Ks(t){return"string"==typeof t||!Rs(t)&&Us(t)&&ga(t)==y}function Xs(t){return"symbol"==typeof t||Us(t)&&ga(t)==D}var Zs=ee?Oe(ee):function(t){return Us(t)&&Ys(t.length)&&!!Lt[ga(t)]},Js=Rn(Ma),to=Rn((function(t,e){return t<=e}));function eo(t){if(!t)return[];if(Is(t))return Ks(t)?Ue(t):fn(t);if(de&&t[de])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[de]());var e=ei(t);return(e==b?je:e==v?Ee:xo)(t)}function ro(t){return t?(t=io(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ao(t){var e=ro(t),r=e%1;return e==e?r?e-r:e:0}function no(t){return t?qr(ao(t),0,4294967295):0}function io(t){if("number"==typeof t)return t;if(Xs(t))return NaN;if(Hs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Hs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ve(t);var r=nt.test(t);return r||st.test(t)?Et(t.slice(2),r?2:8):at.test(t)?NaN:+t}function so(t){return mn(t,Fo(t))}function oo(t){return null==t?"":$a(t)}var co=yn((function(t,e){if(ui(e)||Is(e))mn(e,So(e),t);else for(var r in e)Ft.call(e,r)&&Yr(t,r,e[r])})),lo=yn((function(t,e){mn(e,Fo(e),t)})),uo=yn((function(t,e,r,a){mn(e,Fo(e),t,a)})),ho=yn((function(t,e,r,a){mn(e,So(e),t,a)})),go=Hn(Gr),po=Na((function(t,e){t=bt(t);var r=-1,a=e.length,n=a>2?e[2]:void 0;for(n&&si(e[0],e[1],n)&&(a=1);++r<a;)for(var i=e[r],s=Fo(i),o=-1,c=s.length;++o<c;){var l=s[o],u=t[l];(void 0===u||Cs(u,yt[l])&&!Ft.call(t,l))&&(t[l]=i[l])}return t})),bo=Na((function(t){return t.push(void 0,zn),re(Mo,void 0,t)}));function fo(t,e,r){var a=null==t?void 0:ua(t,e);return void 0===a?r:a}function mo(t,e){return null!=t&&ri(t,e,da)}var vo=On((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Wt.call(e)),t[e]=r}),Uo(Go)),yo=On((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Wt.call(e)),Ft.call(t,e)?t[e].push(r):t[e]=[r]}),$n),Do=Na(ma);function So(t){return Is(t)?Lr(t):wa(t)}function Fo(t){return Is(t)?Lr(t,!0):function(t){if(!Hs(t))return function(t){var e=[];if(null!=t)for(var r in bt(t))e.push(r);return e}(t);var e=ui(t),r=[];for(var a in t)("constructor"!=a||!e&&Ft.call(t,a))&&r.push(a);return r}(t)}var wo=yn((function(t,e,r){Oa(t,e,r)})),Mo=yn((function(t,e,r,a){Oa(t,e,r,a)})),Wo=Hn((function(t,e){var r={};if(null==t)return r;var a=!1;e=ue(e,(function(e){return e=sn(e,t),a||(a=e.length>1),e})),mn(t,Bn(t),r),a&&(r=$r(r,7,En));for(var n=e.length;n--;)Xa(r,e[n]);return r})),Po=Hn((function(t,e){return null==t?{}:function(t,e){return _a(t,e,(function(e,r){return mo(t,r)}))}(t,e)}));function Vo(t,e){if(null==t)return{};var r=ue(Bn(t),(function(t){return[t]}));return e=$n(e),_a(t,r,(function(t,r){return e(t,r[0])}))}var Oo=Ln(So),Co=Ln(Fo);function xo(t){return null==t?[]:Ce(t,So(t))}var _o=wn((function(t,e,r){return e=e.toLowerCase(),t+(r?To(e):e)}));function To(t){return zo(oo(t).toLowerCase())}function Ro(t){return(t=oo(t))&&t.replace(ct,ke).replace(xt,"")}var ko=wn((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),Io=wn((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),No=Fn("toLowerCase"),Lo=wn((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()})),jo=wn((function(t,e,r){return t+(r?" ":"")+zo(e)})),Ao=wn((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),zo=Fn("toUpperCase");function Eo(t,e,r){return t=oo(t),void 0===(e=r?void 0:e)?function(t){return kt.test(t)}(t)?function(t){return t.match(Tt)||[]}(t):function(t){return t.match(Z)||[]}(t):t.match(e)||[]}var Yo=Na((function(t,e){try{return re(t,void 0,e)}catch(r){return As(r)?r:new ht(r)}})),Ho=Hn((function(t,e){return ne(e,(function(e){e=Pi(e),Qr(t,e,vs(t[e],t))})),t}));function Uo(t){return function(){return t}}var Bo=Pn(),Qo=Pn(!0);function Go(t){return t}function qo(t){return Fa("function"==typeof t?t:$r(t,1))}var $o=Na((function(t,e){return function(r){return ma(r,t,e)}})),Ko=Na((function(t,e){return function(r){return ma(t,r,e)}}));function Xo(t,e,r){var a=So(e),n=la(e,a);null!=r||Hs(e)&&(n.length||!a.length)||(r=e,e=t,t=this,n=la(e,So(e)));var i=!(Hs(r)&&"chain"in r&&!r.chain),s=zs(t);return ne(n,(function(r){var a=e[r];t[r]=a,s&&(t.prototype[r]=function(){var e=this.__chain__;if(i||e){var r=t(this.__wrapped__),n=r.__actions__=fn(this.__actions__);return n.push({func:a,args:arguments,thisArg:t}),r.__chain__=e,r}return a.apply(t,he([this.value()],arguments))})})),t}function Zo(){}var Jo=xn(ue),tc=xn(se),ec=xn(be);function rc(t){return oi(t)?Fe(Pi(t)):function(t){return function(e){return ua(e,t)}}(t)}var ac=Tn(),nc=Tn(!0);function ic(){return[]}function sc(){return!1}var oc,cc=Cn((function(t,e){return t+e}),0),lc=In("ceil"),uc=Cn((function(t,e){return t/e}),1),hc=In("floor"),gc=Cn((function(t,e){return t*e}),1),pc=In("round"),bc=Cn((function(t,e){return t-e}),0);return Vr.after=function(t,e){if("function"!=typeof e)throw new mt(n);return t=ao(t),function(){if(--t<1)return e.apply(this,arguments)}},Vr.ary=fs,Vr.assign=co,Vr.assignIn=lo,Vr.assignInWith=uo,Vr.assignWith=ho,Vr.at=go,Vr.before=ms,Vr.bind=vs,Vr.bindAll=Ho,Vr.bindKey=ys,Vr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Rs(t)?t:[t]},Vr.chain=es,Vr.chunk=function(t,e,r){e=(r?si(t,e,r):void 0===e)?1:ir(ao(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var i=0,s=0,o=a(Ze(n/e));i<n;)o[s++]=Ha(t,i,i+=e);return o},Vr.compact=function(t){for(var e=-1,r=null==t?0:t.length,a=0,n=[];++e<r;){var i=t[e];i&&(n[a++]=i)}return n},Vr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=a(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return he(Rs(r)?fn(r):[r],na(e,1))},Vr.cond=function(t){var e=null==t?0:t.length,r=$n();return t=e?ue(t,(function(t){if("function"!=typeof t[1])throw new mt(n);return[r(t[0]),t[1]]})):[],Na((function(r){for(var a=-1;++a<e;){var n=t[a];if(re(n[0],this,r))return re(n[1],this,r)}}))},Vr.conforms=function(t){return function(t){var e=So(t);return function(r){return Kr(r,t,e)}}($r(t,1))},Vr.constant=Uo,Vr.countBy=ns,Vr.create=function(t,e){var r=Or(t);return null==e?r:Br(r,e)},Vr.curry=function t(e,r,a){var n=jn(e,8,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=t.placeholder,n},Vr.curryRight=function t(e,r,a){var n=jn(e,16,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=t.placeholder,n},Vr.debounce=Ds,Vr.defaults=po,Vr.defaultsDeep=bo,Vr.defer=Ss,Vr.delay=Fs,Vr.difference=Ci,Vr.differenceBy=xi,Vr.differenceWith=_i,Vr.drop=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,(e=r||void 0===e?1:ao(e))<0?0:e,a):[]},Vr.dropRight=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,0,(e=a-(e=r||void 0===e?1:ao(e)))<0?0:e):[]},Vr.dropRightWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!0,!0):[]},Vr.dropWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!0):[]},Vr.fill=function(t,e,r,a){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&si(t,e,r)&&(r=0,a=n),function(t,e,r,a){var n=t.length;for((r=ao(r))<0&&(r=-r>n?0:n+r),(a=void 0===a||a>n?n:ao(a))<0&&(a+=n),a=r>a?0:no(a);r<a;)t[r++]=e;return t}(t,e,r,a)):[]},Vr.filter=function(t,e){return(Rs(t)?oe:aa)(t,$n(e,3))},Vr.flatMap=function(t,e){return na(gs(t,e),1)},Vr.flatMapDeep=function(t,e){return na(gs(t,e),1/0)},Vr.flatMapDepth=function(t,e,r){return r=void 0===r?1:ao(r),na(gs(t,e),r)},Vr.flatten=ki,Vr.flattenDeep=function(t){return null!=t&&t.length?na(t,1/0):[]},Vr.flattenDepth=function(t,e){return null!=t&&t.length?na(t,e=void 0===e?1:ao(e)):[]},Vr.flip=function(t){return jn(t,512)},Vr.flow=Bo,Vr.flowRight=Qo,Vr.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,a={};++e<r;){var n=t[e];a[n[0]]=n[1]}return a},Vr.functions=function(t){return null==t?[]:la(t,So(t))},Vr.functionsIn=function(t){return null==t?[]:la(t,Fo(t))},Vr.groupBy=ls,Vr.initial=function(t){return null!=t&&t.length?Ha(t,0,-1):[]},Vr.intersection=Ni,Vr.intersectionBy=Li,Vr.intersectionWith=ji,Vr.invert=vo,Vr.invertBy=yo,Vr.invokeMap=us,Vr.iteratee=qo,Vr.keyBy=hs,Vr.keys=So,Vr.keysIn=Fo,Vr.map=gs,Vr.mapKeys=function(t,e){var r={};return e=$n(e,3),oa(t,(function(t,a,n){Qr(r,e(t,a,n),t)})),r},Vr.mapValues=function(t,e){var r={};return e=$n(e,3),oa(t,(function(t,a,n){Qr(r,a,e(t,a,n))})),r},Vr.matches=function(t){return Pa($r(t,1))},Vr.matchesProperty=function(t,e){return Va(t,$r(e,1))},Vr.memoize=ws,Vr.merge=wo,Vr.mergeWith=Mo,Vr.method=$o,Vr.methodOf=Ko,Vr.mixin=Xo,Vr.negate=Ms,Vr.nthArg=function(t){return t=ao(t),Na((function(e){return Ca(e,t)}))},Vr.omit=Wo,Vr.omitBy=function(t,e){return Vo(t,Ms($n(e)))},Vr.once=function(t){return ms(2,t)},Vr.orderBy=function(t,e,r,a){return null==t?[]:(Rs(e)||(e=null==e?[]:[e]),Rs(r=a?void 0:r)||(r=null==r?[]:[r]),xa(t,e,r))},Vr.over=Jo,Vr.overArgs=Ws,Vr.overEvery=tc,Vr.overSome=ec,Vr.partial=Ps,Vr.partialRight=Vs,Vr.partition=ps,Vr.pick=Po,Vr.pickBy=Vo,Vr.property=rc,Vr.propertyOf=function(t){return function(e){return null==t?void 0:ua(t,e)}},Vr.pull=zi,Vr.pullAll=Ei,Vr.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Ta(t,e,$n(r,2)):t},Vr.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Ta(t,e,void 0,r):t},Vr.pullAt=Yi,Vr.range=ac,Vr.rangeRight=nc,Vr.rearg=Os,Vr.reject=function(t,e){return(Rs(t)?oe:aa)(t,Ms($n(e,3)))},Vr.remove=function(t,e){var r=[];if(!t||!t.length)return r;var a=-1,n=[],i=t.length;for(e=$n(e,3);++a<i;){var s=t[a];e(s,a,t)&&(r.push(s),n.push(a))}return Ra(t,n),r},Vr.rest=function(t,e){if("function"!=typeof t)throw new mt(n);return Na(t,e=void 0===e?e:ao(e))},Vr.reverse=Hi,Vr.sampleSize=function(t,e,r){return e=(r?si(t,e,r):void 0===e)?1:ao(e),(Rs(t)?Ar:ja)(t,e)},Vr.set=function(t,e,r){return null==t?t:Aa(t,e,r)},Vr.setWith=function(t,e,r,a){return a="function"==typeof a?a:void 0,null==t?t:Aa(t,e,r,a)},Vr.shuffle=function(t){return(Rs(t)?zr:Ya)(t)},Vr.slice=function(t,e,r){var a=null==t?0:t.length;return a?(r&&"number"!=typeof r&&si(t,e,r)?(e=0,r=a):(e=null==e?0:ao(e),r=void 0===r?a:ao(r)),Ha(t,e,r)):[]},Vr.sortBy=bs,Vr.sortedUniq=function(t){return t&&t.length?Ga(t):[]},Vr.sortedUniqBy=function(t,e){return t&&t.length?Ga(t,$n(e,2)):[]},Vr.split=function(t,e,r){return r&&"number"!=typeof r&&si(t,e,r)&&(e=r=void 0),(r=void 0===r?4294967295:r>>>0)?(t=oo(t))&&("string"==typeof e||null!=e&&!qs(e))&&!(e=$a(e))&&Le(t)?cn(Ue(t),0,r):t.split(e,r):[]},Vr.spread=function(t,e){if("function"!=typeof t)throw new mt(n);return e=null==e?0:ir(ao(e),0),Na((function(r){var a=r[e],n=cn(r,0,e);return a&&he(n,a),re(t,this,n)}))},Vr.tail=function(t){var e=null==t?0:t.length;return e?Ha(t,1,e):[]},Vr.take=function(t,e,r){return t&&t.length?Ha(t,0,(e=r||void 0===e?1:ao(e))<0?0:e):[]},Vr.takeRight=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,(e=a-(e=r||void 0===e?1:ao(e)))<0?0:e,a):[]},Vr.takeRightWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!1,!0):[]},Vr.takeWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3)):[]},Vr.tap=function(t,e){return e(t),t},Vr.throttle=function(t,e,r){var a=!0,i=!0;if("function"!=typeof t)throw new mt(n);return Hs(r)&&(a="leading"in r?!!r.leading:a,i="trailing"in r?!!r.trailing:i),Ds(t,e,{leading:a,maxWait:e,trailing:i})},Vr.thru=rs,Vr.toArray=eo,Vr.toPairs=Oo,Vr.toPairsIn=Co,Vr.toPath=function(t){return Rs(t)?ue(t,Pi):Xs(t)?[t]:fn(Wi(oo(t)))},Vr.toPlainObject=so,Vr.transform=function(t,e,r){var a=Rs(t),n=a||Ls(t)||Zs(t);if(e=$n(e,4),null==r){var i=t&&t.constructor;r=n?a?new i:[]:Hs(t)&&zs(i)?Or(Ht(t)):{}}return(n?ne:oa)(t,(function(t,a,n){return e(r,t,a,n)})),r},Vr.unary=function(t){return fs(t,1)},Vr.union=Ui,Vr.unionBy=Bi,Vr.unionWith=Qi,Vr.uniq=function(t){return t&&t.length?Ka(t):[]},Vr.uniqBy=function(t,e){return t&&t.length?Ka(t,$n(e,2)):[]},Vr.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Ka(t,void 0,e):[]},Vr.unset=function(t,e){return null==t||Xa(t,e)},Vr.unzip=Gi,Vr.unzipWith=qi,Vr.update=function(t,e,r){return null==t?t:Za(t,e,nn(r))},Vr.updateWith=function(t,e,r,a){return a="function"==typeof a?a:void 0,null==t?t:Za(t,e,nn(r),a)},Vr.values=xo,Vr.valuesIn=function(t){return null==t?[]:Ce(t,Fo(t))},Vr.without=$i,Vr.words=Eo,Vr.wrap=function(t,e){return Ps(nn(e),t)},Vr.xor=Ki,Vr.xorBy=Xi,Vr.xorWith=Zi,Vr.zip=Ji,Vr.zipObject=function(t,e){return rn(t||[],e||[],Yr)},Vr.zipObjectDeep=function(t,e){return rn(t||[],e||[],Aa)},Vr.zipWith=ts,Vr.entries=Oo,Vr.entriesIn=Co,Vr.extend=lo,Vr.extendWith=uo,Xo(Vr,Vr),Vr.add=cc,Vr.attempt=Yo,Vr.camelCase=_o,Vr.capitalize=To,Vr.ceil=lc,Vr.clamp=function(t,e,r){return void 0===r&&(r=e,e=void 0),void 0!==r&&(r=(r=io(r))==r?r:0),void 0!==e&&(e=(e=io(e))==e?e:0),qr(io(t),e,r)},Vr.clone=function(t){return $r(t,4)},Vr.cloneDeep=function(t){return $r(t,5)},Vr.cloneDeepWith=function(t,e){return $r(t,5,e="function"==typeof e?e:void 0)},Vr.cloneWith=function(t,e){return $r(t,4,e="function"==typeof e?e:void 0)},Vr.conformsTo=function(t,e){return null==e||Kr(t,e,So(e))},Vr.deburr=Ro,Vr.defaultTo=function(t,e){return null==t||t!=t?e:t},Vr.divide=uc,Vr.endsWith=function(t,e,r){t=oo(t),e=$a(e);var a=t.length,n=r=void 0===r?a:qr(ao(r),0,a);return(r-=e.length)>=0&&t.slice(r,n)==e},Vr.eq=Cs,Vr.escape=function(t){return(t=oo(t))&&j.test(t)?t.replace(N,Ie):t},Vr.escapeRegExp=function(t){return(t=oo(t))&&Q.test(t)?t.replace(B,"\\$&"):t},Vr.every=function(t,e,r){var a=Rs(t)?se:ea;return r&&si(t,e,r)&&(e=void 0),a(t,$n(e,3))},Vr.find=is,Vr.findIndex=Ti,Vr.findKey=function(t,e){return fe(t,$n(e,3),oa)},Vr.findLast=ss,Vr.findLastIndex=Ri,Vr.findLastKey=function(t,e){return fe(t,$n(e,3),ca)},Vr.floor=hc,Vr.forEach=os,Vr.forEachRight=cs,Vr.forIn=function(t,e){return null==t?t:ia(t,$n(e,3),Fo)},Vr.forInRight=function(t,e){return null==t?t:sa(t,$n(e,3),Fo)},Vr.forOwn=function(t,e){return t&&oa(t,$n(e,3))},Vr.forOwnRight=function(t,e){return t&&ca(t,$n(e,3))},Vr.get=fo,Vr.gt=xs,Vr.gte=_s,Vr.has=function(t,e){return null!=t&&ri(t,e,ba)},Vr.hasIn=mo,Vr.head=Ii,Vr.identity=Go,Vr.includes=function(t,e,r,a){t=Is(t)?t:xo(t),r=r&&!a?ao(r):0;var n=t.length;return r<0&&(r=ir(n+r,0)),Ks(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&ve(t,e,r)>-1},Vr.indexOf=function(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=null==r?0:ao(r);return n<0&&(n=ir(a+n,0)),ve(t,e,n)},Vr.inRange=function(t,e,r){return e=ro(e),void 0===r?(r=e,e=0):r=ro(r),function(t,e,r){return t>=sr(e,r)&&t<ir(e,r)}(t=io(t),e,r)},Vr.invoke=Do,Vr.isArguments=Ts,Vr.isArray=Rs,Vr.isArrayBuffer=ks,Vr.isArrayLike=Is,Vr.isArrayLikeObject=Ns,Vr.isBoolean=function(t){return!0===t||!1===t||Us(t)&&ga(t)==l},Vr.isBuffer=Ls,Vr.isDate=js,Vr.isElement=function(t){return Us(t)&&1===t.nodeType&&!Gs(t)},Vr.isEmpty=function(t){if(null==t)return!0;if(Is(t)&&(Rs(t)||"string"==typeof t||"function"==typeof t.splice||Ls(t)||Zs(t)||Ts(t)))return!t.length;var e=ei(t);if(e==b||e==v)return!t.size;if(ui(t))return!wa(t).length;for(var r in t)if(Ft.call(t,r))return!1;return!0},Vr.isEqual=function(t,e){return ya(t,e)},Vr.isEqualWith=function(t,e,r){var a=(r="function"==typeof r?r:void 0)?r(t,e):void 0;return void 0===a?ya(t,e,void 0,r):!!a},Vr.isError=As,Vr.isFinite=function(t){return"number"==typeof t&&rr(t)},Vr.isFunction=zs,Vr.isInteger=Es,Vr.isLength=Ys,Vr.isMap=Bs,Vr.isMatch=function(t,e){return t===e||Da(t,e,Xn(e))},Vr.isMatchWith=function(t,e,r){return r="function"==typeof r?r:void 0,Da(t,e,Xn(e),r)},Vr.isNaN=function(t){return Qs(t)&&t!=+t},Vr.isNative=function(t){if(li(t))throw new ht("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sa(t)},Vr.isNil=function(t){return null==t},Vr.isNull=function(t){return null===t},Vr.isNumber=Qs,Vr.isObject=Hs,Vr.isObjectLike=Us,Vr.isPlainObject=Gs,Vr.isRegExp=qs,Vr.isSafeInteger=function(t){return Es(t)&&t>=-9007199254740991&&t<=9007199254740991},Vr.isSet=$s,Vr.isString=Ks,Vr.isSymbol=Xs,Vr.isTypedArray=Zs,Vr.isUndefined=function(t){return void 0===t},Vr.isWeakMap=function(t){return Us(t)&&ei(t)==S},Vr.isWeakSet=function(t){return Us(t)&&"[object WeakSet]"==ga(t)},Vr.join=function(t,e){return null==t?"":ar.call(t,e)},Vr.kebabCase=ko,Vr.last=Ai,Vr.lastIndexOf=function(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=a;return void 0!==r&&(n=(n=ao(r))<0?ir(a+n,0):sr(n,a-1)),e==e?function(t,e,r){for(var a=r+1;a--;)if(t[a]===e)return a;return a}(t,e,n):me(t,De,n,!0)},Vr.lowerCase=Io,Vr.lowerFirst=No,Vr.lt=Js,Vr.lte=to,Vr.max=function(t){return t&&t.length?ra(t,Go,pa):void 0},Vr.maxBy=function(t,e){return t&&t.length?ra(t,$n(e,2),pa):void 0},Vr.mean=function(t){return Se(t,Go)},Vr.meanBy=function(t,e){return Se(t,$n(e,2))},Vr.min=function(t){return t&&t.length?ra(t,Go,Ma):void 0},Vr.minBy=function(t,e){return t&&t.length?ra(t,$n(e,2),Ma):void 0},Vr.stubArray=ic,Vr.stubFalse=sc,Vr.stubObject=function(){return{}},Vr.stubString=function(){return""},Vr.stubTrue=function(){return!0},Vr.multiply=gc,Vr.nth=function(t,e){return t&&t.length?Ca(t,ao(e)):void 0},Vr.noConflict=function(){return Ut._===this&&(Ut._=Vt),this},Vr.noop=Zo,Vr.now=ds,Vr.pad=function(t,e,r){t=oo(t);var a=(e=ao(e))?He(t):0;if(!e||a>=e)return t;var n=(e-a)/2;return _n(Je(n),r)+t+_n(Ze(n),r)},Vr.padEnd=function(t,e,r){t=oo(t);var a=(e=ao(e))?He(t):0;return e&&a<e?t+_n(e-a,r):t},Vr.padStart=function(t,e,r){t=oo(t);var a=(e=ao(e))?He(t):0;return e&&a<e?_n(e-a,r)+t:t},Vr.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),cr(oo(t).replace(G,""),e||0)},Vr.random=function(t,e,r){if(r&&"boolean"!=typeof r&&si(t,e,r)&&(e=r=void 0),void 0===r&&("boolean"==typeof e?(r=e,e=void 0):"boolean"==typeof t&&(r=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ro(t),void 0===e?(e=t,t=0):e=ro(e)),t>e){var a=t;t=e,e=a}if(r||t%1||e%1){var n=lr();return sr(t+n*(e-t+zt("1e-"+((n+"").length-1))),e)}return ka(t,e)},Vr.reduce=function(t,e,r){var a=Rs(t)?ge:Me,n=arguments.length<3;return a(t,$n(e,4),r,n,Jr)},Vr.reduceRight=function(t,e,r){var a=Rs(t)?pe:Me,n=arguments.length<3;return a(t,$n(e,4),r,n,ta)},Vr.repeat=function(t,e,r){return e=(r?si(t,e,r):void 0===e)?1:ao(e),Ia(oo(t),e)},Vr.replace=function(){var t=arguments,e=oo(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Vr.result=function(t,e,r){var a=-1,n=(e=sn(e,t)).length;for(n||(n=1,t=void 0);++a<n;){var i=null==t?void 0:t[Pi(e[a])];void 0===i&&(a=n,i=r),t=zs(i)?i.call(t):i}return t},Vr.round=pc,Vr.runInContext=t,Vr.sample=function(t){return(Rs(t)?jr:La)(t)},Vr.size=function(t){if(null==t)return 0;if(Is(t))return Ks(t)?He(t):t.length;var e=ei(t);return e==b||e==v?t.size:wa(t).length},Vr.snakeCase=Lo,Vr.some=function(t,e,r){var a=Rs(t)?be:Ua;return r&&si(t,e,r)&&(e=void 0),a(t,$n(e,3))},Vr.sortedIndex=function(t,e){return Ba(t,e)},Vr.sortedIndexBy=function(t,e,r){return Qa(t,e,$n(r,2))},Vr.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var a=Ba(t,e);if(a<r&&Cs(t[a],e))return a}return-1},Vr.sortedLastIndex=function(t,e){return Ba(t,e,!0)},Vr.sortedLastIndexBy=function(t,e,r){return Qa(t,e,$n(r,2),!0)},Vr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=Ba(t,e,!0)-1;if(Cs(t[r],e))return r}return-1},Vr.startCase=jo,Vr.startsWith=function(t,e,r){return t=oo(t),r=null==r?0:qr(ao(r),0,t.length),e=$a(e),t.slice(r,r+e.length)==e},Vr.subtract=bc,Vr.sum=function(t){return t&&t.length?We(t,Go):0},Vr.sumBy=function(t,e){return t&&t.length?We(t,$n(e,2)):0},Vr.template=function(t,e,r){var a=Vr.templateSettings;r&&si(t,e,r)&&(e=void 0),t=oo(t),e=uo({},e,a,An);var n,i,s=uo({},e.imports,a.imports,An),o=So(s),c=Ce(s,o),l=0,u=e.interpolate||lt,h="__p += '",g=dt((e.escape||lt).source+"|"+u.source+"|"+(u===E?et:lt).source+"|"+(e.evaluate||lt).source+"|$","g"),p="//# sourceURL="+(Ft.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Nt+"]")+"\n";t.replace(g,(function(e,r,a,s,o,c){return a||(a=s),h+=t.slice(l,c).replace(ut,Ne),r&&(n=!0,h+="' +\n__e("+r+") +\n'"),o&&(i=!0,h+="';\n"+o+";\n__p += '"),a&&(h+="' +\n((__t = ("+a+")) == null ? '' : __t) +\n'"),l=c+e.length,e})),h+="';\n";var b=Ft.call(e,"variable")&&e.variable;if(b){if(J.test(b))throw new ht("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(i?h.replace(T,""):h).replace(R,"$1").replace(k,"$1;"),h="function("+(b||"obj")+") {\n"+(b?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(n?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var d=Yo((function(){return gt(o,p+"return "+h).apply(void 0,c)}));if(d.source=h,As(d))throw d;return d},Vr.times=function(t,e){if((t=ao(t))<1||t>9007199254740991)return[];var r=4294967295,a=sr(t,4294967295);t-=4294967295;for(var n=Pe(a,e=$n(e));++r<t;)e(r);return n},Vr.toFinite=ro,Vr.toInteger=ao,Vr.toLength=no,Vr.toLower=function(t){return oo(t).toLowerCase()},Vr.toNumber=io,Vr.toSafeInteger=function(t){return t?qr(ao(t),-9007199254740991,9007199254740991):0===t?t:0},Vr.toString=oo,Vr.toUpper=function(t){return oo(t).toUpperCase()},Vr.trim=function(t,e,r){if((t=oo(t))&&(r||void 0===e))return Ve(t);if(!t||!(e=$a(e)))return t;var a=Ue(t),n=Ue(e);return cn(a,_e(a,n),Te(a,n)+1).join("")},Vr.trimEnd=function(t,e,r){if((t=oo(t))&&(r||void 0===e))return t.slice(0,Be(t)+1);if(!t||!(e=$a(e)))return t;var a=Ue(t);return cn(a,0,Te(a,Ue(e))+1).join("")},Vr.trimStart=function(t,e,r){if((t=oo(t))&&(r||void 0===e))return t.replace(G,"");if(!t||!(e=$a(e)))return t;var a=Ue(t);return cn(a,_e(a,Ue(e))).join("")},Vr.truncate=function(t,e){var r=30,a="...";if(Hs(e)){var n="separator"in e?e.separator:n;r="length"in e?ao(e.length):r,a="omission"in e?$a(e.omission):a}var i=(t=oo(t)).length;if(Le(t)){var s=Ue(t);i=s.length}if(r>=i)return t;var o=r-He(a);if(o<1)return a;var c=s?cn(s,0,o).join(""):t.slice(0,o);if(void 0===n)return c+a;if(s&&(o+=c.length-o),qs(n)){if(t.slice(o).search(n)){var l,u=c;for(n.global||(n=dt(n.source,oo(rt.exec(n))+"g")),n.lastIndex=0;l=n.exec(u);)var h=l.index;c=c.slice(0,void 0===h?o:h)}}else if(t.indexOf($a(n),o)!=o){var g=c.lastIndexOf(n);g>-1&&(c=c.slice(0,g))}return c+a},Vr.unescape=function(t){return(t=oo(t))&&L.test(t)?t.replace(I,Qe):t},Vr.uniqueId=function(t){var e=++wt;return oo(t)+e},Vr.upperCase=Ao,Vr.upperFirst=zo,Vr.each=os,Vr.eachRight=cs,Vr.first=Ii,Xo(Vr,(oc={},oa(Vr,(function(t,e){Ft.call(Vr.prototype,e)||(oc[e]=t)})),oc),{chain:!1}),Vr.VERSION="4.17.21",ne(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Vr[t].placeholder=Vr})),ne(["drop","take"],(function(t,e){_r.prototype[t]=function(r){r=void 0===r?1:ir(ao(r),0);var a=this.__filtered__&&!e?new _r(this):this.clone();return a.__filtered__?a.__takeCount__=sr(r,a.__takeCount__):a.__views__.push({size:sr(r,4294967295),type:t+(a.__dir__<0?"Right":"")}),a},_r.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ne(["filter","map","takeWhile"],(function(t,e){var r=e+1,a=1==r||3==r;_r.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:$n(t,3),type:r}),e.__filtered__=e.__filtered__||a,e}})),ne(["head","last"],(function(t,e){var r="take"+(e?"Right":"");_r.prototype[t]=function(){return this[r](1).value()[0]}})),ne(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");_r.prototype[t]=function(){return this.__filtered__?new _r(this):this[r](1)}})),_r.prototype.compact=function(){return this.filter(Go)},_r.prototype.find=function(t){return this.filter(t).head()},_r.prototype.findLast=function(t){return this.reverse().find(t)},_r.prototype.invokeMap=Na((function(t,e){return"function"==typeof t?new _r(this):this.map((function(r){return ma(r,t,e)}))})),_r.prototype.reject=function(t){return this.filter(Ms($n(t)))},_r.prototype.slice=function(t,e){t=ao(t);var r=this;return r.__filtered__&&(t>0||e<0)?new _r(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),void 0!==e&&(r=(e=ao(e))<0?r.dropRight(-e):r.take(e-t)),r)},_r.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},_r.prototype.toArray=function(){return this.take(4294967295)},oa(_r.prototype,(function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),a=/^(?:head|last)$/.test(e),n=Vr[a?"take"+("last"==e?"Right":""):e],i=a||/^find/.test(e);n&&(Vr.prototype[e]=function(){var e=this.__wrapped__,s=a?[1]:arguments,o=e instanceof _r,c=s[0],l=o||Rs(e),u=function(t){var e=n.apply(Vr,he([t],s));return a&&h?e[0]:e};l&&r&&"function"==typeof c&&1!=c.length&&(o=l=!1);var h=this.__chain__,g=!!this.__actions__.length,p=i&&!h,b=o&&!g;if(!i&&l){e=b?e:new _r(this);var d=t.apply(e,s);return d.__actions__.push({func:rs,args:[u],thisArg:void 0}),new xr(d,h)}return p&&b?t.apply(this,s):(d=this.thru(u),p?a?d.value()[0]:d.value():d)})})),ne(["pop","push","shift","sort","splice","unshift"],(function(t){var e=vt[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",a=/^(?:pop|shift)$/.test(t);Vr.prototype[t]=function(){var t=arguments;if(a&&!this.__chain__){var n=this.value();return e.apply(Rs(n)?n:[],t)}return this[r]((function(r){return e.apply(Rs(r)?r:[],t)}))}})),oa(_r.prototype,(function(t,e){var r=Vr[e];if(r){var a=r.name+"";Ft.call(vr,a)||(vr[a]=[]),vr[a].push({name:e,func:r})}})),vr[Vn(void 0,2).name]=[{name:"wrapper",func:void 0}],_r.prototype.clone=function(){var t=new _r(this.__wrapped__);return t.__actions__=fn(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=fn(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=fn(this.__views__),t},_r.prototype.reverse=function(){if(this.__filtered__){var t=new _r(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},_r.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=Rs(t),a=e<0,n=r?t.length:0,i=function(t,e,r){for(var a=-1,n=r.length;++a<n;){var i=r[a],s=i.size;switch(i.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=sr(e,t+s);break;case"takeRight":t=ir(t,e-s)}}return{start:t,end:e}}(0,n,this.__views__),s=i.start,o=i.end,c=o-s,l=a?o:s-1,u=this.__iteratees__,h=u.length,g=0,p=sr(c,this.__takeCount__);if(!r||!a&&n==c&&p==c)return tn(t,this.__actions__);var b=[];t:for(;c--&&g<p;){for(var d=-1,f=t[l+=e];++d<h;){var m=u[d],v=m.type,y=(0,m.iteratee)(f);if(2==v)f=y;else if(!y){if(1==v)continue t;break t}}b[g++]=f}return b},Vr.prototype.at=as,Vr.prototype.chain=function(){return es(this)},Vr.prototype.commit=function(){return new xr(this.value(),this.__chain__)},Vr.prototype.next=function(){void 0===this.__values__&&(this.__values__=eo(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Vr.prototype.plant=function(t){for(var e,r=this;r instanceof Cr;){var a=Oi(r);a.__index__=0,a.__values__=void 0,e?n.__wrapped__=a:e=a;var n=a;r=r.__wrapped__}return n.__wrapped__=t,e},Vr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof _r){var e=t;return this.__actions__.length&&(e=new _r(this)),(e=e.reverse()).__actions__.push({func:rs,args:[Hi],thisArg:void 0}),new xr(e,this.__chain__)}return this.thru(Hi)},Vr.prototype.toJSON=Vr.prototype.valueOf=Vr.prototype.value=function(){return tn(this.__wrapped__,this.__actions__)},Vr.prototype.first=Vr.prototype.head,de&&(Vr.prototype[de]=function(){return this}),Vr}();Ut._=Ge,void 0===(a=(function(){return Ge}).call(e,r,e,t))||(t.exports=a)}).call(this)}).call(this,r("YuTi")(t))},pJjZ:function(t,e,r){"use strict";r.r(e),r.d(e,"AdminReportingModule",(function(){return fl}));var a=r("ofXK"),n=r("tyNb"),i=r("mrSG"),s=r("LvDl"),o=r("wd/R"),c=r("fXoL"),l=r("oabR"),u=r("aNep"),h=r("3awX"),g=r("/X+5"),p=r("kmnG"),b=r("d3UM"),d=r("3Pt+"),f=r("FKr1"),m=r("lDzL"),v=r("bv9b"),y=r("MT78");let D=(()=>{class t{constructor(){}ngOnInit(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}ngOnChanges(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}setChartOptions(t,e,r,a,n,i){this.chartDom=document.getElementById("main"),this.myChart=y.a(this.chartDom);let s=[];for(var o of a){let t=Object.keys(o)[0];t&&s.push({name:t,type:"bar",stack:"Ad",data:o[t].map(t=>parseFloat(t).toFixed(2))})}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(t){var e=t=>'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+t+'"></span>';let r="<p>"+t[0].axisValue+"</p>",a=0;return t.forEach(t=>{var n="<p>"+e(t.color)+" "+t.seriesName+":  $ "+t.data+"</p>";0!=t.data&&(r+=n),a+=parseFloat(t.data)}),r+="<p>"+e("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>",r}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:n},xAxis:[{type:"category",data:r,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:s},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}convertTimeStampArryToDate(t){let e=[];for(let r=0;r<t.length;r++)e.push(o(t[r]).format("MM-DD-YYYY"));return e}getChartData(t){if(t)return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-reporting-revenue-chart"]],inputs:{chartData:"chartData"},features:[c.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(t,e){1&t&&c.Rb(0,"div",0)},styles:[".demo-chart[_ngcontent-%COMP%]{height:400px}"]}),t})();var S=r("MutI"),F=r("f0Cb");function w(t,e){if(1&t&&(c.Wb(0,"div",1),c.Wb(1,"div",2),c.Wb(2,"div",3),c.Wb(3,"div",4),c.Wb(4,"div",5),c.Wb(5,"h2",6),c.Oc(6,"Selected Statistics"),c.Vb(),c.Vb(),c.Vb(),c.Wb(7,"div",7),c.Wb(8,"mat-list"),c.Wb(9,"mat-list-item"),c.Oc(10),c.mc(11,"number"),c.Vb(),c.Rb(12,"mat-divider"),c.Rb(13,"mat-divider"),c.Wb(14,"mat-list-item"),c.Oc(15),c.mc(16,"number"),c.Vb(),c.Rb(17,"mat-divider"),c.Wb(18,"mat-list-item"),c.Oc(19),c.Vb(),c.Rb(20,"mat-divider"),c.Wb(21,"mat-list-item"),c.Oc(22),c.Vb(),c.Rb(23,"mat-divider"),c.Rb(24,"mat-list-item"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(25,"div",2),c.Wb(26,"div",3),c.Wb(27,"div",4),c.Wb(28,"div",5),c.Wb(29,"h2",6),c.Oc(30,"Month to Date Statistics"),c.Vb(),c.Vb(),c.Vb(),c.Wb(31,"div",7),c.Wb(32,"mat-list"),c.Wb(33,"mat-list-item"),c.Oc(34),c.mc(35,"number"),c.Vb(),c.Rb(36,"mat-divider"),c.Wb(37,"mat-list-item"),c.Oc(38),c.mc(39,"number"),c.Vb(),c.Rb(40,"mat-divider"),c.Wb(41,"mat-list-item"),c.Oc(42),c.mc(43,"number"),c.Vb(),c.Rb(44,"mat-divider"),c.Wb(45,"mat-list-item"),c.Oc(46),c.mc(47,"number"),c.Vb(),c.Rb(48,"mat-divider"),c.Wb(49,"mat-list-item"),c.Oc(50),c.mc(51,"number"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(52,"div",2),c.Wb(53,"div",3),c.Wb(54,"div",4),c.Wb(55,"div",5),c.Wb(56,"h2",6),c.Oc(57,"Last Month Stats"),c.Vb(),c.Vb(),c.Vb(),c.Wb(58,"div",7),c.Wb(59,"mat-list"),c.Wb(60,"mat-list-item"),c.Oc(61),c.mc(62,"number"),c.Vb(),c.Rb(63,"mat-divider"),c.Wb(64,"mat-list-item"),c.Oc(65),c.mc(66,"number"),c.Vb(),c.Rb(67,"mat-divider"),c.Wb(68,"mat-list-item"),c.Oc(69),c.mc(70,"number"),c.Vb(),c.Rb(71,"mat-divider"),c.Wb(72,"mat-list-item"),c.Oc(73),c.mc(74,"number"),c.Vb(),c.Rb(75,"mat-divider"),c.Wb(76,"mat-list-item"),c.Oc(77),c.mc(78,"number"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc();c.Db(10),c.Qc("Revenue: $ ",t.summaryMetricsData.summary[0].selectedStat[0].revenue?c.oc(11,14,t.summaryMetricsData.summary[0].selectedStat[0].revenue,"1.2-2"):"0.00",""),c.Db(5),c.Qc("Profit: $ ",t.summaryMetricsData.summary[0].selectedStat[0].profit?c.oc(16,17,t.summaryMetricsData.summary[0].selectedStat[0].profit,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Start Date: ",t.summaryMetricsData.summary[0].selectedStat[0].selectedStartDate,""),c.Db(3),c.Qc("End Date: ",t.summaryMetricsData.summary[0].selectedStat[0].selectedEndDate,""),c.Db(12),c.Qc("Revenue: $ ",t.summaryMetricsData.summary[0].summaryMetrics[0].revenue?c.oc(35,20,t.summaryMetricsData.summary[0].summaryMetrics[0].revenue,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Revenue Pace: $ ",t.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace?c.oc(39,23,t.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Profit: $ ",t.summaryMetricsData.summary[0].summaryMetrics[0].profit?c.oc(43,26,t.summaryMetricsData.summary[0].summaryMetrics[0].profit,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Profit Pace: $ ",t.summaryMetricsData.summary[0].summaryMetrics[0].profitPace?c.oc(47,29,t.summaryMetricsData.summary[0].summaryMetrics[0].profitPace,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Percentage Change: ",t.summaryMetricsData.summary[0].summaryMetrics[0].percentPace?c.oc(51,32,t.summaryMetricsData.summary[0].summaryMetrics[0].percentPace,"1.2-2"):"0.00"," %"),c.Db(11),c.Qc("Revenue: $ ",t.summaryMetricsData.summary[0].lastMonthStat[0].revenue?c.oc(62,35,t.summaryMetricsData.summary[0].lastMonthStat[0].revenue,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Revenue Pace: $ ",t.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace?c.oc(66,38,t.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace,"2.2-2"):"0.00",""),c.Db(4),c.Qc("Profit: $ ",t.summaryMetricsData.summary[0].lastMonthStat[0].profit?c.oc(70,41,t.summaryMetricsData.summary[0].lastMonthStat[0].profit,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Profit Pace: $ ",t.summaryMetricsData.summary[0].lastMonthStat[0].profitPace?c.oc(74,44,t.summaryMetricsData.summary[0].lastMonthStat[0].profitPace,"1.2-2"):"0.00",""),c.Db(4),c.Qc("Percentage Change: ",t.summaryMetricsData.summary[0].lastMonthStat[0].percentPace?c.oc(78,47,t.summaryMetricsData.summary[0].lastMonthStat[0].percentPace,"1.2-2"):"0.00"," %")}}let M=(()=>{class t{constructor(){}ngOnInit(){this.summaryMetricsData=this.getSummaryData(this.summaryMetricsData)}getSummaryData(t){if(t)return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-summary-metrics"]],inputs:{summaryMetricsData:"summaryMetricsData"},decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-xl-4"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"]],template:function(t,e){1&t&&c.Mc(0,w,79,50,"div",0),2&t&&c.rc("ngIf",e.summaryMetricsData)},directives:[a.p,S.a,S.c,F.a],pipes:[a.g],styles:[""]}),t})();const W=["expandableTable"];function P(t,e){1&t&&(c.Wb(0,"div",32),c.Rb(1,"mat-progress-bar",33),c.Vb())}function V(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",34),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function O(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",35),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function C(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.mc(13,"percent"),c.Vb(),c.Wb(14,"td"),c.Oc(15),c.mc(16,"currency"),c.mc(17,"currency"),c.Vb(),c.Wb(18,"td"),c.Oc(19),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Wb(24,"td"),c.Oc(25),c.mc(26,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr,"2.2-2")||c.oc(13,17,0,"2.2-2")),c.Db(4),c.Pc(c.oc(16,20,t.cpc,"USD")||c.oc(17,23,0,"USD")),c.Db(4),c.Pc(c.oc(20,26,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(23,29,t.profit,"USD")),c.Db(3),c.Pc(c.oc(26,32,t.revenue,"USD"))}}function x(t,e){if(1&t&&(c.Wb(0,"div",38),c.Wb(1,"table",39),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,C,27,35,"tr",40),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function _(t,e){1&t&&(c.Wb(0,"div",41),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function T(t,e){if(1&t&&(c.Mc(0,x,22,1,"div",36),c.Mc(1,_,6,0,"div",37)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function R(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",42),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function k(t,e){1&t&&c.Oc(0," Date ")}function I(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function N(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",43),c.Mc(1,k,1,0,"ng-template",24),c.Mc(2,I,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function L(t,e){1&t&&c.Oc(0," Subid ")}function j(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function A(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",44),c.Mc(1,L,1,0,"ng-template",24),c.Mc(2,j,2,1,"ng-template",17),c.Vb())}function z(t,e){1&t&&c.Oc(0," Publisher ")}function E(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Y(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,z,1,0,"ng-template",24),c.Mc(2,E,2,1,"ng-template",17),c.Vb())}function H(t,e){1&t&&c.Oc(0," Clicks ")}function U(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function B(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",46),c.Mc(1,H,1,0,"ng-template",24),c.Mc(2,U,3,3,"ng-template",17),c.Vb())}function Q(t,e){1&t&&c.Oc(0," Searches ")}function G(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function q(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",47),c.Mc(1,Q,1,0,"ng-template",24),c.Mc(2,G,3,3,"ng-template",17),c.Vb())}function $(t,e){1&t&&c.Oc(0," Filtering ")}function K(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function X(t,e){1&t&&c.Oc(0," Impressions ")}function Z(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function J(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",48),c.Mc(1,X,1,0,"ng-template",24),c.Mc(2,Z,3,3,"ng-template",17),c.Vb())}function tt(t,e){1&t&&c.Oc(0," CPC ")}function et(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"1.2-2"))}}function rt(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",49),c.Mc(1,tt,1,0,"ng-template",24),c.Mc(2,et,3,4,"ng-template",17),c.Vb())}function at(t,e){1&t&&c.Oc(0," CTR ")}function nt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"1.2-2"))}}function it(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",50),c.Mc(1,at,1,0,"ng-template",24),c.Mc(2,nt,3,4,"ng-template",17),c.Vb())}function st(t,e){1&t&&c.Oc(0," Split ")}function ot(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ct(t,e){1&t&&c.Oc(0," Publisher Net ")}function lt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function ut(t,e){1&t&&c.Oc(0," Profit ")}function ht(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function gt(t,e){1&t&&c.Oc(0," Revenue ")}function pt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let bt=(()=>{class t{constructor(t,e,r,a){this.cdr=t,this.userService=e,this.apptitudeService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.cdr.detectChanges()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}getAllApptitudeStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.apptitudeService.getApptitudeStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher"})),this.tagList))if("apptitude"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher")}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher")}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher")}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher")});return this.allStats}))}getSelectedCompanyStored(){return this.userService.getSelectedCompanyFromLocalStorage()}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.cdr.detectChanges()}))}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].filtering+=parseFloat(r.filtering?r.filtering:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks,r.ctr=r.clicks/r.searches,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.detectChanges()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].filtering+=parseFloat(r.filtering?r.filtering:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks,r.ctr=r.clicks/r.searches;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].filtering+=parseFloat(r.filtering?r.filtering:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks,r.ctr=r.clicks/r.searches,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].impressions+=parseFloat(r.impressions?r.impressions:0),e[a].filtering+=parseFloat(r.filtering?r.filtering:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].impressions+=parseFloat(r.impressions?r.impressions:0),e[a].filtering+=parseFloat(r.filtering?r.filtering:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.apptitudeService.getApptitudeStats(t,e,r).toPromise();for(var a of(this.loadingIndicator=!1,this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher"})),this.tagList))if("apptitude"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher")}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher")}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher")}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher")});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].searches+=parseInt(e.searches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const t=yield this.apptitudeService.getSummaryMetrics(this.selectedCompany,e,r).toPromise();var a={},n=0,i=0,s=0;return 0!=t.summary[0].lastMonthStat[0].profitPace&&(n=(t.summary[0].summaryMetrics[0].profitPace-t.summary[0].lastMonthStat[0].profitPace)/t.summary[0].lastMonthStat[0].profitPace*100),0!=t.summary[0].twoLastMonthStat[0].profitPace&&(i=(t.summary[0].lastMonthStat[0].profitPace-t.summary[0].twoLastMonthStat[0].profitPace)/t.summary[0].twoLastMonthStat[0].profitPace*100),0!=t.summary[0].prevSelectedStat[0].profitPace&&(s=(t.summary[0].selectedStat[0].profitPace-t.summary[0].prevSelectedStat[0].profitPace)/t.summary[0].prevSelectedStat[0].profitPace*100),t.summary[0].summaryMetrics[0].percentPace=n,t.summary[0].lastMonthStat[0].percentPace=i,t.summary[0].selectedStat[0].percentPace=s,t.summary[0].selectedStat[0].selectedStartDate=e,t.summary[0].selectedStat[0].selectedEndDate=r,a.summary=t.summary,a}))}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(u.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-apptitude"]],viewQuery:function(t,e){var r;1&t&&c.Tc(W,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:47,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","clicks",4,"ngIf"],["name","searches",4,"ngIf"],["name","filtering"],["ngx-datatable-header-template",""],["name","impressions",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","split"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher"],["name","clicks"],["name","searches"],["name","impressions"],["name","cpc"],["name","ctr"]],template:function(t,e){1&t&&(c.Mc(0,P,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,V,1,1,"app-reporting-revenue-chart",2),c.Mc(3,O,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,T,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,R,1,4,"ng-template",17),c.Vb(),c.Mc(24,N,3,1,"ngx-datatable-column",18),c.Mc(25,A,3,0,"ngx-datatable-column",19),c.Mc(26,Y,3,0,"ngx-datatable-column",20),c.Mc(27,B,3,0,"ngx-datatable-column",21),c.Mc(28,q,3,0,"ngx-datatable-column",22),c.Wb(29,"ngx-datatable-column",23),c.Mc(30,$,1,0,"ng-template",24),c.Mc(31,K,3,3,"ng-template",17),c.Vb(),c.Mc(32,J,3,0,"ngx-datatable-column",25),c.Mc(33,rt,3,0,"ngx-datatable-column",26),c.Mc(34,it,3,0,"ngx-datatable-column",27),c.Wb(35,"ngx-datatable-column",28),c.Mc(36,st,1,0,"ng-template",24),c.Mc(37,ot,3,3,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",29),c.Mc(39,ct,1,0,"ng-template",24),c.Mc(40,lt,3,4,"ng-template",17),c.Vb(),c.Wb(41,"ngx-datatable-column",30),c.Mc(42,ut,1,0,"ng-template",24),c.Mc(43,ht,3,4,"ng-template",17),c.Vb(),c.Wb(44,"ngx-datatable-column",31),c.Mc(45,gt,1,0,"ng-template",24),c.Mc(46,pt,3,4,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(4),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();var dt=r("XJ1K");const ft=["expandableTable"];function mt(t,e){1&t&&(c.Wb(0,"div",27),c.Rb(1,"mat-progress-bar",28),c.Vb())}function vt(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",29),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function yt(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",30),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Dt(t,e){1&t&&(c.Wb(0,"div",31),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function St(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",32),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Ft(t,e){1&t&&c.Oc(0," Date ")}function wt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Mt(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",33),c.Mc(1,Ft,1,0,"ng-template",17),c.Mc(2,wt,3,3,"ng-template",13),c.Vb()),2&t&&c.rc("minWidth",100)}function Wt(t,e){1&t&&c.Oc(0," Subid ")}function Pt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Vt(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",34),c.Mc(1,Wt,1,0,"ng-template",17),c.Mc(2,Pt,2,1,"ng-template",13),c.Vb())}function Ot(t,e){1&t&&c.Oc(0," Publisher ")}function Ct(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function xt(t,e){1&t&&c.Oc(0," Searches ")}function _t(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Tt(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",35),c.Mc(1,xt,1,0,"ng-template",17),c.Mc(2,_t,3,3,"ng-template",13),c.Vb())}function Rt(t,e){1&t&&c.Oc(0," Clicks ")}function kt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function It(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",36),c.Mc(1,Rt,1,0,"ng-template",17),c.Mc(2,kt,3,3,"ng-template",13),c.Vb())}function Nt(t,e){1&t&&c.Oc(0," Coverage ")}function Lt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function jt(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",37),c.Mc(1,Nt,1,0,"ng-template",17),c.Mc(2,Lt,3,3,"ng-template",13),c.Vb())}function At(t,e){1&t&&c.Oc(0," PPC ")}function zt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Et(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",38),c.Mc(1,At,1,0,"ng-template",17),c.Mc(2,zt,3,3,"ng-template",13),c.Vb())}function Yt(t,e){1&t&&c.Oc(0," TQ ")}function Ht(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ut(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",39),c.Mc(1,Yt,1,0,"ng-template",17),c.Mc(2,Ht,3,3,"ng-template",13),c.Vb())}function Bt(t,e){1&t&&c.Oc(0," Split ")}function Qt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}function Gt(t,e){1&t&&c.Oc(0," Publisher Net ")}function qt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function $t(t,e){1&t&&c.Oc(0," Profit ")}function Kt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Xt(t,e){1&t&&c.Oc(0," Revenue ")}function Zt(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let Jt=(()=>{class t{constructor(t,e,r,a){this.cdr=t,this.userService=e,this.hopkinService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.expanded={},this.tagList=[],this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}getAllHopkinStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.hopkinService.getHopkinStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("hopkins"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].ppc+=parseFloat(r.ppc?r.ppc:0),t[a].tq+=parseFloat(r.tq?r.tq:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter;this.rows=e,this.groupPublishFlag=!0,this.cdr.markForCheck()}backProvider(){this.rows=this.allStats,this.groupPublishFlag=!1,this.cdr.markForCheck()}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.loadingIndicator=!1,this.refreshTable()}))}getSelectedCompanyStored(){return this.userService.getSelectedCompanyFromLocalStorage()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}refreshTable(){this.cdr.markForCheck()}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.hopkinService.getHopkinStats(t,e,r).toPromise();for(var a of(this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("hopkins"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].searches+=parseInt(e.searches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.hopkinService.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(dt.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-hopkins"]],viewQuery:function(t,e){var r;1&t&&c.Tc(ft,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:38,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row","px-6"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"btn","btn-sm","btn-dark","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ppc",4,"ngIf"],["name","tq",4,"ngIf"],["name","split",3,"minWidth"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","searches"],["name","clicks"],["name","coverage"],["name","ppc"],["name","tq"]],template:function(t,e){1&t&&(c.Mc(0,mt,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,vt,1,1,"app-reporting-revenue-chart",2),c.Mc(3,yt,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"button",5),c.hc("click",(function(){return e.groupProvider()})),c.Oc(6," Group "),c.Vb(),c.Wb(7,"button",6),c.hc("click",(function(){return e.backProvider()})),c.Oc(8," Back "),c.Vb(),c.Vb(),c.Wb(9,"ngx-datatable",7,8),c.Wb(11,"ngx-datatable-row-detail",9,10),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(13,Dt,6,0,"ng-template",11),c.Vb(),c.Wb(14,"ngx-datatable-column",12),c.Mc(15,St,1,4,"ng-template",13),c.Vb(),c.Mc(16,Mt,3,1,"ngx-datatable-column",14),c.Mc(17,Vt,3,0,"ngx-datatable-column",15),c.Wb(18,"ngx-datatable-column",16),c.Mc(19,Ot,1,0,"ng-template",17),c.Mc(20,Ct,2,1,"ng-template",13),c.Vb(),c.Mc(21,Tt,3,0,"ngx-datatable-column",18),c.Mc(22,It,3,0,"ngx-datatable-column",19),c.Mc(23,jt,3,0,"ngx-datatable-column",20),c.Mc(24,Et,3,0,"ngx-datatable-column",21),c.Mc(25,Ut,3,0,"ngx-datatable-column",22),c.Wb(26,"ngx-datatable-column",23),c.Mc(27,Bt,1,0,"ng-template",17),c.Mc(28,Qt,4,6,"ng-template",13),c.Vb(),c.Wb(29,"ngx-datatable-column",24),c.Mc(30,Gt,1,0,"ng-template",17),c.Mc(31,qt,3,4,"ng-template",13),c.Vb(),c.Wb(32,"ngx-datatable-column",25),c.Mc(33,$t,1,0,"ng-template",17),c.Mc(34,Kt,3,4,"ng-template",13),c.Vb(),c.Wb(35,"ngx-datatable-column",26),c.Mc(36,Xt,1,0,"ng-template",17),c.Mc(37,Zt,3,4,"ng-template",13),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight",100),c.Db(3),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("minWidth",100),c.Db(3),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag),c.Db(1),c.rc("minWidth",35))},directives:[a.p,g.a,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M],pipes:[a.f,a.g,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();const te=["expandableTable"];function ee(t,e){1&t&&(c.Wb(0,"div",23),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function re(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",24),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function ae(t,e){1&t&&c.Oc(0," Publisher ")}function ne(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function ie(t,e){1&t&&c.Oc(0," Tag ")}function se(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function oe(t,e){1&t&&c.Oc(0," Total Searches ")}function ce(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function le(t,e){1&t&&c.Oc(0," Monetized Searches ")}function ue(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function he(t,e){1&t&&c.Oc(0," Clicks ")}function ge(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function pe(t,e){1&t&&c.Oc(0," Follow On ")}function be(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function de(t,e){if(1&t&&(c.Wb(0,"span"),c.Oc(1),c.Vb()),2&t){const t=e.column;c.Db(1),c.Pc(t.name)}}function fe(t,e){if(1&t&&(c.Rb(0,"strong",25),c.mc(1,"percent")),2&t){const t=e.row;c.rc("innerHTML",c.oc(1,1,t.clicks/t.totalSearches,"2.2-2"),c.Ec)}}function me(t,e){1&t&&c.Oc(0," Revenue ")}function ve(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let ye=(()=>{class t{constructor(){this.rows=[{name:"Greg",tag:"YHS Organic",totalSearches:"536412",monetizedSearches:"501235",revenue:"52623",clicks:50351,followOn:"13%"}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}ngOnInit(){}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-imgage-advantage"]],viewQuery:function(t,e){var r;1&t&&c.Tc(te,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:70,vars:13,consts:[[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","followOn"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(t,e){1&t&&(c.Wb(0,"div",0),c.Wb(1,"div",1),c.Wb(2,"div",2),c.Wb(3,"div",3),c.Wb(4,"div",4),c.Wb(5,"h2",5),c.Oc(6,"Month to Date Stats"),c.Vb(),c.Vb(),c.Vb(),c.Wb(7,"div",6),c.Wb(8,"mat-list"),c.Wb(9,"mat-list-item"),c.Oc(10,"Revenue: $103,201.26"),c.Vb(),c.Rb(11,"mat-divider"),c.Wb(12,"mat-list-item"),c.Oc(13,"Revenue Pace: $131,285.19"),c.Vb(),c.Rb(14,"mat-divider"),c.Wb(15,"mat-list-item"),c.Oc(16,"Profit: $21,109.59"),c.Vb(),c.Rb(17,"mat-divider"),c.Wb(18,"mat-list-item"),c.Oc(19,"Profit Pace: $173,121.45"),c.Vb(),c.Rb(20,"mat-divider"),c.Wb(21,"mat-list-item"),c.Oc(22,"Percentage Change: +27%"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(23,"div",1),c.Wb(24,"div",2),c.Wb(25,"div",3),c.Wb(26,"div",4),c.Wb(27,"h2",5),c.Oc(28,"Last Month Stats"),c.Vb(),c.Vb(),c.Vb(),c.Wb(29,"div",6),c.Wb(30,"mat-list"),c.Wb(31,"mat-list-item"),c.Oc(32,"Revenue: $113,542.23"),c.Vb(),c.Rb(33,"mat-divider"),c.Wb(34,"mat-list-item"),c.Oc(35,"Profit: $14,121.39"),c.Vb(),c.Rb(36,"mat-divider"),c.Wb(37,"mat-list-item"),c.Oc(38,"Percentage Change: +11%"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(39,"ngx-datatable",7,8),c.Wb(41,"ngx-datatable-row-detail",9,10),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(43,ee,6,0,"ng-template",11),c.Vb(),c.Wb(44,"ngx-datatable-column",12),c.Mc(45,re,1,4,"ng-template",13),c.Vb(),c.Wb(46,"ngx-datatable-column",14),c.Mc(47,ae,1,0,"ng-template",15),c.Mc(48,ne,2,1,"ng-template",13),c.Vb(),c.Wb(49,"ngx-datatable-column",16),c.Mc(50,ie,1,0,"ng-template",15),c.Mc(51,se,2,1,"ng-template",13),c.Vb(),c.Wb(52,"ngx-datatable-column",17),c.Mc(53,oe,1,0,"ng-template",15),c.Mc(54,ce,3,3,"ng-template",13),c.Vb(),c.Wb(55,"ngx-datatable-column",18),c.Mc(56,le,1,0,"ng-template",15),c.Mc(57,ue,3,3,"ng-template",13),c.Vb(),c.Wb(58,"ngx-datatable-column",19),c.Mc(59,he,1,0,"ng-template",15),c.Mc(60,ge,3,3,"ng-template",13),c.Vb(),c.Wb(61,"ngx-datatable-column",20),c.Mc(62,pe,1,0,"ng-template",15),c.Mc(63,be,2,1,"ng-template",13),c.Vb(),c.Wb(64,"ngx-datatable-column",21),c.Mc(65,de,2,1,"ng-template",15),c.Mc(66,fe,2,4,"ng-template",13),c.Vb(),c.Wb(67,"ngx-datatable-column",22),c.Mc(68,me,1,0,"ng-template",15),c.Mc(69,ve,3,4,"ng-template",13),c.Vb(),c.Vb()),2&t&&(c.Db(39),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",e.rows),c.Db(2),c.rc("rowHeight",100),c.Db(3),c.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[S.a,S.c,F.a,m.d,m.e,m.f,m.b,m.a,m.c],pipes:[a.g,a.w,a.d],styles:[""]}),t})(),De=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-media-net"]],decls:2,vars:0,template:function(t,e){1&t&&(c.Wb(0,"p"),c.Oc(1,"media-net works!"),c.Vb())},styles:[""]}),t})();var Se=r("0TA1"),Fe=r("SHm6"),we=r("qFsG");const Me=["expandableTable"];function We(t,e){1&t&&(c.Wb(0,"div",35),c.Rb(1,"mat-progress-bar",36),c.Vb())}function Pe(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",37),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function Ve(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",38),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Oe(t,e){if(1&t&&(c.Wb(0,"mat-option",39),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.label," ")}}function Ce(t,e){if(1&t){const t=c.Xb();c.Wb(0,"div",5),c.Wb(1,"mat-form-field",6),c.Wb(2,"mat-label"),c.Oc(3,"Condition"),c.Vb(),c.Wb(4,"mat-select",7),c.hc("selectionChange",(function(e){return c.Dc(t),c.lc().filterConditionHandle(e)}))("ngModelChange",(function(e){return c.Dc(t),c.lc().filterCondition=e})),c.Wb(5,"mat-option",40),c.Oc(6,"Greater Than"),c.Vb(),c.Wb(7,"mat-option",41),c.Oc(8,"Less Than"),c.Vb(),c.Vb(),c.Vb(),c.Vb()}if(2&t){const t=c.lc();c.Db(4),c.rc("ngModel",t.filterCondition)}}function xe(t,e){if(1&t){const t=c.Xb();c.Wb(0,"div",5),c.Wb(1,"mat-form-field",42),c.Wb(2,"mat-label"),c.Oc(3,"Filter Amount"),c.Vb(),c.Wb(4,"input",43),c.hc("ngModelChange",(function(e){return c.Dc(t),c.lc().filterAmount=e}))("input",(function(){return c.Dc(t),c.lc().updateFilterAmount()})),c.Vb(),c.Vb(),c.Vb()}if(2&t){const t=c.lc();c.Db(4),c.rc("ngModel",t.filterAmount)}}function _e(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"number"),c.Vb(),c.Wb(13,"td"),c.Oc(14),c.mc(15,"percent"),c.mc(16,"percent"),c.Vb(),c.Wb(17,"td"),c.Oc(18),c.mc(19,"currency"),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Wb(24,"td"),c.Oc(25),c.mc(26,"currency"),c.Vb(),c.Wb(27,"td"),c.Oc(28),c.mc(29,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,9,t.date)),c.Db(3),c.Pc(c.nc(6,11,t.totalsearches)),c.Db(3),c.Pc(c.nc(9,13,t.impressions)),c.Db(3),c.Pc(c.nc(12,15,t.clicks)),c.Db(3),c.Pc(c.oc(15,17,t.ctr,"2.2-2")||c.oc(16,20,0,"2.2-2")),c.Db(4),c.Pc(c.oc(19,23,t.cpc,"USD")||c.oc(20,26,0,"USD")),c.Db(4),c.Pc(c.oc(23,29,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(26,32,t.profit,"USD")),c.Db(3),c.Pc(c.oc(29,35,t.revenue,"USD"))}}function Te(t,e){if(1&t&&(c.Wb(0,"div",46),c.Wb(1,"table",47),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Impressions"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"Clicks"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CTR"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"CPC"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Publisher Net"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Profit"),c.Vb(),c.Wb(20,"th"),c.Oc(21,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(22,"tbody"),c.Mc(23,_e,30,38,"tr",48),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(23),c.rc("ngForOf",t.subReportingForDate)}}function Re(t,e){1&t&&(c.Wb(0,"div",49),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function ke(t,e){if(1&t&&(c.Mc(0,Te,24,1,"div",44),c.Mc(1,Re,6,0,"div",45)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function Ie(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",50),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Ne(t,e){1&t&&c.Oc(0," Date ")}function Le(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function je(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",51),c.Mc(1,Ne,1,0,"ng-template",33),c.Mc(2,Le,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Ae(t,e){1&t&&c.Oc(0," Subid ")}function ze(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ee(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",52),c.Mc(1,Ae,1,0,"ng-template",33),c.Mc(2,ze,2,1,"ng-template",17),c.Vb())}function Ye(t,e){1&t&&c.Oc(0," Publisher ")}function He(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ue(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",53),c.Mc(1,Ye,1,0,"ng-template",33),c.Mc(2,He,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Be(t,e){1&t&&c.Oc(0," Monetized Searches ")}function Qe(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ge(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",54),c.Mc(1,Be,1,0,"ng-template",33),c.Mc(2,Qe,3,3,"ng-template",17),c.Vb())}function qe(t,e){1&t&&c.Oc(0," Searches ")}function $e(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ke(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",55),c.Mc(1,qe,1,0,"ng-template",33),c.Mc(2,$e,3,3,"ng-template",17),c.Vb())}function Xe(t,e){1&t&&c.Oc(0," Impressions ")}function Ze(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Je(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",56),c.Mc(1,Xe,1,0,"ng-template",33),c.Mc(2,Ze,3,3,"ng-template",17),c.Vb())}function tr(t,e){1&t&&c.Oc(0," Clicks ")}function er(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function rr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",57),c.Mc(1,tr,1,0,"ng-template",33),c.Mc(2,er,3,3,"ng-template",17),c.Vb())}function ar(t,e){1&t&&c.Oc(0," CPC ")}function nr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.mc(3,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD")||c.oc(3,4,0,"USD"))}}function ir(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",58),c.Mc(1,ar,1,0,"ng-template",33),c.Mc(2,nr,4,7,"ng-template",17),c.Vb())}function sr(t,e){1&t&&c.Oc(0," CTR ")}function or(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"percent"),c.mc(3,"percent"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"2.2-2")||c.oc(3,4,0,"2.2-2"))}}function cr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",59),c.Mc(1,sr,1,0,"ng-template",33),c.Mc(2,or,4,7,"ng-template",17),c.Vb())}function lr(t,e){1&t&&c.Oc(0," Bing Coverage ")}function ur(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Qc("",c.nc(2,1,t)," %")}}function hr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",60),c.Mc(1,lr,1,0,"ng-template",33),c.Mc(2,ur,3,3,"ng-template",17),c.Vb())}function gr(t,e){1&t&&c.Oc(0," CF Coverage ")}function pr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Qc("",c.nc(2,1,t)," %")}}function br(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",61),c.Mc(1,gr,1,0,"ng-template",33),c.Mc(2,pr,3,3,"ng-template",17),c.Vb())}function dr(t,e){1&t&&c.Oc(0," Follow On ")}function fr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"1.2-2"))}}function mr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",62),c.Mc(1,dr,1,0,"ng-template",33),c.Mc(2,fr,3,4,"ng-template",17),c.Vb())}function vr(t,e){1&t&&c.Oc(0," Publisher Net ")}function yr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Dr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",63),c.Mc(1,vr,1,0,"ng-template",33),c.Mc(2,yr,3,4,"ng-template",17),c.Vb())}function Sr(t,e){1&t&&c.Oc(0," Profit ")}function Fr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function wr(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",64),c.Mc(1,Sr,1,0,"ng-template",33),c.Mc(2,Fr,3,4,"ng-template",17),c.Vb())}function Mr(t,e){1&t&&c.Oc(0," Revenue ")}function Wr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Pr(t,e){1&t&&c.Oc(0," Split ")}function Vr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}function Or(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",65),c.Mc(1,Pr,1,0,"ng-template",33),c.Mc(2,Vr,4,6,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",35)}let Cr=(()=>{class t{constructor(t,e,r,a,n,i,s,o){this.perionService=t,this.cdr=e,this.userService=r,this.tagService=a,this.exportDataService=n,this.datePipe=i,this.currencyPipe=s,this.percentPipe=o,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.summary={revenue:0,profit:0},this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.showFilterAmount=!1,this.filterCondition="",this.groupType="",this.groupbyList=[{value:"date",label:"Date"},{value:"publisher",label:"Publisher"},{value:"subid",label:"Subid"},{value:"bestBingCoverage",label:"Best Bing Coverage"},{value:"worstBingCoverage",label:"Worst Bing Coverage"},{value:"bestCFCoverage",label:"Best CF Coverage"},{value:"worstCFCoverage",label:"Worst CF Coverage"},{value:"reset",label:"Reset"}],this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],yield this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.defaultGroupProvider(),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}updateAllPerionStats(t,e,r){this.perionService.updateAllPerionStats(t,e,r).subscribe(t=>{})}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],yield this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.defaultGroupProvider(),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.loadingIndicator=!1,this.refreshTable()}))}getAllPerionStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const i=yield this.perionService.getAllPerionStats(t,e,r).toPromise();for(var a of(console.log("response:",i),this.loadingIndicator=!1,this.allStat=i.stats,this.allStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("perion"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});return this.allStat}catch(i){return i}}))}groupDate(){var t={},e=this.allStat.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),t[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),t[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].followon+=parseFloat(r.followon?r.followon:0),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.followon=r.followon/r.counter,r.ctr=r.clicks/r.impressions,r.cpc=r.revenue/r.clicks,r.bingCoverage=r.bingCoverage/r.counter,r.cfCoverage=r.cfCoverage/r.counter;this.rows=e,this.groupDateShowFlag=!0,this.groupPublishFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStat.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),t[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),t[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].followon+=parseFloat(r.followon?r.followon:0),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.followon=r.followon/r.counter,r.ctr=r.clicks/r.impressions,r.cpc=r.revenue/r.clicks,r.bingCoverage=r.bingCoverage/r.counter,r.cfCoverage=r.cfCoverage/r.counter,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}defaultGroupProvider(){var t={},e=this.allStat.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].monetizedsearches+=parseFloat(r.monetizedsearches?r.monetizedsearches:0),t[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),t[a].profit+=parseFloat(r.profit),t[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),t[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].followon+=parseFloat(r.followon?r.followon:0),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.followon=r.followon/r.counter,r.ctr=r.clicks/r.impressions,r.cpc=r.revenue/r.clicks,r.bingCoverage=r.bingCoverage/r.counter,r.cfCoverage=r.cfCoverage/r.counter,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.groupType="publisher"}groupProvider(){var t={},e=this.allStat.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].impressions+=parseFloat(r.impressions?r.impressions:0),t[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),t[a].profit+=parseFloat(r.profit),t[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),t[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].followon+=parseFloat(r.followon?r.followon:0),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.followon=r.followon/r.counter,r.ctr=r.clicks/r.impressions,r.cpc=r.revenue/r.clicks,r.bingCoverage=r.bingCoverage/r.counter,r.cfCoverage=r.cfCoverage/r.counter,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}backGroup(){this.rows=this.allStat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStat.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].impressions+=parseFloat(r.impressions?r.impressions:0),e[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),e[a].profit+=parseFloat(r.profit),e[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),e[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].followon+=parseFloat(r.followon?r.followon:0),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.followon=t.followon/t.counter,t.ctr=t.clicks/t.impressions,t.cpc=t.revenue/t.clicks,t.bingCoverage=t.bingCoverage/t.counter,t.cfCoverage=t.cfCoverage/t.counter;return r}groupDateForSubid(t){var e={},r=this.allStat.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].impressions+=parseFloat(r.impressions?r.impressions:0),e[a].totalsearches+=parseFloat(r.totalsearches?r.totalsearches:0),e[a].profit+=parseFloat(r.profit),e[a].bingCoverage+=parseFloat(r.bingCoverage?r.bingCoverage:0),e[a].cfCoverage+=parseFloat(r.cfCoverage?r.cfCoverage:0),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].followon+=parseFloat(r.followon?r.followon:0),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.followon=t.followon/t.counter,t.ctr=t.clicks/t.impressions,t.cpc=t.revenue/t.clicks,t.bingCoverage=t.bingCoverage/t.counter,t.cfCoverage=t.cfCoverage/t.counter;return r}updateFilterAmount(){this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition)}groupCoverageCondition(t,e,r){var a={},n=this.allStat.reduce((function(t,e){var r=e.date+"-"+e.subid+"-"+e.publisher;return a[r]?(a[r].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),a[r].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),a[r].revenue+=parseFloat(e.revenue),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]);for(var i of n)i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter;"worstBingCoverage"==t?(this.rows=e>0&&""!=r?"greater"==r?n.sort((t,e)=>t.bingCoverage-e.bingCoverage).filter(t=>t.revenue>=e):n.sort((t,e)=>t.bingCoverage-e.bingCoverage).filter(t=>t.revenue<=e):n.sort((t,e)=>t.bingCoverage-e.bingCoverage),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestBingCoverage"==t?(this.rows=e>0&&""!=r?"greater"==r?n.sort((t,e)=>e.bingCoverage-t.bingCoverage).filter(t=>t.revenue>=e):n.sort((t,e)=>e.bingCoverage-t.bingCoverage).filter(t=>t.revenue<=e):n.sort((t,e)=>e.bingCoverage-t.bingCoverage),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestCFCoverage"==t?(this.rows=e>0&&""!=r?"greater"==r?n.sort((t,e)=>e.cfCoverage-t.cfCoverage).filter(t=>t.revenue>=e):n.sort((t,e)=>e.cfCoverage-t.cfCoverage).filter(t=>t.revenue<=e):n.sort((t,e)=>e.cfCoverage-t.cfCoverage),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0):(this.rows=e>0&&""!=r?"greater"==r?n.sort((t,e)=>t.cfCoverage-e.cfCoverage).filter(t=>t.revenue>=e):n.sort((t,e)=>t.cfCoverage-e.cfCoverage).filter(t=>t.revenue<=e):n.sort((t,e)=>t.cfCoverage-e.cfCoverage),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!0,this.cdr.markForCheck()}filterConditionHandle(t){this.filterCondition=t.value,this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition),this.cdr.markForCheck()}groupHandle(t){this.groupType=t.value,this.showFilterAmount=!1,this.filterAmount=0,this.filterCondition="","date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():"worstBingCoverage"==t.value||"bestBingCoverage"==t.value||"bestCFCoverage"==t.value||"worstCFCoverage"==t.value?(this.showFilterAmount=!0,this.groupCoverageCondition(t.value,this.filterAmount,this.filterCondition)):this.backGroup(),this.cdr.markForCheck()}refreshTable(){this.cdr.markForCheck()}exportToCsv(){let t=[];if("date"==this.groupType)for(let r of this.rows){let e={date:this.datePipe.transform(r.date,"dd MMM yyyy"),followOn:r.followon,publisherNet:this.currencyPipe.transform(r.publisherNet?r.publisherNet:0),profit:this.currencyPipe.transform(r.profit?r.profit:0),revenue:this.currencyPipe.transform(r.revenue?r.revenue:0),split:r.split};t.push(e)}else if("publisher"==this.groupType)for(let r of this.rows){let e={publisher:r.publisher,followOn:r.followon,publisherNet:this.currencyPipe.transform(r.publisherNet?r.publisherNet:0),profit:this.currencyPipe.transform(r.profit?r.profit:0),revenue:this.currencyPipe.transform(r.revenue?r.revenue:0),split:r.split};t.push(e)}else if("subid"==this.groupType)for(let r of this.rows){let e={subid:r.subid,followOn:r.followon,publisherNet:this.currencyPipe.transform(r.publisherNet?r.publisherNet:0),profit:this.currencyPipe.transform(r.profit?r.profit:0),revenue:this.currencyPipe.transform(r.revenue?r.revenue:0),split:r.split};t.push(e)}else if("worstBingCoverage"==this.groupType||"bestBingCoverage"==this.groupType)for(let r of this.rows){let e={date:this.datePipe.transform(r.date,"dd MMM yyyy"),subid:r.subid,publisher:r.publisher,bingCoverage:r.bingCoverage+"%",revenue:this.currencyPipe.transform(r.revenue?r.revenue:0)};t.push(e)}else if("worstCFCoverage"==this.groupType||"bestCFCoverage"==this.groupType)for(let r of this.rows){let e={date:this.datePipe.transform(r.date,"dd MMM yyyy"),subid:r.subid,publisher:r.publisher,cfCoverage:r.cfCoverage+"%",revenue:this.currencyPipe.transform(r.revenue?r.revenue:0)};t.push(e)}else{for(let t of this.rows)t.date=this.datePipe.transform(t.date,"dd MMM yyyy"),t.bingCoverage=t.bingCoverage+"%",t.cfCoverage=t.cfCoverage+"%";t=this.rows}const e=t.length>0?Object.keys(t[0]):[];this.exportDataService.exportToCsv(t,""!==this.groupType?`perion-${this.selectedCompany}-${this.groupType}`:"perion-"+this.selectedCompany,e)}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const o=yield this.perionService.getSummaryMetrics(t,e,r).toPromise();var a={},n=0,i=0,s=0;return 0!=o.summary[0].lastMonthStat[0].profitPace&&(n=(o.summary[0].summaryMetrics[0].profitPace-o.summary[0].lastMonthStat[0].profitPace)/o.summary[0].lastMonthStat[0].profitPace*100),0!=o.summary[0].twoLastMonthStat[0].profitPace&&(i=(o.summary[0].lastMonthStat[0].profitPace-o.summary[0].twoLastMonthStat[0].profitPace)/o.summary[0].twoLastMonthStat[0].profitPace*100),0!=o.summary[0].prevSelectedStat[0].profitPace&&(s=(o.summary[0].selectedStat[0].profitPace-o.summary[0].prevSelectedStat[0].profitPace)/o.summary[0].prevSelectedStat[0].profitPace*100),o.summary[0].summaryMetrics[0].percentPace=n,o.summary[0].lastMonthStat[0].percentPace=i,o.summary[0].selectedStat[0].percentPace=s,o.summary[0].selectedStat[0].selectedStartDate=e,o.summary[0].selectedStat[0].selectedEndDate=r,a.summary=o.summary,a}catch(o){return o}}))}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.perionService.getAllPerionStats(t,e,r).toPromise();for(var a of(this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("perion"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].totalsearches+=parseInt(e.totalsearches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}combineSummaryMetrics(t){t.summary.keys.forEach(t=>{console.log(t.revenue),this.summary.revenue+=t.revenue,this.summary.profit+=t.revenue*(.01*(100-t.split))})}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(Se.a),c.Qb(c.i),c.Qb(l.a),c.Qb(h.a),c.Qb(Fe.a),c.Qb(a.f),c.Qb(a.d),c.Qb(a.w))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-perion"]],viewQuery:function(t,e){var r;1&t&&c.Tc(Me,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:40,vars:35,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-xl-4",4,"ngIf"],[1,"row","py-2"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","monetizedsearches",4,"ngIf"],["name","totalsearches",4,"ngIf"],["name","impressions",4,"ngIf"],["name","clicks",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","bingCoverage",4,"ngIf"],["name","cfCoverage",4,"ngIf"],["name","followon",4,"ngIf"],["name","publisherNet",4,"ngIf"],["name","profit",4,"ngIf"],["name","revenue"],["ngx-datatable-header-template",""],["name","split",3,"minWidth",4,"ngIf"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[3,"value"],["value","greater"],["value","less"],["appearance","outline",1,"custom-mat-input"],["matInput","","type","number","min","0",3,"ngModel","ngModelChange","input"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","monetizedsearches"],["name","totalsearches"],["name","impressions"],["name","clicks"],["name","cpc"],["name","ctr"],["name","bingCoverage"],["name","cfCoverage"],["name","followon"],["name","publisherNet"],["name","profit"],["name","split",3,"minWidth"]],template:function(t,e){1&t&&(c.Mc(0,We,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,Pe,1,1,"app-reporting-revenue-chart",2),c.Mc(3,Ve,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Mc(10,Oe,2,2,"mat-option",8),c.Vb(),c.Vb(),c.Vb(),c.Mc(11,Ce,9,1,"div",9),c.Mc(12,xe,5,1,"div",9),c.Vb(),c.Wb(13,"div",10),c.Wb(14,"button",11),c.hc("click",(function(){return e.exportToCsv()})),c.Oc(15," Export Stats "),c.Vb(),c.Vb(),c.Wb(16,"ngx-datatable",12,13),c.Wb(18,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(19,ke,2,2,"ng-template",15),c.Vb(),c.Wb(20,"ngx-datatable-column",16),c.Mc(21,Ie,1,4,"ng-template",17),c.Vb(),c.Mc(22,je,3,1,"ngx-datatable-column",18),c.Mc(23,Ee,3,0,"ngx-datatable-column",19),c.Mc(24,Ue,3,1,"ngx-datatable-column",20),c.Mc(25,Ge,3,0,"ngx-datatable-column",21),c.Mc(26,Ke,3,0,"ngx-datatable-column",22),c.Mc(27,Je,3,0,"ngx-datatable-column",23),c.Mc(28,rr,3,0,"ngx-datatable-column",24),c.Mc(29,ir,3,0,"ngx-datatable-column",25),c.Mc(30,cr,3,0,"ngx-datatable-column",26),c.Mc(31,hr,3,0,"ngx-datatable-column",27),c.Mc(32,br,3,0,"ngx-datatable-column",28),c.Mc(33,mr,3,0,"ngx-datatable-column",29),c.Mc(34,Dr,3,0,"ngx-datatable-column",30),c.Mc(35,wr,3,0,"ngx-datatable-column",31),c.Wb(36,"ngx-datatable-column",32),c.Mc(37,Mr,1,0,"ng-template",33),c.Mc(38,Wr,3,4,"ng-template",17),c.Vb(),c.Mc(39,Or,3,1,"ngx-datatable-column",34),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(1),c.rc("ngForOf",e.groupbyList),c.Db(1),c.rc("ngIf",e.showFilterAmount),c.Db(1),c.rc("ngIf",e.showFilterAmount),c.Db(4),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag&&!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),c.Db(1),c.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag&&!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag&&!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag&&!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCFCoverageFlag)),c.Db(1),c.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupBingCoverageFlag)),c.Db(1),c.rc("ngIf",!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!e.groupCoverageFlag),c.Db(1),c.rc("ngIf",!e.groupCoverageFlag),c.Db(4),c.rc("ngIf",!e.groupCoverageFlag))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,a.o,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,f.p,we.b,d.v,d.d],pipes:[a.f,a.g,a.w,a.d],styles:[".mat-form-field-appearance-outline .mat-form-field-outline{background-color:#fff;border-radius:5px}.loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})(),xr=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-reporting"]],decls:1,vars:0,template:function(t,e){1&t&&c.Rb(0,"router-outlet")},directives:[n.l],encapsulation:2}),t})();const _r=["expandableTable"];function Tr(t,e){1&t&&(c.Wb(0,"div",17),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function Rr(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",18),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function kr(t,e){1&t&&c.Oc(0," Publisher ")}function Ir(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Nr(t,e){1&t&&c.Oc(0," Tag ")}function Lr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function jr(t,e){1&t&&c.Oc(0," Total Searches ")}function Ar(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function zr(t,e){1&t&&c.Oc(0," Monetized Searches ")}function Er(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Yr(t,e){1&t&&c.Oc(0," Clicks ")}function Hr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ur(t,e){if(1&t&&(c.Wb(0,"span"),c.Oc(1),c.Vb()),2&t){const t=e.column;c.Db(1),c.Pc(t.name)}}function Br(t,e){if(1&t&&(c.Rb(0,"strong",19),c.mc(1,"percent")),2&t){const t=e.row;c.rc("innerHTML",c.oc(1,1,t.clicks/t.totalSearches,"2.2-2"),c.Ec)}}function Qr(t,e){1&t&&c.Oc(0," Revenue ")}function Gr(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let qr=(()=>{class t{constructor(){this.rows=[{name:"Datalox",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Hopkins Branded",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Datalox 2",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}ngOnInit(){let t=Array.from({length:20},()=>Math.floor(4e3*Math.random()+4e3)),e=Array.from({length:20},()=>Math.floor(6e4*Math.random()+4e4));this.setChartOptions(1e4,1e5,["Nov 1, Nov 2, Nov 3, Nov 4","Nov 5","Nov 5","Nov 6","Nov 7","Nov 8","Nov 9","Nov 10","Nov 11","Nov 12","Nov 13","Nov 14","Nov 15","Nov 16","Nov 17","Nov 18","Nov 19","Nov 20"],t,e)}updateReportingFiltering(t){console.log("Report")}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}setChartOptions(t,e,r,a,n){this.chartDom=document.getElementById("main"),this.myChart=y.a(this.chartDom),this.option={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:["Revenue","Searches"]},xAxis:[{type:"category",data:r,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",min:0,max:t,interval:25e3,axisLabel:{formatter:"${value}"}},{type:"value",name:"Searches",min:0,max:e,interval:1e5,axisLabel:{formatter:"{value}"}}],series:[{name:"Revenue",type:"bar",data:a},{name:"Searches",type:"line",yAxisIndex:1,data:n}]},this.option&&this.myChart.setOption(this.option)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-third-party"]],viewQuery:function(t,e){var r;1&t&&c.Tc(_r,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:30,vars:13,consts:[[3,"onDatesPicked"],["id","main",2,"width","100%","height","300px"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(t,e){1&t&&(c.Wb(0,"app-reporting-filtering",0),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Rb(1,"div",1),c.Wb(2,"ngx-datatable",2,3),c.Wb(4,"ngx-datatable-row-detail",4,5),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(6,Tr,6,0,"ng-template",6),c.Vb(),c.Wb(7,"ngx-datatable-column",7),c.Mc(8,Rr,1,4,"ng-template",8),c.Vb(),c.Wb(9,"ngx-datatable-column",9),c.Mc(10,kr,1,0,"ng-template",10),c.Mc(11,Ir,2,1,"ng-template",8),c.Vb(),c.Wb(12,"ngx-datatable-column",11),c.Mc(13,Nr,1,0,"ng-template",10),c.Mc(14,Lr,2,1,"ng-template",8),c.Vb(),c.Wb(15,"ngx-datatable-column",12),c.Mc(16,jr,1,0,"ng-template",10),c.Mc(17,Ar,3,3,"ng-template",8),c.Vb(),c.Wb(18,"ngx-datatable-column",13),c.Mc(19,zr,1,0,"ng-template",10),c.Mc(20,Er,3,3,"ng-template",8),c.Vb(),c.Wb(21,"ngx-datatable-column",14),c.Mc(22,Yr,1,0,"ng-template",10),c.Mc(23,Hr,3,3,"ng-template",8),c.Vb(),c.Wb(24,"ngx-datatable-column",15),c.Mc(25,Ur,2,1,"ng-template",10),c.Mc(26,Br,2,4,"ng-template",8),c.Vb(),c.Wb(27,"ngx-datatable-column",16),c.Mc(28,Qr,1,0,"ng-template",10),c.Mc(29,Gr,3,4,"ng-template",8),c.Vb(),c.Vb()),2&t&&(c.Db(2),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",e.rows),c.Db(2),c.rc("rowHeight",100),c.Db(3),c.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[g.a,m.d,m.e,m.f,m.b,m.a,m.c],pipes:[a.g,a.w,a.d],styles:[""]}),t})(),$r=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-bing-direct"]],decls:2,vars:0,template:function(t,e){1&t&&(c.Wb(0,"p"),c.Oc(1,"bing-direct works!"),c.Vb())},styles:[""]}),t})();var Kr=r("d9f2");const Xr=["expandableTable"];function Zr(t,e){1&t&&(c.Wb(0,"div",31),c.Rb(1,"mat-progress-bar",32),c.Vb())}function Jr(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",33),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function ta(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",34),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetricsData)}}function ea(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.mc(13,"percent"),c.Vb(),c.Wb(14,"td"),c.Oc(15),c.mc(16,"currency"),c.mc(17,"currency"),c.Vb(),c.Wb(18,"td"),c.Oc(19),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Wb(24,"td"),c.Oc(25),c.mc(26,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr,"2.2-2")||c.oc(13,17,0,"2.2-2")),c.Db(4),c.Pc(c.oc(16,20,t.cpc,"USD")||c.oc(17,23,0,"USD")),c.Db(4),c.Pc(c.oc(20,26,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(23,29,t.profit,"USD")),c.Db(3),c.Pc(c.oc(26,32,t.revenue,"USD"))}}function ra(t,e){if(1&t&&(c.Wb(0,"div",37),c.Wb(1,"table",38),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,ea,27,35,"tr",39),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function aa(t,e){1&t&&(c.Wb(0,"div",40),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function na(t,e){if(1&t&&(c.Mc(0,ra,22,1,"div",35),c.Mc(1,aa,6,0,"div",36)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function ia(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",41),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function sa(t,e){1&t&&c.Oc(0," Date ")}function oa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ca(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",42),c.Mc(1,sa,1,0,"ng-template",27),c.Mc(2,oa,3,3,"ng-template",17),c.Vb())}function la(t,e){1&t&&c.Oc(0," Subid ")}function ua(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function ha(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",43),c.Mc(1,la,1,0,"ng-template",27),c.Mc(2,ua,2,1,"ng-template",17),c.Vb())}function ga(t,e){1&t&&c.Oc(0," Publisher ")}function pa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function ba(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",44),c.Mc(1,ga,1,0,"ng-template",27),c.Mc(2,pa,2,1,"ng-template",17),c.Vb())}function da(t,e){1&t&&c.Oc(0," Searches ")}function fa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ma(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,da,1,0,"ng-template",27),c.Mc(2,fa,3,3,"ng-template",17),c.Vb())}function va(t,e){1&t&&c.Oc(0," Bid Searches ")}function ya(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Da(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",46),c.Mc(1,va,1,0,"ng-template",27),c.Mc(2,ya,3,3,"ng-template",17),c.Vb())}function Sa(t,e){1&t&&c.Oc(0," Clicks ")}function Fa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function wa(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",47),c.Mc(1,Sa,1,0,"ng-template",27),c.Mc(2,Fa,3,3,"ng-template",17),c.Vb())}function Ma(t,e){1&t&&c.Oc(0," BiddedCTR ")}function Wa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"2.2-2")||c.oc(3,4,0,"2.2-2"))}}function Pa(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",48),c.Mc(1,Ma,1,0,"ng-template",27),c.Mc(2,Wa,4,7,"ng-template",17),c.Vb())}function Va(t,e){1&t&&c.Oc(0," CTR ")}function Oa(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"2.2-2")||c.oc(3,4,0,"2.2-2"))}}function Ca(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",49),c.Mc(1,Va,1,0,"ng-template",27),c.Mc(2,Oa,4,7,"ng-template",17),c.Vb())}function xa(t,e){1&t&&c.Oc(0," Publisher Net ")}function _a(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Ta(t,e){1&t&&c.Oc(0," Profit ")}function Ra(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function ka(t,e){1&t&&c.Oc(0," Revenue ")}function Ia(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Na(t,e){1&t&&c.Oc(0," Spilt ")}function La(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}let ja=(()=>{class t{constructor(t,e,r,a){this.lyonService=t,this.cdr=e,this.userService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.summary={revenue:0,profit:0},this.loadingIndicator=!0,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.filteredLyonStat=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllLyonStats(this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetricsData=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}getAllLyonStats(t,e){return Object(i.a)(this,void 0,void 0,(function*(){try{const n=yield this.lyonService.getAllStats(t,e).toPromise();for(var r of(this.loadingIndicator=!1,this.allstat=n,this.allstat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("lyons"==r.tag.advertiser)for(var a of r.tag.subids)"Contains"==a.filterTag?this.allstat.map(t=>{t.subid.includes(a.subid)&&(t.publisher=r.user.length?r.user[0].fullname:"No Publisher",t.tagname=r.tag.name)}):"StartsWith"==a.filterTag?this.allstat.map(t=>{t.subid.startsWith(a.subid)&&(t.publisher=r.user.length?r.user[0].fullname:"No Publisher",t.tagname=r.tag.name)}):"EndsWith"==a.filterTag?this.allstat.map(t=>{t.subid.endsWith(a.subid)&&(t.publisher=r.user.length?r.user[0].fullname:"No Publisher",t.tagname=r.tag.name)}):"ExactValue"==a.filterTag&&this.allstat.map(t=>{t.subid==a.subid&&(t.publisher=r.user.length?r.user[0].fullname:"No Publisher",t.tagname=r.tag.name)});return this.allstat}catch(n){return n}}))}groupDate(){var t={},e=this.allstat.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].biddedCtr+=parseFloat(r.biddedCtr?r.biddedCtr:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.biddedCtr=r.biddedCtr/r.counter,r.ctr=r.clicks/r.searches,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allstat.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].biddedCtr+=parseFloat(r.biddedCtr?r.biddedCtr:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.biddedCtr=r.biddedCtr/r.counter,r.ctr=r.clicks/r.searches,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allstat.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].biddedCtr+=parseFloat(r.biddedCtr?r.biddedCtr:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.biddedCtr=r.biddedCtr/r.counter,r.ctr=r.clicks/r.searches,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}backGroup(){this.rows=this.allstat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}updateAllLyonStats(t,e,r){this.lyonService.updateAllLyonStats(t,e,r).subscribe(t=>{})}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=yield this.getAllLyonStats(this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetricsData=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}refreshTable(){this.cdr.markForCheck()}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const o=yield this.lyonService.getSummaryMetrics(t,e,r).toPromise();var a={},n=0,i=0,s=0;return 0!=o.summary[0].lastMonthStat[0].profitPace&&(n=(o.summary[0].summaryMetrics[0].profitPace-o.summary[0].lastMonthStat[0].profitPace)/o.summary[0].lastMonthStat[0].profitPace*100),0!=o.summary[0].twoLastMonthStat[0].profitPace&&(i=(o.summary[0].lastMonthStat[0].profitPace-o.summary[0].twoLastMonthStat[0].profitPace)/o.summary[0].twoLastMonthStat[0].profitPace*100),0!=o.summary[0].prevSelectedStat[0].profitPace&&(s=(o.summary[0].selectedStat[0].profitPace-o.summary[0].prevSelectedStat[0].profitPace)/o.summary[0].prevSelectedStat[0].profitPace*100),o.summary[0].summaryMetrics[0].percentPace=n,o.summary[0].lastMonthStat[0].percentPace=i,o.summary[0].selectedStat[0].percentPace=s,o.summary[0].selectedStat[0].selectedStartDate=e,o.summary[0].selectedStat[0].selectedEndDate=r,a.summary=o.summary,a}catch(o){return o}}))}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const d=yield this.lyonService.getAllStats(e,r).toPromise();for(var t of(this.loadingIndicator=!1,this.allChart=d,this.allChart.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("lyons"==t.tag.advertiser)for(var a of t.tag.subids)"Contains"==a.filterTag?this.allChart.map(e=>{e.subid.includes(a.subid)&&(e.publisher=t.user.length?t.user[0].fullname:"No Publisher",e.tagname=t.tag.name)}):"StartsWith"==a.filterTag?this.allChart.map(e=>{e.subid.startsWith(a.subid)&&(e.publisher=t.user.length?t.user[0].fullname:"No Publisher",e.tagname=t.tag.name)}):"EndsWith"==a.filterTag?this.allChart.map(e=>{e.subid.endsWith(a.subid)&&(e.publisher=t.user.length?t.user[0].fullname:"No Publisher",e.tagname=t.tag.name)}):"ExactValue"==a.filterTag&&this.allChart.map(e=>{e.subid==a.subid&&(e.publisher=t.user.length?t.user[0].fullname:"No Publisher",e.tagname=t.tag.name)});var n=s.chain(this.allChart).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const f=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return f(t,a)}))},m=f(n,["date","publisher"]),v=[];for(const t in m)if(m.hasOwnProperty(t))for(const e in m[t]){const r={date:m[t][e][0].date,publisher:m[t][e][0].publisher,revenue:s.reduce(m[t][e],(t,e)=>t+e.revenue,0)};v.push(r)}let y=[];for(let t of v)y.push(t.publisher);var i=y.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChart=this.allChart.slice().sort((t,e)=>t.date-e.date);var o={},c=this.allChart.reduce((function(t,e){var r=e.date;return o[r]?o[r].searches+=parseInt(e.searches):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]),l=[],u=[],h={};for(var g of this.daysList){var p=c.filter(t=>t.date==g);if(0==p.length)l.push(g),u.push(0);else for(var b of p)l.push(b.date),u.push(b.searches)}let D=[];for(let t of i){let e=[];for(let a of l){let r=v.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,D.push(r)}return h.revenuePerDay=D,h.datesOfRevenue=l,h.searchesPerDay=u,h.publisherName=i,h}catch(d){return d}}))}groupDateForPublisher(t){var e={},r=this.allstat.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].biddedCtr+=parseFloat(r.biddedCtr?r.biddedCtr:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.biddedCtr=t.biddedCtr/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allstat.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].cpc+=parseFloat(r.cpc?r.cpc:0),e[a].ctr+=parseFloat(r.ctr?r.ctr:0),e[a].biddedCtr+=parseFloat(r.biddedCtr?r.biddedCtr:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.biddedCtr=t.biddedCtr/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}combineSummaryMetrics(t){t.summary.keys.forEach(t=>{this.summary.revenue+=t.revenue,this.summary.profit+=t.revenue*(.01*(100-t.split))})}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(Kr.a),c.Qb(c.i),c.Qb(l.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-lyons"]],viewQuery:function(t,e){var r;1&t&&c.Tc(Xr,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:44,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","biddedCtr",4,"ngIf"],["name","ctr",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date"],["name","subid"],["name","publisher"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","biddedCtr"],["name","ctr"]],template:function(t,e){1&t&&(c.Mc(0,Zr,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,Jr,1,1,"app-reporting-revenue-chart",2),c.Mc(3,ta,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,na,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,ia,1,4,"ng-template",17),c.Vb(),c.Mc(24,ca,3,0,"ngx-datatable-column",18),c.Mc(25,ha,3,0,"ngx-datatable-column",19),c.Mc(26,ba,3,0,"ngx-datatable-column",20),c.Mc(27,ma,3,0,"ngx-datatable-column",21),c.Mc(28,Da,3,0,"ngx-datatable-column",22),c.Mc(29,wa,3,0,"ngx-datatable-column",23),c.Mc(30,Pa,3,0,"ngx-datatable-column",24),c.Mc(31,Ca,3,0,"ngx-datatable-column",25),c.Wb(32,"ngx-datatable-column",26),c.Mc(33,xa,1,0,"ng-template",27),c.Mc(34,_a,3,4,"ng-template",17),c.Vb(),c.Wb(35,"ngx-datatable-column",28),c.Mc(36,Ta,1,0,"ng-template",27),c.Mc(37,Ra,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",29),c.Mc(39,ka,1,0,"ng-template",27),c.Mc(40,Ia,3,4,"ng-template",17),c.Vb(),c.Wb(41,"ngx-datatable-column",30),c.Mc(42,Na,1,0,"ng-template",27),c.Mc(43,La,4,6,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetricsData&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();var Aa=r("Wxo5");const za=["expandableTable"];function Ea(t,e){1&t&&(c.Wb(0,"div",28),c.Rb(1,"mat-progress-bar",29),c.Vb())}function Ya(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",30),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function Ha(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",31),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Ua(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.mc(13,"percent"),c.Vb(),c.Wb(14,"td"),c.Oc(15),c.mc(16,"currency"),c.mc(17,"currency"),c.Vb(),c.Wb(18,"td"),c.Oc(19),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Wb(24,"td"),c.Oc(25),c.mc(26,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr,"2.2-2")||c.oc(13,17,0,"2.2-2")),c.Db(4),c.Pc(c.oc(16,20,t.cpc,"USD")||c.oc(17,23,0,"USD")),c.Db(4),c.Pc(c.oc(20,26,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(23,29,t.profit,"USD")),c.Db(3),c.Pc(c.oc(26,32,t.revenue,"USD"))}}function Ba(t,e){if(1&t&&(c.Wb(0,"div",34),c.Wb(1,"table",35),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,Ua,27,35,"tr",36),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Qa(t,e){1&t&&(c.Wb(0,"div",37),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function Ga(t,e){if(1&t&&(c.Mc(0,Ba,22,1,"div",32),c.Mc(1,Qa,6,0,"div",33)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function qa(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",38),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function $a(t,e){1&t&&c.Oc(0," Date ")}function Ka(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Xa(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",39),c.Mc(1,$a,1,0,"ng-template",24),c.Mc(2,Ka,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Za(t,e){1&t&&c.Oc(0," Subid ")}function Ja(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function tn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",40),c.Mc(1,Za,1,0,"ng-template",24),c.Mc(2,Ja,2,1,"ng-template",17),c.Vb())}function en(t,e){1&t&&c.Oc(0," Publisher ")}function rn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function an(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",41),c.Mc(1,en,1,0,"ng-template",24),c.Mc(2,rn,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function nn(t,e){1&t&&c.Oc(0," Searches ")}function sn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function on(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",42),c.Mc(1,nn,1,0,"ng-template",24),c.Mc(2,sn,3,3,"ng-template",17),c.Vb())}function cn(t,e){1&t&&c.Oc(0," Clicks ")}function ln(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function un(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",43),c.Mc(1,cn,1,0,"ng-template",24),c.Mc(2,ln,3,3,"ng-template",17),c.Vb())}function hn(t,e){1&t&&c.Oc(0," Split ")}function gn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}function pn(t,e){1&t&&c.Oc(0," Publisher Net ")}function bn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function dn(t,e){1&t&&c.Oc(0," Profit ")}function fn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function mn(t,e){1&t&&c.Oc(0," Revenue ")}function vn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let yn=(()=>{class t{constructor(t,e,r,a){this.cdr=t,this.userService=e,this.rubiService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}getSelectedCompanyStored(){return this.userService.getSelectedCompanyFromLocalStorage()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}refreshTable(){this.cdr.markForCheck()}getAllRubiStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.rubiService.getRubiStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("rubi"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].monetized_searches+=parseFloat(r.monetized_searches?r.monetized_searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].monetized_searches+=parseFloat(r.monetized_searches?r.monetized_searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].monetized_searches+=parseFloat(r.monetized_searches?r.monetized_searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].monetized_searches+=parseFloat(r.monetized_searches?r.monetized_searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].monetized_searches+=parseFloat(r.monetized_searches?r.monetized_searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.rubiService.getRubiStats(t,e,r).toPromise();for(var a of(this.loadingIndicator=!1,this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("rubi"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].searches+=parseInt(e.searches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.rubiService.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(Aa.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-rubi"]],viewQuery:function(t,e){var r;1&t&&c.Tc(za,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(t,e){1&t&&(c.Mc(0,Ea,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,Ya,1,1,"app-reporting-revenue-chart",2),c.Mc(3,Ha,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,Ga,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,qa,1,4,"ng-template",17),c.Vb(),c.Mc(24,Xa,3,1,"ngx-datatable-column",18),c.Mc(25,tn,3,0,"ngx-datatable-column",19),c.Mc(26,an,3,1,"ngx-datatable-column",20),c.Mc(27,on,3,0,"ngx-datatable-column",21),c.Mc(28,un,3,0,"ngx-datatable-column",22),c.Wb(29,"ngx-datatable-column",23),c.Mc(30,hn,1,0,"ng-template",24),c.Mc(31,gn,4,6,"ng-template",17),c.Vb(),c.Wb(32,"ngx-datatable-column",25),c.Mc(33,pn,1,0,"ng-template",24),c.Mc(34,bn,3,4,"ng-template",17),c.Vb(),c.Wb(35,"ngx-datatable-column",26),c.Mc(36,dn,1,0,"ng-template",24),c.Mc(37,fn,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",27),c.Mc(39,mn,1,0,"ng-template",24),c.Mc(40,vn,3,4,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();var Dn=r("uJD8");const Sn=["expandableTable"];function Fn(t,e){1&t&&(c.Wb(0,"div",34),c.Rb(1,"mat-progress-bar",35),c.Vb())}function wn(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",36),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function Mn(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",37),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Wn(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.Vb(),c.Wb(13,"td"),c.Oc(14),c.mc(15,"currency"),c.Vb(),c.Wb(16,"td"),c.Oc(17),c.mc(18,"currency"),c.Vb(),c.Wb(19,"td"),c.Oc(20),c.mc(21,"currency"),c.Vb(),c.Wb(22,"td"),c.Oc(23),c.mc(24,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr||0,"2.2-2")),c.Db(3),c.Pc(c.oc(15,17,t.cpc||0,"USD")),c.Db(3),c.Pc(c.oc(18,20,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(21,23,t.profit,"USD")),c.Db(3),c.Pc(c.oc(24,26,t.revenue,"USD"))}}function Pn(t,e){if(1&t&&(c.Wb(0,"div",40),c.Wb(1,"table",41),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,Wn,25,29,"tr",42),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Vn(t,e){1&t&&(c.Wb(0,"div",43),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function On(t,e){if(1&t&&(c.Mc(0,Pn,22,1,"div",38),c.Mc(1,Vn,6,0,"div",39)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function Cn(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",44),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function xn(t,e){1&t&&c.Oc(0," Date ")}function _n(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Tn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,xn,1,0,"ng-template",30),c.Mc(2,_n,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Rn(t,e){1&t&&c.Oc(0," Subid ")}function kn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function In(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",46),c.Mc(1,Rn,1,0,"ng-template",30),c.Mc(2,kn,2,1,"ng-template",17),c.Vb())}function Nn(t,e){1&t&&c.Oc(0," Publisher ")}function Ln(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function jn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",47),c.Mc(1,Nn,1,0,"ng-template",30),c.Mc(2,Ln,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function An(t,e){1&t&&c.Oc(0," Searches ")}function zn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function En(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",48),c.Mc(1,An,1,0,"ng-template",30),c.Mc(2,zn,3,3,"ng-template",17),c.Vb())}function Yn(t,e){1&t&&c.Oc(0," Bid Searches ")}function Hn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Un(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",49),c.Mc(1,Yn,1,0,"ng-template",30),c.Mc(2,Hn,3,3,"ng-template",17),c.Vb())}function Bn(t,e){1&t&&c.Oc(0," Clicks ")}function Qn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Gn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",50),c.Mc(1,Bn,1,0,"ng-template",30),c.Mc(2,Qn,3,3,"ng-template",17),c.Vb())}function qn(t,e){1&t&&c.Oc(0," Coverage ")}function $n(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Kn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",51),c.Mc(1,qn,1,0,"ng-template",30),c.Mc(2,$n,3,3,"ng-template",17),c.Vb())}function Xn(t,e){1&t&&c.Oc(0," CTR ")}function Zn(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"percent"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"2.2-2"))}}function Jn(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",52),c.Mc(1,Xn,1,0,"ng-template",30),c.Mc(2,Zn,3,4,"ng-template",17),c.Vb())}function ti(t,e){1&t&&c.Oc(0," CPC ")}function ei(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"USD"))}}function ri(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",53),c.Mc(1,ti,1,0,"ng-template",30),c.Mc(2,ei,3,4,"ng-template",17),c.Vb())}function ai(t,e){1&t&&c.Oc(0," RN ")}function ni(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ii(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",54),c.Mc(1,ai,1,0,"ng-template",30),c.Mc(2,ni,3,3,"ng-template",17),c.Vb())}function si(t,e){1&t&&c.Oc(0," TQ ")}function oi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ci(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",55),c.Mc(1,si,1,0,"ng-template",30),c.Mc(2,oi,3,3,"ng-template",17),c.Vb())}function li(t,e){1&t&&c.Oc(0," Publisher Net ")}function ui(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function hi(t,e){1&t&&c.Oc(0," Profit ")}function gi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function pi(t,e){1&t&&c.Oc(0," Revenue ")}function bi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function di(t,e){1&t&&c.Oc(0," Split ")}function fi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}let mi=(()=>{class t{constructor(t,e,r,a){this.verizonService=t,this.cdr=e,this.userService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}refreshTable(){this.cdr.markForCheck()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}toggleExpandRow(t){this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{for(var t of(this.allChartStat=this.allStats,this.tagList))if("verizon-direct"==t.tag.advertiser)for(var e of t.tag.subids)"Contains"==e.filterTag?this.allChartStat.map(r=>{r.subid.includes(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"StartsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.startsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"EndsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.endsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"ExactValue"==e.filterTag&&this.allChartStat.map(r=>{r.subid==e.subid&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)});var r=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const p=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return p(t,a)}))},b=p(r,["date","publisher"]),d=[];for(const t in b)if(b.hasOwnProperty(t))for(const e in b[t]){const r={date:b[t][e][0].date,publisher:b[t][e][0].publisher,revenue:s.reduce(b[t][e],(t,e)=>t+e.revenue,0)};d.push(r)}let f=[];for(let t of d)f.push(t.publisher);var a=f.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var n={},i=this.allChartStat.reduce((function(t,e){var r=e.date;return n[r]?(n[r].searches+=parseInt(e.searches),e.revenue&&(n[r].revenue+=e.revenue)):(n[r]=Object.assign({},e),t.push(n[r])),t}),[]),o=[],c=[],l={};for(var u of this.daysList){var h=i.filter(t=>t.date==u);if(0==h.length)o.push(u),c.push(0);else for(var g of h)o.push(g.date),c.push(g.searches)}let m=[];for(let t of a){let e=[];for(let a of o){let r=d.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,m.push(r)}return l.revenuePerDay=m,l.datesOfRevenue=o,l.searchesPerDay=c,l.publisherName=a,l}catch(p){return p}}))}getAllVerizonStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonService.getAllVerizonStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("verizon-direct"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonService.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(Dn.a),c.Qb(c.i),c.Qb(l.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-verizon-direct"]],viewQuery:function(t,e){var r;1&t&&c.Tc(Sn,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:47,vars:29,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(c.Mc(0,Fn,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,wn,1,1,"app-reporting-revenue-chart",2),c.Mc(3,Mn,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,On,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,Cn,1,4,"ng-template",17),c.Vb(),c.Mc(24,Tn,3,1,"ngx-datatable-column",18),c.Mc(25,In,3,0,"ngx-datatable-column",19),c.Mc(26,jn,3,1,"ngx-datatable-column",20),c.Mc(27,En,3,0,"ngx-datatable-column",21),c.Mc(28,Un,3,0,"ngx-datatable-column",22),c.Mc(29,Gn,3,0,"ngx-datatable-column",23),c.Mc(30,Kn,3,0,"ngx-datatable-column",24),c.Mc(31,Jn,3,0,"ngx-datatable-column",25),c.Mc(32,ri,3,0,"ngx-datatable-column",26),c.Mc(33,ii,3,0,"ngx-datatable-column",27),c.Mc(34,ci,3,0,"ngx-datatable-column",28),c.Wb(35,"ngx-datatable-column",29),c.Mc(36,li,1,0,"ng-template",30),c.Mc(37,ui,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",31),c.Mc(39,hi,1,0,"ng-template",30),c.Mc(40,gi,3,4,"ng-template",17),c.Vb(),c.Wb(41,"ngx-datatable-column",32),c.Mc(42,pi,1,0,"ng-template",30),c.Mc(43,bi,3,4,"ng-template",17),c.Vb(),c.Wb(44,"ngx-datatable-column",33),c.Mc(45,di,1,0,"ng-template",30),c.Mc(46,fi,4,6,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(10),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();var vi=r("m5p0");const yi=["expandableTable"];function Di(t,e){1&t&&(c.Wb(0,"div",29),c.Rb(1,"mat-progress-bar",30),c.Vb())}function Si(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",31),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function Fi(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",32),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function wi(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.Vb(),c.Wb(13,"td"),c.Oc(14),c.mc(15,"currency"),c.Vb(),c.Wb(16,"td"),c.Oc(17),c.mc(18,"currency"),c.Vb(),c.Wb(19,"td"),c.Oc(20),c.mc(21,"currency"),c.Vb(),c.Wb(22,"td"),c.Oc(23),c.mc(24,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr||0,"2.2-2")),c.Db(3),c.Pc(c.oc(15,17,t.cpc||0,"USD")),c.Db(3),c.Pc(c.oc(18,20,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(21,23,t.profit,"USD")),c.Db(3),c.Pc(c.oc(24,26,t.revenue,"USD"))}}function Mi(t,e){if(1&t&&(c.Wb(0,"div",35),c.Wb(1,"table",36),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,wi,25,29,"tr",37),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Wi(t,e){1&t&&(c.Wb(0,"div",38),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function Pi(t,e){if(1&t&&(c.Mc(0,Mi,22,1,"div",33),c.Mc(1,Wi,6,0,"div",34)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function Vi(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",39),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Oi(t,e){1&t&&c.Oc(0," Date ")}function Ci(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function xi(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",40),c.Mc(1,Oi,1,0,"ng-template",25),c.Mc(2,Ci,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function _i(t,e){1&t&&c.Oc(0," Subid ")}function Ti(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ri(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",41),c.Mc(1,_i,1,0,"ng-template",25),c.Mc(2,Ti,2,1,"ng-template",17),c.Vb())}function ki(t,e){1&t&&c.Oc(0," Publisher ")}function Ii(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ni(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",42),c.Mc(1,ki,1,0,"ng-template",25),c.Mc(2,Ii,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Li(t,e){1&t&&c.Oc(0," Device ")}function ji(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ai(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",43),c.Mc(1,Li,1,0,"ng-template",25),c.Mc(2,ji,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function zi(t,e){1&t&&c.Oc(0," Searches ")}function Ei(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Yi(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",44),c.Mc(1,zi,1,0,"ng-template",25),c.Mc(2,Ei,3,3,"ng-template",17),c.Vb())}function Hi(t,e){1&t&&c.Oc(0," Clicks ")}function Ui(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Bi(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,Hi,1,0,"ng-template",25),c.Mc(2,Ui,3,3,"ng-template",17),c.Vb())}function Qi(t,e){1&t&&c.Oc(0," Split ")}function Gi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}function qi(t,e){1&t&&c.Oc(0," Publisher Net ")}function $i(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Ki(t,e){1&t&&c.Oc(0," Profit ")}function Xi(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function Zi(t,e){1&t&&c.Oc(0," Revenue ")}function Ji(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let ts=(()=>{class t{constructor(t,e,r,a){this.cdr=t,this.userService=e,this.system1Service=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.system1Service.getAllSystem1Stats(t,e,r).toPromise();for(var a of(this.loadingIndicator=!1,this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("system1"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].searches+=parseInt(e.searches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}getAllSystem1Stats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.system1Service.getAllSystem1Stats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("system1"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.system1Service.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=r.clicks?parseFloat(r.clicks):0,t[a].searches+=r.searches?parseFloat(r.searches):0,t[a].ctr+=r.ctr?parseFloat(r.ctr):0,t[a].revenue+=r.revenue?parseFloat(r.revenue):0,t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=r.clicks?parseFloat(r.clicks):0,t[a].searches+=r.searches?parseFloat(r.searches):0,t[a].ctr+=r.ctr?parseFloat(r.ctr):0,t[a].revenue+=r.revenue?parseFloat(r.revenue):0,t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=r.clicks?parseFloat(r.clicks):0,t[a].searches+=r.searches?parseFloat(r.searches):0,t[a].revenue+=r.revenue?parseFloat(r.revenue):0,t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r.publisher),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}groupDateForPublisher(t){var e={};let r=this.allStats.filter(e=>e.publisher===t).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=r.clicks?parseFloat(r.clicks):0,e[a].searches+=r.searches?parseFloat(r.searches):0,e[a].revenue+=r.revenue?parseFloat(r.revenue):0,e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var a of r)a.split=a.split/a.counter,a.ctr=a.clicks/a.searches,a.cpc=a.revenue/a.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=r.clicks?parseFloat(r.clicks):0,e[a].searches+=r.searches?parseFloat(r.searches):0,e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}refreshTable(){this.cdr.detectChanges()}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(vi.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-system1"]],viewQuery:function(t,e){var r;1&t&&c.Tc(yi,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:42,vars:24,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","device",3,"minWidth",4,"ngIf"],["name","Searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","device",3,"minWidth"],["name","Searches"],["name","clicks"]],template:function(t,e){1&t&&(c.Mc(0,Di,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,Si,1,1,"app-reporting-revenue-chart",2),c.Mc(3,Fi,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,Pi,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,Vi,1,4,"ng-template",17),c.Vb(),c.Mc(24,xi,3,1,"ngx-datatable-column",18),c.Mc(25,Ri,3,0,"ngx-datatable-column",19),c.Mc(26,Ni,3,1,"ngx-datatable-column",20),c.Mc(27,Ai,3,1,"ngx-datatable-column",21),c.Mc(28,Yi,3,0,"ngx-datatable-column",22),c.Mc(29,Bi,3,0,"ngx-datatable-column",23),c.Wb(30,"ngx-datatable-column",24),c.Mc(31,Qi,1,0,"ng-template",25),c.Mc(32,Gi,4,6,"ng-template",17),c.Vb(),c.Wb(33,"ngx-datatable-column",26),c.Mc(34,qi,1,0,"ng-template",25),c.Mc(35,$i,3,4,"ng-template",17),c.Vb(),c.Wb(36,"ngx-datatable-column",27),c.Mc(37,Ki,1,0,"ng-template",25),c.Mc(38,Xi,3,4,"ng-template",17),c.Vb(),c.Wb(39,"ngx-datatable-column",28),c.Mc(40,Zi,1,0,"ng-template",25),c.Mc(41,Ji,3,4,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();var es=r("AytR"),rs=r("tk/3");const as=es.a.apiUrl+"/stats/admin/manual-update";let ns=(()=>{class t{constructor(t){this.http=t}updateManualStats(t){const{company:e,reportType:r,startDate:a,endDate:n}=t;var i={company:e,reportType:r,startDate:o(a).format("YYYY-MM-DD"),endDate:o(n).format("YYYY-MM-DD")};return this.http.put(as+"/stat-update",i)}updateManualSplit(t){const{company:e,reportType:r,tag:a,startDate:n,endDate:i}=t;return this.http.put(as+"/split-update",{company:e,reportType:r,tag:a,startDate:n,endDate:i})}}return t.\u0275fac=function(e){return new(e||t)(c.ec(rs.c))},t.\u0275prov=c.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var is=r("9xcm"),ss=r("+BVi"),os=r("soTd"),cs=r("iadO"),ls=r("bTqV");function us(t,e){if(1&t&&(c.Wb(0,"mat-option",18),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.viewValue," ")}}function hs(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Invalid start date "),c.Vb())}function gs(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Invalid end date"),c.Vb())}function ps(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Start Date Required"),c.Vb())}function bs(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"End Date Required"),c.Vb())}function ds(t,e){if(1&t&&(c.Wb(0,"mat-option",18),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.viewValue," ")}}let fs=(()=>{class t{constructor(t,e,r,a,n,i){this.manualUpdateService=t,this.fb=e,this.companyService=r,this.authService=a,this.userService=n,this.notification=i,this.reportUpdateTitle="Report Stat Update",this.reportTypeData=[],this.message=null,this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}ngOnInit(){this.getReportingProviderList(),this.manaulUpFG=this.fb.group({reportType:new d.g("",d.z.required),preSelectValue:new d.g("",d.z.required),startDate:new d.g("",d.z.required),endDate:new d.g("",d.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new d.j({startDate:new d.g("",d.z.required),endDate:new d.g("",d.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}getReportingProviderList(){this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe(t=>{t.reportingProviders.map(t=>{this.reportTypeData.push({value:t.reportingProvider,viewValue:t.reportingProvider})})})}getSelectedCompanyLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}onReportSubmit(){if(this.manaulUpFG.valid){this.manaulUpFG.addControl("company",new d.g("",d.z.required)),this.manaulUpFG.patchValue({company:this.companySelected});var t=this.manaulUpFG.value.reportType;this.manualUpdateService.updateManualStats(this.manaulUpFG.value).subscribe(e=>{this.isObjectEmpty(e)?this.notification.showWarning(t+" data not existed!",""):"ok"==e.stats?this.notification.showSuccess(t+" data stats successfully updated!",""):"warn"==e.stats&&this.notification.showWarning(t+" data not existed!","")})}}isObjectEmpty(t){return 0===Object.keys(t).length}getDateRanges(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}changeDatePicker(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:o(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:o(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}onPreSetRangeSelectChange(t){"custom"!==t.value&&(this.preSelectValue=t.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}updateDatePickerRange(t,e){this.manaulUpFG.patchValue({startDate:o(t,"MM-DD-YYYY").toDate(),endDate:o(e,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:o(t,"MM-DD-YYYY").toDate(),endDate:o(e,"MM-DD-YYYY").toDate()})}getPreSetDateRange(t){switch(t){case"today":return{startDate:o().utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:o().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:o().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:o().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:o().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:o().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}handleReport(t){if(t.value.length>0){var e=t.value.toLowerCase().replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}));this.reportUpdateTitle=e+" Stat Update"}}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(ns),c.Qb(d.f),c.Qb(is.a),c.Qb(ss.a),c.Qb(l.a),c.Qb(os.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-manual-update"]],decls:36,vars:12,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Report","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(t,e){if(1&t&&(c.Wb(0,"form",0),c.hc("ngSubmit",(function(){return e.onReportSubmit()})),c.Wb(1,"div",1),c.Wb(2,"div",2),c.Wb(3,"div",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"h3",6),c.Oc(7),c.Vb(),c.Vb(),c.Vb(),c.Wb(8,"div",7),c.Wb(9,"mat-form-field"),c.Wb(10,"mat-label"),c.Oc(11,"Report Type"),c.Vb(),c.Wb(12,"mat-select",8),c.hc("selectionChange",(function(t){return e.handleReport(t)})),c.Mc(13,us,2,2,"mat-option",9),c.Vb(),c.Vb(),c.Wb(14,"mat-form-field"),c.Wb(15,"mat-label"),c.Oc(16,"Enter a custom date range"),c.Vb(),c.Wb(17,"mat-date-range-input",10),c.hc("dateChange",(function(){return e.changeDatePicker()})),c.Rb(18,"input",11),c.Wb(19,"input",12),c.hc("dateChange",(function(){return e.changeDatePicker()})),c.Vb(),c.Vb(),c.Rb(20,"mat-datepicker-toggle",13),c.Rb(21,"mat-date-range-picker",null,14),c.Mc(23,hs,2,0,"mat-error",15),c.Mc(24,gs,2,0,"mat-error",15),c.Mc(25,ps,2,0,"mat-error",15),c.Mc(26,bs,2,0,"mat-error",15),c.Vb(),c.Wb(27,"mat-form-field"),c.Wb(28,"mat-label"),c.Oc(29,"Preset Date Range"),c.Vb(),c.Wb(30,"mat-select",16),c.hc("ngModelChange",(function(t){return e.preSelectValue=t}))("selectionChange",(function(t){return e.onPreSetRangeSelectChange(t)})),c.Mc(31,ds,2,2,"mat-option",9),c.Vb(),c.Vb(),c.Wb(32,"div",1),c.Wb(33,"div",2),c.Wb(34,"button",17),c.Oc(35,"Update Stats"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.Ac(22);c.rc("formGroup",e.manaulUpFG),c.Db(7),c.Pc(e.reportUpdateTitle),c.Db(6),c.rc("ngForOf",e.reportTypeData),c.Db(4),c.rc("rangePicker",t)("formGroup",e.range),c.Db(3),c.rc("for",t),c.Db(3),c.rc("ngIf",e.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),c.Db(1),c.rc("ngIf",e.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),c.Db(1),c.rc("ngIf",null==e.manaulUpFG.controls.startDate.errors?null:e.manaulUpFG.controls.startDate.errors.required),c.Db(1),c.rc("ngIf",null==e.manaulUpFG.controls.endDate.errors?null:e.manaulUpFG.controls.endDate.errors.required),c.Db(4),c.rc("ngModel",e.preSelectValue),c.Db(1),c.rc("ngForOf",e.preSetDateRanges)}},directives:[d.B,d.r,d.k,p.c,p.g,b.a,d.q,d.i,a.o,cs.a,cs.h,d.d,d.x,cs.g,cs.f,p.j,cs.b,a.p,ls.b,f.p,p.b],styles:[""]}),t})();function ms(t,e){if(1&t&&(c.Wb(0,"mat-option",19),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.viewValue," ")}}function vs(t,e){if(1&t&&(c.Wb(0,"mat-option",19),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.viewValue," ")}}function ys(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Invalid start date "),c.Vb())}function Ds(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Invalid end date"),c.Vb())}function Ss(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"Start Date Required"),c.Vb())}function Fs(t,e){1&t&&(c.Wb(0,"mat-error"),c.Oc(1,"End Date Required"),c.Vb())}function ws(t,e){if(1&t&&(c.Wb(0,"mat-option",19),c.Oc(1),c.Vb()),2&t){const t=e.$implicit;c.rc("value",t.value),c.Db(1),c.Qc(" ",t.viewValue," ")}}let Ms=(()=>{class t{constructor(t,e,r,a,n,i,s,o){this.manualUpdateService=t,this.fb=e,this.companyService=r,this.authService=a,this.userService=n,this.notification=i,this.tagService=s,this.cdr=o,this.reportProviderData=[],this.tagData=[],this.selectedTagData=[],this.reportUpdateTitle="Report Split Update",this.selectedTagName="",this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}ngOnInit(){this.getReportingProviderList(),this.getAllTags(),this.manaulUpFG=this.fb.group({reportType:new d.g("",d.z.required),tag:new d.g("",d.z.required),preSelectValue:new d.g("",d.z.required),startDate:new d.g("",d.z.required),endDate:new d.g("",d.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new d.j({startDate:new d.g("",d.z.required),endDate:new d.g("",d.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}getSelectedCompanyLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}getAllTags(){this.tagService.getAllTags().subscribe(t=>{var e=[];this.companySelected&&(e=t.filter(t=>t.company[0]._id==this.companySelected)),e.map(t=>{this.tagData.push({value:t._id,viewValue:t.name,advertiser:t.advertiser})}),this.selectedTagData=this.tagData,this.cdr.detectChanges()})}handleTag(t){this.selectedTagName="updateAll"===t.value?"All":this.tagData.filter(e=>e.value==t.value)[0].viewValue}getReportingProviderList(){this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe(t=>{t.reportingProviders.map(t=>{this.reportProviderData.push({value:t.reportingProvider,viewValue:t.reportingProvider})})})}updateDatePickerRange(t,e){this.manaulUpFG.patchValue({startDate:o(t,"MM-DD-YYYY").toDate(),endDate:o(e,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:o(t,"MM-DD-YYYY").toDate(),endDate:o(e,"MM-DD-YYYY").toDate()})}getDateRanges(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}onPreSetRangeSelectChange(t){"custom"!==t.value&&(this.preSelectValue=t.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}getPreSetDateRange(t){switch(t){case"today":return{startDate:o().utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:o().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:o().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:o().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:o().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:o().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:o().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}handleReport(t){if(t.value.length>0){var e=t.value.toLowerCase().replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}));this.reportUpdateTitle=e+" Split Update",this.selectedTagData=[];let r=[];r.push({value:"updateAll",viewValue:"update all",advertiser:t.value});let a=this.tagData.filter(e=>e.advertiser==t.value);this.selectedTagData=r.concat(a),this.cdr.detectChanges()}}onReportSubmit(){this.manaulUpFG.valid&&(this.manaulUpFG.addControl("company",new d.g("",d.z.required)),this.manaulUpFG.patchValue({company:this.companySelected}),this.manualUpdateService.updateManualSplit(this.manaulUpFG.value).subscribe(t=>{this.isObjectEmpty(t)?this.notification.showWarning(this.selectedTagName+" data not existed!",""):this.notification.showSuccess(this.selectedTagName+" data splits  successfully updated!","")}))}isObjectEmpty(t){return 0===Object.keys(t).length}changeDatePicker(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:o(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:o(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(ns),c.Qb(d.f),c.Qb(is.a),c.Qb(ss.a),c.Qb(l.a),c.Qb(os.a),c.Qb(h.a),c.Qb(c.i))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-manual-split-update"]],decls:41,vars:13,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Provider","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matNativeControl","","placeholder","Select Report","formControlName","tag",3,"selectionChange"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(t,e){if(1&t&&(c.Wb(0,"form",0),c.hc("ngSubmit",(function(){return e.onReportSubmit()})),c.Wb(1,"div",1),c.Wb(2,"div",2),c.Wb(3,"div",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"h3",6),c.Oc(7),c.Vb(),c.Vb(),c.Vb(),c.Wb(8,"div",7),c.Wb(9,"mat-form-field"),c.Wb(10,"mat-label"),c.Oc(11,"Provider"),c.Vb(),c.Wb(12,"mat-select",8),c.hc("selectionChange",(function(t){return e.handleReport(t)})),c.Mc(13,ms,2,2,"mat-option",9),c.Vb(),c.Vb(),c.Wb(14,"mat-form-field"),c.Wb(15,"mat-label"),c.Oc(16,"Tag"),c.Vb(),c.Wb(17,"mat-select",10),c.hc("selectionChange",(function(t){return e.handleTag(t)})),c.Mc(18,vs,2,2,"mat-option",9),c.Vb(),c.Vb(),c.Wb(19,"mat-form-field"),c.Wb(20,"mat-label"),c.Oc(21,"Enter a custom date range"),c.Vb(),c.Wb(22,"mat-date-range-input",11),c.hc("dateChange",(function(){return e.changeDatePicker()})),c.Rb(23,"input",12),c.Wb(24,"input",13),c.hc("dateChange",(function(){return e.changeDatePicker()})),c.Vb(),c.Vb(),c.Rb(25,"mat-datepicker-toggle",14),c.Rb(26,"mat-date-range-picker",null,15),c.Mc(28,ys,2,0,"mat-error",16),c.Mc(29,Ds,2,0,"mat-error",16),c.Mc(30,Ss,2,0,"mat-error",16),c.Mc(31,Fs,2,0,"mat-error",16),c.Vb(),c.Wb(32,"mat-form-field"),c.Wb(33,"mat-label"),c.Oc(34,"Preset Date Range"),c.Vb(),c.Wb(35,"mat-select",17),c.hc("ngModelChange",(function(t){return e.preSelectValue=t}))("selectionChange",(function(t){return e.onPreSetRangeSelectChange(t)})),c.Mc(36,ws,2,2,"mat-option",9),c.Vb(),c.Vb(),c.Wb(37,"div",1),c.Wb(38,"div",2),c.Wb(39,"button",18),c.Oc(40,"Update Splits"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.Ac(27);c.rc("formGroup",e.manaulUpFG),c.Db(7),c.Pc(e.reportUpdateTitle),c.Db(6),c.rc("ngForOf",e.reportProviderData),c.Db(5),c.rc("ngForOf",e.selectedTagData),c.Db(4),c.rc("rangePicker",t)("formGroup",e.range),c.Db(3),c.rc("for",t),c.Db(3),c.rc("ngIf",e.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),c.Db(1),c.rc("ngIf",e.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),c.Db(1),c.rc("ngIf",null==e.manaulUpFG.controls.startDate.errors?null:e.manaulUpFG.controls.startDate.errors.required),c.Db(1),c.rc("ngIf",null==e.manaulUpFG.controls.endDate.errors?null:e.manaulUpFG.controls.endDate.errors.required),c.Db(4),c.rc("ngModel",e.preSelectValue),c.Db(1),c.rc("ngForOf",e.preSetDateRanges)}},directives:[d.B,d.r,d.k,p.c,p.g,b.a,d.q,d.i,a.o,cs.a,cs.h,d.d,d.x,cs.g,cs.f,p.j,cs.b,a.p,ls.b,f.p,p.b],styles:[""]}),t})();var Ws=r("mPAa");const Ps=["expandableTable"];function Vs(t,e){1&t&&(c.Wb(0,"div",28),c.Rb(1,"mat-progress-bar",29),c.Vb())}function Os(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",30),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function Cs(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",31),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function xs(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.mc(13,"percent"),c.Vb(),c.Wb(14,"td"),c.Oc(15),c.mc(16,"currency"),c.mc(17,"currency"),c.Vb(),c.Wb(18,"td"),c.Oc(19),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Wb(24,"td"),c.Oc(25),c.mc(26,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr,"2.2-2")||c.oc(13,17,0,"2.2-2")),c.Db(4),c.Pc(c.oc(16,20,t.cpc,"USD")||c.oc(17,23,0,"USD")),c.Db(4),c.Pc(c.oc(20,26,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(23,29,t.profit,"USD")),c.Db(3),c.Pc(c.oc(26,32,t.revenue,"USD"))}}function _s(t,e){if(1&t&&(c.Wb(0,"div",34),c.Wb(1,"table",35),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,xs,27,35,"tr",36),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Ts(t,e){1&t&&(c.Wb(0,"div",37),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function Rs(t,e){if(1&t&&(c.Mc(0,_s,22,1,"div",32),c.Mc(1,Ts,6,0,"div",33)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function ks(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",38),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Is(t,e){1&t&&c.Oc(0," Date ")}function Ns(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ls(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",39),c.Mc(1,Is,1,0,"ng-template",24),c.Mc(2,Ns,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function js(t,e){1&t&&c.Oc(0," Subid ")}function As(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function zs(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",40),c.Mc(1,js,1,0,"ng-template",24),c.Mc(2,As,2,1,"ng-template",17),c.Vb())}function Es(t,e){1&t&&c.Oc(0," Publisher ")}function Ys(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Hs(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",41),c.Mc(1,Es,1,0,"ng-template",24),c.Mc(2,Ys,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Us(t,e){1&t&&c.Oc(0," Searches ")}function Bs(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Qs(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",42),c.Mc(1,Us,1,0,"ng-template",24),c.Mc(2,Bs,3,3,"ng-template",17),c.Vb())}function Gs(t,e){1&t&&c.Oc(0," Clicks ")}function qs(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function $s(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",43),c.Mc(1,Gs,1,0,"ng-template",24),c.Mc(2,qs,3,3,"ng-template",17),c.Vb())}function Ks(t,e){1&t&&c.Oc(0," Split ")}function Xs(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}function Zs(t,e){1&t&&c.Oc(0," Publisher Net ")}function Js(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function to(t,e){1&t&&c.Oc(0," Profit ")}function eo(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function ro(t,e){1&t&&c.Oc(0," Revenue ")}function ao(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}let no=(()=>{class t{constructor(t,e,r,a){this.cdr=t,this.userService=e,this.solexBCService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}getSelectedCompanyStored(){return this.userService.getSelectedCompanyFromLocalStorage()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}onDetailToggle(t){console.log("Detail Toggled",t)}refreshTable(){this.cdr.markForCheck()}getAllSolexBCStats(t,e,r){return this.solexBCService.getSolexBCStats(t,e,r).toPromise().then(t=>{for(var e of(this.loadingIndicator=!1,this.allStats=t.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("solex-bc"==e.tag.advertiser)for(var r of e.tag.subids)"Contains"==r.filterTag?this.allStats.map(t=>{t.subid.includes(r.subid)&&(t.publisher=e.user.length?e.user[0].fullname:"No Publisher",t.tagname=e.tag.name)}):"StartsWith"==r.filterTag?this.allStats.map(t=>{t.subid.startsWith(r.subid)&&(t.publisher=e.user.length?e.user[0].fullname:"No Publisher",t.tagname=e.tag.name)}):"EndsWith"==r.filterTag?this.allStats.map(t=>{t.subid.endsWith(r.subid)&&(t.publisher=e.user.length?e.user[0].fullname:"No Publisher",t.tagname=e.tag.name)}):"ExactValue"==r.filterTag&&this.allStats.map(t=>{t.subid==r.subid&&(t.publisher=e.user.length?e.user[0].fullname:"No Publisher",t.tagname=e.tag.name)});return this.allStats})}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{const f=yield this.solexBCService.getSolexBCStats(t,e,r).toPromise();for(var a of(this.allChartStat=f.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("solex-bc"==a.tag.advertiser)for(var n of a.tag.subids)"Contains"==n.filterTag?this.allChartStat.map(t=>{t.subid.includes(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"StartsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.startsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"EndsWith"==n.filterTag?this.allChartStat.map(t=>{t.subid.endsWith(n.subid)&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)}):"ExactValue"==n.filterTag&&this.allChartStat.map(t=>{t.subid==n.subid&&(t.publisher=a.user.length?a.user[0].fullname:"No Publisher",t.tagname=a.tag.name)});var i=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const m=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return m(t,a)}))},v=m(i,["date","publisher"]),y=[];for(const t in v)if(v.hasOwnProperty(t))for(const e in v[t]){const r={date:v[t][e][0].date,publisher:v[t][e][0].publisher,revenue:s.reduce(v[t][e],(t,e)=>t+e.revenue,0)};y.push(r)}let D=[];for(let t of y)D.push(t.publisher);var o=D.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var c={},l=this.allChartStat.reduce((function(t,e){var r=e.date;return c[r]?c[r].searches+=parseInt(e.searches):(c[r]=Object.assign({},e),t.push(c[r])),t}),[]),u=[],h=[],g={};for(var p of this.daysList){var b=l.filter(t=>t.date==p);if(0==b.length)u.push(p),h.push(0);else for(var d of b)u.push(d.date),h.push(d.searches)}let S=[];for(let t of o){let e=[];for(let a of u){let r=y.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,S.push(r)}return g.revenuePerDay=S,g.datesOfRevenue=u,g.searchesPerDay=h,g.publisherName=o,g}catch(f){return f}}))}getSummaryMetrics(t,e,r){return this.solexBCService.getSummaryMetrics(t,e,r).toPromise().then(t=>{var a={},n=0,i=0,s=0;return 0!=t.summary[0].lastMonthStat[0].profitPace&&(n=(t.summary[0].summaryMetrics[0].profitPace-t.summary[0].lastMonthStat[0].profitPace)/t.summary[0].lastMonthStat[0].profitPace*100),0!=t.summary[0].twoLastMonthStat[0].profitPace&&(i=(t.summary[0].lastMonthStat[0].profitPace-t.summary[0].twoLastMonthStat[0].profitPace)/t.summary[0].twoLastMonthStat[0].profitPace*100),0!=t.summary[0].prevSelectedStat[0].profitPace&&(s=(t.summary[0].selectedStat[0].profitPace-t.summary[0].prevSelectedStat[0].profitPace)/t.summary[0].prevSelectedStat[0].profitPace*100),t.summary[0].summaryMetrics[0].percentPace=n,t.summary[0].lastMonthStat[0].percentPace=i,t.summary[0].selectedStat[0].percentPace=s,t.summary[0].selectedStat[0].selectedStartDate=e,t.summary[0].selectedStat[0].selectedEndDate=r,a.summary=t.summary,a})}getCompanyTags(t){var e=t.split("/")[1];return this.tagService.getCompanyTags(e).toPromise().then(t=>t).catch(t=>t)}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(Ws.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-solex-bc"]],viewQuery:function(t,e){var r;1&t&&c.Tc(Ps,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(t,e){1&t&&(c.Mc(0,Vs,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,Os,1,1,"app-reporting-revenue-chart",2),c.Mc(3,Cs,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,Rs,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,ks,1,4,"ng-template",17),c.Vb(),c.Mc(24,Ls,3,1,"ngx-datatable-column",18),c.Mc(25,zs,3,0,"ngx-datatable-column",19),c.Mc(26,Hs,3,1,"ngx-datatable-column",20),c.Mc(27,Qs,3,0,"ngx-datatable-column",21),c.Mc(28,$s,3,0,"ngx-datatable-column",22),c.Wb(29,"ngx-datatable-column",23),c.Mc(30,Ks,1,0,"ng-template",24),c.Mc(31,Xs,4,6,"ng-template",17),c.Vb(),c.Wb(32,"ngx-datatable-column",25),c.Mc(33,Zs,1,0,"ng-template",24),c.Mc(34,Js,3,4,"ng-template",17),c.Vb(),c.Wb(35,"ngx-datatable-column",26),c.Mc(36,to,1,0,"ng-template",24),c.Mc(37,eo,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",27),c.Mc(39,ro,1,0,"ng-template",24),c.Mc(40,ao,3,4,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();const io=es.a.apiUrl+"/stats/admin/accounting";let so=(()=>{class t{constructor(t){this.http=t}getRubiStats(t,e,r){return this.http.get(io+"/rubi",{params:{company:t,startDate:e,endDate:r}})}getPerionStats(t,e,r){return this.http.get(io+"/perion",{params:{company:t,startDate:e,endDate:r}})}getLyonStats(t,e,r){return this.http.get(io+"/lyons",{params:{company:t,startDate:e,endDate:r}})}getApptitudeStats(t,e,r){return this.http.get(io+"/apptitude",{params:{company:t,startDate:e,endDate:r}})}getSolexBCStats(t,e,r){return this.http.get(io+"/solex-bc",{params:{company:t,startDate:e,endDate:r}})}getVerizonDirectStats(t,e,r){return this.http.get(io+"/verizon-direct",{params:{company:t,startDate:e,endDate:r}})}getSystem1Stats(t,e,r){return this.http.get(io+"/system1",{params:{company:t,startDate:e,endDate:r}})}}return t.\u0275fac=function(e){return new(e||t)(c.ec(rs.c))},t.\u0275prov=c.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const oo=["expandableTable"];function co(t,e){if(1&t&&(c.Wb(0,"div"),c.Wb(1,"div",12),c.Wb(2,"div",13),c.Wb(3,"span"),c.Oc(4),c.Vb(),c.Vb(),c.Wb(5,"div",15),c.Wb(6,"span"),c.Oc(7),c.mc(8,"currency"),c.Vb(),c.Vb(),c.Vb(),c.Vb()),2&t){const t=e.$implicit,r=e.index,a=c.lc().row;c.Db(4),c.Qc("",t," : "),c.Db(3),c.Pc(c.oc(8,2,a.everyrevenue[r],"USD"))}}function lo(t,e){if(1&t&&(c.Wb(0,"div",9),c.Mc(1,co,9,5,"div",10),c.Vb(),c.Wb(2,"div",11),c.Wb(3,"div",12),c.Wb(4,"div",13),c.Wb(5,"strong",14),c.Oc(6,"Total : "),c.Vb(),c.Vb(),c.Wb(7,"div",15),c.Wb(8,"strong",14),c.Oc(9),c.mc(10,"currency"),c.Vb(),c.Vb(),c.Vb(),c.Vb()),2&t){const t=e.row;c.Db(1),c.rc("ngForOf",t.reporting),c.Db(8),c.Pc(c.oc(10,2,t.total,"USD"))}}function uo(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",16),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function ho(t,e){1&t&&c.Oc(0," Publisher Name ")}function go(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}let po=(()=>{class t{constructor(t,e,r,a,n){this.cdr=t,this.userService=e,this.accountingService=r,this.tagService=a,this.companyService=n,this.rows=[],this.loadingIndicator=!0,this.range={startDate:"",endDate:""},this.allRubiStats=[],this.allLyonStats=[],this.allPerionStats=[],this.allSystem1Stats=[],this.allVerizonStats=[],this.allSolexBCStats=[],this.allApptitudeStats=[],this.tagList=[],this.tempStatData=[],this.tempUpdateStatData=[],this.reportTypeData=[],this.selectedCompany=this.getSelectedCompanyStored()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.reportTypeData=yield this.getReportingProviderList(),this.rows=[],this.tempStatData=[],this.reportTypeData.includes("perion")&&(this.PerionData=yield this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.PerionData)),this.reportTypeData.includes("lyons")&&(this.LyonData=yield this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.LyonData)),this.reportTypeData.includes("rubi")&&(this.RubiData=yield this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.RubiData)),this.reportTypeData.includes("apptitude")&&(this.ApptitudeData=yield this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.ApptitudeData)),this.reportTypeData.includes("solex-bc")&&(this.SolexBCData=yield this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.SolexBCData)),this.reportTypeData.includes("verizon-direct")&&(this.VerizonData=yield this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.VerizonData)),this.reportTypeData.includes("system1")&&(this.System1Data=yield this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempStatData=this.tempStatData.concat(this.System1Data));const t=[];for(var e of(this.tempStatData.forEach(e=>{const r=t.filter(t=>t.publisher==e.publisher);if(r.length){const a=t.indexOf(r[0]);t[a].reporting=t[a].reporting.concat(e.reporting),t[a].everyrevenue=t[a].everyrevenue.concat(String(e.revenue)),t[a].total=t[a].total+e.revenue}else"string"==typeof e.reporting&&(e.reporting=[e.reporting]),"number"==typeof e.revenue&&(e.everyrevenue=[String(e.revenue)],e.total=e.revenue),t.push(e)}),t))e.detailHeight=30*(e.reporting.length+1);this.rows=t,this.loadingIndicator=!1,this.cdr.detectChanges()}))}getSelectedCompanyStored(){return this.userService.getSelectedCompanyFromLocalStorage()}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.rows=[],this.tempUpdateStatData=[];var e=[],r=[],a=[],n=[],i=[],s=[],o=[];this.reportTypeData.includes("perion")&&(e=yield this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(e)),this.reportTypeData.includes("lyons")&&(r=yield this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(r)),this.reportTypeData.includes("rubi")&&(a=yield this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(a)),this.reportTypeData.includes("apptitude")&&(n=yield this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(n)),this.reportTypeData.includes("solex-bc")&&(i=yield this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(i)),this.reportTypeData.includes("verizon-direct")&&(s=yield this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(s)),this.reportTypeData.includes("system1")&&(o=yield this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate),this.tempUpdateStatData=this.tempUpdateStatData.concat(o));const c=[];for(var l of(this.tempUpdateStatData.forEach(t=>{const e=c.filter(e=>e.publisher==t.publisher);if(e.length){const r=c.indexOf(e[0]);c[r].reporting=c[r].reporting.concat(t.reporting),c[r].everyrevenue=c[r].everyrevenue.concat(String(t.revenue)),c[r].total=c[r].total+t.revenue}else"string"==typeof t.reporting&&(t.reporting=[t.reporting]),"number"==typeof t.revenue&&(t.everyrevenue=[String(t.revenue)],t.total=t.revenue),c.push(t)}),c))l.detailHeight=30*(l.reporting.length+1);this.rows=c,this.loadingIndicator=!1,this.cdr.detectChanges()}))}getReportingProviderList(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.selectedCompany)try{const e=yield this.companyService.getReportCompany(this.selectedCompany.split("/")[1]).toPromise();var t=[];return e.reportingProviders.map(e=>{t.push(e.reportingProvider)}),t}catch(e){return e}}))}getRubiStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getRubiStats(t,e,r).toPromise();for(var n of(this.allRubiStats=a.stats,this.tagList))if("rubi"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allRubiStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Rubi")}):"StartsWith"==i.filterTag?this.allRubiStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Rubi")}):"EndsWith"==i.filterTag?this.allRubiStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Rubi")}):"ExactValue"==i.filterTag&&this.allRubiStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Rubi")});var s=[],o={};return this.allRubiStats.length>0&&this.allRubiStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getSolexBCStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getSolexBCStats(t,e,r).toPromise();for(var n of(this.allSolexBCStats=a.stats,this.tagList))if("solex-bc"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allSolexBCStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Solex BC")}):"StartsWith"==i.filterTag?this.allSolexBCStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Solex BC")}):"EndsWith"==i.filterTag?this.allSolexBCStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Solex BC")}):"ExactValue"==i.filterTag&&this.allSolexBCStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Solex BC")});var s=[],o={};return this.allSolexBCStats.length>0&&this.allSolexBCStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getVerizonDirectStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getVerizonDirectStats(t,e,r).toPromise();for(var n of(this.allVerizonStats=a.stats,this.tagList))if("verizon-direct"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allVerizonStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")}):"StartsWith"==i.filterTag?this.allVerizonStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")}):"EndsWith"==i.filterTag?this.allVerizonStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")}):"ExactValue"==i.filterTag&&this.allVerizonStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")});var s=[],o={};return this.allVerizonStats.length>0&&this.allVerizonStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getLyonStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getLyonStats(t,e,r).toPromise();for(var n of(this.allLyonStats=a.stats,this.tagList))if("lyons"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allLyonStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Lyons")}):"StartsWith"==i.filterTag?this.allLyonStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Lyons")}):"EndsWith"==i.filterTag?this.allLyonStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Lyons")}):"ExactValue"==i.filterTag&&this.allLyonStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Lyons")});var s=[],o={};return this.allLyonStats.length>0&&this.allLyonStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getPerionStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getPerionStats(t,e,r).toPromise();for(var n of(this.allPerionStats=a.stats,this.tagList))if("perion"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allPerionStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Perion")}):"StartsWith"==i.filterTag?this.allPerionStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Perion")}):"EndsWith"==i.filterTag?this.allPerionStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Perion")}):"ExactValue"==i.filterTag&&this.allPerionStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Perion")});var s=[],o={};return this.allPerionStats.length>0&&this.allPerionStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getApptitudeStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getApptitudeStats(t,e,r).toPromise();for(var n of(this.allApptitudeStats=a.stats,this.tagList))if("apptitude"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allApptitudeStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Apptitude")}):"StartsWith"==i.filterTag?this.allApptitudeStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Apptitude")}):"EndsWith"==i.filterTag?this.allApptitudeStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Apptitude")}):"ExactValue"==i.filterTag&&this.allApptitudeStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="Apptitude")});var s=[],o={};return this.allApptitudeStats.length>0&&this.allApptitudeStats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getSystem1Stats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.accountingService.getSystem1Stats(t,e,r).toPromise();for(var n of(this.allSystem1Stats=a.stats,this.tagList))if("system1"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allSystem1Stats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="System1")}):"StartsWith"==i.filterTag?this.allSystem1Stats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="System1")}):"EndsWith"==i.filterTag?this.allSystem1Stats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="System1")}):"ExactValue"==i.filterTag&&this.allSystem1Stats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.reporting="System1")});var s=[],o={};return this.allSystem1Stats.length>0&&this.allSystem1Stats.reduce((function(t,e){var r=e.publisher;return o[r]?o[r].revenue+=parseFloat(e.revenue):(o[r]=Object.assign({},e),t.push(o[r])),t}),[]).map(t=>{s.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})}),s}))}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(so),c.Qb(h.a),c.Qb(is.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-accounting"]],viewQuery:function(t,e){var r;1&t&&c.Tc(oo,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:10,vars:14,consts:[[3,"onDatesPicked"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],[2,"padding-left","36px"],[4,"ngFor","ngForOf"],[2,"padding-left","36px","margin-top","5px"],[2,"display","flex"],[2,"min-width","20%"],[2,"font-size","14px"],[2,"min-width","80%"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"]],template:function(t,e){1&t&&(c.Wb(0,"app-reporting-filtering",0),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Wb(1,"ngx-datatable",1,2),c.Wb(3,"ngx-datatable-row-detail",3),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(4,lo,11,5,"ng-template",4),c.Vb(),c.Wb(5,"ngx-datatable-column",5),c.Mc(6,uo,1,4,"ng-template",6),c.Vb(),c.Wb(7,"ngx-datatable-column",7),c.Mc(8,ho,1,0,"ng-template",8),c.Mc(9,go,2,1,"ng-template",6),c.Vb(),c.Vb()),2&t&&(c.Db(1),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight",e.getDetailRowHeight),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("minWidth",100))},directives:[g.a,m.d,m.e,m.f,m.b,m.a,m.c,a.o],pipes:[a.d],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:hidden!important}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{border-top:1px solid #222!important}"]}),t})();var bo=r("2Q/2");const fo=["expandableTable"];function mo(t,e){1&t&&(c.Wb(0,"div",34),c.Rb(1,"mat-progress-bar",35),c.Vb())}function vo(t,e){if(1&t&&c.Rb(0,"app-reporting-revenue-chart",36),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function yo(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",37),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Do(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.mc(3,"date"),c.Vb(),c.Wb(4,"td"),c.Oc(5),c.mc(6,"number"),c.Vb(),c.Wb(7,"td"),c.Oc(8),c.mc(9,"number"),c.Vb(),c.Wb(10,"td"),c.Oc(11),c.mc(12,"percent"),c.Vb(),c.Wb(13,"td"),c.Oc(14),c.mc(15,"currency"),c.Vb(),c.Wb(16,"td"),c.Oc(17),c.mc(18,"currency"),c.Vb(),c.Wb(19,"td"),c.Oc(20),c.mc(21,"currency"),c.Vb(),c.Wb(22,"td"),c.Oc(23),c.mc(24,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit;c.Db(2),c.Pc(c.nc(3,8,t.date)),c.Db(3),c.Pc(c.nc(6,10,t.searches)),c.Db(3),c.Pc(c.nc(9,12,t.clicks)),c.Db(3),c.Pc(c.oc(12,14,t.ctr||0,"2.2-2")),c.Db(3),c.Pc(c.oc(15,17,t.cpc||0,"USD")),c.Db(3),c.Pc(c.oc(18,20,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(21,23,t.profit,"USD")),c.Db(3),c.Pc(c.oc(24,26,t.revenue,"USD"))}}function So(t,e){if(1&t&&(c.Wb(0,"div",40),c.Wb(1,"table",41),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,Do,25,29,"tr",42),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Fo(t,e){1&t&&(c.Wb(0,"div",43),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function wo(t,e){if(1&t&&(c.Mc(0,So,22,1,"div",38),c.Mc(1,Fo,6,0,"div",39)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function Mo(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",44),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Wo(t,e){1&t&&c.Oc(0," Date ")}function Po(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"date"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Vo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,Wo,1,0,"ng-template",30),c.Mc(2,Po,3,3,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Oo(t,e){1&t&&c.Oc(0," Subid ")}function Co(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function xo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",46),c.Mc(1,Oo,1,0,"ng-template",30),c.Mc(2,Co,2,1,"ng-template",17),c.Vb())}function _o(t,e){1&t&&c.Oc(0," Publisher ")}function To(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Ro(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",47),c.Mc(1,_o,1,0,"ng-template",30),c.Mc(2,To,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function ko(t,e){1&t&&c.Oc(0," Searches ")}function Io(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function No(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",48),c.Mc(1,ko,1,0,"ng-template",30),c.Mc(2,Io,3,3,"ng-template",17),c.Vb())}function Lo(t,e){1&t&&c.Oc(0," Bid Searches ")}function jo(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ao(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",49),c.Mc(1,Lo,1,0,"ng-template",30),c.Mc(2,jo,3,3,"ng-template",17),c.Vb())}function zo(t,e){1&t&&c.Oc(0," Clicks ")}function Eo(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Yo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",50),c.Mc(1,zo,1,0,"ng-template",30),c.Mc(2,Eo,3,3,"ng-template",17),c.Vb())}function Ho(t,e){1&t&&c.Oc(0," Coverage ")}function Uo(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Bo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",51),c.Mc(1,Ho,1,0,"ng-template",30),c.Mc(2,Uo,3,3,"ng-template",17),c.Vb())}function Qo(t,e){1&t&&c.Oc(0," CTR ")}function Go(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"percent"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"2.2-2"))}}function qo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",52),c.Mc(1,Qo,1,0,"ng-template",30),c.Mc(2,Go,3,4,"ng-template",17),c.Vb())}function $o(t,e){1&t&&c.Oc(0," CPC ")}function Ko(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"USD"))}}function Xo(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",53),c.Mc(1,$o,1,0,"ng-template",30),c.Mc(2,Ko,3,4,"ng-template",17),c.Vb())}function Zo(t,e){1&t&&c.Oc(0," RN ")}function Jo(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function tc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",54),c.Mc(1,Zo,1,0,"ng-template",30),c.Mc(2,Jo,3,3,"ng-template",17),c.Vb())}function ec(t,e){1&t&&c.Oc(0," TQ ")}function rc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function ac(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",55),c.Mc(1,ec,1,0,"ng-template",30),c.Mc(2,rc,3,3,"ng-template",17),c.Vb())}function nc(t,e){1&t&&c.Oc(0," Publisher Net ")}function ic(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function sc(t,e){1&t&&c.Oc(0," Profit ")}function oc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function cc(t,e){1&t&&c.Oc(0," Revenue ")}function lc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function uc(t,e){1&t&&c.Oc(0," Split ")}function hc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}let gc=(()=>{class t{constructor(t,e,r,a){this.verizonarbService=t,this.cdr=e,this.userService=r,this.tagService=a,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}getDateRangeList(t,e){const r=[];let a=o(t);const n=o(e);for(;a<=n;)r.push(o.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+o.utc(36e6).toDate().getTime()),a.add(1,"days");return r}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}refreshTable(){this.cdr.markForCheck()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{for(var t of(this.allChartStat=this.allStats,this.tagList))if("verizon-direct-arb"==t.tag.advertiser)for(var e of t.tag.subids)"Contains"==e.filterTag?this.allChartStat.map(r=>{r.subid.includes(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"StartsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.startsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"EndsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.endsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"ExactValue"==e.filterTag&&this.allChartStat.map(r=>{r.subid==e.subid&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)});var r=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const p=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return p(t,a)}))},b=p(r,["date","publisher"]),d=[];for(const t in b)if(b.hasOwnProperty(t))for(const e in b[t]){const r={date:b[t][e][0].date,publisher:b[t][e][0].publisher,revenue:s.reduce(b[t][e],(t,e)=>t+e.revenue,0)};d.push(r)}let f=[];for(let t of d)f.push(t.publisher);var a=f.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var n={},i=this.allChartStat.reduce((function(t,e){var r=e.date;return n[r]?(n[r].searches+=parseInt(e.searches),e.revenue&&(n[r].revenue+=e.revenue)):(n[r]=Object.assign({},e),t.push(n[r])),t}),[]),o=[],c=[],l={};for(var u of this.daysList){var h=i.filter(t=>t.date==u);if(0==h.length)o.push(u),c.push(0);else for(var g of h)o.push(g.date),c.push(g.searches)}let m=[];for(let t of a){let e=[];for(let a of o){let r=d.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,m.push(r)}return l.revenuePerDay=m,l.datesOfRevenue=o,l.searchesPerDay=c,l.publisherName=a,l}catch(p){return p}}))}getAllVerizonStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonarbService.getAllVerizonArbStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("verizon-direct-arb"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonarbService.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(bo.a),c.Qb(c.i),c.Qb(l.a),c.Qb(h.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-verizon-direct-arb"]],viewQuery:function(t,e){var r;1&t&&c.Tc(fo,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:47,vars:29,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(c.Mc(0,mo,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,vo,1,1,"app-reporting-revenue-chart",2),c.Mc(3,yo,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,wo,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,Mo,1,4,"ng-template",17),c.Vb(),c.Mc(24,Vo,3,1,"ngx-datatable-column",18),c.Mc(25,xo,3,0,"ngx-datatable-column",19),c.Mc(26,Ro,3,1,"ngx-datatable-column",20),c.Mc(27,No,3,0,"ngx-datatable-column",21),c.Mc(28,Ao,3,0,"ngx-datatable-column",22),c.Mc(29,Yo,3,0,"ngx-datatable-column",23),c.Mc(30,Bo,3,0,"ngx-datatable-column",24),c.Mc(31,qo,3,0,"ngx-datatable-column",25),c.Mc(32,Xo,3,0,"ngx-datatable-column",26),c.Mc(33,tc,3,0,"ngx-datatable-column",27),c.Mc(34,ac,3,0,"ngx-datatable-column",28),c.Wb(35,"ngx-datatable-column",29),c.Mc(36,nc,1,0,"ng-template",30),c.Mc(37,ic,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",31),c.Mc(39,sc,1,0,"ng-template",30),c.Mc(40,oc,3,4,"ng-template",17),c.Vb(),c.Wb(41,"ngx-datatable-column",32),c.Mc(42,cc,1,0,"ng-template",30),c.Mc(43,lc,3,4,"ng-template",17),c.Vb(),c.Wb(44,"ngx-datatable-column",33),c.Mc(45,uc,1,0,"ng-template",30),c.Mc(46,hc,4,6,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(10),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,D,M,a.o],pipes:[a.f,a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})();const pc=es.a.apiUrl+"/stats/admin/verizon-arb-hourly";let bc=(()=>{class t{constructor(t){this.http=t}getChartMetrics(t,e,r){return this.http.get(pc+"/chart_metrics",{params:{company:t,startDate:e,endDate:r}})}getAllVerizonArbHourlyStats(t,e,r){return this.http.get(pc+"/",{params:{company:t,startDate:e,endDate:r}})}getAllPublisherVerizonArbHourlyStats(t,e,r){return this.http.get(pc+"/all-publishers",{params:{company:t,startDate:e,endDate:r}})}getTagSummaryMetrics(t,e,r,a){return this.http.get(pc+"/summary_tag_metrics",{params:{company:t,tagId:e,startDate:r,endDate:a}})}getSummaryMetrics(t,e,r){return this.http.get(pc+"/summary_metrics",{params:{company:t,startDate:e,endDate:r}})}getAllDashboardStats(){return this.http.get(pc+"/all-stat")}}return t.\u0275fac=function(e){return new(e||t)(c.ec(rs.c))},t.\u0275prov=c.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),dc=(()=>{class t{constructor(){}ngOnInit(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}ngOnChanges(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}setChartOptions(t,e,r,a,n,i){this.chartDom=document.getElementById("main"),this.myChart=y.a(this.chartDom);let s=[];for(var o of a){let t=Object.keys(o)[0];t&&s.push({name:t,type:"bar",stack:"Ad",data:o[t].map(t=>parseFloat(t).toFixed(2))})}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(t){var e=t=>'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+t+'"></span>';let r="<p>"+t[0].axisValue+"</p>",a=0;return t.forEach(t=>{var n="<p>"+e(t.color)+" "+t.seriesName+":  $ "+t.data+"</p>";r+=n,a+=parseFloat(t.data)}),r+="<p>"+e("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>",r}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:n},xAxis:[{type:"category",data:r,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:s},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}convertTimeStampArryToDate(t){let e=[];for(let r=0;r<t.length;r++)e.push(o(t[r]).format("MMM DD, YYYY hha"));return e}getChartData(t){if(t)return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Kb({type:t,selectors:[["app-reporting-hourly-revenue-chart"]],inputs:{chartData:"chartData"},features:[c.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(t,e){1&t&&c.Rb(0,"div",0)},styles:[""]}),t})();const fc=["expandableTable"];function mc(t,e){1&t&&(c.Wb(0,"div",34),c.Rb(1,"mat-progress-bar",35),c.Vb())}function vc(t,e){if(1&t&&c.Rb(0,"app-reporting-hourly-revenue-chart",36),2&t){const t=c.lc();c.rc("chartData",t.chartData)}}function yc(t,e){if(1&t&&c.Rb(0,"app-summary-metrics",37),2&t){const t=c.lc();c.rc("summaryMetricsData",t.summaryMetrics)}}function Dc(t,e){if(1&t&&(c.Wb(0,"tr"),c.Wb(1,"td"),c.Oc(2),c.Vb(),c.Wb(3,"td"),c.Oc(4),c.mc(5,"number"),c.Vb(),c.Wb(6,"td"),c.Oc(7),c.mc(8,"number"),c.Vb(),c.Wb(9,"td"),c.Oc(10),c.mc(11,"percent"),c.Vb(),c.Wb(12,"td"),c.Oc(13),c.mc(14,"currency"),c.Vb(),c.Wb(15,"td"),c.Oc(16),c.mc(17,"currency"),c.Vb(),c.Wb(18,"td"),c.Oc(19),c.mc(20,"currency"),c.Vb(),c.Wb(21,"td"),c.Oc(22),c.mc(23,"currency"),c.Vb(),c.Vb()),2&t){const t=e.$implicit,r=c.lc(3);c.Db(2),c.Pc(r.formattedDate(t.date)),c.Db(2),c.Pc(c.nc(5,8,t.searches)),c.Db(3),c.Pc(c.nc(8,10,t.clicks)),c.Db(3),c.Pc(c.oc(11,12,t.ctr||0,"2.2-2")),c.Db(3),c.Pc(c.oc(14,15,t.cpc||0,"USD")),c.Db(3),c.Pc(c.oc(17,18,t.publisherNet,"USD")),c.Db(3),c.Pc(c.oc(20,21,t.profit,"USD")),c.Db(3),c.Pc(c.oc(23,24,t.revenue,"USD"))}}function Sc(t,e){if(1&t&&(c.Wb(0,"div",40),c.Wb(1,"table",41),c.Wb(2,"thead"),c.Wb(3,"tr"),c.Wb(4,"th"),c.Oc(5,"Date"),c.Vb(),c.Wb(6,"th"),c.Oc(7,"Searches"),c.Vb(),c.Wb(8,"th"),c.Oc(9,"Clicks"),c.Vb(),c.Wb(10,"th"),c.Oc(11,"CTR"),c.Vb(),c.Wb(12,"th"),c.Oc(13,"CPC"),c.Vb(),c.Wb(14,"th"),c.Oc(15,"Publisher Net"),c.Vb(),c.Wb(16,"th"),c.Oc(17,"Profit"),c.Vb(),c.Wb(18,"th"),c.Oc(19,"Revenue"),c.Vb(),c.Vb(),c.Vb(),c.Wb(20,"tbody"),c.Mc(21,Dc,24,27,"tr",42),c.Vb(),c.Vb(),c.Vb()),2&t){const t=c.lc().row;c.Db(21),c.rc("ngForOf",t.subReportingForDate)}}function Fc(t,e){1&t&&(c.Wb(0,"div",43),c.Wb(1,"div"),c.Wb(2,"strong"),c.Oc(3,"Address"),c.Vb(),c.Vb(),c.Wb(4,"div"),c.Oc(5,"Test"),c.Vb(),c.Vb())}function wc(t,e){if(1&t&&(c.Mc(0,Sc,22,1,"div",38),c.Mc(1,Fc,6,0,"div",39)),2&t){const t=c.lc();c.rc("ngIf","publisher"===t.groupType||"subid"===t.groupType),c.Db(1),c.rc("ngIf","publisher"!==t.groupType&&"subid"!==t.groupType)}}function Mc(t,e){if(1&t){const t=c.Xb();c.Wb(0,"a",44),c.hc("click",(function(){c.Dc(t);const r=e.row;return c.lc().toggleExpandRow(r)})),c.Vb()}if(2&t){const t=e.expanded;c.Ib("datatable-icon-right",!t)("datatable-icon-down",t)}}function Wc(t,e){1&t&&c.Oc(0," Date ")}function Pc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value,r=c.lc(2);c.Db(1),c.Pc(r.formattedDate(t))}}function Vc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",45),c.Mc(1,Wc,1,0,"ng-template",30),c.Mc(2,Pc,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function Oc(t,e){1&t&&c.Oc(0," Subid ")}function Cc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function xc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",46),c.Mc(1,Oc,1,0,"ng-template",30),c.Mc(2,Cc,2,1,"ng-template",17),c.Vb())}function _c(t,e){1&t&&c.Oc(0," Publisher ")}function Tc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(t)}}function Rc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",47),c.Mc(1,_c,1,0,"ng-template",30),c.Mc(2,Tc,2,1,"ng-template",17),c.Vb()),2&t&&c.rc("minWidth",100)}function kc(t,e){1&t&&c.Oc(0," Searches ")}function Ic(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Nc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",48),c.Mc(1,kc,1,0,"ng-template",30),c.Mc(2,Ic,3,3,"ng-template",17),c.Vb())}function Lc(t,e){1&t&&c.Oc(0," Bid Searches ")}function jc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Ac(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",49),c.Mc(1,Lc,1,0,"ng-template",30),c.Mc(2,jc,3,3,"ng-template",17),c.Vb())}function zc(t,e){1&t&&c.Oc(0," Clicks ")}function Ec(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Yc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",50),c.Mc(1,zc,1,0,"ng-template",30),c.Mc(2,Ec,3,3,"ng-template",17),c.Vb())}function Hc(t,e){1&t&&c.Oc(0," Coverage ")}function Uc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function Bc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",51),c.Mc(1,Hc,1,0,"ng-template",30),c.Mc(2,Uc,3,3,"ng-template",17),c.Vb())}function Qc(t,e){1&t&&c.Oc(0," CTR ")}function Gc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"percent"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"2.2-2"))}}function qc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",52),c.Mc(1,Qc,1,0,"ng-template",30),c.Mc(2,Gc,3,4,"ng-template",17),c.Vb())}function $c(t,e){1&t&&c.Oc(0," CPC ")}function Kc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t||0,"USD"))}}function Xc(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",53),c.Mc(1,$c,1,0,"ng-template",30),c.Mc(2,Kc,3,4,"ng-template",17),c.Vb())}function Zc(t,e){1&t&&c.Oc(0," RN ")}function Jc(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function tl(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",54),c.Mc(1,Zc,1,0,"ng-template",30),c.Mc(2,Jc,3,3,"ng-template",17),c.Vb())}function el(t,e){1&t&&c.Oc(0," TQ ")}function rl(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t))}}function al(t,e){1&t&&(c.Wb(0,"ngx-datatable-column",55),c.Mc(1,el,1,0,"ng-template",30),c.Mc(2,rl,3,3,"ng-template",17),c.Vb())}function nl(t,e){1&t&&c.Oc(0," Publisher Net ")}function il(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function sl(t,e){1&t&&c.Oc(0," Profit ")}function ol(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function cl(t,e){1&t&&c.Oc(0," Revenue ")}function ll(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"currency"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.oc(2,1,t,"USD"))}}function ul(t,e){1&t&&c.Oc(0," Split ")}function hl(t,e){if(1&t&&(c.Wb(0,"strong"),c.Oc(1),c.mc(2,"number"),c.mc(3,"number"),c.Vb()),2&t){const t=e.value;c.Db(1),c.Pc(c.nc(2,1,t)||c.oc(3,3,0,"1.0-0"))}}const gl=[{path:"",component:xr,children:[{path:"accounting",component:po},{path:"perion",component:Cr},{path:"image-advantage",component:ye},{path:"hopkins",component:Jt},{path:"apptitude",component:bt},{path:"media-net",component:De},{path:"bing-direct",component:$r},{path:"lyons",component:ja},{path:"rubi",component:yn},{path:"system1",component:ts},{path:"verizon-direct",component:mi},{path:"verizon-direct-arb",component:gc},{path:"verizon-direct-arb-hourly",component:(()=>{class t{constructor(t,e,r,a,n){this.cdr=t,this.userService=e,this.tagService=r,this.verizonarbHourlyService=a,this.datePipe=n,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}ngAfterViewInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.tagList=yield this.getCompanyTags(this.selectedCompany),this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.refreshTable()}))}formattedDate(t){return this.datePipe.transform(t,"MMM dd, yyyy hh a")||""}getSelectedCompanyFromLocalStorage(){return this.userService.getSelectedCompanyFromLocalStorage()}updateReportingFiltering(t){return Object(i.a)(this,void 0,void 0,(function*(){this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],this.rows=yield this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate),this.chartData=yield this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.summaryMetrics=yield this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable()}))}refreshTable(){this.cdr.markForCheck()}groupDate(){var t={},e=this.allStats.reduce((function(e,r){var a=r.date;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks;this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupSubid(){var t={},e=this.allStats.reduce((function(e,r){var a=r.subid;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForSubid(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}groupProvider(){var t={},e=this.allStats.reduce((function(e,r){var a=r.publisher;return t[a]?(t[a].clicks+=parseFloat(r.clicks),t[a].ctr+=parseFloat(r.ctr?r.ctr:0),t[a].rn+=parseFloat(r.rn?r.rn:0),t[a].coverage+=parseFloat(r.coverage?r.coverage:0),t[a].searches+=parseFloat(r.searches?r.searches:0),t[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),t[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),t[a].profit+=parseFloat(r.profit),t[a].publisherNet+=parseFloat(r.publisherNet),t[a].revenue+=parseFloat(r.revenue),t[a].split+=parseFloat(r.split),t[a].counter++):(t[a]=Object.assign({},r),t[a].counter=1,e.push(t[a])),e}),[]);for(var r of e)r.split=r.split/r.counter,r.ctr=r.ctr/r.counter,r.cpc=r.revenue/r.clicks,r.subReportingForDate=this.groupDateForPublisher(r),r.detailHeight=50*(r.subReportingForDate.length+1);this.rows=e,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}groupDateForPublisher(t){var e={},r=this.allStats.filter(e=>e.publisher===t.publisher).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.ctr=t.clicks/t.searches,t.cpc=t.revenue/t.clicks;return r}groupDateForSubid(t){var e={},r=this.allStats.filter(e=>e.subid===t.subid).reduce((function(t,r){var a=r.date;return e[a]?(e[a].clicks+=parseFloat(r.clicks),e[a].rn+=parseFloat(r.rn?r.rn:0),e[a].coverage+=parseFloat(r.coverage?r.coverage:0),e[a].searches+=parseFloat(r.searches?r.searches:0),e[a].biddedSearches+=parseFloat(r.biddedSearches?r.biddedSearches:0),e[a].biddedResults+=parseFloat(r.biddedResults?r.biddedResults:0),e[a].profit+=parseFloat(r.profit),e[a].publisherNet+=parseFloat(r.publisherNet),e[a].revenue+=parseFloat(r.revenue),e[a].split+=parseFloat(r.split),e[a].counter++):(e[a]=Object.assign({},r),e[a].counter=1,t.push(e[a])),t}),[]);for(var t of r)t.split=t.split/t.counter,t.cpc=t.revenue/t.clicks,t.ctr=t.clicks/t.searches;return r}backGroup(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}toggleExpandRow(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}onDetailToggle(t){console.log("Detail Toggled",t)}remove_element(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}groupHandle(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}getChartMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){try{for(var t of(this.allChartStat=this.allStats,this.tagList))if("verizon-direct-arb-hourly"==t.tag.advertiser)for(var e of t.tag.subids)"Contains"==e.filterTag?this.allChartStat.map(r=>{r.subid.includes(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"StartsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.startsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"EndsWith"==e.filterTag?this.allChartStat.map(r=>{r.subid.endsWith(e.subid)&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)}):"ExactValue"==e.filterTag&&this.allChartStat.map(r=>{r.subid==e.subid&&(r.publisher=t.user.length?t.user[0].fullname:"No Publisher",r.tagname=t.tag.name)});var r=s.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value();const p=(t,e)=>{if(!e.length)return t;var r=e[0],a=e.slice(1);return s.mapValues(s.groupBy(t,r),(function(t){return p(t,a)}))},b=p(r,["date","publisher"]),d=[];for(const t in b)if(b.hasOwnProperty(t))for(const e in b[t]){const r={date:b[t][e][0].date,publisher:b[t][e][0].publisher,revenue:s.reduce(b[t][e],(t,e)=>t+e.revenue,0)};d.push(r)}let f=[];for(let t of d)f.push(t.publisher);var a=f.filter((function(t,e,r){return e===r.indexOf(t)}));this.allChartStat=this.allChartStat.slice().sort((t,e)=>t.date-e.date);var n={},i=this.allChartStat.reduce((function(t,e){var r=e.date;return n[r]?(n[r].searches+=parseInt(e.searches),e.revenue&&(n[r].revenue+=e.revenue)):(n[r]=Object.assign({},e),t.push(n[r])),t}),[]),o=[],c=[],l={};for(var u of this.daysList){var h=i.filter(t=>t.date==u);if(0==h.length)o.push(u),c.push(0);else for(var g of h)o.push(g.date),c.push(g.searches)}let m=[];for(let t of a){let e=[];for(let a of o){let r=d.filter(e=>e.date==a&&e.publisher==t);e.push(r.length>0?r[0].revenue:0)}let r={};r[t]=e,m.push(r)}return l.revenuePerDay=m,l.datesOfRevenue=o,l.searchesPerDay=c,l.publisherName=a,l}catch(p){return p}}))}getAllVerizonStats(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonarbHourlyService.getAllVerizonArbHourlyStats(t,e,r).toPromise();for(var n of(this.loadingIndicator=!1,this.allStats=a.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList))if("verizon-direct-arb-hourly"==n.tag.advertiser)for(var i of n.tag.subids)"Contains"==i.filterTag?this.allStats.map(t=>{t.subid.includes(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"StartsWith"==i.filterTag?this.allStats.map(t=>{t.subid.startsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"EndsWith"==i.filterTag?this.allStats.map(t=>{t.subid.endsWith(i.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}):"ExactValue"==i.filterTag&&this.allStats.map(t=>{t.subid==i.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)});return this.allStats}))}getSummaryMetrics(t,e,r){return Object(i.a)(this,void 0,void 0,(function*(){const a=yield this.verizonarbHourlyService.getSummaryMetrics(t,e,r).toPromise();var n={},i=0,s=0,o=0;return 0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(s=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(o=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=s,a.summary[0].selectedStat[0].percentPace=o,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n}))}getCompanyTags(t){return Object(i.a)(this,void 0,void 0,(function*(){var e=t.split("/")[1];try{return yield this.tagService.getCompanyTags(e).toPromise()}catch(r){return r}}))}getDetailRowHeight(t,e){let r;return t&&(r=t.detailHeight),r}getDateRangeList(t,e){const r=[];let a=o(t).startOf("day");const n=o(e).endOf("day");for(;a<=n;)r.push(o.utc(a).toDate().getTime()),a=o(a).add(1,"hour");return r}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(c.i),c.Qb(l.a),c.Qb(h.a),c.Qb(bc),c.Qb(a.f))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-verizon-direct-arb-hourly"]],viewQuery:function(t,e){var r;1&t&&c.Tc(fc,!0),2&t&&c.zc(r=c.ic())&&(e.table=r.first)},decls:47,vars:29,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(c.Mc(0,mc,2,0,"div",0),c.Wb(1,"app-reporting-filtering",1),c.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),c.Vb(),c.Mc(2,vc,1,1,"app-reporting-hourly-revenue-chart",2),c.Mc(3,yc,1,1,"app-summary-metrics",3),c.Wb(4,"div",4),c.Wb(5,"div",5),c.Wb(6,"mat-form-field",6),c.Wb(7,"mat-label"),c.Oc(8,"Choose an Group By"),c.Vb(),c.Wb(9,"mat-select",7),c.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),c.Wb(10,"mat-option",8),c.Oc(11,"Date"),c.Vb(),c.Wb(12,"mat-option",9),c.Oc(13,"Publisher"),c.Vb(),c.Wb(14,"mat-option",10),c.Oc(15,"Subid"),c.Vb(),c.Wb(16,"mat-option",11),c.Oc(17,"Reset"),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Vb(),c.Wb(18,"ngx-datatable",12,13),c.Wb(20,"ngx-datatable-row-detail",14),c.hc("toggle",(function(t){return e.onDetailToggle(t)})),c.Mc(21,wc,2,2,"ng-template",15),c.Vb(),c.Wb(22,"ngx-datatable-column",16),c.Mc(23,Mc,1,4,"ng-template",17),c.Vb(),c.Mc(24,Vc,3,1,"ngx-datatable-column",18),c.Mc(25,xc,3,0,"ngx-datatable-column",19),c.Mc(26,Rc,3,1,"ngx-datatable-column",20),c.Mc(27,Nc,3,0,"ngx-datatable-column",21),c.Mc(28,Ac,3,0,"ngx-datatable-column",22),c.Mc(29,Yc,3,0,"ngx-datatable-column",23),c.Mc(30,Bc,3,0,"ngx-datatable-column",24),c.Mc(31,qc,3,0,"ngx-datatable-column",25),c.Mc(32,Xc,3,0,"ngx-datatable-column",26),c.Mc(33,tl,3,0,"ngx-datatable-column",27),c.Mc(34,al,3,0,"ngx-datatable-column",28),c.Wb(35,"ngx-datatable-column",29),c.Mc(36,nl,1,0,"ng-template",30),c.Mc(37,il,3,4,"ng-template",17),c.Vb(),c.Wb(38,"ngx-datatable-column",31),c.Mc(39,sl,1,0,"ng-template",30),c.Mc(40,ol,3,4,"ng-template",17),c.Vb(),c.Wb(41,"ngx-datatable-column",32),c.Mc(42,cl,1,0,"ng-template",30),c.Mc(43,ll,3,4,"ng-template",17),c.Vb(),c.Wb(44,"ngx-datatable-column",33),c.Mc(45,ul,1,0,"ng-template",30),c.Mc(46,hl,4,6,"ng-template",17),c.Vb(),c.Vb()),2&t&&(c.rc("ngIf",e.loadingIndicator),c.Db(2),c.rc("ngIf",e.chartData&&!e.loadingIndicator),c.Db(1),c.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),c.Db(6),c.rc("ngModel",e.groupType),c.Db(9),c.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),c.Db(2),c.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),c.Db(2),c.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),c.Db(2),c.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),c.Db(1),c.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(1),c.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),c.Db(10),c.rc("minWidth",35))},directives:[a.p,g.a,p.c,p.g,b.a,d.q,d.t,f.p,m.d,m.e,m.f,m.b,m.a,m.c,v.a,dc,M,a.o],pipes:[a.g,a.w,a.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),t})()},{path:"third-party",component:qr},{path:"solex-bc",component:no},{path:"manual-stat-update",component:fs},{path:"manual-split-update",component:Ms},{path:"",redirectTo:"",pathMatch:"full"},{path:"**",redirectTo:"",pathMatch:"full"}]}];let pl=(()=>{class t{}return t.\u0275mod=c.Ob({type:t}),t.\u0275inj=c.Nb({factory:function(e){return new(e||t)},imports:[[n.k.forChild(gl)],n.k]}),t})();var bl=r("UKGz"),dl=r("e8Ap");let fl=(()=>{class t{}return t.\u0275mod=c.Ob({type:t}),t.\u0275inj=c.Nb({factory:function(e){return new(e||t)},providers:[a.f,a.w,a.d],imports:[[n.k,a.c,pl,m.g,d.w,d.m,S.d,cs.e,p.e,f.n,b.b,bl.a,f.q,we.c,ls.c,dl.b,v.b]]}),t})()}}]);