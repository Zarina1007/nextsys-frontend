!function(){function t(t,r){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,r)}(t))||r&&t&&"number"==typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==a.return||a.return()}finally{if(c)throw o}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{LvDl:function(t,e,r){(function(t){var a;(function(){var n="Expected a function",i="__lodash_placeholder__",o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],s="[object Arguments]",c="[object Array]",u="[object Boolean]",l="[object Date]",h="[object Error]",p="[object Function]",g="[object GeneratorFunction]",b="[object Map]",f="[object Number]",d="[object Object]",m="[object RegExp]",v="[object Set]",y="[object String]",D="[object Symbol]",S="[object WeakMap]",w="[object ArrayBuffer]",F="[object DataView]",x="[object Float32Array]",M="[object Float64Array]",W="[object Int8Array]",P="[object Int16Array]",V="[object Int32Array]",O="[object Uint8Array]",C="[object Uint16Array]",k="[object Uint32Array]",R=/\b__p \+= '';/g,_=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,I=/&(?:amp|lt|gt|quot|#39);/g,N=/[&<>"']/g,L=RegExp(I.source),A=RegExp(N.source),j=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,E=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H=/^\w*$/,U=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,B=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(B.source),G=/^\s+/,q=/\s/,$=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,X=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,J=/[()=,{}\[\]\/\s]/,tt=/\\(\\)?/g,et=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,at=/^[-+]0x[0-9a-f]+$/i,nt=/^0b[01]+$/i,it=/^\[object .+?Constructor\]$/,ot=/^0o[0-7]+$/i,st=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ut=/($^)/,lt=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gt="["+pt+"]",bt="["+ht+"]",ft="\\d+",dt="[a-z\\xdf-\\xf6\\xf8-\\xff]",mt="[^\\ud800-\\udfff"+pt+ft+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",vt="\\ud83c[\\udffb-\\udfff]",yt="[^\\ud800-\\udfff]",Dt="(?:\\ud83c[\\udde6-\\uddff]){2}",St="[\\ud800-\\udbff][\\udc00-\\udfff]",wt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ft="(?:"+dt+"|"+mt+")",xt="(?:"+wt+"|"+mt+")",Mt="(?:"+bt+"|"+vt+")?",Wt="[\\ufe0e\\ufe0f]?"+Mt+"(?:\\u200d(?:"+[yt,Dt,St].join("|")+")[\\ufe0e\\ufe0f]?"+Mt+")*",Pt="(?:"+["[\\u2700-\\u27bf]",Dt,St].join("|")+")"+Wt,Vt="(?:"+[yt+bt+"?",bt,Dt,St,"[\\ud800-\\udfff]"].join("|")+")",Ot=RegExp("['\u2019]","g"),Ct=RegExp(bt,"g"),kt=RegExp(vt+"(?="+vt+")|"+Vt+Wt,"g"),Rt=RegExp([wt+"?"+dt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[gt,wt,"$"].join("|")+")",xt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[gt,wt+Ft,"$"].join("|")+")",wt+"?"+Ft+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",wt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ft,Pt].join("|"),"g"),_t=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),Tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,It=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Nt=-1,Lt={};Lt[x]=Lt[M]=Lt[W]=Lt[P]=Lt[V]=Lt[O]=Lt["[object Uint8ClampedArray]"]=Lt[C]=Lt[k]=!0,Lt[s]=Lt[c]=Lt[w]=Lt[u]=Lt[F]=Lt[l]=Lt[h]=Lt[p]=Lt[b]=Lt[f]=Lt[d]=Lt[m]=Lt[v]=Lt[y]=Lt[S]=!1;var At={};At[s]=At[c]=At[w]=At[F]=At[u]=At[l]=At[x]=At[M]=At[W]=At[P]=At[V]=At[b]=At[f]=At[d]=At[m]=At[v]=At[y]=At[D]=At[O]=At["[object Uint8ClampedArray]"]=At[C]=At[k]=!0,At[h]=At[p]=At[S]=!1;var jt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zt=parseFloat,Et=parseInt,Yt="object"==typeof global&&global&&global.Object===Object&&global,Ht="object"==typeof self&&self&&self.Object===Object&&self,Ut=Yt||Ht||Function("return this")(),Bt=e&&!e.nodeType&&e,Qt=Bt&&"object"==typeof t&&t&&!t.nodeType&&t,Gt=Qt&&Qt.exports===Bt,qt=Gt&&Yt.process,$t=function(){try{return Qt&&Qt.require&&Qt.require("util").types||qt&&qt.binding&&qt.binding("util")}catch(t){}}(),Kt=$t&&$t.isArrayBuffer,Xt=$t&&$t.isDate,Zt=$t&&$t.isMap,Jt=$t&&$t.isRegExp,te=$t&&$t.isSet,ee=$t&&$t.isTypedArray;function re(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function ae(t,e,r,a){for(var n=-1,i=null==t?0:t.length;++n<i;){var o=t[n];e(a,o,r(o),t)}return a}function ne(t,e){for(var r=-1,a=null==t?0:t.length;++r<a&&!1!==e(t[r],r,t););return t}function ie(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function oe(t,e){for(var r=-1,a=null==t?0:t.length;++r<a;)if(!e(t[r],r,t))return!1;return!0}function se(t,e){for(var r=-1,a=null==t?0:t.length,n=0,i=[];++r<a;){var o=t[r];e(o,r,t)&&(i[n++]=o)}return i}function ce(t,e){return!(null==t||!t.length)&&ve(t,e,0)>-1}function ue(t,e,r){for(var a=-1,n=null==t?0:t.length;++a<n;)if(r(e,t[a]))return!0;return!1}function le(t,e){for(var r=-1,a=null==t?0:t.length,n=Array(a);++r<a;)n[r]=e(t[r],r,t);return n}function he(t,e){for(var r=-1,a=e.length,n=t.length;++r<a;)t[n+r]=e[r];return t}function pe(t,e,r,a){var n=-1,i=null==t?0:t.length;for(a&&i&&(r=t[++n]);++n<i;)r=e(r,t[n],n,t);return r}function ge(t,e,r,a){var n=null==t?0:t.length;for(a&&n&&(r=t[--n]);n--;)r=e(r,t[n],n,t);return r}function be(t,e){for(var r=-1,a=null==t?0:t.length;++r<a;)if(e(t[r],r,t))return!0;return!1}var fe=we("length");function de(t,e,r){var a;return r(t,(function(t,r,n){if(e(t,r,n))return a=r,!1})),a}function me(t,e,r,a){for(var n=t.length,i=r+(a?1:-1);a?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function ve(t,e,r){return e==e?function(t,e,r){for(var a=r-1,n=t.length;++a<n;)if(t[a]===e)return a;return-1}(t,e,r):me(t,De,r)}function ye(t,e,r,a){for(var n=r-1,i=t.length;++n<i;)if(a(t[n],e))return n;return-1}function De(t){return t!=t}function Se(t,e){var r=null==t?0:t.length;return r?Me(t,e)/r:NaN}function we(t){return function(e){return null==e?void 0:e[t]}}function Fe(t){return function(e){return null==t?void 0:t[e]}}function xe(t,e,r,a,n){return n(t,(function(t,n,i){r=a?(a=!1,t):e(r,t,n,i)})),r}function Me(t,e){for(var r,a=-1,n=t.length;++a<n;){var i=e(t[a]);void 0!==i&&(r=void 0===r?i:r+i)}return r}function We(t,e){for(var r=-1,a=Array(t);++r<t;)a[r]=e(r);return a}function Pe(t){return t?t.slice(0,Be(t)+1).replace(G,""):t}function Ve(t){return function(e){return t(e)}}function Oe(t,e){return le(e,(function(e){return t[e]}))}function Ce(t,e){return t.has(e)}function ke(t,e){for(var r=-1,a=t.length;++r<a&&ve(e,t[r],0)>-1;);return r}function Re(t,e){for(var r=t.length;r--&&ve(e,t[r],0)>-1;);return r}function _e(t,e){for(var r=t.length,a=0;r--;)t[r]===e&&++a;return a}var Te=Fe({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Ie=Fe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ne(t){return"\\"+jt[t]}function Le(t){return _t.test(t)}function Ae(t){var e=-1,r=Array(t.size);return t.forEach((function(t,a){r[++e]=[a,t]})),r}function je(t,e){return function(r){return t(e(r))}}function ze(t,e){for(var r=-1,a=t.length,n=0,o=[];++r<a;){var s=t[r];s!==e&&s!==i||(t[r]=i,o[n++]=r)}return o}function Ee(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function Ye(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=[t,t]})),r}function He(t){return Le(t)?function(t){for(var e=kt.lastIndex=0;kt.test(t);)++e;return e}(t):fe(t)}function Ue(t){return Le(t)?function(t){return t.match(kt)||[]}(t):function(t){return t.split("")}(t)}function Be(t){for(var e=t.length;e--&&q.test(t.charAt(e)););return e}var Qe=Fe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ge=function t(e){var r,a=(e=null==e?Ut:Ge.defaults(Ut.Object(),e,Ge.pick(Ut,It))).Array,q=e.Date,ht=e.Error,pt=e.Function,gt=e.Math,bt=e.Object,ft=e.RegExp,dt=e.String,mt=e.TypeError,vt=a.prototype,yt=bt.prototype,Dt=e["__core-js_shared__"],St=pt.prototype.toString,wt=yt.hasOwnProperty,Ft=0,xt=(r=/[^.]+$/.exec(Dt&&Dt.keys&&Dt.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",Mt=yt.toString,Wt=St.call(bt),Pt=Ut._,Vt=ft("^"+St.call(wt).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=Gt?e.Buffer:void 0,_t=e.Symbol,jt=e.Uint8Array,Yt=kt?kt.allocUnsafe:void 0,Ht=je(bt.getPrototypeOf,bt),Bt=bt.create,Qt=yt.propertyIsEnumerable,qt=vt.splice,$t=_t?_t.isConcatSpreadable:void 0,fe=_t?_t.iterator:void 0,Fe=_t?_t.toStringTag:void 0,qe=function(){try{var t=Zn(bt,"defineProperty");return t({},"",{}),t}catch(e){}}(),$e=e.clearTimeout!==Ut.clearTimeout&&e.clearTimeout,Ke=q&&q.now!==Ut.Date.now&&q.now,Xe=e.setTimeout!==Ut.setTimeout&&e.setTimeout,Ze=gt.ceil,Je=gt.floor,tr=bt.getOwnPropertySymbols,er=kt?kt.isBuffer:void 0,rr=e.isFinite,ar=vt.join,nr=je(bt.keys,bt),ir=gt.max,or=gt.min,sr=q.now,cr=e.parseInt,ur=gt.random,lr=vt.reverse,hr=Zn(e,"DataView"),pr=Zn(e,"Map"),gr=Zn(e,"Promise"),br=Zn(e,"Set"),fr=Zn(e,"WeakMap"),dr=Zn(bt,"create"),mr=fr&&new fr,vr={},yr=Pi(hr),Dr=Pi(pr),Sr=Pi(gr),wr=Pi(br),Fr=Pi(fr),xr=_t?_t.prototype:void 0,Mr=xr?xr.valueOf:void 0,Wr=xr?xr.toString:void 0;function Pr(t){if(Bo(t)&&!To(t)&&!(t instanceof kr)){if(t instanceof Cr)return t;if(wt.call(t,"__wrapped__"))return Vi(t)}return new Cr(t)}var Vr=function(){function t(){}return function(e){if(!Uo(e))return{};if(Bt)return Bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function Or(){}function Cr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function kr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Rr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function _r(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function Tr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function Ir(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Tr;++e<r;)this.add(t[e])}function Nr(t){var e=this.__data__=new _r(t);this.size=e.size}function Lr(t,e){var r=To(t),a=!r&&_o(t),n=!r&&!a&&Ao(t),i=!r&&!a&&!n&&Jo(t),o=r||a||n||i,s=o?We(t.length,dt):[],c=s.length;for(var u in t)!e&&!wt.call(t,u)||o&&("length"==u||n&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ii(u,c))||s.push(u);return s}function Ar(t){var e=t.length;return e?t[Ta(0,e-1)]:void 0}function jr(t,e){return wi(dn(t),qr(e,0,t.length))}function zr(t){return wi(dn(t))}function Er(t,e,r){(void 0!==r&&!Co(t[e],r)||void 0===r&&!(e in t))&&Qr(t,e,r)}function Yr(t,e,r){var a=t[e];wt.call(t,e)&&Co(a,r)&&(void 0!==r||e in t)||Qr(t,e,r)}function Hr(t,e){for(var r=t.length;r--;)if(Co(t[r][0],e))return r;return-1}function Ur(t,e,r,a){return Jr(t,(function(t,n,i){e(a,t,r(t),i)})),a}function Br(t,e){return t&&mn(e,Ss(e),t)}function Qr(t,e,r){"__proto__"==e&&qe?qe(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Gr(t,e){for(var r=-1,n=e.length,i=a(n),o=null==t;++r<n;)i[r]=o?void 0:ds(t,e[r]);return i}function qr(t,e,r){return t==t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t}function $r(t,e,r,a,n,i){var o,c=1&e,h=2&e,S=4&e;if(r&&(o=n?r(t,a,n,i):r(t)),void 0!==o)return o;if(!Uo(t))return t;var R=To(t);if(R){if(o=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&wt.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return dn(t,o)}else{var _=ei(t),T=_==p||_==g;if(Ao(t))return ln(t,c);if(_==d||_==s||T&&!n){if(o=h||T?{}:ai(t),!c)return h?function(t,e){return mn(t,ti(t),e)}(t,function(t,e){return t&&mn(e,ws(e),t)}(o,t)):function(t,e){return mn(t,Jn(t),e)}(t,Br(o,t))}else{if(!At[_])return n?t:{};o=function(t,e,r){var a=t.constructor;switch(e){case w:return hn(t);case u:case l:return new a(+t);case F:return function(t,e){var r=e?hn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case x:case M:case W:case P:case V:case O:case"[object Uint8ClampedArray]":case C:case k:return pn(t,r);case b:return new a;case f:case y:return new a(t);case m:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return new a;case D:return Mr?bt(Mr.call(t)):{}}}(t,_,c)}}i||(i=new Nr);var I=i.get(t);if(I)return I;i.set(t,o),Ko(t)?t.forEach((function(a){o.add($r(a,e,r,a,t,i))})):Qo(t)&&t.forEach((function(a,n){o.set(n,$r(a,e,r,n,t,i))}));var N=R?void 0:(S?h?Bn:Un:h?ws:Ss)(t);return ne(N||t,(function(a,n){N&&(a=t[n=a]),Yr(o,n,$r(a,e,r,n,t,i))})),o}function Kr(t,e,r){var a=r.length;if(null==t)return!a;for(t=bt(t);a--;){var n=r[a],i=t[n];if(void 0===i&&!(n in t)||!(0,e[n])(i))return!1}return!0}function Xr(t,e,r){if("function"!=typeof t)throw new mt(n);return vi((function(){t.apply(void 0,r)}),e)}function Zr(t,e,r,a){var n=-1,i=ce,o=!0,s=t.length,c=[],u=e.length;if(!s)return c;r&&(e=le(e,Ve(r))),a?(i=ue,o=!1):e.length>=200&&(i=Ce,o=!1,e=new Ir(e));t:for(;++n<s;){var l=t[n],h=null==r?l:r(l);if(l=a||0!==l?l:0,o&&h==h){for(var p=u;p--;)if(e[p]===h)continue t;c.push(l)}else i(e,h,a)||c.push(l)}return c}Pr.templateSettings={escape:j,evaluate:z,interpolate:E,variable:"",imports:{_:Pr}},(Pr.prototype=Or.prototype).constructor=Pr,(Cr.prototype=Vr(Or.prototype)).constructor=Cr,(kr.prototype=Vr(Or.prototype)).constructor=kr,Rr.prototype.clear=function(){this.__data__=dr?dr(null):{},this.size=0},Rr.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Rr.prototype.get=function(t){var e=this.__data__;if(dr){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return wt.call(e,t)?e[t]:void 0},Rr.prototype.has=function(t){var e=this.__data__;return dr?void 0!==e[t]:wt.call(e,t)},Rr.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=dr&&void 0===e?"__lodash_hash_undefined__":e,this},_r.prototype.clear=function(){this.__data__=[],this.size=0},_r.prototype.delete=function(t){var e=this.__data__,r=Hr(e,t);return!(r<0||(r==e.length-1?e.pop():qt.call(e,r,1),--this.size,0))},_r.prototype.get=function(t){var e=this.__data__,r=Hr(e,t);return r<0?void 0:e[r][1]},_r.prototype.has=function(t){return Hr(this.__data__,t)>-1},_r.prototype.set=function(t,e){var r=this.__data__,a=Hr(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this},Tr.prototype.clear=function(){this.size=0,this.__data__={hash:new Rr,map:new(pr||_r),string:new Rr}},Tr.prototype.delete=function(t){var e=Kn(this,t).delete(t);return this.size-=e?1:0,e},Tr.prototype.get=function(t){return Kn(this,t).get(t)},Tr.prototype.has=function(t){return Kn(this,t).has(t)},Tr.prototype.set=function(t,e){var r=Kn(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this},Ir.prototype.add=Ir.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Ir.prototype.has=function(t){return this.__data__.has(t)},Nr.prototype.clear=function(){this.__data__=new _r,this.size=0},Nr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Nr.prototype.get=function(t){return this.__data__.get(t)},Nr.prototype.has=function(t){return this.__data__.has(t)},Nr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof _r){var a=r.__data__;if(!pr||a.length<199)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new Tr(a)}return r.set(t,e),this.size=r.size,this};var Jr=Dn(sa),ta=Dn(ca,!0);function ea(t,e){var r=!0;return Jr(t,(function(t,a,n){return r=!!e(t,a,n)})),r}function ra(t,e,r){for(var a=-1,n=t.length;++a<n;){var i=t[a],o=e(i);if(null!=o&&(void 0===s?o==o&&!Zo(o):r(o,s)))var s=o,c=i}return c}function aa(t,e){var r=[];return Jr(t,(function(t,a,n){e(t,a,n)&&r.push(t)})),r}function na(t,e,r,a,n){var i=-1,o=t.length;for(r||(r=ni),n||(n=[]);++i<o;){var s=t[i];e>0&&r(s)?e>1?na(s,e-1,r,a,n):he(n,s):a||(n[n.length]=s)}return n}var ia=Sn(),oa=Sn(!0);function sa(t,e){return t&&ia(t,e,Ss)}function ca(t,e){return t&&oa(t,e,Ss)}function ua(t,e){return se(e,(function(e){return Eo(t[e])}))}function la(t,e){for(var r=0,a=(e=on(e,t)).length;null!=t&&r<a;)t=t[Wi(e[r++])];return r&&r==a?t:void 0}function ha(t,e,r){var a=e(t);return To(t)?a:he(a,r(t))}function pa(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Fe&&Fe in bt(t)?function(t){var e=wt.call(t,Fe),r=t[Fe];try{t[Fe]=void 0;var a=!0}catch(i){}var n=Mt.call(t);return a&&(e?t[Fe]=r:delete t[Fe]),n}(t):function(t){return Mt.call(t)}(t)}function ga(t,e){return t>e}function ba(t,e){return null!=t&&wt.call(t,e)}function fa(t,e){return null!=t&&e in bt(t)}function da(t,e,r){for(var n=r?ue:ce,i=t[0].length,o=t.length,s=o,c=a(o),u=1/0,l=[];s--;){var h=t[s];s&&e&&(h=le(h,Ve(e))),u=or(h.length,u),c[s]=!r&&(e||i>=120&&h.length>=120)?new Ir(s&&h):void 0}h=t[0];var p=-1,g=c[0];t:for(;++p<i&&l.length<u;){var b=h[p],f=e?e(b):b;if(b=r||0!==b?b:0,!(g?Ce(g,f):n(l,f,r))){for(s=o;--s;){var d=c[s];if(!(d?Ce(d,f):n(t[s],f,r)))continue t}g&&g.push(f),l.push(b)}}return l}function ma(t,e,r){var a=null==(t=bi(t,e=on(e,t)))?t:t[Wi(ji(e))];return null==a?void 0:re(a,t,r)}function va(t){return Bo(t)&&pa(t)==s}function ya(t,e,r,a,n){return t===e||(null==t||null==e||!Bo(t)&&!Bo(e)?t!=t&&e!=e:function(t,e,r,a,n,i){var o=To(t),p=To(e),g=o?c:ei(t),S=p?c:ei(e),x=(g=g==s?d:g)==d,M=(S=S==s?d:S)==d,W=g==S;if(W&&Ao(t)){if(!Ao(e))return!1;o=!0,x=!1}if(W&&!x)return i||(i=new Nr),o||Jo(t)?Yn(t,e,r,a,n,i):function(t,e,r,a,n,i,o){switch(r){case F:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case w:return!(t.byteLength!=e.byteLength||!i(new jt(t),new jt(e)));case u:case l:case f:return Co(+t,+e);case h:return t.name==e.name&&t.message==e.message;case m:case y:return t==e+"";case b:var s=Ae;case v:if(s||(s=Ee),t.size!=e.size&&!(1&a))return!1;var c=o.get(t);if(c)return c==e;a|=2,o.set(t,e);var p=Yn(s(t),s(e),a,n,i,o);return o.delete(t),p;case D:if(Mr)return Mr.call(t)==Mr.call(e)}return!1}(t,e,g,r,a,n,i);if(!(1&r)){var P=x&&wt.call(t,"__wrapped__"),V=M&&wt.call(e,"__wrapped__");if(P||V){var O=P?t.value():t,C=V?e.value():e;return i||(i=new Nr),n(O,C,r,a,i)}}return!!W&&(i||(i=new Nr),function(t,e,r,a,n,i){var o=1&r,s=Un(t),c=s.length;if(c!=Un(e).length&&!o)return!1;for(var u=c;u--;){var l=s[u];if(!(o?l in e:wt.call(e,l)))return!1}var h=i.get(t),p=i.get(e);if(h&&p)return h==e&&p==t;var g=!0;i.set(t,e),i.set(e,t);for(var b=o;++u<c;){var f=t[l=s[u]],d=e[l];if(a)var m=o?a(d,f,l,e,t,i):a(f,d,l,t,e,i);if(!(void 0===m?f===d||n(f,d,r,a,i):m)){g=!1;break}b||(b="constructor"==l)}if(g&&!b){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(g=!1)}return i.delete(t),i.delete(e),g}(t,e,r,a,n,i))}(t,e,r,a,ya,n))}function Da(t,e,r,a){var n=r.length,i=n,o=!a;if(null==t)return!i;for(t=bt(t);n--;){var s=r[n];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++n<i;){var c=(s=r[n])[0],u=t[c],l=s[1];if(o&&s[2]){if(void 0===u&&!(c in t))return!1}else{var h=new Nr;if(a)var p=a(u,l,c,t,e,h);if(!(void 0===p?ya(l,u,3,a,h):p))return!1}}return!0}function Sa(t){return!(!Uo(t)||(e=t,xt&&xt in e))&&(Eo(t)?Vt:it).test(Pi(t));var e}function wa(t){return"function"==typeof t?t:null==t?Gs:"object"==typeof t?To(t)?Pa(t[0],t[1]):Wa(t):rc(t)}function Fa(t){if(!li(t))return nr(t);var e=[];for(var r in bt(t))wt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function xa(t,e){return t<e}function Ma(t,e){var r=-1,n=No(t)?a(t.length):[];return Jr(t,(function(t,a,i){n[++r]=e(t,a,i)})),n}function Wa(t){var e=Xn(t);return 1==e.length&&e[0][2]?pi(e[0][0],e[0][1]):function(r){return r===t||Da(r,t,e)}}function Pa(t,e){return si(t)&&hi(e)?pi(Wi(t),e):function(r){var a=ds(r,t);return void 0===a&&a===e?ms(r,t):ya(e,a,3)}}function Va(t,e,r,a,n){t!==e&&ia(e,(function(i,o){if(n||(n=new Nr),Uo(i))!function(t,e,r,a,n,i,o){var s=di(t,r),c=di(e,r),u=o.get(c);if(u)Er(t,r,u);else{var l=i?i(s,c,r+"",t,e,o):void 0,h=void 0===l;if(h){var p=To(c),g=!p&&Ao(c),b=!p&&!g&&Jo(c);l=c,p||g||b?To(s)?l=s:Lo(s)?l=dn(s):g?(h=!1,l=ln(c,!0)):b?(h=!1,l=pn(c,!0)):l=[]:qo(c)||_o(c)?(l=s,_o(s)?l=ss(s):Uo(s)&&!Eo(s)||(l=ai(c))):h=!1}h&&(o.set(c,l),n(l,c,a,i,o),o.delete(c)),Er(t,r,l)}}(t,e,o,r,Va,a,n);else{var s=a?a(di(t,o),i,o+"",t,e,n):void 0;void 0===s&&(s=i),Er(t,o,s)}}),ws)}function Oa(t,e){var r=t.length;if(r)return ii(e+=e<0?r:0,r)?t[e]:void 0}function Ca(t,e,r){e=e.length?le(e,(function(t){return To(t)?function(e){return la(e,1===t.length?t[0]:t)}:t})):[Gs];var a=-1;return e=le(e,Ve($n())),function(t,e){var a=t.length;for(t.sort((function(t,e){return function(t,e,r){for(var a=-1,n=t.criteria,i=e.criteria,o=n.length,s=r.length;++a<o;){var c=gn(n[a],i[a]);if(c)return a>=s?c:c*("desc"==r[a]?-1:1)}return t.index-e.index}(t,e,r)}));a--;)t[a]=t[a].value;return t}(Ma(t,(function(t,r,n){return{criteria:le(e,(function(e){return e(t)})),index:++a,value:t}})))}function ka(t,e,r){for(var a=-1,n=e.length,i={};++a<n;){var o=e[a],s=la(t,o);r(s,o)&&ja(i,on(o,t),s)}return i}function Ra(t,e,r,a){var n=a?ye:ve,i=-1,o=e.length,s=t;for(t===e&&(e=dn(e)),r&&(s=le(t,Ve(r)));++i<o;)for(var c=0,u=e[i],l=r?r(u):u;(c=n(s,l,c,a))>-1;)s!==t&&qt.call(s,c,1),qt.call(t,c,1);return t}function _a(t,e){for(var r=t?e.length:0,a=r-1;r--;){var n=e[r];if(r==a||n!==i){var i=n;ii(n)?qt.call(t,n,1):Xa(t,n)}}return t}function Ta(t,e){return t+Je(ur()*(e-t+1))}function Ia(t,e){var r="";if(!t||e<1||e>9007199254740991)return r;do{e%2&&(r+=t),(e=Je(e/2))&&(t+=t)}while(e);return r}function Na(t,e){return yi(gi(t,e,Gs),t+"")}function La(t){return Ar(Cs(t))}function Aa(t,e){var r=Cs(t);return wi(r,qr(e,0,r.length))}function ja(t,e,r,a){if(!Uo(t))return t;for(var n=-1,i=(e=on(e,t)).length,o=i-1,s=t;null!=s&&++n<i;){var c=Wi(e[n]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(n!=o){var l=s[c];void 0===(u=a?a(l,c,s):void 0)&&(u=Uo(l)?l:ii(e[n+1])?[]:{})}Yr(s,c,u),s=s[c]}return t}var za=mr?function(t,e){return mr.set(t,e),t}:Gs,Ea=qe?function(t,e){return qe(t,"toString",{configurable:!0,enumerable:!1,value:Us(e),writable:!0})}:Gs;function Ya(t){return wi(Cs(t))}function Ha(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=a(i);++n<i;)o[n]=t[n+e];return o}function Ua(t,e){var r;return Jr(t,(function(t,a,n){return!(r=e(t,a,n))})),!!r}function Ba(t,e,r){var a=0,n=null==t?a:t.length;if("number"==typeof e&&e==e&&n<=2147483647){for(;a<n;){var i=a+n>>>1,o=t[i];null!==o&&!Zo(o)&&(r?o<=e:o<e)?a=i+1:n=i}return n}return Qa(t,e,Gs,r)}function Qa(t,e,r,a){var n=0,i=null==t?0:t.length;if(0===i)return 0;for(var o=(e=r(e))!=e,s=null===e,c=Zo(e),u=void 0===e;n<i;){var l=Je((n+i)/2),h=r(t[l]),p=void 0!==h,g=null===h,b=h==h,f=Zo(h);if(o)var d=a||b;else d=u?b&&(a||p):s?b&&p&&(a||!g):c?b&&p&&!g&&(a||!f):!g&&!f&&(a?h<=e:h<e);d?n=l+1:i=l}return or(i,4294967294)}function Ga(t,e){for(var r=-1,a=t.length,n=0,i=[];++r<a;){var o=t[r],s=e?e(o):o;if(!r||!Co(s,c)){var c=s;i[n++]=0===o?0:o}}return i}function qa(t){return"number"==typeof t?t:Zo(t)?NaN:+t}function $a(t){if("string"==typeof t)return t;if(To(t))return le(t,$a)+"";if(Zo(t))return Wr?Wr.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ka(t,e,r){var a=-1,n=ce,i=t.length,o=!0,s=[],c=s;if(r)o=!1,n=ue;else if(i>=200){var u=e?null:Nn(t);if(u)return Ee(u);o=!1,n=Ce,c=new Ir}else c=e?[]:s;t:for(;++a<i;){var l=t[a],h=e?e(l):l;if(l=r||0!==l?l:0,o&&h==h){for(var p=c.length;p--;)if(c[p]===h)continue t;e&&c.push(h),s.push(l)}else n(c,h,r)||(c!==s&&c.push(h),s.push(l))}return s}function Xa(t,e){return null==(t=bi(t,e=on(e,t)))||delete t[Wi(ji(e))]}function Za(t,e,r,a){return ja(t,e,r(la(t,e)),a)}function Ja(t,e,r,a){for(var n=t.length,i=a?n:-1;(a?i--:++i<n)&&e(t[i],i,t););return r?Ha(t,a?0:i,a?i+1:n):Ha(t,a?i+1:0,a?n:i)}function tn(t,e){var r=t;return r instanceof kr&&(r=r.value()),pe(e,(function(t,e){return e.func.apply(e.thisArg,he([t],e.args))}),r)}function en(t,e,r){var n=t.length;if(n<2)return n?Ka(t[0]):[];for(var i=-1,o=a(n);++i<n;)for(var s=t[i],c=-1;++c<n;)c!=i&&(o[i]=Zr(o[i]||s,t[c],e,r));return Ka(na(o,1),e,r)}function rn(t,e,r){for(var a=-1,n=t.length,i=e.length,o={};++a<n;)r(o,t[a],a<i?e[a]:void 0);return o}function an(t){return Lo(t)?t:[]}function nn(t){return"function"==typeof t?t:Gs}function on(t,e){return To(t)?t:si(t,e)?[t]:Mi(cs(t))}var sn=Na;function cn(t,e,r){var a=t.length;return r=void 0===r?a:r,!e&&r>=a?t:Ha(t,e,r)}var un=$e||function(t){return Ut.clearTimeout(t)};function ln(t,e){if(e)return t.slice();var r=t.length,a=Yt?Yt(r):new t.constructor(r);return t.copy(a),a}function hn(t){var e=new t.constructor(t.byteLength);return new jt(e).set(new jt(t)),e}function pn(t,e){var r=e?hn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function gn(t,e){if(t!==e){var r=void 0!==t,a=null===t,n=t==t,i=Zo(t),o=void 0!==e,s=null===e,c=e==e,u=Zo(e);if(!s&&!u&&!i&&t>e||i&&o&&c&&!s&&!u||a&&o&&c||!r&&c||!n)return 1;if(!a&&!i&&!u&&t<e||u&&r&&n&&!a&&!i||s&&r&&n||!o&&n||!c)return-1}return 0}function bn(t,e,r,n){for(var i=-1,o=t.length,s=r.length,c=-1,u=e.length,l=ir(o-s,0),h=a(u+l),p=!n;++c<u;)h[c]=e[c];for(;++i<s;)(p||i<o)&&(h[r[i]]=t[i]);for(;l--;)h[c++]=t[i++];return h}function fn(t,e,r,n){for(var i=-1,o=t.length,s=-1,c=r.length,u=-1,l=e.length,h=ir(o-c,0),p=a(h+l),g=!n;++i<h;)p[i]=t[i];for(var b=i;++u<l;)p[b+u]=e[u];for(;++s<c;)(g||i<o)&&(p[b+r[s]]=t[i++]);return p}function dn(t,e){var r=-1,n=t.length;for(e||(e=a(n));++r<n;)e[r]=t[r];return e}function mn(t,e,r,a){var n=!r;r||(r={});for(var i=-1,o=e.length;++i<o;){var s=e[i],c=a?a(r[s],t[s],s,r,t):void 0;void 0===c&&(c=t[s]),n?Qr(r,s,c):Yr(r,s,c)}return r}function vn(t,e){return function(r,a){var n=To(r)?ae:Ur,i=e?e():{};return n(r,t,$n(a,2),i)}}function yn(t){return Na((function(e,r){var a=-1,n=r.length,i=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(n--,i):void 0,o&&oi(r[0],r[1],o)&&(i=n<3?void 0:i,n=1),e=bt(e);++a<n;){var s=r[a];s&&t(e,s,a,i)}return e}))}function Dn(t,e){return function(r,a){if(null==r)return r;if(!No(r))return t(r,a);for(var n=r.length,i=e?n:-1,o=bt(r);(e?i--:++i<n)&&!1!==a(o[i],i,o););return r}}function Sn(t){return function(e,r,a){for(var n=-1,i=bt(e),o=a(e),s=o.length;s--;){var c=o[t?s:++n];if(!1===r(i[c],c,i))break}return e}}function wn(t){return function(e){var r=Le(e=cs(e))?Ue(e):void 0,a=r?r[0]:e.charAt(0),n=r?cn(r,1).join(""):e.slice(1);return a[t]()+n}}function Fn(t){return function(e){return pe(Es(_s(e).replace(Ot,"")),t,"")}}function xn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Vr(t.prototype),a=t.apply(r,e);return Uo(a)?a:r}}function Mn(t){return function(e,r,a){var n=bt(e);if(!No(e)){var i=$n(r,3);e=Ss(e),r=function(t){return i(n[t],t,n)}}var o=t(e,r,a);return o>-1?n[i?e[o]:o]:void 0}}function Wn(t){return Hn((function(e){var r=e.length,a=r,i=Cr.prototype.thru;for(t&&e.reverse();a--;){var o=e[a];if("function"!=typeof o)throw new mt(n);if(i&&!s&&"wrapper"==Gn(o))var s=new Cr([],!0)}for(a=s?a:r;++a<r;){var c=Gn(o=e[a]),u="wrapper"==c?Qn(o):void 0;s=u&&ci(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[Gn(u[0])].apply(s,u[3]):1==o.length&&ci(o)?s[c]():s.thru(o)}return function(){var t=arguments,a=t[0];if(s&&1==t.length&&To(a))return s.plant(a).value();for(var n=0,i=r?e[n].apply(this,t):a;++n<r;)i=e[n].call(this,i);return i}}))}function Pn(t,e,r,n,i,o,s,c,u,l){var h=128&e,p=1&e,g=2&e,b=24&e,f=512&e,d=g?void 0:xn(t);return function m(){for(var v=arguments.length,y=a(v),D=v;D--;)y[D]=arguments[D];if(b)var S=qn(m),w=_e(y,S);if(n&&(y=bn(y,n,i,b)),o&&(y=fn(y,o,s,b)),v-=w,b&&v<l){var F=ze(y,S);return Tn(t,e,Pn,m.placeholder,r,y,F,c,u,l-v)}var x=p?r:this,M=g?x[t]:t;return v=y.length,c?y=fi(y,c):f&&v>1&&y.reverse(),h&&u<v&&(y.length=u),this&&this!==Ut&&this instanceof m&&(M=d||xn(M)),M.apply(x,y)}}function Vn(t,e){return function(r,a){return function(t,e,r,a){return sa(t,(function(t,n,i){e(a,r(t),n,i)})),a}(r,t,e(a),{})}}function On(t,e){return function(r,a){var n;if(void 0===r&&void 0===a)return e;if(void 0!==r&&(n=r),void 0!==a){if(void 0===n)return a;"string"==typeof r||"string"==typeof a?(r=$a(r),a=$a(a)):(r=qa(r),a=qa(a)),n=t(r,a)}return n}}function Cn(t){return Hn((function(e){return e=le(e,Ve($n())),Na((function(r){var a=this;return t(e,(function(t){return re(t,a,r)}))}))}))}function kn(t,e){var r=(e=void 0===e?" ":$a(e)).length;if(r<2)return r?Ia(e,t):e;var a=Ia(e,Ze(t/He(e)));return Le(e)?cn(Ue(a),0,t).join(""):a.slice(0,t)}function Rn(t){return function(e,r,n){return n&&"number"!=typeof n&&oi(e,r,n)&&(r=n=void 0),e=as(e),void 0===r?(r=e,e=0):r=as(r),function(t,e,r,n){for(var i=-1,o=ir(Ze((e-t)/(r||1)),0),s=a(o);o--;)s[n?o:++i]=t,t+=r;return s}(e,r,n=void 0===n?e<r?1:-1:as(n),t)}}function _n(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=os(e),r=os(r)),t(e,r)}}function Tn(t,e,r,a,n,i,o,s,c,u){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);var h=[t,e,n,l?i:void 0,l?o:void 0,l?void 0:i,l?void 0:o,s,c,u],p=r.apply(void 0,h);return ci(t)&&mi(p,h),p.placeholder=a,Di(p,t,e)}function In(t){var e=gt[t];return function(t,r){if(t=os(t),(r=null==r?0:or(ns(r),292))&&rr(t)){var a=(cs(t)+"e").split("e");return+((a=(cs(e(a[0]+"e"+(+a[1]+r)))+"e").split("e"))[0]+"e"+(+a[1]-r))}return e(t)}}var Nn=br&&1/Ee(new br([,-0]))[1]==1/0?function(t){return new br(t)}:Zs;function Ln(t){return function(e){var r=ei(e);return r==b?Ae(e):r==v?Ye(e):function(t,e){return le(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function An(t,e,r,o,s,c,u,l){var h=2&e;if(!h&&"function"!=typeof t)throw new mt(n);var p=o?o.length:0;if(p||(e&=-97,o=s=void 0),u=void 0===u?u:ir(ns(u),0),l=void 0===l?l:ns(l),p-=s?s.length:0,64&e){var g=o,b=s;o=s=void 0}var f=h?void 0:Qn(t),d=[t,e,r,o,s,g,b,c,u,l];if(f&&function(t,e){var r=t[1],a=e[1],n=r|a;if(!(n<131||128==a&&8==r||128==a&&256==r&&t[7].length<=e[8]||384==a&&e[7].length<=e[8]&&8==r))return t;1&a&&(t[2]=e[2],n|=1&r?0:4);var o=e[3];if(o){var s=t[3];t[3]=s?bn(s,o,e[4]):o,t[4]=s?ze(t[3],i):e[4]}(o=e[5])&&(t[5]=(s=t[5])?fn(s,o,e[6]):o,t[6]=s?ze(t[5],i):e[6]),(o=e[7])&&(t[7]=o),128&a&&(t[8]=null==t[8]?e[8]:or(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=n}(d,f),t=d[0],e=d[1],r=d[2],o=d[3],s=d[4],!(l=d[9]=void 0===d[9]?h?0:t.length:ir(d[9]-p,0))&&24&e&&(e&=-25),e&&1!=e)m=8==e||16==e?function(t,e,r){var n=xn(t);return function i(){for(var o=arguments.length,s=a(o),c=o,u=qn(i);c--;)s[c]=arguments[c];var l=o<3&&s[0]!==u&&s[o-1]!==u?[]:ze(s,u);if((o-=l.length)<r)return Tn(t,e,Pn,i.placeholder,void 0,s,l,void 0,void 0,r-o);var h=this&&this!==Ut&&this instanceof i?n:t;return re(h,this,s)}}(t,e,l):32!=e&&33!=e||s.length?Pn.apply(void 0,d):function(t,e,r,n){var i=1&e,o=xn(t);return function e(){for(var s=-1,c=arguments.length,u=-1,l=n.length,h=a(l+c),p=this&&this!==Ut&&this instanceof e?o:t;++u<l;)h[u]=n[u];for(;c--;)h[u++]=arguments[++s];return re(p,i?r:this,h)}}(t,e,r,o);else var m=function(t,e,r){var a=1&e,n=xn(t);return function e(){var i=this&&this!==Ut&&this instanceof e?n:t;return i.apply(a?r:this,arguments)}}(t,e,r);return Di((f?za:mi)(m,d),t,e)}function jn(t,e,r,a){return void 0===t||Co(t,yt[r])&&!wt.call(a,r)?e:t}function zn(t,e,r,a,n,i){return Uo(t)&&Uo(e)&&(i.set(e,t),Va(t,e,void 0,zn,i),i.delete(e)),t}function En(t){return qo(t)?void 0:t}function Yn(t,e,r,a,n,i){var o=1&r,s=t.length,c=e.length;if(s!=c&&!(o&&c>s))return!1;var u=i.get(t),l=i.get(e);if(u&&l)return u==e&&l==t;var h=-1,p=!0,g=2&r?new Ir:void 0;for(i.set(t,e),i.set(e,t);++h<s;){var b=t[h],f=e[h];if(a)var d=o?a(f,b,h,e,t,i):a(b,f,h,t,e,i);if(void 0!==d){if(d)continue;p=!1;break}if(g){if(!be(e,(function(t,e){if(!Ce(g,e)&&(b===t||n(b,t,r,a,i)))return g.push(e)}))){p=!1;break}}else if(b!==f&&!n(b,f,r,a,i)){p=!1;break}}return i.delete(t),i.delete(e),p}function Hn(t){return yi(gi(t,void 0,Ti),t+"")}function Un(t){return ha(t,Ss,Jn)}function Bn(t){return ha(t,ws,ti)}var Qn=mr?function(t){return mr.get(t)}:Zs;function Gn(t){for(var e=t.name+"",r=vr[e],a=wt.call(vr,e)?r.length:0;a--;){var n=r[a],i=n.func;if(null==i||i==t)return n.name}return e}function qn(t){return(wt.call(Pr,"placeholder")?Pr:t).placeholder}function $n(){var t=Pr.iteratee||qs;return t=t===qs?wa:t,arguments.length?t(arguments[0],arguments[1]):t}function Kn(t,e){var r,a,n=t.__data__;return("string"==(a=typeof(r=e))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==r:null===r)?n["string"==typeof e?"string":"hash"]:n.map}function Xn(t){for(var e=Ss(t),r=e.length;r--;){var a=e[r],n=t[a];e[r]=[a,n,hi(n)]}return e}function Zn(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Sa(r)?r:void 0}var Jn=tr?function(t){return null==t?[]:(t=bt(t),se(tr(t),(function(e){return Qt.call(t,e)})))}:ic,ti=tr?function(t){for(var e=[];t;)he(e,Jn(t)),t=Ht(t);return e}:ic,ei=pa;function ri(t,e,r){for(var a=-1,n=(e=on(e,t)).length,i=!1;++a<n;){var o=Wi(e[a]);if(!(i=null!=t&&r(t,o)))break;t=t[o]}return i||++a!=n?i:!!(n=null==t?0:t.length)&&Ho(n)&&ii(o,n)&&(To(t)||_o(t))}function ai(t){return"function"!=typeof t.constructor||li(t)?{}:Vr(Ht(t))}function ni(t){return To(t)||_o(t)||!!($t&&t&&t[$t])}function ii(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&st.test(t))&&t>-1&&t%1==0&&t<e}function oi(t,e,r){if(!Uo(r))return!1;var a=typeof e;return!!("number"==a?No(r)&&ii(e,r.length):"string"==a&&e in r)&&Co(r[e],t)}function si(t,e){if(To(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Zo(t))||H.test(t)||!Y.test(t)||null!=e&&t in bt(e)}function ci(t){var e=Gn(t),r=Pr[e];if("function"!=typeof r||!(e in kr.prototype))return!1;if(t===r)return!0;var a=Qn(r);return!!a&&t===a[0]}(hr&&ei(new hr(new ArrayBuffer(1)))!=F||pr&&ei(new pr)!=b||gr&&"[object Promise]"!=ei(gr.resolve())||br&&ei(new br)!=v||fr&&ei(new fr)!=S)&&(ei=function(t){var e=pa(t),r=e==d?t.constructor:void 0,a=r?Pi(r):"";if(a)switch(a){case yr:return F;case Dr:return b;case Sr:return"[object Promise]";case wr:return v;case Fr:return S}return e});var ui=Dt?Eo:oc;function li(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||yt)}function hi(t){return t==t&&!Uo(t)}function pi(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in bt(r))}}function gi(t,e,r){return e=ir(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=ir(n.length-e,0),s=a(o);++i<o;)s[i]=n[e+i];i=-1;for(var c=a(e+1);++i<e;)c[i]=n[i];return c[e]=r(s),re(t,this,c)}}function bi(t,e){return e.length<2?t:la(t,Ha(e,0,-1))}function fi(t,e){for(var r=t.length,a=or(e.length,r),n=dn(t);a--;){var i=e[a];t[a]=ii(i,r)?n[i]:void 0}return t}function di(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var mi=Si(za),vi=Xe||function(t,e){return Ut.setTimeout(t,e)},yi=Si(Ea);function Di(t,e,r){var a=e+"";return yi(t,function(t,e){var r=e.length;if(!r)return t;var a=r-1;return e[a]=(r>1?"& ":"")+e[a],e=e.join(r>2?", ":" "),t.replace($,"{\n/* [wrapped with "+e+"] */\n")}(a,function(t,e){return ne(o,(function(r){var a="_."+r[0];e&r[1]&&!ce(t,a)&&t.push(a)})),t.sort()}(function(t){var e=t.match(K);return e?e[1].split(X):[]}(a),r)))}function Si(t){var e=0,r=0;return function(){var a=sr(),n=16-(a-r);if(r=a,n>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function wi(t,e){var r=-1,a=t.length,n=a-1;for(e=void 0===e?a:e;++r<e;){var i=Ta(r,n),o=t[i];t[i]=t[r],t[r]=o}return t.length=e,t}var Fi,xi,Mi=(Fi=xo((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(U,(function(t,r,a,n){e.push(a?n.replace(tt,"$1"):r||t)})),e}),(function(t){return 500===xi.size&&xi.clear(),t})),xi=Fi.cache,Fi);function Wi(t){if("string"==typeof t||Zo(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Pi(t){if(null!=t){try{return St.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Vi(t){if(t instanceof kr)return t.clone();var e=new Cr(t.__wrapped__,t.__chain__);return e.__actions__=dn(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Oi=Na((function(t,e){return Lo(t)?Zr(t,na(e,1,Lo,!0)):[]})),Ci=Na((function(t,e){var r=ji(e);return Lo(r)&&(r=void 0),Lo(t)?Zr(t,na(e,1,Lo,!0),$n(r,2)):[]})),ki=Na((function(t,e){var r=ji(e);return Lo(r)&&(r=void 0),Lo(t)?Zr(t,na(e,1,Lo,!0),void 0,r):[]}));function Ri(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=null==r?0:ns(r);return n<0&&(n=ir(a+n,0)),me(t,$n(e,3),n)}function _i(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=a-1;return void 0!==r&&(n=ns(r),n=r<0?ir(a+n,0):or(n,a-1)),me(t,$n(e,3),n,!0)}function Ti(t){return null!=t&&t.length?na(t,1):[]}function Ii(t){return t&&t.length?t[0]:void 0}var Ni=Na((function(t){var e=le(t,an);return e.length&&e[0]===t[0]?da(e):[]})),Li=Na((function(t){var e=ji(t),r=le(t,an);return e===ji(r)?e=void 0:r.pop(),r.length&&r[0]===t[0]?da(r,$n(e,2)):[]})),Ai=Na((function(t){var e=ji(t),r=le(t,an);return(e="function"==typeof e?e:void 0)&&r.pop(),r.length&&r[0]===t[0]?da(r,void 0,e):[]}));function ji(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var zi=Na(Ei);function Ei(t,e){return t&&t.length&&e&&e.length?Ra(t,e):t}var Yi=Hn((function(t,e){var r=null==t?0:t.length,a=Gr(t,e);return _a(t,le(e,(function(t){return ii(t,r)?+t:t})).sort(gn)),a}));function Hi(t){return null==t?t:lr.call(t)}var Ui=Na((function(t){return Ka(na(t,1,Lo,!0))})),Bi=Na((function(t){var e=ji(t);return Lo(e)&&(e=void 0),Ka(na(t,1,Lo,!0),$n(e,2))})),Qi=Na((function(t){var e=ji(t);return e="function"==typeof e?e:void 0,Ka(na(t,1,Lo,!0),void 0,e)}));function Gi(t){if(!t||!t.length)return[];var e=0;return t=se(t,(function(t){if(Lo(t))return e=ir(t.length,e),!0})),We(e,(function(e){return le(t,we(e))}))}function qi(t,e){if(!t||!t.length)return[];var r=Gi(t);return null==e?r:le(r,(function(t){return re(e,void 0,t)}))}var $i=Na((function(t,e){return Lo(t)?Zr(t,e):[]})),Ki=Na((function(t){return en(se(t,Lo))})),Xi=Na((function(t){var e=ji(t);return Lo(e)&&(e=void 0),en(se(t,Lo),$n(e,2))})),Zi=Na((function(t){var e=ji(t);return e="function"==typeof e?e:void 0,en(se(t,Lo),void 0,e)})),Ji=Na(Gi),to=Na((function(t){var e=t.length,r=e>1?t[e-1]:void 0;return r="function"==typeof r?(t.pop(),r):void 0,qi(t,r)}));function eo(t){var e=Pr(t);return e.__chain__=!0,e}function ro(t,e){return e(t)}var ao=Hn((function(t){var e=t.length,r=e?t[0]:0,a=this.__wrapped__,n=function(e){return Gr(e,t)};return!(e>1||this.__actions__.length)&&a instanceof kr&&ii(r)?((a=a.slice(r,+r+(e?1:0))).__actions__.push({func:ro,args:[n],thisArg:void 0}),new Cr(a,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(n)})),no=vn((function(t,e,r){wt.call(t,r)?++t[r]:Qr(t,r,1)})),io=Mn(Ri),oo=Mn(_i);function so(t,e){return(To(t)?ne:Jr)(t,$n(e,3))}function co(t,e){return(To(t)?ie:ta)(t,$n(e,3))}var uo=vn((function(t,e,r){wt.call(t,r)?t[r].push(e):Qr(t,r,[e])})),lo=Na((function(t,e,r){var n=-1,i="function"==typeof e,o=No(t)?a(t.length):[];return Jr(t,(function(t){o[++n]=i?re(e,t,r):ma(t,e,r)})),o})),ho=vn((function(t,e,r){Qr(t,r,e)}));function po(t,e){return(To(t)?le:Ma)(t,$n(e,3))}var go=vn((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]})),bo=Na((function(t,e){if(null==t)return[];var r=e.length;return r>1&&oi(t,e[0],e[1])?e=[]:r>2&&oi(e[0],e[1],e[2])&&(e=[e[0]]),Ca(t,na(e,1),[])})),fo=Ke||function(){return Ut.Date.now()};function mo(t,e,r){return e=r?void 0:e,An(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function vo(t,e){var r;if("function"!=typeof e)throw new mt(n);return t=ns(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}var yo=Na((function(t,e,r){var a=1;if(r.length){var n=ze(r,qn(yo));a|=32}return An(t,a,e,r,n)})),Do=Na((function(t,e,r){var a=3;if(r.length){var n=ze(r,qn(Do));a|=32}return An(e,a,t,r,n)}));function So(t,e,r){var a,i,o,s,c,u,l=0,h=!1,p=!1,g=!0;if("function"!=typeof t)throw new mt(n);function b(e){var r=a,n=i;return a=i=void 0,l=e,s=t.apply(n,r)}function f(t){return l=t,c=vi(m,e),h?b(t):s}function d(t){var r=t-u;return void 0===u||r>=e||r<0||p&&t-l>=o}function m(){var t=fo();if(d(t))return v(t);c=vi(m,function(t){var r=e-(t-u);return p?or(r,o-(t-l)):r}(t))}function v(t){return c=void 0,g&&a?b(t):(a=i=void 0,s)}function y(){var t=fo(),r=d(t);if(a=arguments,i=this,u=t,r){if(void 0===c)return f(u);if(p)return un(c),c=vi(m,e),b(u)}return void 0===c&&(c=vi(m,e)),s}return e=os(e)||0,Uo(r)&&(h=!!r.leading,o=(p="maxWait"in r)?ir(os(r.maxWait)||0,e):o,g="trailing"in r?!!r.trailing:g),y.cancel=function(){void 0!==c&&un(c),l=0,a=u=i=c=void 0},y.flush=function(){return void 0===c?s:v(fo())},y}var wo=Na((function(t,e){return Xr(t,1,e)})),Fo=Na((function(t,e,r){return Xr(t,os(e)||0,r)}));function xo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(n);var r=function r(){var a=arguments,n=e?e.apply(this,a):a[0],i=r.cache;if(i.has(n))return i.get(n);var o=t.apply(this,a);return r.cache=i.set(n,o)||i,o};return r.cache=new(xo.Cache||Tr),r}function Mo(t){if("function"!=typeof t)throw new mt(n);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}xo.Cache=Tr;var Wo=sn((function(t,e){var r=(e=1==e.length&&To(e[0])?le(e[0],Ve($n())):le(na(e,1),Ve($n()))).length;return Na((function(a){for(var n=-1,i=or(a.length,r);++n<i;)a[n]=e[n].call(this,a[n]);return re(t,this,a)}))})),Po=Na((function(t,e){return An(t,32,void 0,e,ze(e,qn(Po)))})),Vo=Na((function(t,e){return An(t,64,void 0,e,ze(e,qn(Vo)))})),Oo=Hn((function(t,e){return An(t,256,void 0,void 0,void 0,e)}));function Co(t,e){return t===e||t!=t&&e!=e}var ko=_n(ga),Ro=_n((function(t,e){return t>=e})),_o=va(function(){return arguments}())?va:function(t){return Bo(t)&&wt.call(t,"callee")&&!Qt.call(t,"callee")},To=a.isArray,Io=Kt?Ve(Kt):function(t){return Bo(t)&&pa(t)==w};function No(t){return null!=t&&Ho(t.length)&&!Eo(t)}function Lo(t){return Bo(t)&&No(t)}var Ao=er||oc,jo=Xt?Ve(Xt):function(t){return Bo(t)&&pa(t)==l};function zo(t){if(!Bo(t))return!1;var e=pa(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!qo(t)}function Eo(t){if(!Uo(t))return!1;var e=pa(t);return e==p||e==g||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Yo(t){return"number"==typeof t&&t==ns(t)}function Ho(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Uo(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Bo(t){return null!=t&&"object"==typeof t}var Qo=Zt?Ve(Zt):function(t){return Bo(t)&&ei(t)==b};function Go(t){return"number"==typeof t||Bo(t)&&pa(t)==f}function qo(t){if(!Bo(t)||pa(t)!=d)return!1;var e=Ht(t);if(null===e)return!0;var r=wt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&St.call(r)==Wt}var $o=Jt?Ve(Jt):function(t){return Bo(t)&&pa(t)==m},Ko=te?Ve(te):function(t){return Bo(t)&&ei(t)==v};function Xo(t){return"string"==typeof t||!To(t)&&Bo(t)&&pa(t)==y}function Zo(t){return"symbol"==typeof t||Bo(t)&&pa(t)==D}var Jo=ee?Ve(ee):function(t){return Bo(t)&&Ho(t.length)&&!!Lt[pa(t)]},ts=_n(xa),es=_n((function(t,e){return t<=e}));function rs(t){if(!t)return[];if(No(t))return Xo(t)?Ue(t):dn(t);if(fe&&t[fe])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[fe]());var e=ei(t);return(e==b?Ae:e==v?Ee:Cs)(t)}function as(t){return t?(t=os(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ns(t){var e=as(t),r=e%1;return e==e?r?e-r:e:0}function is(t){return t?qr(ns(t),0,4294967295):0}function os(t){if("number"==typeof t)return t;if(Zo(t))return NaN;if(Uo(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Uo(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Pe(t);var r=nt.test(t);return r||ot.test(t)?Et(t.slice(2),r?2:8):at.test(t)?NaN:+t}function ss(t){return mn(t,ws(t))}function cs(t){return null==t?"":$a(t)}var us=yn((function(t,e){if(li(e)||No(e))mn(e,Ss(e),t);else for(var r in e)wt.call(e,r)&&Yr(t,r,e[r])})),ls=yn((function(t,e){mn(e,ws(e),t)})),hs=yn((function(t,e,r,a){mn(e,ws(e),t,a)})),ps=yn((function(t,e,r,a){mn(e,Ss(e),t,a)})),gs=Hn(Gr),bs=Na((function(t,e){t=bt(t);var r=-1,a=e.length,n=a>2?e[2]:void 0;for(n&&oi(e[0],e[1],n)&&(a=1);++r<a;)for(var i=e[r],o=ws(i),s=-1,c=o.length;++s<c;){var u=o[s],l=t[u];(void 0===l||Co(l,yt[u])&&!wt.call(t,u))&&(t[u]=i[u])}return t})),fs=Na((function(t){return t.push(void 0,zn),re(xs,void 0,t)}));function ds(t,e,r){var a=null==t?void 0:la(t,e);return void 0===a?r:a}function ms(t,e){return null!=t&&ri(t,e,fa)}var vs=Vn((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Mt.call(e)),t[e]=r}),Us(Gs)),ys=Vn((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Mt.call(e)),wt.call(t,e)?t[e].push(r):t[e]=[r]}),$n),Ds=Na(ma);function Ss(t){return No(t)?Lr(t):Fa(t)}function ws(t){return No(t)?Lr(t,!0):function(t){if(!Uo(t))return function(t){var e=[];if(null!=t)for(var r in bt(t))e.push(r);return e}(t);var e=li(t),r=[];for(var a in t)("constructor"!=a||!e&&wt.call(t,a))&&r.push(a);return r}(t)}var Fs=yn((function(t,e,r){Va(t,e,r)})),xs=yn((function(t,e,r,a){Va(t,e,r,a)})),Ms=Hn((function(t,e){var r={};if(null==t)return r;var a=!1;e=le(e,(function(e){return e=on(e,t),a||(a=e.length>1),e})),mn(t,Bn(t),r),a&&(r=$r(r,7,En));for(var n=e.length;n--;)Xa(r,e[n]);return r})),Ws=Hn((function(t,e){return null==t?{}:function(t,e){return ka(t,e,(function(e,r){return ms(t,r)}))}(t,e)}));function Ps(t,e){if(null==t)return{};var r=le(Bn(t),(function(t){return[t]}));return e=$n(e),ka(t,r,(function(t,r){return e(t,r[0])}))}var Vs=Ln(Ss),Os=Ln(ws);function Cs(t){return null==t?[]:Oe(t,Ss(t))}var ks=Fn((function(t,e,r){return e=e.toLowerCase(),t+(r?Rs(e):e)}));function Rs(t){return zs(cs(t).toLowerCase())}function _s(t){return(t=cs(t))&&t.replace(ct,Te).replace(Ct,"")}var Ts=Fn((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),Is=Fn((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),Ns=wn("toLowerCase"),Ls=Fn((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()})),As=Fn((function(t,e,r){return t+(r?" ":"")+zs(e)})),js=Fn((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),zs=wn("toUpperCase");function Es(t,e,r){return t=cs(t),void 0===(e=r?void 0:e)?function(t){return Tt.test(t)}(t)?function(t){return t.match(Rt)||[]}(t):function(t){return t.match(Z)||[]}(t):t.match(e)||[]}var Ys=Na((function(t,e){try{return re(t,void 0,e)}catch(r){return zo(r)?r:new ht(r)}})),Hs=Hn((function(t,e){return ne(e,(function(e){e=Wi(e),Qr(t,e,yo(t[e],t))})),t}));function Us(t){return function(){return t}}var Bs=Wn(),Qs=Wn(!0);function Gs(t){return t}function qs(t){return wa("function"==typeof t?t:$r(t,1))}var $s=Na((function(t,e){return function(r){return ma(r,t,e)}})),Ks=Na((function(t,e){return function(r){return ma(t,r,e)}}));function Xs(t,e,r){var a=Ss(e),n=ua(e,a);null!=r||Uo(e)&&(n.length||!a.length)||(r=e,e=t,t=this,n=ua(e,Ss(e)));var i=!(Uo(r)&&"chain"in r&&!r.chain),o=Eo(t);return ne(n,(function(r){var a=e[r];t[r]=a,o&&(t.prototype[r]=function(){var e=this.__chain__;if(i||e){var r=t(this.__wrapped__),n=r.__actions__=dn(this.__actions__);return n.push({func:a,args:arguments,thisArg:t}),r.__chain__=e,r}return a.apply(t,he([this.value()],arguments))})})),t}function Zs(){}var Js=Cn(le),tc=Cn(oe),ec=Cn(be);function rc(t){return si(t)?we(Wi(t)):function(t){return function(e){return la(e,t)}}(t)}var ac=Rn(),nc=Rn(!0);function ic(){return[]}function oc(){return!1}var sc,cc=On((function(t,e){return t+e}),0),uc=In("ceil"),lc=On((function(t,e){return t/e}),1),hc=In("floor"),pc=On((function(t,e){return t*e}),1),gc=In("round"),bc=On((function(t,e){return t-e}),0);return Pr.after=function(t,e){if("function"!=typeof e)throw new mt(n);return t=ns(t),function(){if(--t<1)return e.apply(this,arguments)}},Pr.ary=mo,Pr.assign=us,Pr.assignIn=ls,Pr.assignInWith=hs,Pr.assignWith=ps,Pr.at=gs,Pr.before=vo,Pr.bind=yo,Pr.bindAll=Hs,Pr.bindKey=Do,Pr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return To(t)?t:[t]},Pr.chain=eo,Pr.chunk=function(t,e,r){e=(r?oi(t,e,r):void 0===e)?1:ir(ns(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var i=0,o=0,s=a(Ze(n/e));i<n;)s[o++]=Ha(t,i,i+=e);return s},Pr.compact=function(t){for(var e=-1,r=null==t?0:t.length,a=0,n=[];++e<r;){var i=t[e];i&&(n[a++]=i)}return n},Pr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=a(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return he(To(r)?dn(r):[r],na(e,1))},Pr.cond=function(t){var e=null==t?0:t.length,r=$n();return t=e?le(t,(function(t){if("function"!=typeof t[1])throw new mt(n);return[r(t[0]),t[1]]})):[],Na((function(r){for(var a=-1;++a<e;){var n=t[a];if(re(n[0],this,r))return re(n[1],this,r)}}))},Pr.conforms=function(t){return function(t){var e=Ss(t);return function(r){return Kr(r,t,e)}}($r(t,1))},Pr.constant=Us,Pr.countBy=no,Pr.create=function(t,e){var r=Vr(t);return null==e?r:Br(r,e)},Pr.curry=function t(e,r,a){var n=An(e,8,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=t.placeholder,n},Pr.curryRight=function t(e,r,a){var n=An(e,16,void 0,void 0,void 0,void 0,void 0,r=a?void 0:r);return n.placeholder=t.placeholder,n},Pr.debounce=So,Pr.defaults=bs,Pr.defaultsDeep=fs,Pr.defer=wo,Pr.delay=Fo,Pr.difference=Oi,Pr.differenceBy=Ci,Pr.differenceWith=ki,Pr.drop=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,(e=r||void 0===e?1:ns(e))<0?0:e,a):[]},Pr.dropRight=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,0,(e=a-(e=r||void 0===e?1:ns(e)))<0?0:e):[]},Pr.dropRightWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!0,!0):[]},Pr.dropWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!0):[]},Pr.fill=function(t,e,r,a){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&oi(t,e,r)&&(r=0,a=n),function(t,e,r,a){var n=t.length;for((r=ns(r))<0&&(r=-r>n?0:n+r),(a=void 0===a||a>n?n:ns(a))<0&&(a+=n),a=r>a?0:is(a);r<a;)t[r++]=e;return t}(t,e,r,a)):[]},Pr.filter=function(t,e){return(To(t)?se:aa)(t,$n(e,3))},Pr.flatMap=function(t,e){return na(po(t,e),1)},Pr.flatMapDeep=function(t,e){return na(po(t,e),1/0)},Pr.flatMapDepth=function(t,e,r){return r=void 0===r?1:ns(r),na(po(t,e),r)},Pr.flatten=Ti,Pr.flattenDeep=function(t){return null!=t&&t.length?na(t,1/0):[]},Pr.flattenDepth=function(t,e){return null!=t&&t.length?na(t,e=void 0===e?1:ns(e)):[]},Pr.flip=function(t){return An(t,512)},Pr.flow=Bs,Pr.flowRight=Qs,Pr.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,a={};++e<r;){var n=t[e];a[n[0]]=n[1]}return a},Pr.functions=function(t){return null==t?[]:ua(t,Ss(t))},Pr.functionsIn=function(t){return null==t?[]:ua(t,ws(t))},Pr.groupBy=uo,Pr.initial=function(t){return null!=t&&t.length?Ha(t,0,-1):[]},Pr.intersection=Ni,Pr.intersectionBy=Li,Pr.intersectionWith=Ai,Pr.invert=vs,Pr.invertBy=ys,Pr.invokeMap=lo,Pr.iteratee=qs,Pr.keyBy=ho,Pr.keys=Ss,Pr.keysIn=ws,Pr.map=po,Pr.mapKeys=function(t,e){var r={};return e=$n(e,3),sa(t,(function(t,a,n){Qr(r,e(t,a,n),t)})),r},Pr.mapValues=function(t,e){var r={};return e=$n(e,3),sa(t,(function(t,a,n){Qr(r,a,e(t,a,n))})),r},Pr.matches=function(t){return Wa($r(t,1))},Pr.matchesProperty=function(t,e){return Pa(t,$r(e,1))},Pr.memoize=xo,Pr.merge=Fs,Pr.mergeWith=xs,Pr.method=$s,Pr.methodOf=Ks,Pr.mixin=Xs,Pr.negate=Mo,Pr.nthArg=function(t){return t=ns(t),Na((function(e){return Oa(e,t)}))},Pr.omit=Ms,Pr.omitBy=function(t,e){return Ps(t,Mo($n(e)))},Pr.once=function(t){return vo(2,t)},Pr.orderBy=function(t,e,r,a){return null==t?[]:(To(e)||(e=null==e?[]:[e]),To(r=a?void 0:r)||(r=null==r?[]:[r]),Ca(t,e,r))},Pr.over=Js,Pr.overArgs=Wo,Pr.overEvery=tc,Pr.overSome=ec,Pr.partial=Po,Pr.partialRight=Vo,Pr.partition=go,Pr.pick=Ws,Pr.pickBy=Ps,Pr.property=rc,Pr.propertyOf=function(t){return function(e){return null==t?void 0:la(t,e)}},Pr.pull=zi,Pr.pullAll=Ei,Pr.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Ra(t,e,$n(r,2)):t},Pr.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Ra(t,e,void 0,r):t},Pr.pullAt=Yi,Pr.range=ac,Pr.rangeRight=nc,Pr.rearg=Oo,Pr.reject=function(t,e){return(To(t)?se:aa)(t,Mo($n(e,3)))},Pr.remove=function(t,e){var r=[];if(!t||!t.length)return r;var a=-1,n=[],i=t.length;for(e=$n(e,3);++a<i;){var o=t[a];e(o,a,t)&&(r.push(o),n.push(a))}return _a(t,n),r},Pr.rest=function(t,e){if("function"!=typeof t)throw new mt(n);return Na(t,e=void 0===e?e:ns(e))},Pr.reverse=Hi,Pr.sampleSize=function(t,e,r){return e=(r?oi(t,e,r):void 0===e)?1:ns(e),(To(t)?jr:Aa)(t,e)},Pr.set=function(t,e,r){return null==t?t:ja(t,e,r)},Pr.setWith=function(t,e,r,a){return a="function"==typeof a?a:void 0,null==t?t:ja(t,e,r,a)},Pr.shuffle=function(t){return(To(t)?zr:Ya)(t)},Pr.slice=function(t,e,r){var a=null==t?0:t.length;return a?(r&&"number"!=typeof r&&oi(t,e,r)?(e=0,r=a):(e=null==e?0:ns(e),r=void 0===r?a:ns(r)),Ha(t,e,r)):[]},Pr.sortBy=bo,Pr.sortedUniq=function(t){return t&&t.length?Ga(t):[]},Pr.sortedUniqBy=function(t,e){return t&&t.length?Ga(t,$n(e,2)):[]},Pr.split=function(t,e,r){return r&&"number"!=typeof r&&oi(t,e,r)&&(e=r=void 0),(r=void 0===r?4294967295:r>>>0)?(t=cs(t))&&("string"==typeof e||null!=e&&!$o(e))&&!(e=$a(e))&&Le(t)?cn(Ue(t),0,r):t.split(e,r):[]},Pr.spread=function(t,e){if("function"!=typeof t)throw new mt(n);return e=null==e?0:ir(ns(e),0),Na((function(r){var a=r[e],n=cn(r,0,e);return a&&he(n,a),re(t,this,n)}))},Pr.tail=function(t){var e=null==t?0:t.length;return e?Ha(t,1,e):[]},Pr.take=function(t,e,r){return t&&t.length?Ha(t,0,(e=r||void 0===e?1:ns(e))<0?0:e):[]},Pr.takeRight=function(t,e,r){var a=null==t?0:t.length;return a?Ha(t,(e=a-(e=r||void 0===e?1:ns(e)))<0?0:e,a):[]},Pr.takeRightWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3),!1,!0):[]},Pr.takeWhile=function(t,e){return t&&t.length?Ja(t,$n(e,3)):[]},Pr.tap=function(t,e){return e(t),t},Pr.throttle=function(t,e,r){var a=!0,i=!0;if("function"!=typeof t)throw new mt(n);return Uo(r)&&(a="leading"in r?!!r.leading:a,i="trailing"in r?!!r.trailing:i),So(t,e,{leading:a,maxWait:e,trailing:i})},Pr.thru=ro,Pr.toArray=rs,Pr.toPairs=Vs,Pr.toPairsIn=Os,Pr.toPath=function(t){return To(t)?le(t,Wi):Zo(t)?[t]:dn(Mi(cs(t)))},Pr.toPlainObject=ss,Pr.transform=function(t,e,r){var a=To(t),n=a||Ao(t)||Jo(t);if(e=$n(e,4),null==r){var i=t&&t.constructor;r=n?a?new i:[]:Uo(t)&&Eo(i)?Vr(Ht(t)):{}}return(n?ne:sa)(t,(function(t,a,n){return e(r,t,a,n)})),r},Pr.unary=function(t){return mo(t,1)},Pr.union=Ui,Pr.unionBy=Bi,Pr.unionWith=Qi,Pr.uniq=function(t){return t&&t.length?Ka(t):[]},Pr.uniqBy=function(t,e){return t&&t.length?Ka(t,$n(e,2)):[]},Pr.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Ka(t,void 0,e):[]},Pr.unset=function(t,e){return null==t||Xa(t,e)},Pr.unzip=Gi,Pr.unzipWith=qi,Pr.update=function(t,e,r){return null==t?t:Za(t,e,nn(r))},Pr.updateWith=function(t,e,r,a){return a="function"==typeof a?a:void 0,null==t?t:Za(t,e,nn(r),a)},Pr.values=Cs,Pr.valuesIn=function(t){return null==t?[]:Oe(t,ws(t))},Pr.without=$i,Pr.words=Es,Pr.wrap=function(t,e){return Po(nn(e),t)},Pr.xor=Ki,Pr.xorBy=Xi,Pr.xorWith=Zi,Pr.zip=Ji,Pr.zipObject=function(t,e){return rn(t||[],e||[],Yr)},Pr.zipObjectDeep=function(t,e){return rn(t||[],e||[],ja)},Pr.zipWith=to,Pr.entries=Vs,Pr.entriesIn=Os,Pr.extend=ls,Pr.extendWith=hs,Xs(Pr,Pr),Pr.add=cc,Pr.attempt=Ys,Pr.camelCase=ks,Pr.capitalize=Rs,Pr.ceil=uc,Pr.clamp=function(t,e,r){return void 0===r&&(r=e,e=void 0),void 0!==r&&(r=(r=os(r))==r?r:0),void 0!==e&&(e=(e=os(e))==e?e:0),qr(os(t),e,r)},Pr.clone=function(t){return $r(t,4)},Pr.cloneDeep=function(t){return $r(t,5)},Pr.cloneDeepWith=function(t,e){return $r(t,5,e="function"==typeof e?e:void 0)},Pr.cloneWith=function(t,e){return $r(t,4,e="function"==typeof e?e:void 0)},Pr.conformsTo=function(t,e){return null==e||Kr(t,e,Ss(e))},Pr.deburr=_s,Pr.defaultTo=function(t,e){return null==t||t!=t?e:t},Pr.divide=lc,Pr.endsWith=function(t,e,r){t=cs(t),e=$a(e);var a=t.length,n=r=void 0===r?a:qr(ns(r),0,a);return(r-=e.length)>=0&&t.slice(r,n)==e},Pr.eq=Co,Pr.escape=function(t){return(t=cs(t))&&A.test(t)?t.replace(N,Ie):t},Pr.escapeRegExp=function(t){return(t=cs(t))&&Q.test(t)?t.replace(B,"\\$&"):t},Pr.every=function(t,e,r){var a=To(t)?oe:ea;return r&&oi(t,e,r)&&(e=void 0),a(t,$n(e,3))},Pr.find=io,Pr.findIndex=Ri,Pr.findKey=function(t,e){return de(t,$n(e,3),sa)},Pr.findLast=oo,Pr.findLastIndex=_i,Pr.findLastKey=function(t,e){return de(t,$n(e,3),ca)},Pr.floor=hc,Pr.forEach=so,Pr.forEachRight=co,Pr.forIn=function(t,e){return null==t?t:ia(t,$n(e,3),ws)},Pr.forInRight=function(t,e){return null==t?t:oa(t,$n(e,3),ws)},Pr.forOwn=function(t,e){return t&&sa(t,$n(e,3))},Pr.forOwnRight=function(t,e){return t&&ca(t,$n(e,3))},Pr.get=ds,Pr.gt=ko,Pr.gte=Ro,Pr.has=function(t,e){return null!=t&&ri(t,e,ba)},Pr.hasIn=ms,Pr.head=Ii,Pr.identity=Gs,Pr.includes=function(t,e,r,a){t=No(t)?t:Cs(t),r=r&&!a?ns(r):0;var n=t.length;return r<0&&(r=ir(n+r,0)),Xo(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&ve(t,e,r)>-1},Pr.indexOf=function(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=null==r?0:ns(r);return n<0&&(n=ir(a+n,0)),ve(t,e,n)},Pr.inRange=function(t,e,r){return e=as(e),void 0===r?(r=e,e=0):r=as(r),function(t,e,r){return t>=or(e,r)&&t<ir(e,r)}(t=os(t),e,r)},Pr.invoke=Ds,Pr.isArguments=_o,Pr.isArray=To,Pr.isArrayBuffer=Io,Pr.isArrayLike=No,Pr.isArrayLikeObject=Lo,Pr.isBoolean=function(t){return!0===t||!1===t||Bo(t)&&pa(t)==u},Pr.isBuffer=Ao,Pr.isDate=jo,Pr.isElement=function(t){return Bo(t)&&1===t.nodeType&&!qo(t)},Pr.isEmpty=function(t){if(null==t)return!0;if(No(t)&&(To(t)||"string"==typeof t||"function"==typeof t.splice||Ao(t)||Jo(t)||_o(t)))return!t.length;var e=ei(t);if(e==b||e==v)return!t.size;if(li(t))return!Fa(t).length;for(var r in t)if(wt.call(t,r))return!1;return!0},Pr.isEqual=function(t,e){return ya(t,e)},Pr.isEqualWith=function(t,e,r){var a=(r="function"==typeof r?r:void 0)?r(t,e):void 0;return void 0===a?ya(t,e,void 0,r):!!a},Pr.isError=zo,Pr.isFinite=function(t){return"number"==typeof t&&rr(t)},Pr.isFunction=Eo,Pr.isInteger=Yo,Pr.isLength=Ho,Pr.isMap=Qo,Pr.isMatch=function(t,e){return t===e||Da(t,e,Xn(e))},Pr.isMatchWith=function(t,e,r){return r="function"==typeof r?r:void 0,Da(t,e,Xn(e),r)},Pr.isNaN=function(t){return Go(t)&&t!=+t},Pr.isNative=function(t){if(ui(t))throw new ht("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sa(t)},Pr.isNil=function(t){return null==t},Pr.isNull=function(t){return null===t},Pr.isNumber=Go,Pr.isObject=Uo,Pr.isObjectLike=Bo,Pr.isPlainObject=qo,Pr.isRegExp=$o,Pr.isSafeInteger=function(t){return Yo(t)&&t>=-9007199254740991&&t<=9007199254740991},Pr.isSet=Ko,Pr.isString=Xo,Pr.isSymbol=Zo,Pr.isTypedArray=Jo,Pr.isUndefined=function(t){return void 0===t},Pr.isWeakMap=function(t){return Bo(t)&&ei(t)==S},Pr.isWeakSet=function(t){return Bo(t)&&"[object WeakSet]"==pa(t)},Pr.join=function(t,e){return null==t?"":ar.call(t,e)},Pr.kebabCase=Ts,Pr.last=ji,Pr.lastIndexOf=function(t,e,r){var a=null==t?0:t.length;if(!a)return-1;var n=a;return void 0!==r&&(n=(n=ns(r))<0?ir(a+n,0):or(n,a-1)),e==e?function(t,e,r){for(var a=r+1;a--;)if(t[a]===e)return a;return a}(t,e,n):me(t,De,n,!0)},Pr.lowerCase=Is,Pr.lowerFirst=Ns,Pr.lt=ts,Pr.lte=es,Pr.max=function(t){return t&&t.length?ra(t,Gs,ga):void 0},Pr.maxBy=function(t,e){return t&&t.length?ra(t,$n(e,2),ga):void 0},Pr.mean=function(t){return Se(t,Gs)},Pr.meanBy=function(t,e){return Se(t,$n(e,2))},Pr.min=function(t){return t&&t.length?ra(t,Gs,xa):void 0},Pr.minBy=function(t,e){return t&&t.length?ra(t,$n(e,2),xa):void 0},Pr.stubArray=ic,Pr.stubFalse=oc,Pr.stubObject=function(){return{}},Pr.stubString=function(){return""},Pr.stubTrue=function(){return!0},Pr.multiply=pc,Pr.nth=function(t,e){return t&&t.length?Oa(t,ns(e)):void 0},Pr.noConflict=function(){return Ut._===this&&(Ut._=Pt),this},Pr.noop=Zs,Pr.now=fo,Pr.pad=function(t,e,r){t=cs(t);var a=(e=ns(e))?He(t):0;if(!e||a>=e)return t;var n=(e-a)/2;return kn(Je(n),r)+t+kn(Ze(n),r)},Pr.padEnd=function(t,e,r){t=cs(t);var a=(e=ns(e))?He(t):0;return e&&a<e?t+kn(e-a,r):t},Pr.padStart=function(t,e,r){t=cs(t);var a=(e=ns(e))?He(t):0;return e&&a<e?kn(e-a,r)+t:t},Pr.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),cr(cs(t).replace(G,""),e||0)},Pr.random=function(t,e,r){if(r&&"boolean"!=typeof r&&oi(t,e,r)&&(e=r=void 0),void 0===r&&("boolean"==typeof e?(r=e,e=void 0):"boolean"==typeof t&&(r=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=as(t),void 0===e?(e=t,t=0):e=as(e)),t>e){var a=t;t=e,e=a}if(r||t%1||e%1){var n=ur();return or(t+n*(e-t+zt("1e-"+((n+"").length-1))),e)}return Ta(t,e)},Pr.reduce=function(t,e,r){var a=To(t)?pe:xe,n=arguments.length<3;return a(t,$n(e,4),r,n,Jr)},Pr.reduceRight=function(t,e,r){var a=To(t)?ge:xe,n=arguments.length<3;return a(t,$n(e,4),r,n,ta)},Pr.repeat=function(t,e,r){return e=(r?oi(t,e,r):void 0===e)?1:ns(e),Ia(cs(t),e)},Pr.replace=function(){var t=arguments,e=cs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Pr.result=function(t,e,r){var a=-1,n=(e=on(e,t)).length;for(n||(n=1,t=void 0);++a<n;){var i=null==t?void 0:t[Wi(e[a])];void 0===i&&(a=n,i=r),t=Eo(i)?i.call(t):i}return t},Pr.round=gc,Pr.runInContext=t,Pr.sample=function(t){return(To(t)?Ar:La)(t)},Pr.size=function(t){if(null==t)return 0;if(No(t))return Xo(t)?He(t):t.length;var e=ei(t);return e==b||e==v?t.size:Fa(t).length},Pr.snakeCase=Ls,Pr.some=function(t,e,r){var a=To(t)?be:Ua;return r&&oi(t,e,r)&&(e=void 0),a(t,$n(e,3))},Pr.sortedIndex=function(t,e){return Ba(t,e)},Pr.sortedIndexBy=function(t,e,r){return Qa(t,e,$n(r,2))},Pr.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var a=Ba(t,e);if(a<r&&Co(t[a],e))return a}return-1},Pr.sortedLastIndex=function(t,e){return Ba(t,e,!0)},Pr.sortedLastIndexBy=function(t,e,r){return Qa(t,e,$n(r,2),!0)},Pr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=Ba(t,e,!0)-1;if(Co(t[r],e))return r}return-1},Pr.startCase=As,Pr.startsWith=function(t,e,r){return t=cs(t),r=null==r?0:qr(ns(r),0,t.length),e=$a(e),t.slice(r,r+e.length)==e},Pr.subtract=bc,Pr.sum=function(t){return t&&t.length?Me(t,Gs):0},Pr.sumBy=function(t,e){return t&&t.length?Me(t,$n(e,2)):0},Pr.template=function(t,e,r){var a=Pr.templateSettings;r&&oi(t,e,r)&&(e=void 0),t=cs(t),e=hs({},e,a,jn);var n,i,o=hs({},e.imports,a.imports,jn),s=Ss(o),c=Oe(o,s),u=0,l=e.interpolate||ut,h="__p += '",p=ft((e.escape||ut).source+"|"+l.source+"|"+(l===E?et:ut).source+"|"+(e.evaluate||ut).source+"|$","g"),g="//# sourceURL="+(wt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Nt+"]")+"\n";t.replace(p,(function(e,r,a,o,s,c){return a||(a=o),h+=t.slice(u,c).replace(lt,Ne),r&&(n=!0,h+="' +\n__e("+r+") +\n'"),s&&(i=!0,h+="';\n"+s+";\n__p += '"),a&&(h+="' +\n((__t = ("+a+")) == null ? '' : __t) +\n'"),u=c+e.length,e})),h+="';\n";var b=wt.call(e,"variable")&&e.variable;if(b){if(J.test(b))throw new ht("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(i?h.replace(R,""):h).replace(_,"$1").replace(T,"$1;"),h="function("+(b||"obj")+") {\n"+(b?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(n?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var f=Ys((function(){return pt(s,g+"return "+h).apply(void 0,c)}));if(f.source=h,zo(f))throw f;return f},Pr.times=function(t,e){if((t=ns(t))<1||t>9007199254740991)return[];var r=4294967295,a=or(t,4294967295);t-=4294967295;for(var n=We(a,e=$n(e));++r<t;)e(r);return n},Pr.toFinite=as,Pr.toInteger=ns,Pr.toLength=is,Pr.toLower=function(t){return cs(t).toLowerCase()},Pr.toNumber=os,Pr.toSafeInteger=function(t){return t?qr(ns(t),-9007199254740991,9007199254740991):0===t?t:0},Pr.toString=cs,Pr.toUpper=function(t){return cs(t).toUpperCase()},Pr.trim=function(t,e,r){if((t=cs(t))&&(r||void 0===e))return Pe(t);if(!t||!(e=$a(e)))return t;var a=Ue(t),n=Ue(e);return cn(a,ke(a,n),Re(a,n)+1).join("")},Pr.trimEnd=function(t,e,r){if((t=cs(t))&&(r||void 0===e))return t.slice(0,Be(t)+1);if(!t||!(e=$a(e)))return t;var a=Ue(t);return cn(a,0,Re(a,Ue(e))+1).join("")},Pr.trimStart=function(t,e,r){if((t=cs(t))&&(r||void 0===e))return t.replace(G,"");if(!t||!(e=$a(e)))return t;var a=Ue(t);return cn(a,ke(a,Ue(e))).join("")},Pr.truncate=function(t,e){var r=30,a="...";if(Uo(e)){var n="separator"in e?e.separator:n;r="length"in e?ns(e.length):r,a="omission"in e?$a(e.omission):a}var i=(t=cs(t)).length;if(Le(t)){var o=Ue(t);i=o.length}if(r>=i)return t;var s=r-He(a);if(s<1)return a;var c=o?cn(o,0,s).join(""):t.slice(0,s);if(void 0===n)return c+a;if(o&&(s+=c.length-s),$o(n)){if(t.slice(s).search(n)){var u,l=c;for(n.global||(n=ft(n.source,cs(rt.exec(n))+"g")),n.lastIndex=0;u=n.exec(l);)var h=u.index;c=c.slice(0,void 0===h?s:h)}}else if(t.indexOf($a(n),s)!=s){var p=c.lastIndexOf(n);p>-1&&(c=c.slice(0,p))}return c+a},Pr.unescape=function(t){return(t=cs(t))&&L.test(t)?t.replace(I,Qe):t},Pr.uniqueId=function(t){var e=++Ft;return cs(t)+e},Pr.upperCase=js,Pr.upperFirst=zs,Pr.each=so,Pr.eachRight=co,Pr.first=Ii,Xs(Pr,(sc={},sa(Pr,(function(t,e){wt.call(Pr.prototype,e)||(sc[e]=t)})),sc),{chain:!1}),Pr.VERSION="4.17.21",ne(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Pr[t].placeholder=Pr})),ne(["drop","take"],(function(t,e){kr.prototype[t]=function(r){r=void 0===r?1:ir(ns(r),0);var a=this.__filtered__&&!e?new kr(this):this.clone();return a.__filtered__?a.__takeCount__=or(r,a.__takeCount__):a.__views__.push({size:or(r,4294967295),type:t+(a.__dir__<0?"Right":"")}),a},kr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ne(["filter","map","takeWhile"],(function(t,e){var r=e+1,a=1==r||3==r;kr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:$n(t,3),type:r}),e.__filtered__=e.__filtered__||a,e}})),ne(["head","last"],(function(t,e){var r="take"+(e?"Right":"");kr.prototype[t]=function(){return this[r](1).value()[0]}})),ne(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");kr.prototype[t]=function(){return this.__filtered__?new kr(this):this[r](1)}})),kr.prototype.compact=function(){return this.filter(Gs)},kr.prototype.find=function(t){return this.filter(t).head()},kr.prototype.findLast=function(t){return this.reverse().find(t)},kr.prototype.invokeMap=Na((function(t,e){return"function"==typeof t?new kr(this):this.map((function(r){return ma(r,t,e)}))})),kr.prototype.reject=function(t){return this.filter(Mo($n(t)))},kr.prototype.slice=function(t,e){t=ns(t);var r=this;return r.__filtered__&&(t>0||e<0)?new kr(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),void 0!==e&&(r=(e=ns(e))<0?r.dropRight(-e):r.take(e-t)),r)},kr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},kr.prototype.toArray=function(){return this.take(4294967295)},sa(kr.prototype,(function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),a=/^(?:head|last)$/.test(e),n=Pr[a?"take"+("last"==e?"Right":""):e],i=a||/^find/.test(e);n&&(Pr.prototype[e]=function(){var e=this.__wrapped__,o=a?[1]:arguments,s=e instanceof kr,c=o[0],u=s||To(e),l=function(t){var e=n.apply(Pr,he([t],o));return a&&h?e[0]:e};u&&r&&"function"==typeof c&&1!=c.length&&(s=u=!1);var h=this.__chain__,p=!!this.__actions__.length,g=i&&!h,b=s&&!p;if(!i&&u){e=b?e:new kr(this);var f=t.apply(e,o);return f.__actions__.push({func:ro,args:[l],thisArg:void 0}),new Cr(f,h)}return g&&b?t.apply(this,o):(f=this.thru(l),g?a?f.value()[0]:f.value():f)})})),ne(["pop","push","shift","sort","splice","unshift"],(function(t){var e=vt[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",a=/^(?:pop|shift)$/.test(t);Pr.prototype[t]=function(){var t=arguments;if(a&&!this.__chain__){var n=this.value();return e.apply(To(n)?n:[],t)}return this[r]((function(r){return e.apply(To(r)?r:[],t)}))}})),sa(kr.prototype,(function(t,e){var r=Pr[e];if(r){var a=r.name+"";wt.call(vr,a)||(vr[a]=[]),vr[a].push({name:e,func:r})}})),vr[Pn(void 0,2).name]=[{name:"wrapper",func:void 0}],kr.prototype.clone=function(){var t=new kr(this.__wrapped__);return t.__actions__=dn(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=dn(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=dn(this.__views__),t},kr.prototype.reverse=function(){if(this.__filtered__){var t=new kr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},kr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=To(t),a=e<0,n=r?t.length:0,i=function(t,e,r){for(var a=-1,n=r.length;++a<n;){var i=r[a],o=i.size;switch(i.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=or(e,t+o);break;case"takeRight":t=ir(t,e-o)}}return{start:t,end:e}}(0,n,this.__views__),o=i.start,s=i.end,c=s-o,u=a?s:o-1,l=this.__iteratees__,h=l.length,p=0,g=or(c,this.__takeCount__);if(!r||!a&&n==c&&g==c)return tn(t,this.__actions__);var b=[];t:for(;c--&&p<g;){for(var f=-1,d=t[u+=e];++f<h;){var m=l[f],v=m.type,y=(0,m.iteratee)(d);if(2==v)d=y;else if(!y){if(1==v)continue t;break t}}b[p++]=d}return b},Pr.prototype.at=ao,Pr.prototype.chain=function(){return eo(this)},Pr.prototype.commit=function(){return new Cr(this.value(),this.__chain__)},Pr.prototype.next=function(){void 0===this.__values__&&(this.__values__=rs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Pr.prototype.plant=function(t){for(var e,r=this;r instanceof Or;){var a=Vi(r);a.__index__=0,a.__values__=void 0,e?n.__wrapped__=a:e=a;var n=a;r=r.__wrapped__}return n.__wrapped__=t,e},Pr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof kr){var e=t;return this.__actions__.length&&(e=new kr(this)),(e=e.reverse()).__actions__.push({func:ro,args:[Hi],thisArg:void 0}),new Cr(e,this.__chain__)}return this.thru(Hi)},Pr.prototype.toJSON=Pr.prototype.valueOf=Pr.prototype.value=function(){return tn(this.__wrapped__,this.__actions__)},Pr.prototype.first=Pr.prototype.head,fe&&(Pr.prototype[fe]=function(){return this}),Pr}();Ut._=Ge,void 0===(a=(function(){return Ge}).call(e,r,e,t))||(t.exports=a)}).call(this)}).call(this,r("YuTi")(t))},pJjZ:function(e,a,i){"use strict";i.r(a),i.d(a,"AdminReportingModule",(function(){return Xu}));var o,s=i("ofXK"),c=i("tyNb"),u=i("mrSG"),l=i("LvDl"),h=i("wd/R"),p=i("fXoL"),g=i("oabR"),b=i("aNep"),f=i("3awX"),d=i("/X+5"),m=i("kmnG"),v=i("d3UM"),y=i("3Pt+"),D=i("FKr1"),S=i("lDzL"),w=i("bv9b"),F=i("MT78"),x=((o=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}},{key:"ngOnChanges",value:function(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}},{key:"setChartOptions",value:function(e,r,a,n,i,o){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom);var s,c=[],u=t(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,h=Object.keys(l)[0];h&&c.push({name:h,type:"bar",stack:"Ad",data:l[h].map((function(t){return parseFloat(t).toFixed(2)}))})}}catch(p){u.e(p)}finally{u.f()}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(t){var e=function(t){return'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+t+'"></span>'},r="<p>"+t[0].axisValue+"</p>",a=0;return t.forEach((function(t){var n="<p>"+e(t.color)+" "+t.seriesName+":  $ "+t.data+"</p>";r+=n,a+=parseFloat(t.data)})),r+="<p>"+e("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:i},xAxis:[{type:"category",data:a,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:c},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}},{key:"convertTimeStampArryToDate",value:function(t){for(var e=[],r=0;r<t.length;r++)e.push(h(t[r]).format("MM-DD-YYYY"));return e}},{key:"getChartData",value:function(t){if(t)return t}}]),e}()).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=p.Kb({type:o,selectors:[["app-reporting-revenue-chart"]],inputs:{chartData:"chartData"},features:[p.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(t,e){1&t&&p.Rb(0,"div",0)},styles:[".demo-chart[_ngcontent-%COMP%]{height:400px}"]}),o),M=i("MutI"),W=i("f0Cb");function P(t,e){if(1&t&&(p.Wb(0,"div",1),p.Wb(1,"div",2),p.Wb(2,"div",3),p.Wb(3,"div",4),p.Wb(4,"div",5),p.Wb(5,"h2",6),p.Oc(6,"Selected Statistics"),p.Vb(),p.Vb(),p.Vb(),p.Wb(7,"div",7),p.Wb(8,"mat-list"),p.Wb(9,"mat-list-item"),p.Oc(10),p.mc(11,"number"),p.Vb(),p.Rb(12,"mat-divider"),p.Rb(13,"mat-divider"),p.Wb(14,"mat-list-item"),p.Oc(15),p.mc(16,"number"),p.Vb(),p.Rb(17,"mat-divider"),p.Wb(18,"mat-list-item"),p.Oc(19),p.Vb(),p.Rb(20,"mat-divider"),p.Wb(21,"mat-list-item"),p.Oc(22),p.Vb(),p.Rb(23,"mat-divider"),p.Rb(24,"mat-list-item"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(25,"div",2),p.Wb(26,"div",3),p.Wb(27,"div",4),p.Wb(28,"div",5),p.Wb(29,"h2",6),p.Oc(30,"Month to Date Statistics"),p.Vb(),p.Vb(),p.Vb(),p.Wb(31,"div",7),p.Wb(32,"mat-list"),p.Wb(33,"mat-list-item"),p.Oc(34),p.mc(35,"number"),p.Vb(),p.Rb(36,"mat-divider"),p.Wb(37,"mat-list-item"),p.Oc(38),p.mc(39,"number"),p.Vb(),p.Rb(40,"mat-divider"),p.Wb(41,"mat-list-item"),p.Oc(42),p.mc(43,"number"),p.Vb(),p.Rb(44,"mat-divider"),p.Wb(45,"mat-list-item"),p.Oc(46),p.mc(47,"number"),p.Vb(),p.Rb(48,"mat-divider"),p.Wb(49,"mat-list-item"),p.Oc(50),p.mc(51,"number"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(52,"div",2),p.Wb(53,"div",3),p.Wb(54,"div",4),p.Wb(55,"div",5),p.Wb(56,"h2",6),p.Oc(57,"Last Month Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(58,"div",7),p.Wb(59,"mat-list"),p.Wb(60,"mat-list-item"),p.Oc(61),p.mc(62,"number"),p.Vb(),p.Rb(63,"mat-divider"),p.Wb(64,"mat-list-item"),p.Oc(65),p.mc(66,"number"),p.Vb(),p.Rb(67,"mat-divider"),p.Wb(68,"mat-list-item"),p.Oc(69),p.mc(70,"number"),p.Vb(),p.Rb(71,"mat-divider"),p.Wb(72,"mat-list-item"),p.Oc(73),p.mc(74,"number"),p.Vb(),p.Rb(75,"mat-divider"),p.Wb(76,"mat-list-item"),p.Oc(77),p.mc(78,"number"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc();p.Db(10),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].selectedStat[0].revenue?p.oc(11,14,r.summaryMetricsData.summary[0].selectedStat[0].revenue,"1.2-2"):"0.00",""),p.Db(5),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].selectedStat[0].profit?p.oc(16,17,r.summaryMetricsData.summary[0].selectedStat[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Start Date: ",r.summaryMetricsData.summary[0].selectedStat[0].selectedStartDate,""),p.Db(3),p.Qc("End Date: ",r.summaryMetricsData.summary[0].selectedStat[0].selectedEndDate,""),p.Db(12),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].revenue?p.oc(35,20,r.summaryMetricsData.summary[0].summaryMetrics[0].revenue,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Revenue Pace: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace?p.oc(39,23,r.summaryMetricsData.summary[0].summaryMetrics[0].revenuePace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].profit?p.oc(43,26,r.summaryMetricsData.summary[0].summaryMetrics[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit Pace: $ ",r.summaryMetricsData.summary[0].summaryMetrics[0].profitPace?p.oc(47,29,r.summaryMetricsData.summary[0].summaryMetrics[0].profitPace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Percentage Change: ",r.summaryMetricsData.summary[0].summaryMetrics[0].percentPace?p.oc(51,32,r.summaryMetricsData.summary[0].summaryMetrics[0].percentPace,"1.2-2"):"0.00"," %"),p.Db(11),p.Qc("Revenue: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].revenue?p.oc(62,35,r.summaryMetricsData.summary[0].lastMonthStat[0].revenue,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Revenue Pace: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace?p.oc(66,38,r.summaryMetricsData.summary[0].lastMonthStat[0].revenuePace,"2.2-2"):"0.00",""),p.Db(4),p.Qc("Profit: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].profit?p.oc(70,41,r.summaryMetricsData.summary[0].lastMonthStat[0].profit,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Profit Pace: $ ",r.summaryMetricsData.summary[0].lastMonthStat[0].profitPace?p.oc(74,44,r.summaryMetricsData.summary[0].lastMonthStat[0].profitPace,"1.2-2"):"0.00",""),p.Db(4),p.Qc("Percentage Change: ",r.summaryMetricsData.summary[0].lastMonthStat[0].percentPace?p.oc(78,47,r.summaryMetricsData.summary[0].lastMonthStat[0].percentPace,"1.2-2"):"0.00"," %")}}var V,O=((V=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){this.summaryMetricsData=this.getSummaryData(this.summaryMetricsData)}},{key:"getSummaryData",value:function(t){if(t)return t}}]),t}()).\u0275fac=function(t){return new(t||V)},V.\u0275cmp=p.Kb({type:V,selectors:[["app-summary-metrics"]],inputs:{summaryMetricsData:"summaryMetricsData"},decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-xl-4"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"]],template:function(t,e){1&t&&p.Mc(0,P,79,50,"div",0),2&t&&p.rc("ngIf",e.summaryMetricsData)},directives:[s.p,M.a,M.c,W.a],pipes:[s.g],styles:[""]}),V),C=["expandableTable"];function k(t,e){1&t&&(p.Wb(0,"div",32),p.Rb(1,"mat-progress-bar",33),p.Vb())}function R(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",34),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function _(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",35),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function T(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function I(t,e){if(1&t&&(p.Wb(0,"div",38),p.Wb(1,"table",39),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,T,27,35,"tr",40),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function N(t,e){1&t&&(p.Wb(0,"div",41),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function L(t,e){if(1&t&&(p.Mc(0,I,22,1,"div",36),p.Mc(1,N,6,0,"div",37)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function A(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",42),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function j(t,e){1&t&&p.Oc(0," Date ")}function z(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function E(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,j,1,0,"ng-template",24),p.Mc(2,z,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Y(t,e){1&t&&p.Oc(0," Subid ")}function H(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function U(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,Y,1,0,"ng-template",24),p.Mc(2,H,2,1,"ng-template",17),p.Vb())}function B(t,e){1&t&&p.Oc(0," Publisher ")}function Q(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function G(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,B,1,0,"ng-template",24),p.Mc(2,Q,2,1,"ng-template",17),p.Vb())}function q(t,e){1&t&&p.Oc(0," Clicks ")}function $(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function K(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,q,1,0,"ng-template",24),p.Mc(2,$,3,3,"ng-template",17),p.Vb())}function X(t,e){1&t&&p.Oc(0," Searches ")}function Z(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function J(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,X,1,0,"ng-template",24),p.Mc(2,Z,3,3,"ng-template",17),p.Vb())}function tt(t,e){1&t&&p.Oc(0," Filtering ")}function et(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function rt(t,e){1&t&&p.Oc(0," Impressions ")}function at(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function nt(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,rt,1,0,"ng-template",24),p.Mc(2,at,3,3,"ng-template",17),p.Vb())}function it(t,e){1&t&&p.Oc(0," CPC ")}function ot(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function st(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,it,1,0,"ng-template",24),p.Mc(2,ot,3,4,"ng-template",17),p.Vb())}function ct(t,e){1&t&&p.Oc(0," CTR ")}function ut(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function lt(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,ct,1,0,"ng-template",24),p.Mc(2,ut,3,4,"ng-template",17),p.Vb())}function ht(t,e){1&t&&p.Oc(0," Split ")}function pt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function gt(t,e){1&t&&p.Oc(0," Publisher Net ")}function bt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function ft(t,e){1&t&&p.Oc(0," Profit ")}function dt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function mt(t,e){1&t&&p.Oc(0," Revenue ")}function vt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var yt,Dt=((yt=function(){function e(t,a,n,i){r(this,e),this.cdr=t,this.userService=a,this.apptitudeService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.cdr.detectChanges();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getAllApptitudeStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.apptitudeService.getApptitudeStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("apptitude"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.cdr.detectChanges();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].filtering+=parseFloat(e.filtering?e.filtering:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.detectChanges()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].filtering+=parseFloat(e.filtering?e.filtering:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].filtering+=parseFloat(e.filtering?e.filtering:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.ctr=i.clicks/i.searches,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.detectChanges()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].impressions+=parseFloat(e.impressions?e.impressions:0),a[r].filtering+=parseFloat(e.filtering?e.filtering:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].impressions+=parseFloat(e.impressions?e.impressions:0),a[r].filtering+=parseFloat(e.filtering?e.filtering:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.apptitudeService.getApptitudeStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("apptitude"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher")}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].searches+=parseInt(e.searches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,n,i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.apptitudeService.getSummaryMetrics(this.selectedCompany,e,r).toPromise();case 2:return a=t.sent,n={},i=0,o=0,s=0,t.abrupt("return",(0!=a.summary[0].lastMonthStat[0].profitPace&&(i=(a.summary[0].summaryMetrics[0].profitPace-a.summary[0].lastMonthStat[0].profitPace)/a.summary[0].lastMonthStat[0].profitPace*100),0!=a.summary[0].twoLastMonthStat[0].profitPace&&(o=(a.summary[0].lastMonthStat[0].profitPace-a.summary[0].twoLastMonthStat[0].profitPace)/a.summary[0].twoLastMonthStat[0].profitPace*100),0!=a.summary[0].prevSelectedStat[0].profitPace&&(s=(a.summary[0].selectedStat[0].profitPace-a.summary[0].prevSelectedStat[0].profitPace)/a.summary[0].prevSelectedStat[0].profitPace*100),a.summary[0].summaryMetrics[0].percentPace=i,a.summary[0].lastMonthStat[0].percentPace=o,a.summary[0].selectedStat[0].percentPace=s,a.summary[0].selectedStat[0].selectedStartDate=e,a.summary[0].selectedStat[0].selectedEndDate=r,n.summary=a.summary,n));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}}]),e}()).\u0275fac=function(t){return new(t||yt)(p.Qb(p.i),p.Qb(g.a),p.Qb(b.a),p.Qb(f.a))},yt.\u0275cmp=p.Kb({type:yt,selectors:[["app-apptitude"]],viewQuery:function(t,e){var r;1&t&&p.Tc(C,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:47,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","clicks",4,"ngIf"],["name","searches",4,"ngIf"],["name","filtering"],["ngx-datatable-header-template",""],["name","impressions",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","split"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher"],["name","clicks"],["name","searches"],["name","impressions"],["name","cpc"],["name","ctr"]],template:function(t,e){1&t&&(p.Mc(0,k,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,R,1,1,"app-reporting-revenue-chart",2),p.Mc(3,_,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,L,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,A,1,4,"ng-template",17),p.Vb(),p.Mc(24,E,3,1,"ngx-datatable-column",18),p.Mc(25,U,3,0,"ngx-datatable-column",19),p.Mc(26,G,3,0,"ngx-datatable-column",20),p.Mc(27,K,3,0,"ngx-datatable-column",21),p.Mc(28,J,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,tt,1,0,"ng-template",24),p.Mc(31,et,3,3,"ng-template",17),p.Vb(),p.Mc(32,nt,3,0,"ngx-datatable-column",25),p.Mc(33,st,3,0,"ngx-datatable-column",26),p.Mc(34,lt,3,0,"ngx-datatable-column",27),p.Wb(35,"ngx-datatable-column",28),p.Mc(36,ht,1,0,"ng-template",24),p.Mc(37,pt,3,3,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",29),p.Mc(39,gt,1,0,"ng-template",24),p.Mc(40,bt,3,4,"ng-template",17),p.Vb(),p.Wb(41,"ngx-datatable-column",30),p.Mc(42,ft,1,0,"ng-template",24),p.Mc(43,dt,3,4,"ng-template",17),p.Vb(),p.Wb(44,"ngx-datatable-column",31),p.Mc(45,mt,1,0,"ng-template",24),p.Mc(46,vt,3,4,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(4),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),yt),St=i("XJ1K"),wt=["expandableTable"];function Ft(t,e){1&t&&(p.Wb(0,"div",27),p.Rb(1,"mat-progress-bar",28),p.Vb())}function xt(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",29),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Mt(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",30),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Wt(t,e){1&t&&(p.Wb(0,"div",31),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Pt(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",32),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Vt(t,e){1&t&&p.Oc(0," Date ")}function Ot(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ct(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",33),p.Mc(1,Vt,1,0,"ng-template",17),p.Mc(2,Ot,3,3,"ng-template",13),p.Vb()),2&t&&p.rc("minWidth",100)}function kt(t,e){1&t&&p.Oc(0," Subid ")}function Rt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function _t(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",34),p.Mc(1,kt,1,0,"ng-template",17),p.Mc(2,Rt,2,1,"ng-template",13),p.Vb())}function Tt(t,e){1&t&&p.Oc(0," Publisher ")}function It(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Nt(t,e){1&t&&p.Oc(0," Searches ")}function Lt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function At(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",35),p.Mc(1,Nt,1,0,"ng-template",17),p.Mc(2,Lt,3,3,"ng-template",13),p.Vb())}function jt(t,e){1&t&&p.Oc(0," Clicks ")}function zt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Et(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",36),p.Mc(1,jt,1,0,"ng-template",17),p.Mc(2,zt,3,3,"ng-template",13),p.Vb())}function Yt(t,e){1&t&&p.Oc(0," Coverage ")}function Ht(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ut(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",37),p.Mc(1,Yt,1,0,"ng-template",17),p.Mc(2,Ht,3,3,"ng-template",13),p.Vb())}function Bt(t,e){1&t&&p.Oc(0," PPC ")}function Qt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Gt(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",38),p.Mc(1,Bt,1,0,"ng-template",17),p.Mc(2,Qt,3,3,"ng-template",13),p.Vb())}function qt(t,e){1&t&&p.Oc(0," TQ ")}function $t(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Kt(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,qt,1,0,"ng-template",17),p.Mc(2,$t,3,3,"ng-template",13),p.Vb())}function Xt(t,e){1&t&&p.Oc(0," Split ")}function Zt(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function Jt(t,e){1&t&&p.Oc(0," Publisher Net ")}function te(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function ee(t,e){1&t&&p.Oc(0," Profit ")}function re(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function ae(t,e){1&t&&p.Oc(0," Revenue ")}function ne(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var ie,oe=((ie=function(){function e(t,a,n,i){r(this,e),this.cdr=t,this.userService=a,this.hopkinService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.expanded={},this.tagList=[],this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getAllHopkinStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.hopkinService.getHopkinStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("hopkins"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].ppc+=parseFloat(e.ppc?e.ppc:0),r[a].tq+=parseFloat(e.tq?e.tq:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.cdr.markForCheck()}},{key:"backProvider",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.cdr.markForCheck()}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllHopkinStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.loadingIndicator=!1,this.refreshTable();case 16:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.hopkinService.getHopkinStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("hopkins"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].searches+=parseInt(e.searches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.hopkinService.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),e}()).\u0275fac=function(t){return new(t||ie)(p.Qb(p.i),p.Qb(g.a),p.Qb(St.a),p.Qb(f.a))},ie.\u0275cmp=p.Kb({type:ie,selectors:[["app-hopkins"]],viewQuery:function(t,e){var r;1&t&&p.Tc(wt,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:38,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row","px-6"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"btn","btn-sm","btn-dark","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ppc",4,"ngIf"],["name","tq",4,"ngIf"],["name","split",3,"minWidth"],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","searches"],["name","clicks"],["name","coverage"],["name","ppc"],["name","tq"]],template:function(t,e){1&t&&(p.Mc(0,Ft,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,xt,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Mt,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"button",5),p.hc("click",(function(){return e.groupProvider()})),p.Oc(6," Group "),p.Vb(),p.Wb(7,"button",6),p.hc("click",(function(){return e.backProvider()})),p.Oc(8," Back "),p.Vb(),p.Vb(),p.Wb(9,"ngx-datatable",7,8),p.Wb(11,"ngx-datatable-row-detail",9,10),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(13,Wt,6,0,"ng-template",11),p.Vb(),p.Wb(14,"ngx-datatable-column",12),p.Mc(15,Pt,1,4,"ng-template",13),p.Vb(),p.Mc(16,Ct,3,1,"ngx-datatable-column",14),p.Mc(17,_t,3,0,"ngx-datatable-column",15),p.Wb(18,"ngx-datatable-column",16),p.Mc(19,Tt,1,0,"ng-template",17),p.Mc(20,It,2,1,"ng-template",13),p.Vb(),p.Mc(21,At,3,0,"ngx-datatable-column",18),p.Mc(22,Et,3,0,"ngx-datatable-column",19),p.Mc(23,Ut,3,0,"ngx-datatable-column",20),p.Mc(24,Gt,3,0,"ngx-datatable-column",21),p.Mc(25,Kt,3,0,"ngx-datatable-column",22),p.Wb(26,"ngx-datatable-column",23),p.Mc(27,Xt,1,0,"ng-template",17),p.Mc(28,Zt,4,6,"ng-template",13),p.Vb(),p.Wb(29,"ngx-datatable-column",24),p.Mc(30,Jt,1,0,"ng-template",17),p.Mc(31,te,3,4,"ng-template",13),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,ee,1,0,"ng-template",17),p.Mc(34,re,3,4,"ng-template",13),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,ae,1,0,"ng-template",17),p.Mc(37,ne,3,4,"ng-template",13),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("minWidth",100),p.Db(3),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag),p.Db(1),p.rc("minWidth",35))},directives:[s.p,d.a,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O],pipes:[s.f,s.g,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),ie),se=["expandableTable"];function ce(t,e){1&t&&(p.Wb(0,"div",23),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function ue(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",24),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function le(t,e){1&t&&p.Oc(0," Publisher ")}function he(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function pe(t,e){1&t&&p.Oc(0," Tag ")}function ge(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function be(t,e){1&t&&p.Oc(0," Total Searches ")}function fe(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function de(t,e){1&t&&p.Oc(0," Monetized Searches ")}function me(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ve(t,e){1&t&&p.Oc(0," Clicks ")}function ye(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function De(t,e){1&t&&p.Oc(0," Follow On ")}function Se(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function we(t,e){if(1&t&&(p.Wb(0,"span"),p.Oc(1),p.Vb()),2&t){var r=e.column;p.Db(1),p.Pc(r.name)}}function Fe(t,e){if(1&t&&(p.Rb(0,"strong",25),p.mc(1,"percent")),2&t){var r=e.row;p.rc("innerHTML",p.oc(1,1,r.clicks/r.totalSearches,"2.2-2"),p.Ec)}}function xe(t,e){1&t&&p.Oc(0," Revenue ")}function Me(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var We,Pe,Ve=((Pe=function(){function t(){r(this,t),this.rows=[{name:"Greg",tag:"YHS Organic",totalSearches:"536412",monetizedSearches:"501235",revenue:"52623",clicks:50351,followOn:"13%"}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}return n(t,[{key:"ngOnInit",value:function(){}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}}]),t}()).\u0275fac=function(t){return new(t||Pe)},Pe.\u0275cmp=p.Kb({type:Pe,selectors:[["app-imgage-advantage"]],viewQuery:function(t,e){var r;1&t&&p.Tc(se,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:70,vars:13,consts:[[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","followOn"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"h2",5),p.Oc(6,"Month to Date Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(7,"div",6),p.Wb(8,"mat-list"),p.Wb(9,"mat-list-item"),p.Oc(10,"Revenue: $103,201.26"),p.Vb(),p.Rb(11,"mat-divider"),p.Wb(12,"mat-list-item"),p.Oc(13,"Revenue Pace: $131,285.19"),p.Vb(),p.Rb(14,"mat-divider"),p.Wb(15,"mat-list-item"),p.Oc(16,"Profit: $21,109.59"),p.Vb(),p.Rb(17,"mat-divider"),p.Wb(18,"mat-list-item"),p.Oc(19,"Profit Pace: $173,121.45"),p.Vb(),p.Rb(20,"mat-divider"),p.Wb(21,"mat-list-item"),p.Oc(22,"Percentage Change: +27%"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(23,"div",1),p.Wb(24,"div",2),p.Wb(25,"div",3),p.Wb(26,"div",4),p.Wb(27,"h2",5),p.Oc(28,"Last Month Stats"),p.Vb(),p.Vb(),p.Vb(),p.Wb(29,"div",6),p.Wb(30,"mat-list"),p.Wb(31,"mat-list-item"),p.Oc(32,"Revenue: $113,542.23"),p.Vb(),p.Rb(33,"mat-divider"),p.Wb(34,"mat-list-item"),p.Oc(35,"Profit: $14,121.39"),p.Vb(),p.Rb(36,"mat-divider"),p.Wb(37,"mat-list-item"),p.Oc(38,"Percentage Change: +11%"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(39,"ngx-datatable",7,8),p.Wb(41,"ngx-datatable-row-detail",9,10),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(43,ce,6,0,"ng-template",11),p.Vb(),p.Wb(44,"ngx-datatable-column",12),p.Mc(45,ue,1,4,"ng-template",13),p.Vb(),p.Wb(46,"ngx-datatable-column",14),p.Mc(47,le,1,0,"ng-template",15),p.Mc(48,he,2,1,"ng-template",13),p.Vb(),p.Wb(49,"ngx-datatable-column",16),p.Mc(50,pe,1,0,"ng-template",15),p.Mc(51,ge,2,1,"ng-template",13),p.Vb(),p.Wb(52,"ngx-datatable-column",17),p.Mc(53,be,1,0,"ng-template",15),p.Mc(54,fe,3,3,"ng-template",13),p.Vb(),p.Wb(55,"ngx-datatable-column",18),p.Mc(56,de,1,0,"ng-template",15),p.Mc(57,me,3,3,"ng-template",13),p.Vb(),p.Wb(58,"ngx-datatable-column",19),p.Mc(59,ve,1,0,"ng-template",15),p.Mc(60,ye,3,3,"ng-template",13),p.Vb(),p.Wb(61,"ngx-datatable-column",20),p.Mc(62,De,1,0,"ng-template",15),p.Mc(63,Se,2,1,"ng-template",13),p.Vb(),p.Wb(64,"ngx-datatable-column",21),p.Mc(65,we,2,1,"ng-template",15),p.Mc(66,Fe,2,4,"ng-template",13),p.Vb(),p.Wb(67,"ngx-datatable-column",22),p.Mc(68,xe,1,0,"ng-template",15),p.Mc(69,Me,3,4,"ng-template",13),p.Vb(),p.Vb()),2&t&&(p.Db(39),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",e.rows),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[M.a,M.c,W.a,S.d,S.e,S.f,S.b,S.a,S.c],pipes:[s.g,s.w,s.d],styles:[""]}),Pe),Oe=((We=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||We)},We.\u0275cmp=p.Kb({type:We,selectors:[["app-media-net"]],decls:2,vars:0,template:function(t,e){1&t&&(p.Wb(0,"p"),p.Oc(1,"media-net works!"),p.Vb())},styles:[""]}),We),Ce=i("0TA1"),ke=i("SHm6"),Re=i("qFsG"),_e=["expandableTable"];function Te(t,e){1&t&&(p.Wb(0,"div",34),p.Rb(1,"mat-progress-bar",35),p.Vb())}function Ie(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",36),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Ne(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",37),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Le(t,e){if(1&t&&(p.Wb(0,"mat-option",38),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.label," ")}}function Ae(t,e){if(1&t){var r=p.Xb();p.Wb(0,"div",5),p.Wb(1,"mat-form-field",6),p.Wb(2,"mat-label"),p.Oc(3,"Condition"),p.Vb(),p.Wb(4,"mat-select",7),p.hc("selectionChange",(function(t){return p.Dc(r),p.lc().filterConditionHandle(t)}))("ngModelChange",(function(t){return p.Dc(r),p.lc().filterCondition=t})),p.Wb(5,"mat-option",39),p.Oc(6,"Greater Than"),p.Vb(),p.Wb(7,"mat-option",40),p.Oc(8,"Less Than"),p.Vb(),p.Vb(),p.Vb(),p.Vb()}if(2&t){var a=p.lc();p.Db(4),p.rc("ngModel",a.filterCondition)}}function je(t,e){if(1&t){var r=p.Xb();p.Wb(0,"div",5),p.Wb(1,"mat-form-field",41),p.Wb(2,"mat-label"),p.Oc(3,"Filter Amount"),p.Vb(),p.Wb(4,"input",42),p.hc("ngModelChange",(function(t){return p.Dc(r),p.lc().filterAmount=t}))("input",(function(){return p.Dc(r),p.lc().updateFilterAmount()})),p.Vb(),p.Vb(),p.Vb()}if(2&t){var a=p.lc();p.Db(4),p.rc("ngModel",a.filterAmount)}}function ze(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"number"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"percent"),p.mc(16,"percent"),p.Vb(),p.Wb(17,"td"),p.Oc(18),p.mc(19,"currency"),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Wb(27,"td"),p.Oc(28),p.mc(29,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,9,r.date)),p.Db(3),p.Pc(p.nc(6,11,r.totalsearches)),p.Db(3),p.Pc(p.nc(9,13,r.impressions)),p.Db(3),p.Pc(p.nc(12,15,r.clicks)),p.Db(3),p.Pc(p.oc(15,17,r.ctr,"2.2-2")||p.oc(16,20,0,"2.2-2")),p.Db(4),p.Pc(p.oc(19,23,r.cpc,"USD")||p.oc(20,26,0,"USD")),p.Db(4),p.Pc(p.oc(23,29,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.profit,"USD")),p.Db(3),p.Pc(p.oc(29,35,r.revenue,"USD"))}}function Ee(t,e){if(1&t&&(p.Wb(0,"div",45),p.Wb(1,"table",46),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Impressions"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"Clicks"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CTR"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"CPC"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Publisher Net"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Profit"),p.Vb(),p.Wb(20,"th"),p.Oc(21,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(22,"tbody"),p.Mc(23,ze,30,38,"tr",47),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(23),p.rc("ngForOf",r.subReportingForDate)}}function Ye(t,e){1&t&&(p.Wb(0,"div",48),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function He(t,e){if(1&t&&(p.Mc(0,Ee,24,1,"div",43),p.Mc(1,Ye,6,0,"div",44)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Ue(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",49),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Be(t,e){1&t&&p.Oc(0," Date ")}function Qe(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ge(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,Be,1,0,"ng-template",32),p.Mc(2,Qe,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function qe(t,e){1&t&&p.Oc(0," Subid ")}function $e(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Ke(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,qe,1,0,"ng-template",32),p.Mc(2,$e,2,1,"ng-template",17),p.Vb())}function Xe(t,e){1&t&&p.Oc(0," Publisher ")}function Ze(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Je(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,Xe,1,0,"ng-template",32),p.Mc(2,Ze,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function tr(t,e){1&t&&p.Oc(0," Searches ")}function er(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function rr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,tr,1,0,"ng-template",32),p.Mc(2,er,3,3,"ng-template",17),p.Vb())}function ar(t,e){1&t&&p.Oc(0," Impressions ")}function nr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ir(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,ar,1,0,"ng-template",32),p.Mc(2,nr,3,3,"ng-template",17),p.Vb())}function or(t,e){1&t&&p.Oc(0," Clicks ")}function sr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function cr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,or,1,0,"ng-template",32),p.Mc(2,sr,3,3,"ng-template",17),p.Vb())}function ur(t,e){1&t&&p.Oc(0," CPC ")}function lr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.mc(3,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD")||p.oc(3,4,0,"USD"))}}function hr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,ur,1,0,"ng-template",32),p.Mc(2,lr,4,7,"ng-template",17),p.Vb())}function pr(t,e){1&t&&p.Oc(0," CTR ")}function gr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.mc(3,"percent"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function br(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,pr,1,0,"ng-template",32),p.Mc(2,gr,4,7,"ng-template",17),p.Vb())}function fr(t,e){1&t&&p.Oc(0," Bing Coverage ")}function dr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Qc("",p.nc(2,1,r)," %")}}function mr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",58),p.Mc(1,fr,1,0,"ng-template",32),p.Mc(2,dr,3,3,"ng-template",17),p.Vb())}function vr(t,e){1&t&&p.Oc(0," CF Coverage ")}function yr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Qc("",p.nc(2,1,r)," %")}}function Dr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",59),p.Mc(1,vr,1,0,"ng-template",32),p.Mc(2,yr,3,3,"ng-template",17),p.Vb())}function Sr(t,e){1&t&&p.Oc(0," Follow On ")}function wr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"1.2-2"))}}function Fr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",60),p.Mc(1,Sr,1,0,"ng-template",32),p.Mc(2,wr,3,4,"ng-template",17),p.Vb())}function xr(t,e){1&t&&p.Oc(0," Publisher Net ")}function Mr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Wr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",61),p.Mc(1,xr,1,0,"ng-template",32),p.Mc(2,Mr,3,4,"ng-template",17),p.Vb())}function Pr(t,e){1&t&&p.Oc(0," Profit ")}function Vr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Or(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",62),p.Mc(1,Pr,1,0,"ng-template",32),p.Mc(2,Vr,3,4,"ng-template",17),p.Vb())}function Cr(t,e){1&t&&p.Oc(0," Revenue ")}function kr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Rr(t,e){1&t&&p.Oc(0," Split ")}function _r(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function Tr(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",63),p.Mc(1,Rr,1,0,"ng-template",32),p.Mc(2,_r,4,6,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",35)}var Ir,Nr,Lr=((Nr=function(){function e(t,a,n,i,o,s,c,u){r(this,e),this.perionService=t,this.cdr=a,this.userService=n,this.tagService=i,this.exportDataService=o,this.datePipe=s,this.currencyPipe=c,this.percentPipe=u,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.summary={revenue:0,profit:0},this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.showFilterAmount=!1,this.filterCondition="",this.groupType="",this.groupbyList=[{value:"date",label:"Date"},{value:"publisher",label:"Publisher"},{value:"subid",label:"Subid"},{value:"bestBingCoverage",label:"Best Bing Coverage"},{value:"worstBingCoverage",label:"Worst Bing Coverage"},{value:"bestCFCoverage",label:"Best CF Coverage"},{value:"worstCFCoverage",label:"Worst CF Coverage"},{value:"reset",label:"Reset"}],this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"updateAllPerionStats",value:function(t,e,r){this.perionService.updateAllPerionStats(t,e,r).subscribe((function(t){}))}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 22:case"end":return e.stop()}}),e,this)})))}},{key:"getAllPerionStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.perionService.getAllPerionStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.loadingIndicator=!1,this.allStat=i.stats,this.allStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("perion"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStat.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStat.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStat.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStat.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStat);case 9:return n.prev=9,n.t0=n.catch(0),n.abrupt("return",n.t0);case 12:case"end":return n.stop()}}),n,this,[[0,9]])})))}},{key:"groupDate",value:function(){var e,r={},a=this.allStat.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].totalsearches+=parseFloat(e.totalsearches?e.totalsearches:0),r[a].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),r[a].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].followon+=parseFloat(e.followon?e.followon:0),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupDateShowFlag=!0,this.groupPublishFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStat.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].totalsearches+=parseFloat(e.totalsearches?e.totalsearches:0),r[a].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),r[a].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].followon+=parseFloat(e.followon?e.followon:0),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStat.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].impressions+=parseFloat(e.impressions?e.impressions:0),r[a].totalsearches+=parseFloat(e.totalsearches?e.totalsearches:0),r[a].profit+=parseFloat(e.profit),r[a].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),r[a].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].followon+=parseFloat(e.followon?e.followon:0),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.followon=i.followon/i.counter,i.ctr=i.clicks/i.impressions,i.cpc=i.revenue/i.clicks,i.bingCoverage=i.bingCoverage/i.counter,i.cfCoverage=i.cfCoverage/i.counter,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!1,this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStat.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].impressions+=parseFloat(e.impressions?e.impressions:0),a[r].totalsearches+=parseFloat(e.totalsearches?e.totalsearches:0),a[r].profit+=parseFloat(e.profit),a[r].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),a[r].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].followon+=parseFloat(e.followon?e.followon:0),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.followon=e.followon/e.counter,e.ctr=e.clicks/e.impressions,e.cpc=e.revenue/e.clicks,e.bingCoverage=e.bingCoverage/e.counter,e.cfCoverage=e.cfCoverage/e.counter}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStat.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].impressions+=parseFloat(e.impressions?e.impressions:0),a[r].totalsearches+=parseFloat(e.totalsearches?e.totalsearches:0),a[r].profit+=parseFloat(e.profit),a[r].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),a[r].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].followon+=parseFloat(e.followon?e.followon:0),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.followon=e.followon/e.counter,e.ctr=e.clicks/e.impressions,e.cpc=e.revenue/e.clicks,e.bingCoverage=e.bingCoverage/e.counter,e.cfCoverage=e.cfCoverage/e.counter}catch(o){i.e(o)}finally{i.f()}return n}},{key:"updateFilterAmount",value:function(){this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition)}},{key:"groupCoverageCondition",value:function(e,r,a){var n,i={},o=this.allStat.reduce((function(t,e){var r=e.date+"-"+e.subid+"-"+e.publisher;return i[r]?(i[r].bingCoverage+=parseFloat(e.bingCoverage?e.bingCoverage:0),i[r].cfCoverage+=parseFloat(e.cfCoverage?e.cfCoverage:0),i[r].revenue+=parseFloat(e.revenue),i[r].counter++):(i[r]=Object.assign({},e),i[r].counter=1,t.push(i[r])),t}),[]),s=t(o);try{for(s.s();!(n=s.n()).done;){var c=n.value;c.bingCoverage=c.bingCoverage/c.counter,c.cfCoverage=c.cfCoverage/c.counter}}catch(u){s.e(u)}finally{s.f()}"worstBingCoverage"==e?(this.rows=r>0&&""!=a?"greater"==a?o.sort((function(t,e){return t.bingCoverage-e.bingCoverage})).filter((function(t){return t.revenue>=r})):o.sort((function(t,e){return t.bingCoverage-e.bingCoverage})).filter((function(t){return t.revenue<=r})):o.sort((function(t,e){return t.bingCoverage-e.bingCoverage})),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestBingCoverage"==e?(this.rows=r>0&&""!=a?"greater"==a?o.sort((function(t,e){return e.bingCoverage-t.bingCoverage})).filter((function(t){return t.revenue>=r})):o.sort((function(t,e){return e.bingCoverage-t.bingCoverage})).filter((function(t){return t.revenue<=r})):o.sort((function(t,e){return e.bingCoverage-t.bingCoverage})),this.groupBingCoverageFlag=!0,this.groupCFCoverageFlag=!1):"bestCFCoverage"==e?(this.rows=r>0&&""!=a?"greater"==a?o.sort((function(t,e){return e.cfCoverage-t.cfCoverage})).filter((function(t){return t.revenue>=r})):o.sort((function(t,e){return e.cfCoverage-t.cfCoverage})).filter((function(t){return t.revenue<=r})):o.sort((function(t,e){return e.cfCoverage-t.cfCoverage})),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0):(this.rows=r>0&&""!=a?"greater"==a?o.sort((function(t,e){return t.cfCoverage-e.cfCoverage})).filter((function(t){return t.revenue>=r})):o.sort((function(t,e){return t.cfCoverage-e.cfCoverage})).filter((function(t){return t.revenue<=r})):o.sort((function(t,e){return t.cfCoverage-e.cfCoverage})),this.groupBingCoverageFlag=!1,this.groupCFCoverageFlag=!0),this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupCoverageFlag=!0,this.cdr.markForCheck()}},{key:"filterConditionHandle",value:function(t){this.filterCondition=t.value,this.groupCoverageCondition(this.groupType,this.filterAmount,this.filterCondition),this.cdr.markForCheck()}},{key:"groupHandle",value:function(t){this.groupType=t.value,this.showFilterAmount=!1,this.filterAmount=0,this.filterCondition="","date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():"worstBingCoverage"==t.value||"bestBingCoverage"==t.value||"bestCFCoverage"==t.value||"worstCFCoverage"==t.value?(this.showFilterAmount=!0,this.groupCoverageCondition(t.value,this.filterAmount,this.filterCondition)):this.backGroup(),this.cdr.markForCheck()}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"exportToCsv",value:function(){var e=[];if("date"==this.groupType){var r,a=t(this.rows);try{for(a.s();!(r=a.n()).done;){var n=r.value,i={date:this.datePipe.transform(n.date,"dd MMM yyyy"),followOn:n.followon,publisherNet:this.currencyPipe.transform(n.publisherNet?n.publisherNet:0),profit:this.currencyPipe.transform(n.profit?n.profit:0),revenue:this.currencyPipe.transform(n.revenue?n.revenue:0),split:n.split};e.push(i)}}catch(W){a.e(W)}finally{a.f()}}else if("publisher"==this.groupType){var o,s=t(this.rows);try{for(s.s();!(o=s.n()).done;){var c=o.value,u={publisher:c.publisher,followOn:c.followon,publisherNet:this.currencyPipe.transform(c.publisherNet?c.publisherNet:0),profit:this.currencyPipe.transform(c.profit?c.profit:0),revenue:this.currencyPipe.transform(c.revenue?c.revenue:0),split:c.split};e.push(u)}}catch(W){s.e(W)}finally{s.f()}}else if("subid"==this.groupType){var l,h=t(this.rows);try{for(h.s();!(l=h.n()).done;){var p=l.value,g={subid:p.subid,followOn:p.followon,publisherNet:this.currencyPipe.transform(p.publisherNet?p.publisherNet:0),profit:this.currencyPipe.transform(p.profit?p.profit:0),revenue:this.currencyPipe.transform(p.revenue?p.revenue:0),split:p.split};e.push(g)}}catch(W){h.e(W)}finally{h.f()}}else if("worstBingCoverage"==this.groupType||"bestBingCoverage"==this.groupType){var b,f=t(this.rows);try{for(f.s();!(b=f.n()).done;){var d=b.value,m={date:this.datePipe.transform(d.date,"dd MMM yyyy"),subid:d.subid,publisher:d.publisher,bingCoverage:d.bingCoverage+"%",revenue:this.currencyPipe.transform(d.revenue?d.revenue:0)};e.push(m)}}catch(W){f.e(W)}finally{f.f()}}else if("worstCFCoverage"==this.groupType||"bestCFCoverage"==this.groupType){var v,y=t(this.rows);try{for(y.s();!(v=y.n()).done;){var D=v.value,S={date:this.datePipe.transform(D.date,"dd MMM yyyy"),subid:D.subid,publisher:D.publisher,cfCoverage:D.cfCoverage+"%",revenue:this.currencyPipe.transform(D.revenue?D.revenue:0)};e.push(S)}}catch(W){y.e(W)}finally{y.f()}}else{var w,F=t(this.rows);try{for(F.s();!(w=F.n()).done;){var x=w.value;x.date=this.datePipe.transform(x.date,"dd MMM yyyy"),x.bingCoverage=x.bingCoverage+"%",x.cfCoverage=x.cfCoverage+"%"}}catch(W){F.e(W)}finally{F.f()}e=this.rows}var M=e.length>0?Object.keys(e[0]):[];this.exportDataService.exportToCsv(e,""!==this.groupType?"perion-".concat(this.selectedCompany,"-").concat(this.groupType):"perion-"+this.selectedCompany,M)}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.perionService.getSummaryMetrics(t,e,r).toPromise();case 3:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 8:return a.prev=8,a.t0=a.catch(0),a.abrupt("return",a.t0);case 11:case"end":return a.stop()}}),a,this,[[0,8]])})))}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.perionService.getAllPerionStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("perion"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].totalsearches+=parseInt(e.totalsearches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"combineSummaryMetrics",value:function(t){var e=this;t.summary.keys.forEach((function(t){console.log(t.revenue),e.summary.revenue+=t.revenue,e.summary.profit+=t.revenue*(.01*(100-t.split))}))}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}}]),e}()).\u0275fac=function(t){return new(t||Nr)(p.Qb(Ce.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a),p.Qb(ke.a),p.Qb(s.f),p.Qb(s.d),p.Qb(s.w))},Nr.\u0275cmp=p.Kb({type:Nr,selectors:[["app-perion"]],viewQuery:function(t,e){var r;1&t&&p.Tc(_e,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:39,vars:34,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","col-xl-4",4,"ngIf"],[1,"row","py-2"],[1,"btn","btn-sm","btn-primary","mx-3",3,"click"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","totalsearches",4,"ngIf"],["name","impressions",4,"ngIf"],["name","clicks",4,"ngIf"],["name","cpc",4,"ngIf"],["name","ctr",4,"ngIf"],["name","bingCoverage",4,"ngIf"],["name","cfCoverage",4,"ngIf"],["name","followon",4,"ngIf"],["name","publisherNet",4,"ngIf"],["name","profit",4,"ngIf"],["name","revenue"],["ngx-datatable-header-template",""],["name","split",3,"minWidth",4,"ngIf"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],[3,"value"],["value","greater"],["value","less"],["appearance","outline",1,"custom-mat-input"],["matInput","","type","number","min","0",3,"ngModel","ngModelChange","input"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","totalsearches"],["name","impressions"],["name","clicks"],["name","cpc"],["name","ctr"],["name","bingCoverage"],["name","cfCoverage"],["name","followon"],["name","publisherNet"],["name","profit"],["name","split",3,"minWidth"]],template:function(t,e){1&t&&(p.Mc(0,Te,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,Ie,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Ne,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Mc(10,Le,2,2,"mat-option",8),p.Vb(),p.Vb(),p.Vb(),p.Mc(11,Ae,9,1,"div",9),p.Mc(12,je,5,1,"div",9),p.Vb(),p.Wb(13,"div",10),p.Wb(14,"button",11),p.hc("click",(function(){return e.exportToCsv()})),p.Oc(15," Export Stats "),p.Vb(),p.Vb(),p.Wb(16,"ngx-datatable",12,13),p.Wb(18,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(19,He,2,2,"ng-template",15),p.Vb(),p.Wb(20,"ngx-datatable-column",16),p.Mc(21,Ue,1,4,"ng-template",17),p.Vb(),p.Mc(22,Ge,3,1,"ngx-datatable-column",18),p.Mc(23,Ke,3,0,"ngx-datatable-column",19),p.Mc(24,Je,3,1,"ngx-datatable-column",20),p.Mc(25,rr,3,0,"ngx-datatable-column",21),p.Mc(26,ir,3,0,"ngx-datatable-column",22),p.Mc(27,cr,3,0,"ngx-datatable-column",23),p.Mc(28,hr,3,0,"ngx-datatable-column",24),p.Mc(29,br,3,0,"ngx-datatable-column",25),p.Mc(30,mr,3,0,"ngx-datatable-column",26),p.Mc(31,Dr,3,0,"ngx-datatable-column",27),p.Mc(32,Fr,3,0,"ngx-datatable-column",28),p.Mc(33,Wr,3,0,"ngx-datatable-column",29),p.Mc(34,Or,3,0,"ngx-datatable-column",30),p.Wb(35,"ngx-datatable-column",31),p.Mc(36,Cr,1,0,"ng-template",32),p.Mc(37,kr,3,4,"ng-template",17),p.Vb(),p.Mc(38,Tr,3,1,"ngx-datatable-column",33),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(1),p.rc("ngForOf",e.groupbyList),p.Db(1),p.rc("ngIf",e.showFilterAmount),p.Db(1),p.rc("ngIf",e.showFilterAmount),p.Db(4),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupCFCoverageFlag)),p.Db(1),p.rc("ngIf",!(e.groupPublishFlag||e.groupDateShowFlag||e.groupSubidShowFlag||e.groupBingCoverageFlag)),p.Db(1),p.rc("ngIf",!e.groupCoverageFlag),p.Db(1),p.rc("ngIf",!e.groupCoverageFlag),p.Db(1),p.rc("ngIf",!e.groupCoverageFlag),p.Db(4),p.rc("ngIf",!e.groupCoverageFlag))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,s.o,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,D.p,Re.b,y.v,y.d],pipes:[s.f,s.g,s.w,s.d],styles:[".mat-form-field-appearance-outline .mat-form-field-outline{background-color:#fff;border-radius:5px}.loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Nr),Ar=((Ir=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Ir)},Ir.\u0275cmp=p.Kb({type:Ir,selectors:[["app-reporting"]],decls:1,vars:0,template:function(t,e){1&t&&p.Rb(0,"router-outlet")},directives:[c.l],encapsulation:2}),Ir),jr=["expandableTable"];function zr(t,e){1&t&&(p.Wb(0,"div",17),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Er(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",18),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Yr(t,e){1&t&&p.Oc(0," Publisher ")}function Hr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Ur(t,e){1&t&&p.Oc(0," Tag ")}function Br(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Qr(t,e){1&t&&p.Oc(0," Total Searches ")}function Gr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function qr(t,e){1&t&&p.Oc(0," Monetized Searches ")}function $r(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Kr(t,e){1&t&&p.Oc(0," Clicks ")}function Xr(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Zr(t,e){if(1&t&&(p.Wb(0,"span"),p.Oc(1),p.Vb()),2&t){var r=e.column;p.Db(1),p.Pc(r.name)}}function Jr(t,e){if(1&t&&(p.Rb(0,"strong",19),p.mc(1,"percent")),2&t){var r=e.row;p.rc("innerHTML",p.oc(1,1,r.clicks/r.totalSearches,"2.2-2"),p.Ec)}}function ta(t,e){1&t&&p.Oc(0," Revenue ")}function ea(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var ra,aa,na=((aa=function(){function t(){r(this,t),this.rows=[{name:"Datalox",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Hopkins Branded",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562},{name:"Datalox 2",tag:"Guppy Media",totalSearches:"5341",monetizedSearches:"5213",revenue:"1362",clicks:562}],this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={}}return n(t,[{key:"ngOnInit",value:function(){var t=Array.from({length:20},(function(){return Math.floor(4e3*Math.random()+4e3)})),e=Array.from({length:20},(function(){return Math.floor(6e4*Math.random()+4e4)}));this.setChartOptions(1e4,1e5,["Nov 1, Nov 2, Nov 3, Nov 4","Nov 5","Nov 5","Nov 6","Nov 7","Nov 8","Nov 9","Nov 10","Nov 11","Nov 12","Nov 13","Nov 14","Nov 15","Nov 16","Nov 17","Nov 18","Nov 19","Nov 20"],t,e)}},{key:"updateReportingFiltering",value:function(t){console.log("Report")}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"setChartOptions",value:function(t,e,r,a,n){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom),this.option={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:["Revenue","Searches"]},xAxis:[{type:"category",data:r,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",min:0,max:t,interval:25e3,axisLabel:{formatter:"${value}"}},{type:"value",name:"Searches",min:0,max:e,interval:1e5,axisLabel:{formatter:"{value}"}}],series:[{name:"Revenue",type:"bar",data:a},{name:"Searches",type:"line",yAxisIndex:1,data:n}]},this.option&&this.myChart.setOption(this.option)}}]),t}()).\u0275fac=function(t){return new(t||aa)},aa.\u0275cmp=p.Kb({type:aa,selectors:[["app-third-party"]],viewQuery:function(t,e){var r;1&t&&p.Tc(jr,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:30,vars:13,consts:[[3,"onDatesPicked"],["id","main",2,"width","100%","height","300px"],[1,"material","fullscreen","expandable",2,"top","52px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows"],["expandableTable",""],[3,"rowHeight","toggle"],["myDetailRow",""],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","name"],["ngx-datatable-header-template",""],["name","tag"],["name","totalSearches"],["name","monetizedSearches"],["name","clicks"],["name","CTR"],["name","revenue"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],[3,"innerHTML"]],template:function(t,e){1&t&&(p.Wb(0,"app-reporting-filtering",0),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Rb(1,"div",1),p.Wb(2,"ngx-datatable",2,3),p.Wb(4,"ngx-datatable-row-detail",4,5),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(6,zr,6,0,"ng-template",6),p.Vb(),p.Wb(7,"ngx-datatable-column",7),p.Mc(8,Er,1,4,"ng-template",8),p.Vb(),p.Wb(9,"ngx-datatable-column",9),p.Mc(10,Yr,1,0,"ng-template",10),p.Mc(11,Hr,2,1,"ng-template",8),p.Vb(),p.Wb(12,"ngx-datatable-column",11),p.Mc(13,Ur,1,0,"ng-template",10),p.Mc(14,Br,2,1,"ng-template",8),p.Vb(),p.Wb(15,"ngx-datatable-column",12),p.Mc(16,Qr,1,0,"ng-template",10),p.Mc(17,Gr,3,3,"ng-template",8),p.Vb(),p.Wb(18,"ngx-datatable-column",13),p.Mc(19,qr,1,0,"ng-template",10),p.Mc(20,$r,3,3,"ng-template",8),p.Vb(),p.Wb(21,"ngx-datatable-column",14),p.Mc(22,Kr,1,0,"ng-template",10),p.Mc(23,Xr,3,3,"ng-template",8),p.Vb(),p.Wb(24,"ngx-datatable-column",15),p.Mc(25,Zr,2,1,"ng-template",10),p.Mc(26,Jr,2,4,"ng-template",8),p.Vb(),p.Wb(27,"ngx-datatable-column",16),p.Mc(28,ta,1,0,"ng-template",10),p.Mc(29,ea,3,4,"ng-template",8),p.Vb(),p.Vb()),2&t&&(p.Db(2),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("scrollbarH",!0)("rows",e.rows),p.Db(2),p.rc("rowHeight",100),p.Db(3),p.rc("width",50)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1))},directives:[d.a,S.d,S.e,S.f,S.b,S.a,S.c],pipes:[s.g,s.w,s.d],styles:[""]}),aa),ia=((ra=function(){function t(){r(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ra)},ra.\u0275cmp=p.Kb({type:ra,selectors:[["app-bing-direct"]],decls:2,vars:0,template:function(t,e){1&t&&(p.Wb(0,"p"),p.Oc(1,"bing-direct works!"),p.Vb())},styles:[""]}),ra),oa=i("d9f2"),sa=["expandableTable"];function ca(t,e){1&t&&(p.Wb(0,"div",31),p.Rb(1,"mat-progress-bar",32),p.Vb())}function ua(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",33),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function la(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",34),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetricsData)}}function ha(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function pa(t,e){if(1&t&&(p.Wb(0,"div",37),p.Wb(1,"table",38),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,ha,27,35,"tr",39),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function ga(t,e){1&t&&(p.Wb(0,"div",40),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function ba(t,e){if(1&t&&(p.Mc(0,pa,22,1,"div",35),p.Mc(1,ga,6,0,"div",36)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function fa(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",41),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function da(t,e){1&t&&p.Oc(0," Date ")}function ma(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function va(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,da,1,0,"ng-template",27),p.Mc(2,ma,3,3,"ng-template",17),p.Vb())}function ya(t,e){1&t&&p.Oc(0," Subid ")}function Da(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Sa(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,ya,1,0,"ng-template",27),p.Mc(2,Da,2,1,"ng-template",17),p.Vb())}function wa(t,e){1&t&&p.Oc(0," Publisher ")}function Fa(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function xa(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,wa,1,0,"ng-template",27),p.Mc(2,Fa,2,1,"ng-template",17),p.Vb())}function Ma(t,e){1&t&&p.Oc(0," Searches ")}function Wa(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Pa(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,Ma,1,0,"ng-template",27),p.Mc(2,Wa,3,3,"ng-template",17),p.Vb())}function Va(t,e){1&t&&p.Oc(0," Bid Searches ")}function Oa(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ca(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,Va,1,0,"ng-template",27),p.Mc(2,Oa,3,3,"ng-template",17),p.Vb())}function ka(t,e){1&t&&p.Oc(0," Clicks ")}function Ra(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function _a(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,ka,1,0,"ng-template",27),p.Mc(2,Ra,3,3,"ng-template",17),p.Vb())}function Ta(t,e){1&t&&p.Oc(0," BiddedCTR ")}function Ia(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function Na(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,Ta,1,0,"ng-template",27),p.Mc(2,Ia,4,7,"ng-template",17),p.Vb())}function La(t,e){1&t&&p.Oc(0," CTR ")}function Aa(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"2.2-2")||p.oc(3,4,0,"2.2-2"))}}function ja(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,La,1,0,"ng-template",27),p.Mc(2,Aa,4,7,"ng-template",17),p.Vb())}function za(t,e){1&t&&p.Oc(0," Publisher Net ")}function Ea(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ya(t,e){1&t&&p.Oc(0," Profit ")}function Ha(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ua(t,e){1&t&&p.Oc(0," Revenue ")}function Ba(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Qa(t,e){1&t&&p.Oc(0," Spilt ")}function Ga(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var qa,$a=((qa=function(){function e(t,a,n,i){r(this,e),this.lyonService=t,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.summary={revenue:0,profit:0},this.loadingIndicator=!0,this.columns=[{prop:"name"},{name:"Gender"}],this.expanded={},this.tagList=[],this.filteredLyonStat=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllLyonStats(this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetricsData=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getAllLyonStats",value:function(e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c,u,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.lyonService.getAllStats(e,r).toPromise();case 3:n=a.sent,i=t((this.loadingIndicator=!1,this.allstat=n,this.allstat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(i.s();!(o=i.n()).done;)if("lyons"==(s=o.value).tag.advertiser){c=t(s.tag.subids);try{for(c.s();!(u=c.n()).done;)"Contains"==(l=u.value).filterTag?this.allstat.map((function(t){t.subid.includes(l.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"StartsWith"==l.filterTag?this.allstat.map((function(t){t.subid.startsWith(l.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"EndsWith"==l.filterTag?this.allstat.map((function(t){t.subid.endsWith(l.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"ExactValue"==l.filterTag&&this.allstat.map((function(t){t.subid==l.subid&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)}))}catch(h){c.e(h)}finally{c.f()}}}catch(h){i.e(h)}finally{i.f()}return a.abrupt("return",this.allstat);case 9:return a.prev=9,a.t0=a.catch(0),a.abrupt("return",a.t0);case 12:case"end":return a.stop()}}),a,this,[[0,9]])})))}},{key:"groupDate",value:function(){var e,r={},a=this.allstat.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].biddedCtr+=parseFloat(e.biddedCtr?e.biddedCtr:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allstat.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].biddedCtr+=parseFloat(e.biddedCtr?e.biddedCtr:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allstat.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].biddedCtr+=parseFloat(e.biddedCtr?e.biddedCtr:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.biddedCtr=i.biddedCtr/i.counter,i.ctr=i.clicks/i.searches,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allstat,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"updateAllLyonStats",value:function(t,e,r){this.lyonService.updateAllLyonStats(t,e,r).subscribe((function(t){}))}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),e.next=5,this.getAllLyonStats(this.range.startDate,this.range.endDate);case 5:return this.rows=e.sent,e.next=8,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 8:return this.chartData=e.sent,e.next=11,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 11:this.summaryMetricsData=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 18:case"end":return e.stop()}}),e,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.lyonService.getSummaryMetrics(t,e,r).toPromise();case 3:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 8:return a.prev=8,a.t0=a.catch(0),a.abrupt("return",a.t0);case 11:case"end":return a.stop()}}),a,this,[[0,8]])})))}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.lyonService.getAllStats(r,a).toPromise();case 3:n=e.sent,i=t((this.loadingIndicator=!1,this.allChart=n,this.allChart.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(i.s();!(o=i.n()).done;)if("lyons"==(s=o.value).tag.advertiser){c=t(s.tag.subids);try{for(c.s();!(u=c.n()).done;)"Contains"==(h=u.value).filterTag?this.allChart.map((function(t){t.subid.includes(h.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"StartsWith"==h.filterTag?this.allChart.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"EndsWith"==h.filterTag?this.allChart.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)})):"ExactValue"==h.filterTag&&this.allChart.map((function(t){t.subid==h.subid&&(t.publisher=s.user.length?s.user[0].fullname:"No Publisher",t.tagname=s.tag.name)}))}catch(j){c.e(j)}finally{c.f()}}}catch(j){i.e(j)}finally{i.f()}for(f in p=l.chain(this.allChart).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),g=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(p,["date","publisher"]),b=[],g)if(g.hasOwnProperty(f))for(d in g[f])m={date:g[f][d][0].date,publisher:g[f][d][0].publisher,revenue:l.reduce(g[f][d],(function(t,e){return t+e.revenue}),0)},b.push(m);for(v=[],y=0,D=b;y<D.length;y++)S=D[y],v.push(S.publisher);w=v.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChart=this.allChart.slice().sort((function(t,e){return t.date-e.date})),F={},x=this.allChart.reduce((function(t,e){var r=e.date;return F[r]?F[r].searches+=parseInt(e.searches):(F[r]=Object.assign({},e),t.push(F[r])),t}),[]),M=[],W=[],P={},V=t(this.daysList);try{for(V.s();!(O=V.n()).done;)if(C=O.value,0==(k=x.filter((function(t){return t.date==C}))).length)M.push(C),W.push(0);else{R=t(k);try{for(R.s();!(_=R.n()).done;)T=_.value,M.push(T.date),W.push(T.searches)}catch(j){R.e(j)}finally{R.f()}}}catch(j){V.e(j)}finally{V.f()}I=[],N=t(w);try{for(A=function(){var e,r=L.value,a=[],n=t(M);try{var i=function(){var t=e.value,n=b.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(j){n.e(j)}finally{n.f()}var o={};o[r]=a,I.push(o)},N.s();!(L=N.n()).done;)A()}catch(j){N.e(j)}finally{N.f()}return e.abrupt("return",(P.revenuePerDay=I,P.datesOfRevenue=M,P.searchesPerDay=W,P.publisherName=w,P));case 22:return e.prev=22,e.t0=e.catch(0),e.abrupt("return",e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])})))}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allstat.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].biddedCtr+=parseFloat(e.biddedCtr?e.biddedCtr:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.biddedCtr=e.biddedCtr/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allstat.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].cpc+=parseFloat(e.cpc?e.cpc:0),a[r].ctr+=parseFloat(e.ctr?e.ctr:0),a[r].biddedCtr+=parseFloat(e.biddedCtr?e.biddedCtr:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.biddedCtr=e.biddedCtr/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"combineSummaryMetrics",value:function(t){var e=this;t.summary.keys.forEach((function(t){e.summary.revenue+=t.revenue,e.summary.profit+=t.revenue*(.01*(100-t.split))}))}}]),e}()).\u0275fac=function(t){return new(t||qa)(p.Qb(oa.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},qa.\u0275cmp=p.Kb({type:qa,selectors:[["app-lyons"]],viewQuery:function(t,e){var r;1&t&&p.Tc(sa,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:44,vars:25,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","biddedCtr",4,"ngIf"],["name","ctr",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date"],["name","subid"],["name","publisher"],["name","searches"],["name","biddedSearches"],["name","clicks"],["name","biddedCtr"],["name","ctr"]],template:function(t,e){1&t&&(p.Mc(0,ca,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,ua,1,1,"app-reporting-revenue-chart",2),p.Mc(3,la,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,ba,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,fa,1,4,"ng-template",17),p.Vb(),p.Mc(24,va,3,0,"ngx-datatable-column",18),p.Mc(25,Sa,3,0,"ngx-datatable-column",19),p.Mc(26,xa,3,0,"ngx-datatable-column",20),p.Mc(27,Pa,3,0,"ngx-datatable-column",21),p.Mc(28,Ca,3,0,"ngx-datatable-column",22),p.Mc(29,_a,3,0,"ngx-datatable-column",23),p.Mc(30,Na,3,0,"ngx-datatable-column",24),p.Mc(31,ja,3,0,"ngx-datatable-column",25),p.Wb(32,"ngx-datatable-column",26),p.Mc(33,za,1,0,"ng-template",27),p.Mc(34,Ea,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",28),p.Mc(36,Ya,1,0,"ng-template",27),p.Mc(37,Ha,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",29),p.Mc(39,Ua,1,0,"ng-template",27),p.Mc(40,Ba,3,4,"ng-template",17),p.Vb(),p.Wb(41,"ngx-datatable-column",30),p.Mc(42,Qa,1,0,"ng-template",27),p.Mc(43,Ga,4,6,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetricsData&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),qa),Ka=i("Wxo5"),Xa=["expandableTable"];function Za(t,e){1&t&&(p.Wb(0,"div",28),p.Rb(1,"mat-progress-bar",29),p.Vb())}function Ja(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",30),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function tn(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",31),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function en(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function rn(t,e){if(1&t&&(p.Wb(0,"div",34),p.Wb(1,"table",35),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,en,27,35,"tr",36),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function an(t,e){1&t&&(p.Wb(0,"div",37),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function nn(t,e){if(1&t&&(p.Mc(0,rn,22,1,"div",32),p.Mc(1,an,6,0,"div",33)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function on(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",38),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function sn(t,e){1&t&&p.Oc(0," Date ")}function cn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function un(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,sn,1,0,"ng-template",24),p.Mc(2,cn,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function ln(t,e){1&t&&p.Oc(0," Subid ")}function hn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function pn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,ln,1,0,"ng-template",24),p.Mc(2,hn,2,1,"ng-template",17),p.Vb())}function gn(t,e){1&t&&p.Oc(0," Publisher ")}function bn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function fn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,gn,1,0,"ng-template",24),p.Mc(2,bn,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function dn(t,e){1&t&&p.Oc(0," Searches ")}function mn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function vn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,dn,1,0,"ng-template",24),p.Mc(2,mn,3,3,"ng-template",17),p.Vb())}function yn(t,e){1&t&&p.Oc(0," Clicks ")}function Dn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Sn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,yn,1,0,"ng-template",24),p.Mc(2,Dn,3,3,"ng-template",17),p.Vb())}function wn(t,e){1&t&&p.Oc(0," Split ")}function Fn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function xn(t,e){1&t&&p.Oc(0," Publisher Net ")}function Mn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Wn(t,e){1&t&&p.Oc(0," Profit ")}function Pn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Vn(t,e){1&t&&p.Oc(0," Revenue ")}function On(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var Cn,kn=((Cn=function(){function e(t,a,n,i){r(this,e),this.cdr=t,this.userService=a,this.rubiService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getAllRubiStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.rubiService.getRubiStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("rubi"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].monetized_searches+=parseFloat(e.monetized_searches?e.monetized_searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].monetized_searches+=parseFloat(e.monetized_searches?e.monetized_searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].monetized_searches+=parseFloat(e.monetized_searches?e.monetized_searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].monetized_searches+=parseFloat(e.monetized_searches?e.monetized_searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].monetized_searches+=parseFloat(e.monetized_searches?e.monetized_searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.rubiService.getRubiStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("rubi"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].searches+=parseInt(e.searches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.rubiService.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}}]),e}()).\u0275fac=function(t){return new(t||Cn)(p.Qb(p.i),p.Qb(g.a),p.Qb(Ka.a),p.Qb(f.a))},Cn.\u0275cmp=p.Kb({type:Cn,selectors:[["app-rubi"]],viewQuery:function(t,e){var r;1&t&&p.Tc(Xa,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(t,e){1&t&&(p.Mc(0,Za,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,Ja,1,1,"app-reporting-revenue-chart",2),p.Mc(3,tn,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,nn,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,on,1,4,"ng-template",17),p.Vb(),p.Mc(24,un,3,1,"ngx-datatable-column",18),p.Mc(25,pn,3,0,"ngx-datatable-column",19),p.Mc(26,fn,3,1,"ngx-datatable-column",20),p.Mc(27,vn,3,0,"ngx-datatable-column",21),p.Mc(28,Sn,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,wn,1,0,"ng-template",24),p.Mc(31,Fn,4,6,"ng-template",17),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,xn,1,0,"ng-template",24),p.Mc(34,Mn,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,Wn,1,0,"ng-template",24),p.Mc(37,Pn,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",27),p.Mc(39,Vn,1,0,"ng-template",24),p.Mc(40,On,3,4,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Cn),Rn=i("uJD8"),_n=["expandableTable"];function Tn(t,e){1&t&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function In(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",37),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Nn(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",38),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Ln(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function An(t,e){if(1&t&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Ln,25,29,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function jn(t,e){1&t&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function zn(t,e){if(1&t&&(p.Mc(0,An,22,1,"div",39),p.Mc(1,jn,6,0,"div",40)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function En(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Yn(t,e){1&t&&p.Oc(0," Date ")}function Hn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Un(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,Yn,1,0,"ng-template",31),p.Mc(2,Hn,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Bn(t,e){1&t&&p.Oc(0," Subid ")}function Qn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Gn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,Bn,1,0,"ng-template",31),p.Mc(2,Qn,2,1,"ng-template",17),p.Vb())}function qn(t,e){1&t&&p.Oc(0," Publisher ")}function $n(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Kn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,qn,1,0,"ng-template",31),p.Mc(2,$n,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Xn(t,e){1&t&&p.Oc(0," Searches ")}function Zn(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Jn(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,Xn,1,0,"ng-template",31),p.Mc(2,Zn,3,3,"ng-template",17),p.Vb())}function ti(t,e){1&t&&p.Oc(0," Bid Searches ")}function ei(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ri(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,ti,1,0,"ng-template",31),p.Mc(2,ei,3,3,"ng-template",17),p.Vb())}function ai(t,e){1&t&&p.Oc(0," Bid Searches Result ")}function ni(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ii(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,ai,1,0,"ng-template",31),p.Mc(2,ni,3,3,"ng-template",17),p.Vb())}function oi(t,e){1&t&&p.Oc(0," Clicks ")}function si(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ci(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,oi,1,0,"ng-template",31),p.Mc(2,si,3,3,"ng-template",17),p.Vb())}function ui(t,e){1&t&&p.Oc(0," Coverage ")}function li(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,ui,1,0,"ng-template",31),p.Mc(2,li,3,3,"ng-template",17),p.Vb())}function pi(t,e){1&t&&p.Oc(0," CTR ")}function gi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function bi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,pi,1,0,"ng-template",31),p.Mc(2,gi,3,4,"ng-template",17),p.Vb())}function fi(t,e){1&t&&p.Oc(0," CPC ")}function di(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function mi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,fi,1,0,"ng-template",31),p.Mc(2,di,3,4,"ng-template",17),p.Vb())}function vi(t,e){1&t&&p.Oc(0," RN ")}function yi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Di(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,vi,1,0,"ng-template",31),p.Mc(2,yi,3,3,"ng-template",17),p.Vb())}function Si(t,e){1&t&&p.Oc(0," TQ ")}function wi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Fi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,Si,1,0,"ng-template",31),p.Mc(2,wi,3,3,"ng-template",17),p.Vb())}function xi(t,e){1&t&&p.Oc(0," Publisher Net ")}function Mi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Wi(t,e){1&t&&p.Oc(0," Profit ")}function Pi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Vi(t,e){1&t&&p.Oc(0," Revenue ")}function Oi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ci(t,e){1&t&&p.Oc(0," Split ")}function ki(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Ri,_i=((Ri=function(){function e(t,a,n,i){r(this,e),this.verizonService=t,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(t){this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a,n,i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=t((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct"==(n=a.value).tag.advertiser){i=t(n.tag.subids);try{for(i.s();!(o=i.n()).done;)"Contains"==(s=o.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"StartsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"EndsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"ExactValue"==s.filterTag&&this.allChartStat.map((function(t){t.subid==s.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),u=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(t,e){return t+e.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),D={},S=this.allChartStat.reduce((function(t,e){var r=e.date;return D[r]?(D[r].searches+=parseInt(e.searches),e.revenue&&(D[r].revenue+=e.revenue)):(D[r]=Object.assign({},e),t.push(D[r])),t}),[]),w=[],F=[],x={},M=t(this.daysList);try{for(M.s();!(W=M.n()).done;)if(P=W.value,0==(V=S.filter((function(t){return t.date==P}))).length)w.push(P),F.push(0);else{O=t(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){M.e(N)}finally{M.f()}R=[],_=t(y);try{for(I=function(){var e,r=T.value,a=[],n=t(w);try{var i=function(){var t=e.value,n=h.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var o={};o[r]=a,R.push(o)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return e.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return e.prev=19,e.t0=e.catch(0),e.abrupt("return",e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonService.getAllVerizonStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("verizon-direct"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonService.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),e}()).\u0275fac=function(t){return new(t||Ri)(p.Qb(Rn.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},Ri.\u0275cmp=p.Kb({type:Ri,selectors:[["app-verizon-direct"]],viewQuery:function(t,e){var r;1&t&&p.Tc(_n,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(p.Mc(0,Tn,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,In,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Nn,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,zn,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,En,1,4,"ng-template",17),p.Vb(),p.Mc(24,Un,3,1,"ngx-datatable-column",18),p.Mc(25,Gn,3,0,"ngx-datatable-column",19),p.Mc(26,Kn,3,1,"ngx-datatable-column",20),p.Mc(27,Jn,3,0,"ngx-datatable-column",21),p.Mc(28,ri,3,0,"ngx-datatable-column",22),p.Mc(29,ii,3,0,"ngx-datatable-column",23),p.Mc(30,ci,3,0,"ngx-datatable-column",24),p.Mc(31,hi,3,0,"ngx-datatable-column",25),p.Mc(32,bi,3,0,"ngx-datatable-column",26),p.Mc(33,mi,3,0,"ngx-datatable-column",27),p.Mc(34,Di,3,0,"ngx-datatable-column",28),p.Mc(35,Fi,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,xi,1,0,"ng-template",31),p.Mc(38,Mi,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Wi,1,0,"ng-template",31),p.Mc(41,Pi,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,Vi,1,0,"ng-template",31),p.Mc(44,Oi,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Ci,1,0,"ng-template",31),p.Mc(47,ki,4,6,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Ri),Ti=i("m5p0"),Ii=["expandableTable"];function Ni(t,e){1&t&&(p.Wb(0,"div",29),p.Rb(1,"mat-progress-bar",30),p.Vb())}function Li(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",31),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Ai(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",32),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function ji(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function zi(t,e){if(1&t&&(p.Wb(0,"div",35),p.Wb(1,"table",36),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,ji,25,29,"tr",37),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Ei(t,e){1&t&&(p.Wb(0,"div",38),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Yi(t,e){if(1&t&&(p.Mc(0,zi,22,1,"div",33),p.Mc(1,Ei,6,0,"div",34)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Hi(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",39),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Ui(t,e){1&t&&p.Oc(0," Date ")}function Bi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Qi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,Ui,1,0,"ng-template",25),p.Mc(2,Bi,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Gi(t,e){1&t&&p.Oc(0," Subid ")}function qi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function $i(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,Gi,1,0,"ng-template",25),p.Mc(2,qi,2,1,"ng-template",17),p.Vb())}function Ki(t,e){1&t&&p.Oc(0," Publisher ")}function Xi(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Zi(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,Ki,1,0,"ng-template",25),p.Mc(2,Xi,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Ji(t,e){1&t&&p.Oc(0," Device ")}function to(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function eo(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,Ji,1,0,"ng-template",25),p.Mc(2,to,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function ro(t,e){1&t&&p.Oc(0," Searches ")}function ao(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function no(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",44),p.Mc(1,ro,1,0,"ng-template",25),p.Mc(2,ao,3,3,"ng-template",17),p.Vb())}function io(t,e){1&t&&p.Oc(0," Clicks ")}function oo(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function so(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",45),p.Mc(1,io,1,0,"ng-template",25),p.Mc(2,oo,3,3,"ng-template",17),p.Vb())}function co(t,e){1&t&&p.Oc(0," Split ")}function uo(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function lo(t,e){1&t&&p.Oc(0," Publisher Net ")}function ho(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function po(t,e){1&t&&p.Oc(0," Profit ")}function go(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function bo(t,e){1&t&&p.Oc(0," Revenue ")}function fo(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var mo,vo,yo=((mo=function(){function e(t,a,n,i){r(this,e),this.cdr=t,this.userService=a,this.system1Service=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.expanded={},this.tagList=[],this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.system1Service.getAllSystem1Stats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.loadingIndicator=!1,this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("system1"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].searches+=parseInt(e.searches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getAllSystem1Stats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.system1Service.getAllSystem1Stats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("system1"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.system1Service.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=e.clicks?parseFloat(e.clicks):0,r[a].searches+=e.searches?parseFloat(e.searches):0,r[a].ctr+=e.ctr?parseFloat(e.ctr):0,r[a].revenue+=e.revenue?parseFloat(e.revenue):0,r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=e.clicks?parseFloat(e.clicks):0,r[a].searches+=e.searches?parseFloat(e.searches):0,r[a].ctr+=e.ctr?parseFloat(e.ctr):0,r[a].revenue+=e.revenue?parseFloat(e.revenue):0,r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=e.clicks?parseFloat(e.clicks):0,r[a].searches+=e.searches?parseFloat(e.searches):0,r[a].revenue+=e.revenue?parseFloat(e.revenue):0,r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i.publisher),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=e.clicks?parseFloat(e.clicks):0,a[r].searches+=e.searches?parseFloat(e.searches):0,a[r].revenue+=e.revenue?parseFloat(e.revenue):0,a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.split=o.split/o.counter,o.ctr=o.clicks/o.searches,o.cpc=o.revenue/o.clicks}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=e.clicks?parseFloat(e.clicks):0,a[r].searches+=e.searches?parseFloat(e.searches):0,a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"refreshTable",value:function(){this.cdr.detectChanges()}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}}]),e}()).\u0275fac=function(t){return new(t||mo)(p.Qb(p.i),p.Qb(g.a),p.Qb(Ti.a),p.Qb(f.a))},mo.\u0275cmp=p.Kb({type:mo,selectors:[["app-system1"]],viewQuery:function(t,e){var r;1&t&&p.Tc(Ii,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:42,vars:24,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","device",3,"minWidth",4,"ngIf"],["name","Searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","device",3,"minWidth"],["name","Searches"],["name","clicks"]],template:function(t,e){1&t&&(p.Mc(0,Ni,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,Li,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Ai,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,Yi,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Hi,1,4,"ng-template",17),p.Vb(),p.Mc(24,Qi,3,1,"ngx-datatable-column",18),p.Mc(25,$i,3,0,"ngx-datatable-column",19),p.Mc(26,Zi,3,1,"ngx-datatable-column",20),p.Mc(27,eo,3,1,"ngx-datatable-column",21),p.Mc(28,no,3,0,"ngx-datatable-column",22),p.Mc(29,so,3,0,"ngx-datatable-column",23),p.Wb(30,"ngx-datatable-column",24),p.Mc(31,co,1,0,"ng-template",25),p.Mc(32,uo,4,6,"ng-template",17),p.Vb(),p.Wb(33,"ngx-datatable-column",26),p.Mc(34,lo,1,0,"ng-template",25),p.Mc(35,ho,3,4,"ng-template",17),p.Vb(),p.Wb(36,"ngx-datatable-column",27),p.Mc(37,po,1,0,"ng-template",25),p.Mc(38,go,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",28),p.Mc(40,bo,1,0,"ng-template",25),p.Mc(41,fo,3,4,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),mo),Do=i("AytR"),So=i("tk/3"),wo=Do.a.apiUrl+"/stats/admin/manual-update",Fo=((vo=function(){function t(e){r(this,t),this.http=e}return n(t,[{key:"updateManualStats",value:function(t){var e=t.company,r=t.reportType,a=t.startDate,n=t.endDate,i={company:e,reportType:r,startDate:h(a).format("YYYY-MM-DD"),endDate:h(n).format("YYYY-MM-DD")};return this.http.put(wo+"/stat-update",i)}},{key:"updateManualSplit",value:function(t){var e=t.company,r=t.reportType,a=t.tag,n=t.startDate,i=t.endDate;return this.http.put(wo+"/split-update",{company:e,reportType:r,tag:a,startDate:n,endDate:i})}}]),t}()).\u0275fac=function(t){return new(t||vo)(p.ec(So.c))},vo.\u0275prov=p.Mb({token:vo,factory:vo.\u0275fac,providedIn:"root"}),vo),xo=i("9xcm"),Mo=i("+BVi"),Wo=i("soTd"),Po=i("iadO"),Vo=i("bTqV");function Oo(t,e){if(1&t&&(p.Wb(0,"mat-option",18),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function Co(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid start date "),p.Vb())}function ko(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid end date"),p.Vb())}function Ro(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Start Date Required"),p.Vb())}function _o(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"End Date Required"),p.Vb())}function To(t,e){if(1&t&&(p.Wb(0,"mat-option",18),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}var Io,No=((Io=function(){function t(e,a,n,i,o,s){r(this,t),this.manualUpdateService=e,this.fb=a,this.companyService=n,this.authService=i,this.userService=o,this.notification=s,this.reportUpdateTitle="Report Stat Update",this.reportTypeData=[],this.message=null,this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}return n(t,[{key:"ngOnInit",value:function(){this.getReportingProviderList(),this.manaulUpFG=this.fb.group({reportType:new y.g("",y.z.required),preSelectValue:new y.g("",y.z.required),startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new y.j({startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}},{key:"getReportingProviderList",value:function(){var t=this;this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe((function(e){e.reportingProviders.map((function(e){t.reportTypeData.push({value:e.reportingProvider,viewValue:e.reportingProvider})}))}))}},{key:"getSelectedCompanyLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"onReportSubmit",value:function(){var t=this;if(this.manaulUpFG.valid){this.manaulUpFG.addControl("company",new y.g("",y.z.required)),this.manaulUpFG.patchValue({company:this.companySelected});var e=this.manaulUpFG.value.reportType;this.manualUpdateService.updateManualStats(this.manaulUpFG.value).subscribe((function(r){t.isObjectEmpty(r)?t.notification.showWarning(e+" data not existed!",""):"ok"==r.stats?t.notification.showSuccess(e+" data stats successfully updated!",""):"warn"==r.stats&&t.notification.showWarning(e+" data not existed!","")}))}}},{key:"isObjectEmpty",value:function(t){return 0===Object.keys(t).length}},{key:"getDateRanges",value:function(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}},{key:"changeDatePicker",value:function(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:h(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:h(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}},{key:"onPreSetRangeSelectChange",value:function(t){"custom"!==t.value&&(this.preSelectValue=t.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}},{key:"updateDatePickerRange",value:function(t,e){this.manaulUpFG.patchValue({startDate:h(t,"MM-DD-YYYY").toDate(),endDate:h(e,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:h(t,"MM-DD-YYYY").toDate(),endDate:h(e,"MM-DD-YYYY").toDate()})}},{key:"getPreSetDateRange",value:function(t){switch(t){case"today":return{startDate:h().utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:h().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:h().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:h().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:h().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:h().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}},{key:"handleReport",value:function(t){if(t.value.length>0){var e=t.value.toLowerCase().replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}));this.reportUpdateTitle=e+" Stat Update"}}}]),t}()).\u0275fac=function(t){return new(t||Io)(p.Qb(Fo),p.Qb(y.f),p.Qb(xo.a),p.Qb(Mo.a),p.Qb(g.a),p.Qb(Wo.a))},Io.\u0275cmp=p.Kb({type:Io,selectors:[["app-manual-update"]],decls:36,vars:12,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Report","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(t,e){if(1&t&&(p.Wb(0,"form",0),p.hc("ngSubmit",(function(){return e.onReportSubmit()})),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"h3",6),p.Oc(7),p.Vb(),p.Vb(),p.Vb(),p.Wb(8,"div",7),p.Wb(9,"mat-form-field"),p.Wb(10,"mat-label"),p.Oc(11,"Report Type"),p.Vb(),p.Wb(12,"mat-select",8),p.hc("selectionChange",(function(t){return e.handleReport(t)})),p.Mc(13,Oo,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(14,"mat-form-field"),p.Wb(15,"mat-label"),p.Oc(16,"Enter a custom date range"),p.Vb(),p.Wb(17,"mat-date-range-input",10),p.hc("dateChange",(function(){return e.changeDatePicker()})),p.Rb(18,"input",11),p.Wb(19,"input",12),p.hc("dateChange",(function(){return e.changeDatePicker()})),p.Vb(),p.Vb(),p.Rb(20,"mat-datepicker-toggle",13),p.Rb(21,"mat-date-range-picker",null,14),p.Mc(23,Co,2,0,"mat-error",15),p.Mc(24,ko,2,0,"mat-error",15),p.Mc(25,Ro,2,0,"mat-error",15),p.Mc(26,_o,2,0,"mat-error",15),p.Vb(),p.Wb(27,"mat-form-field"),p.Wb(28,"mat-label"),p.Oc(29,"Preset Date Range"),p.Vb(),p.Wb(30,"mat-select",16),p.hc("ngModelChange",(function(t){return e.preSelectValue=t}))("selectionChange",(function(t){return e.onPreSetRangeSelectChange(t)})),p.Mc(31,To,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(32,"div",1),p.Wb(33,"div",2),p.Wb(34,"button",17),p.Oc(35,"Update Stats"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.Ac(22);p.rc("formGroup",e.manaulUpFG),p.Db(7),p.Pc(e.reportUpdateTitle),p.Db(6),p.rc("ngForOf",e.reportTypeData),p.Db(4),p.rc("rangePicker",r)("formGroup",e.range),p.Db(3),p.rc("for",r),p.Db(3),p.rc("ngIf",e.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),p.Db(1),p.rc("ngIf",e.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),p.Db(1),p.rc("ngIf",null==e.manaulUpFG.controls.startDate.errors?null:e.manaulUpFG.controls.startDate.errors.required),p.Db(1),p.rc("ngIf",null==e.manaulUpFG.controls.endDate.errors?null:e.manaulUpFG.controls.endDate.errors.required),p.Db(4),p.rc("ngModel",e.preSelectValue),p.Db(1),p.rc("ngForOf",e.preSetDateRanges)}},directives:[y.B,y.r,y.k,m.c,m.g,v.a,y.q,y.i,s.o,Po.a,Po.h,y.d,y.x,Po.g,Po.f,m.j,Po.b,s.p,Vo.b,D.p,m.b],styles:[""]}),Io);function Lo(t,e){if(1&t&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function Ao(t,e){if(1&t&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}function jo(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid start date "),p.Vb())}function zo(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Invalid end date"),p.Vb())}function Eo(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"Start Date Required"),p.Vb())}function Yo(t,e){1&t&&(p.Wb(0,"mat-error"),p.Oc(1,"End Date Required"),p.Vb())}function Ho(t,e){if(1&t&&(p.Wb(0,"mat-option",19),p.Oc(1),p.Vb()),2&t){var r=e.$implicit;p.rc("value",r.value),p.Db(1),p.Qc(" ",r.viewValue," ")}}var Uo,Bo=((Uo=function(){function t(e,a,n,i,o,s,c,u){r(this,t),this.manualUpdateService=e,this.fb=a,this.companyService=n,this.authService=i,this.userService=o,this.notification=s,this.tagService=c,this.cdr=u,this.reportProviderData=[],this.tagData=[],this.selectedTagData=[],this.reportUpdateTitle="Report Split Update",this.selectedTagName="",this.currentUser=this.authService.currentUserValue,this.companySelected=this.getSelectedCompanyLocalStorage()}return n(t,[{key:"ngOnInit",value:function(){this.getReportingProviderList(),this.getAllTags(),this.manaulUpFG=this.fb.group({reportType:new y.g("",y.z.required),tag:new y.g("",y.z.required),preSelectValue:new y.g("",y.z.required),startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.preSetDateRanges=this.getDateRanges(),this.range=new y.j({startDate:new y.g("",y.z.required),endDate:new y.g("",y.z.required)}),this.selectedRange={startDate:"",endDate:""},this.preSelectValue="last7days",this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate)}},{key:"getSelectedCompanyLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"getAllTags",value:function(){var t=this;this.tagService.getAllTags().subscribe((function(e){var r=[];t.companySelected&&(r=e.filter((function(e){return e.company[0]._id==t.companySelected}))),r.map((function(e){t.tagData.push({value:e._id,viewValue:e.name,advertiser:e.advertiser})})),t.selectedTagData=t.tagData,t.cdr.detectChanges()}))}},{key:"handleTag",value:function(t){this.selectedTagName="updateAll"===t.value?"All":this.tagData.filter((function(e){return e.value==t.value}))[0].viewValue}},{key:"getReportingProviderList",value:function(){var t=this;this.companySelected&&this.companyService.getOneCompany(this.companySelected.split("/")[1]).subscribe((function(e){e.reportingProviders.map((function(e){t.reportProviderData.push({value:e.reportingProvider,viewValue:e.reportingProvider})}))}))}},{key:"updateDatePickerRange",value:function(t,e){this.manaulUpFG.patchValue({startDate:h(t,"MM-DD-YYYY").toDate(),endDate:h(e,"MM-DD-YYYY").toDate()}),this.range.patchValue({startDate:h(t,"MM-DD-YYYY").toDate(),endDate:h(e,"MM-DD-YYYY").toDate()})}},{key:"getDateRanges",value:function(){return[{value:"today",viewValue:"Today"},{value:"yesterday",viewValue:"Yesterday"},{value:"last7days",viewValue:"Last 7 Days"},{value:"last30days",viewValue:"Last 30 Days"},{value:"monthToDate",viewValue:"Month to Date"},{value:"lastMonth",viewValue:"Last Month"},{value:"custom",viewValue:"Custom"}]}},{key:"onPreSetRangeSelectChange",value:function(t){"custom"!==t.value&&(this.preSelectValue=t.value,this.preSelectDates=this.getPreSetDateRange(this.preSelectValue),this.updateDatePickerRange(this.preSelectDates.startDate,this.preSelectDates.endDate))}},{key:"getPreSetDateRange",value:function(t){switch(t){case"today":return{startDate:h().utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"yesterday":return{startDate:h().subtract(1,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().subtract(1,"days").utc().endOf("day").format("MM-DD-YYYY")};case"last7days":return{startDate:h().subtract(7,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"last30days":return{startDate:h().subtract(30,"days").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"monthToDate":return{startDate:h().startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().endOf("day").format("MM-DD-YYYY")};case"lastMonth":return{startDate:h().subtract(1,"months").startOf("month").utc().startOf("day").format("MM-DD-YYYY"),endDate:h().utc().subtract(1,"months").endOf("month").format("MM-DD-YYYY")}}}},{key:"handleReport",value:function(t){if(t.value.length>0){var e=t.value.toLowerCase().replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}));this.reportUpdateTitle=e+" Split Update",this.selectedTagData=[];var r=[];r.push({value:"updateAll",viewValue:"update all",advertiser:t.value});var a=this.tagData.filter((function(e){return e.advertiser==t.value}));this.selectedTagData=r.concat(a),this.cdr.detectChanges()}}},{key:"onReportSubmit",value:function(){var t=this;this.manaulUpFG.valid&&(this.manaulUpFG.addControl("company",new y.g("",y.z.required)),this.manaulUpFG.patchValue({company:this.companySelected}),this.manualUpdateService.updateManualSplit(this.manaulUpFG.value).subscribe((function(e){t.isObjectEmpty(e)?t.notification.showWarning(t.selectedTagName+" data not existed!",""):t.notification.showSuccess(t.selectedTagName+" data splits  successfully updated!","")})))}},{key:"isObjectEmpty",value:function(t){return 0===Object.keys(t).length}},{key:"changeDatePicker",value:function(){this.range.valid&&(this.selectedRange.startDate=this.range.value.startDate,this.selectedRange.endDate=this.range.value.endDate,this.manaulUpFG.patchValue({startDate:h(this.range.value.startDate,"MM-DD-YYYY").toDate(),endDate:h(this.range.value.endDate,"MM-DD-YYYY").toDate()}),this.preSelectValue="custom")}}]),t}()).\u0275fac=function(t){return new(t||Uo)(p.Qb(Fo),p.Qb(y.f),p.Qb(xo.a),p.Qb(Mo.a),p.Qb(g.a),p.Qb(Wo.a),p.Qb(f.a),p.Qb(p.i))},Uo.\u0275cmp=p.Kb({type:Uo,selectors:[["app-manual-split-update"]],decls:41,vars:13,consts:[["id","manaulUpForm",1,"example-container",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-6"],[1,"card","card-custom","example","example-compact","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label"],[1,"card-body"],["matNativeControl","","placeholder","Select Provider","formControlName","reportType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matNativeControl","","placeholder","Select Report","formControlName","tag",3,"selectionChange"],[3,"rangePicker","formGroup","dateChange"],["matStartDate","","formControlName","startDate","placeholder","Start date","required",""],["matEndDate","","formControlName","endDate","placeholder","End date","required","",3,"dateChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["formControlName","preSelectValue",3,"ngModel","ngModelChange","selectionChange"],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(t,e){if(1&t&&(p.Wb(0,"form",0),p.hc("ngSubmit",(function(){return e.onReportSubmit()})),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"h3",6),p.Oc(7),p.Vb(),p.Vb(),p.Vb(),p.Wb(8,"div",7),p.Wb(9,"mat-form-field"),p.Wb(10,"mat-label"),p.Oc(11,"Provider"),p.Vb(),p.Wb(12,"mat-select",8),p.hc("selectionChange",(function(t){return e.handleReport(t)})),p.Mc(13,Lo,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(14,"mat-form-field"),p.Wb(15,"mat-label"),p.Oc(16,"Tag"),p.Vb(),p.Wb(17,"mat-select",10),p.hc("selectionChange",(function(t){return e.handleTag(t)})),p.Mc(18,Ao,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(19,"mat-form-field"),p.Wb(20,"mat-label"),p.Oc(21,"Enter a custom date range"),p.Vb(),p.Wb(22,"mat-date-range-input",11),p.hc("dateChange",(function(){return e.changeDatePicker()})),p.Rb(23,"input",12),p.Wb(24,"input",13),p.hc("dateChange",(function(){return e.changeDatePicker()})),p.Vb(),p.Vb(),p.Rb(25,"mat-datepicker-toggle",14),p.Rb(26,"mat-date-range-picker",null,15),p.Mc(28,jo,2,0,"mat-error",16),p.Mc(29,zo,2,0,"mat-error",16),p.Mc(30,Eo,2,0,"mat-error",16),p.Mc(31,Yo,2,0,"mat-error",16),p.Vb(),p.Wb(32,"mat-form-field"),p.Wb(33,"mat-label"),p.Oc(34,"Preset Date Range"),p.Vb(),p.Wb(35,"mat-select",17),p.hc("ngModelChange",(function(t){return e.preSelectValue=t}))("selectionChange",(function(t){return e.onPreSetRangeSelectChange(t)})),p.Mc(36,Ho,2,2,"mat-option",9),p.Vb(),p.Vb(),p.Wb(37,"div",1),p.Wb(38,"div",2),p.Wb(39,"button",18),p.Oc(40,"Update Splits"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.Ac(27);p.rc("formGroup",e.manaulUpFG),p.Db(7),p.Pc(e.reportUpdateTitle),p.Db(6),p.rc("ngForOf",e.reportProviderData),p.Db(5),p.rc("ngForOf",e.selectedTagData),p.Db(4),p.rc("rangePicker",r)("formGroup",e.range),p.Db(3),p.rc("for",r),p.Db(3),p.rc("ngIf",e.manaulUpFG.controls.startDate.hasError("matStartDateInvalid")),p.Db(1),p.rc("ngIf",e.manaulUpFG.controls.endDate.hasError("matEndDateInvalid")),p.Db(1),p.rc("ngIf",null==e.manaulUpFG.controls.startDate.errors?null:e.manaulUpFG.controls.startDate.errors.required),p.Db(1),p.rc("ngIf",null==e.manaulUpFG.controls.endDate.errors?null:e.manaulUpFG.controls.endDate.errors.required),p.Db(4),p.rc("ngModel",e.preSelectValue),p.Db(1),p.rc("ngForOf",e.preSetDateRanges)}},directives:[y.B,y.r,y.k,m.c,m.g,v.a,y.q,y.i,s.o,Po.a,Po.h,y.d,y.x,Po.g,Po.f,m.j,Po.b,s.p,Vo.b,D.p,m.b],styles:[""]}),Uo),Qo=i("mPAa"),Go=["expandableTable"];function qo(t,e){1&t&&(p.Wb(0,"div",28),p.Rb(1,"mat-progress-bar",29),p.Vb())}function $o(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",30),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Ko(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",31),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Xo(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.mc(13,"percent"),p.Vb(),p.Wb(14,"td"),p.Oc(15),p.mc(16,"currency"),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Wb(24,"td"),p.Oc(25),p.mc(26,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr,"2.2-2")||p.oc(13,17,0,"2.2-2")),p.Db(4),p.Pc(p.oc(16,20,r.cpc,"USD")||p.oc(17,23,0,"USD")),p.Db(4),p.Pc(p.oc(20,26,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(23,29,r.profit,"USD")),p.Db(3),p.Pc(p.oc(26,32,r.revenue,"USD"))}}function Zo(t,e){if(1&t&&(p.Wb(0,"div",34),p.Wb(1,"table",35),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Xo,27,35,"tr",36),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Jo(t,e){1&t&&(p.Wb(0,"div",37),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function ts(t,e){if(1&t&&(p.Mc(0,Zo,22,1,"div",32),p.Mc(1,Jo,6,0,"div",33)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function es(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",38),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function rs(t,e){1&t&&p.Oc(0," Date ")}function as(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ns(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",39),p.Mc(1,rs,1,0,"ng-template",24),p.Mc(2,as,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function is(t,e){1&t&&p.Oc(0," Subid ")}function os(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function ss(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",40),p.Mc(1,is,1,0,"ng-template",24),p.Mc(2,os,2,1,"ng-template",17),p.Vb())}function cs(t,e){1&t&&p.Oc(0," Publisher ")}function us(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function ls(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",41),p.Mc(1,cs,1,0,"ng-template",24),p.Mc(2,us,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function hs(t,e){1&t&&p.Oc(0," Searches ")}function ps(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function gs(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",42),p.Mc(1,hs,1,0,"ng-template",24),p.Mc(2,ps,3,3,"ng-template",17),p.Vb())}function bs(t,e){1&t&&p.Oc(0," Clicks ")}function fs(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ds(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",43),p.Mc(1,bs,1,0,"ng-template",24),p.Mc(2,fs,3,3,"ng-template",17),p.Vb())}function ms(t,e){1&t&&p.Oc(0," Split ")}function vs(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}function ys(t,e){1&t&&p.Oc(0," Publisher Net ")}function Ds(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Ss(t,e){1&t&&p.Oc(0," Profit ")}function ws(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Fs(t,e){1&t&&p.Oc(0," Revenue ")}function xs(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}var Ms,Ws,Ps=((Ms=function(){function e(t,a,n,i){r(this,e),this.cdr=t,this.userService=a,this.solexBCService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.expanded={},this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"getAllSolexBCStats",value:function(e,r,a){var n=this;return this.solexBCService.getSolexBCStats(e,r,a).toPromise().then((function(e){var r,a=t((n.loadingIndicator=!1,n.allStats=e.stats,n.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),n.tagList));try{for(a.s();!(r=a.n()).done;){var i=r.value;if("solex-bc"==i.tag.advertiser){var o,s=t(i.tag.subids);try{for(s.s();!(o=s.n()).done;){var c=o.value;"Contains"==c.filterTag?n.allStats.map((function(t){t.subid.includes(c.subid)&&(t.publisher=i.user.length?i.user[0].fullname:"No Publisher",t.tagname=i.tag.name)})):"StartsWith"==c.filterTag?n.allStats.map((function(t){t.subid.startsWith(c.subid)&&(t.publisher=i.user.length?i.user[0].fullname:"No Publisher",t.tagname=i.tag.name)})):"EndsWith"==c.filterTag?n.allStats.map((function(t){t.subid.endsWith(c.subid)&&(t.publisher=i.user.length?i.user[0].fullname:"No Publisher",t.tagname=i.tag.name)})):"ExactValue"==c.filterTag&&n.allStats.map((function(t){t.subid==c.subid&&(t.publisher=i.user.length?i.user[0].fullname:"No Publisher",t.tagname=i.tag.name)}))}}catch(u){s.e(u)}finally{s.f()}}}}catch(u){a.e(u)}finally{a.f()}return n.allStats}))}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I,N,L,A,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.solexBCService.getSolexBCStats(e,r,a).toPromise();case 3:i=n.sent,o=t((this.allChartStat=i.stats,this.allChartStat.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("solex-bc"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(h=u.n()).done;)"Contains"==(p=h.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==p.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(p.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==p.filterTag&&this.allChartStat.map((function(t){t.subid==p.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(z){u.e(z)}finally{u.f()}}}catch(z){o.e(z)}finally{o.f()}for(d in g=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),b=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(g,["date","publisher"]),f=[],b)if(b.hasOwnProperty(d))for(m in b[d])v={date:b[d][m][0].date,publisher:b[d][m][0].publisher,revenue:l.reduce(b[d][m],(function(t,e){return t+e.revenue}),0)},f.push(v);for(y=[],D=0,S=f;D<S.length;D++)w=S[D],y.push(w.publisher);F=y.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),x={},M=this.allChartStat.reduce((function(t,e){var r=e.date;return x[r]?x[r].searches+=parseInt(e.searches):(x[r]=Object.assign({},e),t.push(x[r])),t}),[]),W=[],P=[],V={},O=t(this.daysList);try{for(O.s();!(C=O.n()).done;)if(k=C.value,0==(R=M.filter((function(t){return t.date==k}))).length)W.push(k),P.push(0);else{_=t(R);try{for(_.s();!(T=_.n()).done;)I=T.value,W.push(I.date),P.push(I.searches)}catch(z){_.e(z)}finally{_.f()}}}catch(z){O.e(z)}finally{O.f()}N=[],L=t(F);try{for(j=function(){var e,r=A.value,a=[],n=t(W);try{var i=function(){var t=e.value,n=f.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(z){n.e(z)}finally{n.f()}var o={};o[r]=a,N.push(o)},L.s();!(A=L.n()).done;)j()}catch(z){L.e(z)}finally{L.f()}return n.abrupt("return",(V.revenuePerDay=N,V.datesOfRevenue=W,V.searchesPerDay=P,V.publisherName=F,V));case 22:return n.prev=22,n.t0=n.catch(0),n.abrupt("return",n.t0);case 25:case"end":return n.stop()}}),n,this,[[0,22]])})))}},{key:"getSummaryMetrics",value:function(t,e,r){return this.solexBCService.getSummaryMetrics(t,e,r).toPromise().then((function(t){var a={},n=0,i=0,o=0;return 0!=t.summary[0].lastMonthStat[0].profitPace&&(n=(t.summary[0].summaryMetrics[0].profitPace-t.summary[0].lastMonthStat[0].profitPace)/t.summary[0].lastMonthStat[0].profitPace*100),0!=t.summary[0].twoLastMonthStat[0].profitPace&&(i=(t.summary[0].lastMonthStat[0].profitPace-t.summary[0].twoLastMonthStat[0].profitPace)/t.summary[0].twoLastMonthStat[0].profitPace*100),0!=t.summary[0].prevSelectedStat[0].profitPace&&(o=(t.summary[0].selectedStat[0].profitPace-t.summary[0].prevSelectedStat[0].profitPace)/t.summary[0].prevSelectedStat[0].profitPace*100),t.summary[0].summaryMetrics[0].percentPace=n,t.summary[0].lastMonthStat[0].percentPace=i,t.summary[0].selectedStat[0].percentPace=o,t.summary[0].selectedStat[0].selectedStartDate=e,t.summary[0].selectedStat[0].selectedEndDate=r,a.summary=t.summary,a}))}},{key:"getCompanyTags",value:function(t){var e=t.split("/")[1];return this.tagService.getCompanyTags(e).toPromise().then((function(t){return t})).catch((function(t){return t}))}}]),e}()).\u0275fac=function(t){return new(t||Ms)(p.Qb(p.i),p.Qb(g.a),p.Qb(Qo.a),p.Qb(f.a))},Ms.\u0275cmp=p.Kb({type:Ms,selectors:[["app-solex-bc"]],viewQuery:function(t,e){var r;1&t&&p.Tc(Go,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:41,vars:23,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","clicks",4,"ngIf"],["name","split",3,"minWidth"],["ngx-datatable-header-template",""],["name","publisherNet"],["name","profit"],["name","revenue"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","clicks"]],template:function(t,e){1&t&&(p.Mc(0,qo,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,$o,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Ko,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,ts,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,es,1,4,"ng-template",17),p.Vb(),p.Mc(24,ns,3,1,"ngx-datatable-column",18),p.Mc(25,ss,3,0,"ngx-datatable-column",19),p.Mc(26,ls,3,1,"ngx-datatable-column",20),p.Mc(27,gs,3,0,"ngx-datatable-column",21),p.Mc(28,ds,3,0,"ngx-datatable-column",22),p.Wb(29,"ngx-datatable-column",23),p.Mc(30,ms,1,0,"ng-template",24),p.Mc(31,vs,4,6,"ng-template",17),p.Vb(),p.Wb(32,"ngx-datatable-column",25),p.Mc(33,ys,1,0,"ng-template",24),p.Mc(34,Ds,3,4,"ng-template",17),p.Vb(),p.Wb(35,"ngx-datatable-column",26),p.Mc(36,Ss,1,0,"ng-template",24),p.Mc(37,ws,3,4,"ng-template",17),p.Vb(),p.Wb(38,"ngx-datatable-column",27),p.Mc(39,Fs,1,0,"ng-template",24),p.Mc(40,xs,3,4,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Ms),Vs=Do.a.apiUrl+"/stats/admin/accounting",Os=((Ws=function(){function t(e){r(this,t),this.http=e}return n(t,[{key:"getRubiStats",value:function(t,e,r){return this.http.get(Vs+"/rubi",{params:{company:t,startDate:e,endDate:r}})}},{key:"getPerionStats",value:function(t,e,r){return this.http.get(Vs+"/perion",{params:{company:t,startDate:e,endDate:r}})}},{key:"getLyonStats",value:function(t,e,r){return this.http.get(Vs+"/lyons",{params:{company:t,startDate:e,endDate:r}})}},{key:"getApptitudeStats",value:function(t,e,r){return this.http.get(Vs+"/apptitude",{params:{company:t,startDate:e,endDate:r}})}},{key:"getSolexBCStats",value:function(t,e,r){return this.http.get(Vs+"/solex-bc",{params:{company:t,startDate:e,endDate:r}})}},{key:"getVerizonDirectStats",value:function(t,e,r){return this.http.get(Vs+"/verizon-direct",{params:{company:t,startDate:e,endDate:r}})}},{key:"getSystem1Stats",value:function(t,e,r){return this.http.get(Vs+"/system1",{params:{company:t,startDate:e,endDate:r}})}}]),t}()).\u0275fac=function(t){return new(t||Ws)(p.ec(So.c))},Ws.\u0275prov=p.Mb({token:Ws,factory:Ws.\u0275fac,providedIn:"root"}),Ws),Cs=["expandableTable"];function ks(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"div",12),p.Wb(2,"div",13),p.Wb(3,"span"),p.Oc(4),p.Vb(),p.Vb(),p.Wb(5,"div",15),p.Wb(6,"span"),p.Oc(7),p.mc(8,"currency"),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var r=e.$implicit,a=e.index,n=p.lc().row;p.Db(4),p.Qc("",r," : "),p.Db(3),p.Pc(p.oc(8,2,n.everyrevenue[a],"USD"))}}function Rs(t,e){if(1&t&&(p.Wb(0,"div",9),p.Mc(1,ks,9,5,"div",10),p.Vb(),p.Wb(2,"div",11),p.Wb(3,"div",12),p.Wb(4,"div",13),p.Wb(5,"strong",14),p.Oc(6,"Total : "),p.Vb(),p.Vb(),p.Wb(7,"div",15),p.Wb(8,"strong",14),p.Oc(9),p.mc(10,"currency"),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var r=e.row;p.Db(1),p.rc("ngForOf",r.reporting),p.Db(8),p.Pc(p.oc(10,2,r.total,"USD"))}}function _s(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",16),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function Ts(t,e){1&t&&p.Oc(0," Publisher Name ")}function Is(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}var Ns,Ls=((Ns=function(){function e(t,a,n,i,o){r(this,e),this.cdr=t,this.userService=a,this.accountingService=n,this.tagService=i,this.companyService=o,this.rows=[],this.loadingIndicator=!0,this.range={startDate:"",endDate:""},this.allRubiStats=[],this.allLyonStats=[],this.allPerionStats=[],this.allSystem1Stats=[],this.allVerizonStats=[],this.allSolexBCStats=[],this.allApptitudeStats=[],this.tagList=[],this.tempStatData=[],this.tempUpdateStatData=[],this.reportTypeData=[],this.selectedCompany=this.getSelectedCompanyStored()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,r,a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,t.next=5,this.getReportingProviderList();case 5:if(this.reportTypeData=t.sent,this.rows=[],this.tempStatData=[],t.t0=this.reportTypeData.includes("perion"),!t.t0){t.next=14;break}return t.next=12,this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.PerionData=t.sent,this.tempStatData=this.tempStatData.concat(this.PerionData);case 14:if(t.t1=this.reportTypeData.includes("lyons"),!t.t1){t.next=20;break}return t.next=18,this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 18:this.LyonData=t.sent,this.tempStatData=this.tempStatData.concat(this.LyonData);case 20:if(t.t2=this.reportTypeData.includes("rubi"),!t.t2){t.next=26;break}return t.next=24,this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 24:this.RubiData=t.sent,this.tempStatData=this.tempStatData.concat(this.RubiData);case 26:if(t.t3=this.reportTypeData.includes("apptitude"),!t.t3){t.next=32;break}return t.next=30,this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 30:this.ApptitudeData=t.sent,this.tempStatData=this.tempStatData.concat(this.ApptitudeData);case 32:if(t.t4=this.reportTypeData.includes("solex-bc"),!t.t4){t.next=38;break}return t.next=36,this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 36:this.SolexBCData=t.sent,this.tempStatData=this.tempStatData.concat(this.SolexBCData);case 38:if(t.t5=this.reportTypeData.includes("verizon-direct"),!t.t5){t.next=44;break}return t.next=42,this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 42:this.VerizonData=t.sent,this.tempStatData=this.tempStatData.concat(this.VerizonData);case 44:if(t.t6=this.reportTypeData.includes("system1"),!t.t6){t.next=50;break}return t.next=48,this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 48:this.System1Data=t.sent,this.tempStatData=this.tempStatData.concat(this.System1Data);case 50:for(e=[],r=0,this.tempStatData.forEach((function(t){var r=e.filter((function(e){return e.publisher==t.publisher}));if(r.length){var a=e.indexOf(r[0]);e[a].reporting=e[a].reporting.concat(t.reporting),e[a].everyrevenue=e[a].everyrevenue.concat(String(t.revenue)),e[a].total=e[a].total+t.revenue}else"string"==typeof t.reporting&&(t.reporting=[t.reporting]),"number"==typeof t.revenue&&(t.everyrevenue=[String(t.revenue)],t.total=t.revenue),e.push(t)})),a=e;r<a.length;r++)(n=a[r]).detailHeight=30*(n.reporting.length+1);this.rows=e,this.loadingIndicator=!1,this.cdr.detectChanges();case 53:case"end":return t.stop()}}),t,this)})))}},{key:"getSelectedCompanyStored",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a,n,i,o,s,c,u,l,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadingIndicator=!0,this.range=t,this.rows=[],this.tempUpdateStatData=[],r=[],a=[],n=[],i=[],o=[],s=[],c=[],e.t0=this.reportTypeData.includes("perion"),!e.t0){e.next=8;break}return e.next=6,this.getPerionStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:r=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(r);case 8:if(e.t1=this.reportTypeData.includes("lyons"),!e.t1){e.next=14;break}return e.next=12,this.getLyonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:a=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(a);case 14:if(e.t2=this.reportTypeData.includes("rubi"),!e.t2){e.next=20;break}return e.next=18,this.getRubiStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 18:n=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(n);case 20:if(e.t3=this.reportTypeData.includes("apptitude"),!e.t3){e.next=26;break}return e.next=24,this.getApptitudeStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 24:i=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(i);case 26:if(e.t4=this.reportTypeData.includes("solex-bc"),!e.t4){e.next=32;break}return e.next=30,this.getSolexBCStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 30:o=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(o);case 32:if(e.t5=this.reportTypeData.includes("verizon-direct"),!e.t5){e.next=38;break}return e.next=36,this.getVerizonDirectStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 36:s=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(s);case 38:if(e.t6=this.reportTypeData.includes("system1"),!e.t6){e.next=44;break}return e.next=42,this.getSystem1Stats(this.selectedCompany,this.range.startDate,this.range.endDate);case 42:c=e.sent,this.tempUpdateStatData=this.tempUpdateStatData.concat(c);case 44:for(u=[],l=0,this.tempUpdateStatData.forEach((function(t){var e=u.filter((function(e){return e.publisher==t.publisher}));if(e.length){var r=u.indexOf(e[0]);u[r].reporting=u[r].reporting.concat(t.reporting),u[r].everyrevenue=u[r].everyrevenue.concat(String(t.revenue)),u[r].total=u[r].total+t.revenue}else"string"==typeof t.reporting&&(t.reporting=[t.reporting]),"number"==typeof t.revenue&&(t.everyrevenue=[String(t.revenue)],t.total=t.revenue),u.push(t)})),h=u;l<h.length;l++)(p=h[l]).detailHeight=30*(p.reporting.length+1);this.rows=u,this.loadingIndicator=!1,this.cdr.detectChanges();case 47:case"end":return e.stop()}}),e,this)})))}},{key:"getReportingProviderList",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.selectedCompany){t.next=12;break}return t.prev=1,t.next=4,this.companyService.getReportCompany(this.selectedCompany.split("/")[1]).toPromise();case 4:return e=t.sent,r=[],t.abrupt("return",(e.reportingProviders.map((function(t){r.push(t.reportingProvider)})),r));case 9:return t.prev=9,t.t0=t.catch(1),t.abrupt("return",t.t0);case 12:case"end":return t.stop()}}),t,this,[[1,9]])})))}},{key:"getRubiStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getRubiStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allRubiStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("rubi"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allRubiStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Rubi")})):"StartsWith"==h.filterTag?this.allRubiStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Rubi")})):"EndsWith"==h.filterTag?this.allRubiStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Rubi")})):"ExactValue"==h.filterTag&&this.allRubiStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Rubi")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allRubiStats.length>0&&this.allRubiStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getSolexBCStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getSolexBCStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allSolexBCStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("solex-bc"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allSolexBCStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Solex BC")})):"StartsWith"==h.filterTag?this.allSolexBCStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Solex BC")})):"EndsWith"==h.filterTag?this.allSolexBCStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Solex BC")})):"ExactValue"==h.filterTag&&this.allSolexBCStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Solex BC")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allSolexBCStats.length>0&&this.allSolexBCStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getVerizonDirectStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getVerizonDirectStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allVerizonStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("verizon-direct"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allVerizonStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")})):"StartsWith"==h.filterTag?this.allVerizonStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")})):"EndsWith"==h.filterTag?this.allVerizonStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")})):"ExactValue"==h.filterTag&&this.allVerizonStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Verizon Direct")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allVerizonStats.length>0&&this.allVerizonStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getLyonStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getLyonStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allLyonStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("lyons"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allLyonStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Lyons")})):"StartsWith"==h.filterTag?this.allLyonStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Lyons")})):"EndsWith"==h.filterTag?this.allLyonStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Lyons")})):"ExactValue"==h.filterTag&&this.allLyonStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Lyons")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allLyonStats.length>0&&this.allLyonStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getPerionStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getPerionStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allPerionStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("perion"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allPerionStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Perion")})):"StartsWith"==h.filterTag?this.allPerionStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Perion")})):"EndsWith"==h.filterTag?this.allPerionStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Perion")})):"ExactValue"==h.filterTag&&this.allPerionStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Perion")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allPerionStats.length>0&&this.allPerionStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getApptitudeStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getApptitudeStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allApptitudeStats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("apptitude"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allApptitudeStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Apptitude")})):"StartsWith"==h.filterTag?this.allApptitudeStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Apptitude")})):"EndsWith"==h.filterTag?this.allApptitudeStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Apptitude")})):"ExactValue"==h.filterTag&&this.allApptitudeStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="Apptitude")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allApptitudeStats.length>0&&this.allApptitudeStats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getSystem1Stats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h,p,g;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.accountingService.getSystem1Stats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.allSystem1Stats=i.stats,this.tagList));try{for(o.s();!(s=o.n()).done;)if("system1"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allSystem1Stats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="System1")})):"StartsWith"==h.filterTag?this.allSystem1Stats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="System1")})):"EndsWith"==h.filterTag?this.allSystem1Stats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="System1")})):"ExactValue"==h.filterTag&&this.allSystem1Stats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.reporting="System1")}))}catch(b){u.e(b)}finally{u.f()}}}catch(b){o.e(b)}finally{o.f()}return p=[],g={},n.abrupt("return",(this.allSystem1Stats.length>0&&this.allSystem1Stats.reduce((function(t,e){var r=e.publisher;return g[r]?g[r].revenue+=parseFloat(e.revenue):(g[r]=Object.assign({},e),t.push(g[r])),t}),[]).map((function(t){p.push({publisher:t.publisher?t.publisher:"No Publisher",reporting:t.reporting?t.reporting:"No Reporting",revenue:t.revenue})})),p));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}}]),e}()).\u0275fac=function(t){return new(t||Ns)(p.Qb(p.i),p.Qb(g.a),p.Qb(Os),p.Qb(f.a),p.Qb(xo.a))},Ns.\u0275cmp=p.Kb({type:Ns,selectors:[["app-accounting"]],viewQuery:function(t,e){var r;1&t&&p.Tc(Cs,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:10,vars:14,consts:[[3,"onDatesPicked"],[1,"material","fullscreen","expandable",2,"top","30px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","publisher",3,"minWidth"],["ngx-datatable-header-template",""],[2,"padding-left","36px"],[4,"ngFor","ngForOf"],[2,"padding-left","36px","margin-top","5px"],[2,"display","flex"],[2,"min-width","20%"],[2,"font-size","14px"],[2,"min-width","80%"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"]],template:function(t,e){1&t&&(p.Wb(0,"app-reporting-filtering",0),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Wb(1,"ngx-datatable",1,2),p.Wb(3,"ngx-datatable-row-detail",3),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(4,Rs,11,5,"ng-template",4),p.Vb(),p.Wb(5,"ngx-datatable-column",5),p.Mc(6,_s,1,4,"ng-template",6),p.Vb(),p.Wb(7,"ngx-datatable-column",7),p.Mc(8,Ts,1,0,"ng-template",8),p.Mc(9,Is,2,1,"ng-template",6),p.Vb(),p.Vb()),2&t&&(p.Db(1),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight",e.getDetailRowHeight),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("minWidth",100))},directives:[d.a,S.d,S.e,S.f,S.b,S.a,S.c,s.o],pipes:[s.d],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:hidden!important}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{border-top:1px solid #222!important}"]}),Ns),As=i("2Q/2"),js=["expandableTable"];function zs(t,e){1&t&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function Es(t,e){if(1&t&&p.Rb(0,"app-reporting-revenue-chart",37),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function Ys(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",38),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function Hs(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.mc(3,"date"),p.Vb(),p.Wb(4,"td"),p.Oc(5),p.mc(6,"number"),p.Vb(),p.Wb(7,"td"),p.Oc(8),p.mc(9,"number"),p.Vb(),p.Wb(10,"td"),p.Oc(11),p.mc(12,"percent"),p.Vb(),p.Wb(13,"td"),p.Oc(14),p.mc(15,"currency"),p.Vb(),p.Wb(16,"td"),p.Oc(17),p.mc(18,"currency"),p.Vb(),p.Wb(19,"td"),p.Oc(20),p.mc(21,"currency"),p.Vb(),p.Wb(22,"td"),p.Oc(23),p.mc(24,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit;p.Db(2),p.Pc(p.nc(3,8,r.date)),p.Db(3),p.Pc(p.nc(6,10,r.searches)),p.Db(3),p.Pc(p.nc(9,12,r.clicks)),p.Db(3),p.Pc(p.oc(12,14,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(15,17,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(18,20,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(21,23,r.profit,"USD")),p.Db(3),p.Pc(p.oc(24,26,r.revenue,"USD"))}}function Us(t,e){if(1&t&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,Hs,25,29,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Bs(t,e){1&t&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Qs(t,e){if(1&t&&(p.Mc(0,Us,22,1,"div",39),p.Mc(1,Bs,6,0,"div",40)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Gs(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function qs(t,e){1&t&&p.Oc(0," Date ")}function $s(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"date"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ks(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,qs,1,0,"ng-template",31),p.Mc(2,$s,3,3,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function Xs(t,e){1&t&&p.Oc(0," Subid ")}function Zs(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function Js(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,Xs,1,0,"ng-template",31),p.Mc(2,Zs,2,1,"ng-template",17),p.Vb())}function tc(t,e){1&t&&p.Oc(0," Publisher ")}function ec(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function rc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,tc,1,0,"ng-template",31),p.Mc(2,ec,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function ac(t,e){1&t&&p.Oc(0," Searches ")}function nc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function ic(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,ac,1,0,"ng-template",31),p.Mc(2,nc,3,3,"ng-template",17),p.Vb())}function oc(t,e){1&t&&p.Oc(0," Bid Searches ")}function sc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function cc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,oc,1,0,"ng-template",31),p.Mc(2,sc,3,3,"ng-template",17),p.Vb())}function uc(t,e){1&t&&p.Oc(0," Bid Searches Result ")}function lc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,uc,1,0,"ng-template",31),p.Mc(2,lc,3,3,"ng-template",17),p.Vb())}function pc(t,e){1&t&&p.Oc(0," Clicks ")}function gc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function bc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,pc,1,0,"ng-template",31),p.Mc(2,gc,3,3,"ng-template",17),p.Vb())}function fc(t,e){1&t&&p.Oc(0," Coverage ")}function dc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function mc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,fc,1,0,"ng-template",31),p.Mc(2,dc,3,3,"ng-template",17),p.Vb())}function vc(t,e){1&t&&p.Oc(0," CTR ")}function yc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function Dc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,vc,1,0,"ng-template",31),p.Mc(2,yc,3,4,"ng-template",17),p.Vb())}function Sc(t,e){1&t&&p.Oc(0," CPC ")}function wc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function Fc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,Sc,1,0,"ng-template",31),p.Mc(2,wc,3,4,"ng-template",17),p.Vb())}function xc(t,e){1&t&&p.Oc(0," RN ")}function Mc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Wc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,xc,1,0,"ng-template",31),p.Mc(2,Mc,3,3,"ng-template",17),p.Vb())}function Pc(t,e){1&t&&p.Oc(0," TQ ")}function Vc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Oc(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,Pc,1,0,"ng-template",31),p.Mc(2,Vc,3,3,"ng-template",17),p.Vb())}function Cc(t,e){1&t&&p.Oc(0," Publisher Net ")}function kc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Rc(t,e){1&t&&p.Oc(0," Profit ")}function _c(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Tc(t,e){1&t&&p.Oc(0," Revenue ")}function Ic(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Nc(t,e){1&t&&p.Oc(0," Split ")}function Lc(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Ac,jc,zc,Ec=((Ac=function(){function e(t,a,n,i){r(this,e),this.verizonarbService=t,this.cdr=a,this.userService=n,this.tagService=i,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t),n=h(e);a<=n;)r.push(h.utc(a,"YYYY-MM-DD").startOf("day").toDate().getTime()+h.utc(36e6).toDate().getTime()),a.add(1,"days");return r}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a,n,i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=t((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct-arb"==(n=a.value).tag.advertiser){i=t(n.tag.subids);try{for(i.s();!(o=i.n()).done;)"Contains"==(s=o.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"StartsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"EndsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"ExactValue"==s.filterTag&&this.allChartStat.map((function(t){t.subid==s.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),u=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(t,e){return t+e.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),D={},S=this.allChartStat.reduce((function(t,e){var r=e.date;return D[r]?(D[r].searches+=parseInt(e.searches),e.revenue&&(D[r].revenue+=e.revenue)):(D[r]=Object.assign({},e),t.push(D[r])),t}),[]),w=[],F=[],x={},M=t(this.daysList);try{for(M.s();!(W=M.n()).done;)if(P=W.value,0==(V=S.filter((function(t){return t.date==P}))).length)w.push(P),F.push(0);else{O=t(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){M.e(N)}finally{M.f()}R=[],_=t(y);try{for(I=function(){var e,r=T.value,a=[],n=t(w);try{var i=function(){var t=e.value,n=h.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var o={};o[r]=a,R.push(o)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return e.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return e.prev=19,e.t0=e.catch(0),e.abrupt("return",e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonarbService.getAllVerizonArbStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("verizon-direct-arb"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonarbService.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}}]),e}()).\u0275fac=function(t){return new(t||Ac)(p.Qb(As.a),p.Qb(p.i),p.Qb(g.a),p.Qb(f.a))},Ac.\u0275cmp=p.Kb({type:Ac,selectors:[["app-verizon-direct-arb"]],viewQuery:function(t,e){var r;1&t&&p.Tc(js,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(p.Mc(0,zs,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,Es,1,1,"app-reporting-revenue-chart",2),p.Mc(3,Ys,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,Qs,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Gs,1,4,"ng-template",17),p.Vb(),p.Mc(24,Ks,3,1,"ngx-datatable-column",18),p.Mc(25,Js,3,0,"ngx-datatable-column",19),p.Mc(26,rc,3,1,"ngx-datatable-column",20),p.Mc(27,ic,3,0,"ngx-datatable-column",21),p.Mc(28,cc,3,0,"ngx-datatable-column",22),p.Mc(29,hc,3,0,"ngx-datatable-column",23),p.Mc(30,bc,3,0,"ngx-datatable-column",24),p.Mc(31,mc,3,0,"ngx-datatable-column",25),p.Mc(32,Dc,3,0,"ngx-datatable-column",26),p.Mc(33,Fc,3,0,"ngx-datatable-column",27),p.Mc(34,Wc,3,0,"ngx-datatable-column",28),p.Mc(35,Oc,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,Cc,1,0,"ng-template",31),p.Mc(38,kc,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Rc,1,0,"ng-template",31),p.Mc(41,_c,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,Tc,1,0,"ng-template",31),p.Mc(44,Ic,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Nc,1,0,"ng-template",31),p.Mc(47,Lc,4,6,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,x,O,s.o],pipes:[s.f,s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Ac),Yc=Do.a.apiUrl+"/stats/admin/verizon-arb-hourly",Hc=((zc=function(){function t(e){r(this,t),this.http=e}return n(t,[{key:"getChartMetrics",value:function(t,e,r){return this.http.get(Yc+"/chart_metrics",{params:{company:t,startDate:e,endDate:r}})}},{key:"getAllVerizonArbHourlyStats",value:function(t,e,r){return this.http.get(Yc+"/",{params:{company:t,startDate:e,endDate:r}})}},{key:"getAllPublisherVerizonArbHourlyStats",value:function(t,e,r){return this.http.get(Yc+"/all-publishers",{params:{company:t,startDate:e,endDate:r}})}},{key:"getSummaryMetrics",value:function(t,e,r){return this.http.get(Yc+"/summary_metrics",{params:{company:t,startDate:e,endDate:r}})}},{key:"getAllDashboardStats",value:function(){return this.http.get(Yc+"/all-stat")}}]),t}()).\u0275fac=function(t){return new(t||zc)(p.ec(So.c))},zc.\u0275prov=p.Mb({token:zc,factory:zc.\u0275fac,providedIn:"root"}),zc),Uc=((jc=function(){function e(){r(this,e)}return n(e,[{key:"ngOnInit",value:function(){this.setChartOptions(5,5,[0],[0],[0],[0]),this.chartData=this.getChartData(this.chartData),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay)}},{key:"ngOnChanges",value:function(){this.chartData&&(this.chartData.datesOfRevenue=this.convertTimeStampArryToDate(this.chartData.datesOfRevenue),this.setChartOptions(3e4,3e5,this.chartData.datesOfRevenue,this.chartData.revenuePerDay,this.chartData.publisherName,this.chartData.searchesPerDay))}},{key:"setChartOptions",value:function(e,r,a,n,i,o){this.chartDom=document.getElementById("main"),this.myChart=F.a(this.chartDom);var s,c=[],u=t(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,h=Object.keys(l)[0];h&&c.push({name:h,type:"bar",stack:"Ad",data:l[h].map((function(t){return parseFloat(t).toFixed(2)}))})}}catch(p){u.e(p)}finally{u.f()}this.option={tooltip:{trigger:"axis",axisPointer:{animation:!0,type:"cross",crossStyle:{color:"#999"}},formatter:function(t){var e=function(t){return'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+t+'"></span>'},r="<p>"+t[0].axisValue+"</p>",a=0;return t.forEach((function(t){var n="<p>"+e(t.color)+" "+t.seriesName+":  $ "+t.data+"</p>";r+=n,a+=parseFloat(t.data)})),r+="<p>"+e("#fc345c")+" Total:  $ "+a.toFixed(2)+"</p>"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:i},xAxis:[{type:"category",data:a,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Revenue",axisLabel:{formatter:"${value}"},axisLine:{show:!0,lineStyle:{color:"#5470C6"}}}],series:c},this.option&&this.myChart.setOption(this.option,!0),window.addEventListener("resize",this.myChart.resize)}},{key:"convertTimeStampArryToDate",value:function(t){for(var e=[],r=0;r<t.length;r++)e.push(h(t[r]).format("MMM DD, YYYY hha"));return e}},{key:"getChartData",value:function(t){if(t)return t}}]),e}()).\u0275fac=function(t){return new(t||jc)},jc.\u0275cmp=p.Kb({type:jc,selectors:[["app-reporting-hourly-revenue-chart"]],inputs:{chartData:"chartData"},features:[p.Bb],decls:1,vars:0,consts:[["id","main",2,"width","100%","height","300px"]],template:function(t,e){1&t&&p.Rb(0,"div",0)},styles:[""]}),jc),Bc=["expandableTable"];function Qc(t,e){1&t&&(p.Wb(0,"div",35),p.Rb(1,"mat-progress-bar",36),p.Vb())}function Gc(t,e){if(1&t&&p.Rb(0,"app-reporting-hourly-revenue-chart",37),2&t){var r=p.lc();p.rc("chartData",r.chartData)}}function qc(t,e){if(1&t&&p.Rb(0,"app-summary-metrics",38),2&t){var r=p.lc();p.rc("summaryMetricsData",r.summaryMetrics)}}function $c(t,e){if(1&t&&(p.Wb(0,"tr"),p.Wb(1,"td"),p.Oc(2),p.Vb(),p.Wb(3,"td"),p.Oc(4),p.mc(5,"number"),p.Vb(),p.Wb(6,"td"),p.Oc(7),p.mc(8,"number"),p.Vb(),p.Wb(9,"td"),p.Oc(10),p.mc(11,"percent"),p.Vb(),p.Wb(12,"td"),p.Oc(13),p.mc(14,"currency"),p.Vb(),p.Wb(15,"td"),p.Oc(16),p.mc(17,"currency"),p.Vb(),p.Wb(18,"td"),p.Oc(19),p.mc(20,"currency"),p.Vb(),p.Wb(21,"td"),p.Oc(22),p.mc(23,"currency"),p.Vb(),p.Vb()),2&t){var r=e.$implicit,a=p.lc(3);p.Db(2),p.Pc(a.formattedDate(r.date)),p.Db(2),p.Pc(p.nc(5,8,r.searches)),p.Db(3),p.Pc(p.nc(8,10,r.clicks)),p.Db(3),p.Pc(p.oc(11,12,r.ctr||0,"2.2-2")),p.Db(3),p.Pc(p.oc(14,15,r.cpc||0,"USD")),p.Db(3),p.Pc(p.oc(17,18,r.publisherNet,"USD")),p.Db(3),p.Pc(p.oc(20,21,r.profit,"USD")),p.Db(3),p.Pc(p.oc(23,24,r.revenue,"USD"))}}function Kc(t,e){if(1&t&&(p.Wb(0,"div",41),p.Wb(1,"table",42),p.Wb(2,"thead"),p.Wb(3,"tr"),p.Wb(4,"th"),p.Oc(5,"Date"),p.Vb(),p.Wb(6,"th"),p.Oc(7,"Searches"),p.Vb(),p.Wb(8,"th"),p.Oc(9,"Clicks"),p.Vb(),p.Wb(10,"th"),p.Oc(11,"CTR"),p.Vb(),p.Wb(12,"th"),p.Oc(13,"CPC"),p.Vb(),p.Wb(14,"th"),p.Oc(15,"Publisher Net"),p.Vb(),p.Wb(16,"th"),p.Oc(17,"Profit"),p.Vb(),p.Wb(18,"th"),p.Oc(19,"Revenue"),p.Vb(),p.Vb(),p.Vb(),p.Wb(20,"tbody"),p.Mc(21,$c,24,27,"tr",43),p.Vb(),p.Vb(),p.Vb()),2&t){var r=p.lc().row;p.Db(21),p.rc("ngForOf",r.subReportingForDate)}}function Xc(t,e){1&t&&(p.Wb(0,"div",44),p.Wb(1,"div"),p.Wb(2,"strong"),p.Oc(3,"Address"),p.Vb(),p.Vb(),p.Wb(4,"div"),p.Oc(5,"Test"),p.Vb(),p.Vb())}function Zc(t,e){if(1&t&&(p.Mc(0,Kc,22,1,"div",39),p.Mc(1,Xc,6,0,"div",40)),2&t){var r=p.lc();p.rc("ngIf","publisher"===r.groupType||"subid"===r.groupType),p.Db(1),p.rc("ngIf","publisher"!==r.groupType&&"subid"!==r.groupType)}}function Jc(t,e){if(1&t){var r=p.Xb();p.Wb(0,"a",45),p.hc("click",(function(){p.Dc(r);var t=e.row;return p.lc().toggleExpandRow(t)})),p.Vb()}if(2&t){var a=e.expanded;p.Ib("datatable-icon-right",!a)("datatable-icon-down",a)}}function tu(t,e){1&t&&p.Oc(0," Date ")}function eu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value,a=p.lc(2);p.Db(1),p.Pc(a.formattedDate(r))}}function ru(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",46),p.Mc(1,tu,1,0,"ng-template",31),p.Mc(2,eu,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function au(t,e){1&t&&p.Oc(0," Subid ")}function nu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function iu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",47),p.Mc(1,au,1,0,"ng-template",31),p.Mc(2,nu,2,1,"ng-template",17),p.Vb())}function ou(t,e){1&t&&p.Oc(0," Publisher ")}function su(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(r)}}function cu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",48),p.Mc(1,ou,1,0,"ng-template",31),p.Mc(2,su,2,1,"ng-template",17),p.Vb()),2&t&&p.rc("minWidth",100)}function uu(t,e){1&t&&p.Oc(0," Searches ")}function lu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function hu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",49),p.Mc(1,uu,1,0,"ng-template",31),p.Mc(2,lu,3,3,"ng-template",17),p.Vb())}function pu(t,e){1&t&&p.Oc(0," Bid Searches ")}function gu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function bu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",50),p.Mc(1,pu,1,0,"ng-template",31),p.Mc(2,gu,3,3,"ng-template",17),p.Vb())}function fu(t,e){1&t&&p.Oc(0," Bid Searches Result ")}function du(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function mu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",51),p.Mc(1,fu,1,0,"ng-template",31),p.Mc(2,du,3,3,"ng-template",17),p.Vb())}function vu(t,e){1&t&&p.Oc(0," Clicks ")}function yu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Du(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",52),p.Mc(1,vu,1,0,"ng-template",31),p.Mc(2,yu,3,3,"ng-template",17),p.Vb())}function Su(t,e){1&t&&p.Oc(0," Coverage ")}function wu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Fu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",53),p.Mc(1,Su,1,0,"ng-template",31),p.Mc(2,wu,3,3,"ng-template",17),p.Vb())}function xu(t,e){1&t&&p.Oc(0," CTR ")}function Mu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"percent"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"2.2-2"))}}function Wu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",54),p.Mc(1,xu,1,0,"ng-template",31),p.Mc(2,Mu,3,4,"ng-template",17),p.Vb())}function Pu(t,e){1&t&&p.Oc(0," CPC ")}function Vu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r||0,"USD"))}}function Ou(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",55),p.Mc(1,Pu,1,0,"ng-template",31),p.Mc(2,Vu,3,4,"ng-template",17),p.Vb())}function Cu(t,e){1&t&&p.Oc(0," RN ")}function ku(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Ru(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",56),p.Mc(1,Cu,1,0,"ng-template",31),p.Mc(2,ku,3,3,"ng-template",17),p.Vb())}function _u(t,e){1&t&&p.Oc(0," TQ ")}function Tu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r))}}function Iu(t,e){1&t&&(p.Wb(0,"ngx-datatable-column",57),p.Mc(1,_u,1,0,"ng-template",31),p.Mc(2,Tu,3,3,"ng-template",17),p.Vb())}function Nu(t,e){1&t&&p.Oc(0," Publisher Net ")}function Lu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Au(t,e){1&t&&p.Oc(0," Profit ")}function ju(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function zu(t,e){1&t&&p.Oc(0," Revenue ")}function Eu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"currency"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.oc(2,1,r,"USD"))}}function Yu(t,e){1&t&&p.Oc(0," Split ")}function Hu(t,e){if(1&t&&(p.Wb(0,"strong"),p.Oc(1),p.mc(2,"number"),p.mc(3,"number"),p.Vb()),2&t){var r=e.value;p.Db(1),p.Pc(p.nc(2,1,r)||p.oc(3,3,0,"1.0-0"))}}var Uu,Bu,Qu,Gu=[{path:"",component:Ar,children:[{path:"accounting",component:Ls},{path:"perion",component:Lr},{path:"image-advantage",component:Ve},{path:"hopkins",component:oe},{path:"apptitude",component:Dt},{path:"media-net",component:Oe},{path:"bing-direct",component:ia},{path:"lyons",component:$a},{path:"rubi",component:kn},{path:"system1",component:yo},{path:"verizon-direct",component:_i},{path:"verizon-direct-arb",component:Ec},{path:"verizon-direct-arb-hourly",component:(Uu=function(){function e(t,a,n,i,o){r(this,e),this.cdr=t,this.userService=a,this.tagService=n,this.verizonarbHourlyService=i,this.datePipe=o,this.range={startDate:"",endDate:""},this.loadingIndicator=!0,this.tagList=[],this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.daysList=[],this.selectedCompany=this.getSelectedCompanyFromLocalStorage()}return n(e,[{key:"ngAfterViewInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCompanyTags(this.selectedCompany);case 2:return this.tagList=t.sent,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],t.next=7,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 7:return this.rows=t.sent,t.next=10,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 10:return this.chartData=t.sent,t.next=13,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 13:this.summaryMetrics=t.sent,this.refreshTable();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"formattedDate",value:function(t){return this.datePipe.transform(t,"MMM dd, yyyy hh a")||""}},{key:"getSelectedCompanyFromLocalStorage",value:function(){return this.userService.getSelectedCompanyFromLocalStorage()}},{key:"updateReportingFiltering",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingIndicator=!0,this.range=t,this.daysList=this.getDateRangeList(this.range.startDate,this.range.endDate),this.rows=[],e.next=6,this.getAllVerizonStats(this.selectedCompany,this.range.startDate,this.range.endDate);case 6:return this.rows=e.sent,e.next=9,this.getChartMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 9:return this.chartData=e.sent,e.next=12,this.getSummaryMetrics(this.selectedCompany,this.range.startDate,this.range.endDate);case 12:this.summaryMetrics=e.sent,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.groupType="",this.loadingIndicator=!1,this.refreshTable();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"refreshTable",value:function(){this.cdr.markForCheck()}},{key:"groupDate",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.date;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!0,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupSubid",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.subid;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForSubid(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!0,this.cdr.markForCheck()}},{key:"groupProvider",value:function(){var e,r={},a=this.allStats.reduce((function(t,e){var a=e.publisher;return r[a]?(r[a].clicks+=parseFloat(e.clicks),r[a].ctr+=parseFloat(e.ctr?e.ctr:0),r[a].rn+=parseFloat(e.rn?e.rn:0),r[a].coverage+=parseFloat(e.coverage?e.coverage:0),r[a].searches+=parseFloat(e.searches?e.searches:0),r[a].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),r[a].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),r[a].profit+=parseFloat(e.profit),r[a].publisherNet+=parseFloat(e.publisherNet),r[a].revenue+=parseFloat(e.revenue),r[a].split+=parseFloat(e.split),r[a].counter++):(r[a]=Object.assign({},e),r[a].counter=1,t.push(r[a])),t}),[]),n=t(a);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.split=i.split/i.counter,i.ctr=i.ctr/i.counter,i.cpc=i.revenue/i.clicks,i.subReportingForDate=this.groupDateForPublisher(i),i.detailHeight=50*(i.subReportingForDate.length+1)}}catch(o){n.e(o)}finally{n.f()}this.rows=a,this.groupPublishFlag=!0,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"groupDateForPublisher",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.publisher===e.publisher})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.ctr=e.clicks/e.searches,e.cpc=e.revenue/e.clicks}catch(o){i.e(o)}finally{i.f()}return n}},{key:"groupDateForSubid",value:function(e){var r,a={},n=this.allStats.filter((function(t){return t.subid===e.subid})).reduce((function(t,e){var r=e.date;return a[r]?(a[r].clicks+=parseFloat(e.clicks),a[r].rn+=parseFloat(e.rn?e.rn:0),a[r].coverage+=parseFloat(e.coverage?e.coverage:0),a[r].searches+=parseFloat(e.searches?e.searches:0),a[r].biddedSearches+=parseFloat(e.biddedSearches?e.biddedSearches:0),a[r].biddedResults+=parseFloat(e.biddedResults?e.biddedResults:0),a[r].profit+=parseFloat(e.profit),a[r].publisherNet+=parseFloat(e.publisherNet),a[r].revenue+=parseFloat(e.revenue),a[r].split+=parseFloat(e.split),a[r].counter++):(a[r]=Object.assign({},e),a[r].counter=1,t.push(a[r])),t}),[]),i=t(n);try{for(i.s();!(r=i.n()).done;)(e=r.value).split=e.split/e.counter,e.cpc=e.revenue/e.clicks,e.ctr=e.clicks/e.searches}catch(o){i.e(o)}finally{i.f()}return n}},{key:"backGroup",value:function(){this.rows=this.allStats,this.groupPublishFlag=!1,this.groupDateShowFlag=!1,this.groupSubidShowFlag=!1,this.cdr.markForCheck()}},{key:"toggleExpandRow",value:function(t){console.log("Toggled Expand Row!",t),this.table.rowDetail.toggleExpandRow(t)}},{key:"onDetailToggle",value:function(t){console.log("Detail Toggled",t)}},{key:"remove_element",value:function(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return void t.splice(r,1)}},{key:"groupHandle",value:function(t){this.groupType=t.value,"date"==t.value?this.groupDate():"publisher"==t.value?this.groupProvider():"subid"==t.value?this.groupSubid():this.backGroup()}},{key:"getChartMetrics",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a,n,i,o,s,c,u,h,p,g,b,f,d,m,v,y,D,S,w,F,x,M,W,P,V,O,C,k,R,_,T,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=t((this.allChartStat=this.allStats,this.tagList));try{for(r.s();!(a=r.n()).done;)if("verizon-direct-arb-hourly"==(n=a.value).tag.advertiser){i=t(n.tag.subids);try{for(i.s();!(o=i.n()).done;)"Contains"==(s=o.value).filterTag?this.allChartStat.map((function(t){t.subid.includes(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"StartsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.startsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"EndsWith"==s.filterTag?this.allChartStat.map((function(t){t.subid.endsWith(s.subid)&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)})):"ExactValue"==s.filterTag&&this.allChartStat.map((function(t){t.subid==s.subid&&(t.publisher=n.user.length?n.user[0].fullname:"No Publisher",t.tagname=n.tag.name)}))}catch(N){i.e(N)}finally{i.f()}}}catch(N){r.e(N)}finally{r.f()}for(p in c=l.chain(this.allChartStat).sortBy((function(t){return t.date})).sortBy((function(t){return t.publisher})).value(),u=function t(e,r){if(!r.length)return e;var a=r[0],n=r.slice(1);return l.mapValues(l.groupBy(e,a),(function(e){return t(e,n)}))}(c,["date","publisher"]),h=[],u)if(u.hasOwnProperty(p))for(g in u[p])b={date:u[p][g][0].date,publisher:u[p][g][0].publisher,revenue:l.reduce(u[p][g],(function(t,e){return t+e.revenue}),0)},h.push(b);for(f=[],d=0,m=h;d<m.length;d++)v=m[d],f.push(v.publisher);y=f.filter((function(t,e,r){return e===r.indexOf(t)})),this.allChartStat=this.allChartStat.slice().sort((function(t,e){return t.date-e.date})),D={},S=this.allChartStat.reduce((function(t,e){var r=e.date;return D[r]?(D[r].searches+=parseInt(e.searches),e.revenue&&(D[r].revenue+=e.revenue)):(D[r]=Object.assign({},e),t.push(D[r])),t}),[]),w=[],F=[],x={},M=t(this.daysList);try{for(M.s();!(W=M.n()).done;)if(P=W.value,0==(V=S.filter((function(t){return t.date==P}))).length)w.push(P),F.push(0);else{O=t(V);try{for(O.s();!(C=O.n()).done;)k=C.value,w.push(k.date),F.push(k.searches)}catch(N){O.e(N)}finally{O.f()}}}catch(N){M.e(N)}finally{M.f()}R=[],_=t(y);try{for(I=function(){var e,r=T.value,a=[],n=t(w);try{var i=function(){var t=e.value,n=h.filter((function(e){return e.date==t&&e.publisher==r}));a.push(n.length>0?n[0].revenue:0)};for(n.s();!(e=n.n()).done;)i()}catch(N){n.e(N)}finally{n.f()}var o={};o[r]=a,R.push(o)},_.s();!(T=_.n()).done;)I()}catch(N){_.e(N)}finally{_.f()}return e.abrupt("return",(x.revenuePerDay=R,x.datesOfRevenue=w,x.searchesPerDay=F,x.publisherName=y,x));case 19:return e.prev=19,e.t0=e.catch(0),e.abrupt("return",e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})))}},{key:"getAllVerizonStats",value:function(e,r,a){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s,c,u,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.verizonarbHourlyService.getAllVerizonArbHourlyStats(e,r,a).toPromise();case 2:i=n.sent,o=t((this.loadingIndicator=!1,this.allStats=i.stats,this.allStats.map((function(t){t.publisher="No Publisher",t.tagname="No Tag"})),this.tagList));try{for(o.s();!(s=o.n()).done;)if("verizon-direct-arb-hourly"==(c=s.value).tag.advertiser){u=t(c.tag.subids);try{for(u.s();!(l=u.n()).done;)"Contains"==(h=l.value).filterTag?this.allStats.map((function(t){t.subid.includes(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"StartsWith"==h.filterTag?this.allStats.map((function(t){t.subid.startsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"EndsWith"==h.filterTag?this.allStats.map((function(t){t.subid.endsWith(h.subid)&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)})):"ExactValue"==h.filterTag&&this.allStats.map((function(t){t.subid==h.subid&&(t.publisher=c.user.length?c.user[0].fullname:"No Publisher",t.tagname=c.tag.name)}))}catch(p){u.e(p)}finally{u.f()}}}catch(p){o.e(p)}finally{o.f()}return n.abrupt("return",this.allStats);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getSummaryMetrics",value:function(t,e,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var n,i,o,s,c;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.verizonarbHourlyService.getSummaryMetrics(t,e,r).toPromise();case 2:return n=a.sent,i={},o=0,s=0,c=0,a.abrupt("return",(0!=n.summary[0].lastMonthStat[0].profitPace&&(o=(n.summary[0].summaryMetrics[0].profitPace-n.summary[0].lastMonthStat[0].profitPace)/n.summary[0].lastMonthStat[0].profitPace*100),0!=n.summary[0].twoLastMonthStat[0].profitPace&&(s=(n.summary[0].lastMonthStat[0].profitPace-n.summary[0].twoLastMonthStat[0].profitPace)/n.summary[0].twoLastMonthStat[0].profitPace*100),0!=n.summary[0].prevSelectedStat[0].profitPace&&(c=(n.summary[0].selectedStat[0].profitPace-n.summary[0].prevSelectedStat[0].profitPace)/n.summary[0].prevSelectedStat[0].profitPace*100),n.summary[0].summaryMetrics[0].percentPace=o,n.summary[0].lastMonthStat[0].percentPace=s,n.summary[0].selectedStat[0].percentPace=c,n.summary[0].selectedStat[0].selectedStartDate=e,n.summary[0].selectedStat[0].selectedEndDate=r,i.summary=n.summary,i));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"getCompanyTags",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("/")[1],e.prev=1,e.next=4,this.tagService.getCompanyTags(r).toPromise();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getDetailRowHeight",value:function(t,e){var r;return t&&(r=t.detailHeight),r}},{key:"getDateRangeList",value:function(t,e){for(var r=[],a=h(t).startOf("day"),n=h(e).endOf("day");a<=n;)r.push(h.utc(a).toDate().getTime()),a=h(a).add(1,"hour");return r}}]),e}(),Uu.\u0275fac=function(t){return new(t||Uu)(p.Qb(p.i),p.Qb(g.a),p.Qb(f.a),p.Qb(Hc),p.Qb(s.f))},Uu.\u0275cmp=p.Kb({type:Uu,selectors:[["app-verizon-direct-arb-hourly"]],viewQuery:function(t,e){var r;1&t&&p.Tc(Bc,!0),2&t&&p.zc(r=p.ic())&&(e.table=r.first)},decls:48,vars:30,consts:[["class","loading-bar",4,"ngIf"],[3,"onDatesPicked"],[3,"chartData",4,"ngIf"],[3,"summaryMetricsData",4,"ngIf"],[1,"row"],[1,"col-xl-4"],["appearance","fill"],[3,"ngModel","selectionChange","ngModelChange"],["value","date"],["value","publisher"],["value","subid"],["value","reset"],[1,"material","fullscreen","expandable",2,"top","10px","height","500px",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","rows","loadingIndicator"],["expandableTable",""],[3,"rowHeight","toggle"],["ngx-datatable-row-detail-template",""],[3,"width","resizeable","sortable","draggable","canAutoResize"],["ngx-datatable-cell-template",""],["name","date",3,"minWidth",4,"ngIf"],["name","subid",4,"ngIf"],["name","publisher",3,"minWidth",4,"ngIf"],["name","searches",4,"ngIf"],["name","biddedSearches",4,"ngIf"],["name","biddedResults",4,"ngIf"],["name","clicks",4,"ngIf"],["name","coverage",4,"ngIf"],["name","ctr",4,"ngIf"],["name","cpc",4,"ngIf"],["name","rn",4,"ngIf"],["name","tqScore",4,"ngIf"],["name","publisherNet"],["ngx-datatable-header-template",""],["name","profit"],["name","revenue"],["name","split",3,"minWidth"],[1,"loading-bar"],["mode","indeterminate"],[3,"chartData"],[3,"summaryMetricsData"],["class","table-responsive","style","padding-left: 36px;",4,"ngIf"],["style","padding-left: 35px",4,"ngIf"],[1,"table-responsive",2,"padding-left","36px"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[2,"padding-left","35px"],["href","javascript:void(0)","title","Expand/Collapse Row",3,"click"],["name","date",3,"minWidth"],["name","subid"],["name","publisher",3,"minWidth"],["name","searches"],["name","biddedSearches"],["name","biddedResults"],["name","clicks"],["name","coverage"],["name","ctr"],["name","cpc"],["name","rn"],["name","tqScore"]],template:function(t,e){1&t&&(p.Mc(0,Qc,2,0,"div",0),p.Wb(1,"app-reporting-filtering",1),p.hc("onDatesPicked",(function(t){return e.updateReportingFiltering(t)})),p.Vb(),p.Mc(2,Gc,1,1,"app-reporting-hourly-revenue-chart",2),p.Mc(3,qc,1,1,"app-summary-metrics",3),p.Wb(4,"div",4),p.Wb(5,"div",5),p.Wb(6,"mat-form-field",6),p.Wb(7,"mat-label"),p.Oc(8,"Choose an Group By"),p.Vb(),p.Wb(9,"mat-select",7),p.hc("selectionChange",(function(t){return e.groupHandle(t)}))("ngModelChange",(function(t){return e.groupType=t})),p.Wb(10,"mat-option",8),p.Oc(11,"Date"),p.Vb(),p.Wb(12,"mat-option",9),p.Oc(13,"Publisher"),p.Vb(),p.Wb(14,"mat-option",10),p.Oc(15,"Subid"),p.Vb(),p.Wb(16,"mat-option",11),p.Oc(17,"Reset"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Wb(18,"ngx-datatable",12,13),p.Wb(20,"ngx-datatable-row-detail",14),p.hc("toggle",(function(t){return e.onDetailToggle(t)})),p.Mc(21,Zc,2,2,"ng-template",15),p.Vb(),p.Wb(22,"ngx-datatable-column",16),p.Mc(23,Jc,1,4,"ng-template",17),p.Vb(),p.Mc(24,ru,3,1,"ngx-datatable-column",18),p.Mc(25,iu,3,0,"ngx-datatable-column",19),p.Mc(26,cu,3,1,"ngx-datatable-column",20),p.Mc(27,hu,3,0,"ngx-datatable-column",21),p.Mc(28,bu,3,0,"ngx-datatable-column",22),p.Mc(29,mu,3,0,"ngx-datatable-column",23),p.Mc(30,Du,3,0,"ngx-datatable-column",24),p.Mc(31,Fu,3,0,"ngx-datatable-column",25),p.Mc(32,Wu,3,0,"ngx-datatable-column",26),p.Mc(33,Ou,3,0,"ngx-datatable-column",27),p.Mc(34,Ru,3,0,"ngx-datatable-column",28),p.Mc(35,Iu,3,0,"ngx-datatable-column",29),p.Wb(36,"ngx-datatable-column",30),p.Mc(37,Nu,1,0,"ng-template",31),p.Mc(38,Lu,3,4,"ng-template",17),p.Vb(),p.Wb(39,"ngx-datatable-column",32),p.Mc(40,Au,1,0,"ng-template",31),p.Mc(41,ju,3,4,"ng-template",17),p.Vb(),p.Wb(42,"ngx-datatable-column",33),p.Mc(43,zu,1,0,"ng-template",31),p.Mc(44,Eu,3,4,"ng-template",17),p.Vb(),p.Wb(45,"ngx-datatable-column",34),p.Mc(46,Yu,1,0,"ng-template",31),p.Mc(47,Hu,4,6,"ng-template",17),p.Vb(),p.Vb()),2&t&&(p.rc("ngIf",e.loadingIndicator),p.Db(2),p.rc("ngIf",e.chartData&&!e.loadingIndicator),p.Db(1),p.rc("ngIf",e.summaryMetrics&&!e.loadingIndicator),p.Db(6),p.rc("ngModel",e.groupType),p.Db(9),p.rc("columnMode","force")("headerHeight",50)("footerHeight",0)("rowHeight",50)("scrollbarV",!0)("rows",e.rows)("loadingIndicator",e.loadingIndicator),p.Db(2),p.rc("rowHeight","publisher"===e.groupType||"subid"===e.groupType?e.getDetailRowHeight:130),p.Db(2),p.rc("width",30)("resizeable",!1)("sortable",!1)("draggable",!1)("canAutoResize",!1),p.Db(2),p.rc("ngIf",!e.groupPublishFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag),p.Db(1),p.rc("ngIf",!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(1),p.rc("ngIf",!e.groupPublishFlag&&!e.groupDateShowFlag&&!e.groupSubidShowFlag),p.Db(10),p.rc("minWidth",35))},directives:[s.p,d.a,m.c,m.g,v.a,y.q,y.t,D.p,S.d,S.e,S.f,S.b,S.a,S.c,w.a,Uc,O,s.o],pipes:[s.g,s.w,s.d],styles:[".loading-bar[_ngcontent-%COMP%]{position:fixed;top:118px;left:0;right:0;transition:top .3s ease;z-index:95;margin:0}[_nghost-%COMP%]     .mat-progress-bar .mat-progress-bar-fill:after{background-color:#99c2eb}@media screen and (max-width:992px){.loading-bar[_ngcontent-%COMP%]{top:81px}}"]}),Uu)},{path:"third-party",component:na},{path:"solex-bc",component:Ps},{path:"manual-stat-update",component:No},{path:"manual-split-update",component:Bo},{path:"",redirectTo:"",pathMatch:"full"},{path:"**",redirectTo:"",pathMatch:"full"}]}],qu=((Bu=function t(){r(this,t)}).\u0275mod=p.Ob({type:Bu}),Bu.\u0275inj=p.Nb({factory:function(t){return new(t||Bu)},imports:[[c.k.forChild(Gu)],c.k]}),Bu),$u=i("UKGz"),Ku=i("e8Ap"),Xu=((Qu=function t(){r(this,t)}).\u0275mod=p.Ob({type:Qu}),Qu.\u0275inj=p.Nb({factory:function(t){return new(t||Qu)},providers:[s.f,s.w,s.d],imports:[[c.k,s.c,qu,S.g,y.w,y.m,M.d,Po.e,m.e,D.n,v.b,$u.a,D.q,Re.c,Vo.c,Ku.b,w.b]]}),Qu)}}])}();