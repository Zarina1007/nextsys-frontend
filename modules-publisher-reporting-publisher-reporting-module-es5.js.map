{"version":3,"sources":["webpack:///src/app/modules/publisher-reporting/publisher-reporting-routing.module.ts","webpack:///src/app/modules/publisher-reporting/publisher-reporting.component.ts","webpack:///src/app/modules/publisher-reporting/publisher-reporting.component.html","webpack:///src/app/modules/publisher-reporting/publisher-reporting.module.ts","webpack:///src/app/modules/publisher-reporting/publisher/publisher.component.html","webpack:///src/app/modules/publisher-reporting/publisher/publisher.component.ts"],"names":["routes","path","component","children","pathMatch","redirectTo","PublisherReportingRoutingModule","forChild","imports","exports","PublisherReportingComponent","selector","templateUrl","styleUrls","PublisherReportingModule","declarations","entryComponents","PublisherComponent","route","tagManagementService","cdr","userService","perionService","lyonService","loadingIndicator","range","startDate","endDate","params","subscribe","routeParams","getTagInformation","tagId","tagRows","selectedAdvertiser","advertiser","selectedCompany","company","getLyonChartMetrics","chartData","getPerionChartMetrics","refreshTable","id","getOneTag","toPromise","then","response","error","getAllStats","allChart","chartAllLyonStat","subids","tagSub","concat","filter","stat","subid","includes","startsWith","endsWith","filter_data","obj","pos","arr","map","mapObj","_id","indexOf","helperChart","f","revenue","parseFloat","ctr","biddedCtr","biddedCTR","resultChart","reduce","r","o","key","rptDate","Object","assign","push","searches","parseInt","revenuePerDayVal","datesOfRevenueVal","searchesPerDayVal","chartDataValue","resVal","markForCheck","getChartMetrics","updateReportingFiltering"],"mappings":"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","file":"modules-publisher-reporting-publisher-reporting-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { PublisherReportingComponent } from './publisher-reporting.component';\nimport { PublisherComponent } from './publisher/publisher.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PublisherReportingComponent,\n    children: [\n      {\n        path: ':tagId',\n        component: PublisherComponent,\n        pathMatch: 'full',\n      },\n      \n      { path: '', redirectTo: '', pathMatch: 'full' },\n      { path: '**', redirectTo: '', pathMatch: 'full' },\n    ]\n  }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes)\n  ],\n  exports: [RouterModule]\n})\nexport class PublisherReportingRoutingModule { }\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-publisher-reporting',\n  templateUrl: './publisher-reporting.component.html',\n  styleUrls: ['./publisher-reporting.component.scss']\n})\nexport class PublisherReportingComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<router-outlet></router-outlet>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { PublisherReportingRoutingModule } from './publisher-reporting-routing.module';\nimport { PublisherComponent } from './publisher/publisher.component';\nimport { PublisherReportingComponent } from './publisher-reporting.component';\nimport { SharedModule } from 'src/app/shared/modules/shared.module';\n\n@NgModule({\n  declarations: [\n    PublisherComponent, \n    PublisherReportingComponent\n  ],\n  imports: [\n    RouterModule,\n    CommonModule,\n    PublisherReportingRoutingModule,\n    SharedModule\n  ],\n  entryComponents: [],\n})\nexport class PublisherReportingModule { }\n","<app-reporting-filtering (onDatesPicked)=\"updateReportingFiltering($event)\"></app-reporting-filtering>\r\n<!-- Chart Part-->\r\n<app-reporting-revenue-chart *ngIf=\"chartData\"\r\n  [chartData]=\"chartData\"></app-reporting-revenue-chart>","import { Component, AfterViewInit, ChangeDetectorRef } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { TagInterface } from 'src/app/shared/models/tag.interface';\nimport { TagManagementService } from '../../tag-management/tag-management.service';\nimport { UsersService } from '../../../shared/service/users.service'\nimport { ChartDataInterface } from 'src/app/shared/models/chartData.interface';\nimport { PerionService } from 'src/app/shared/service/admin-stats/perion.service';\nimport { LyonService } from 'src/app/shared/service/admin-stats/lyon.service';\n\n@Component({\n  selector: 'app-publisher',\n  templateUrl: './publisher.component.html',\n  styleUrls: ['./publisher.component.scss']\n})\nexport class PublisherComponent implements AfterViewInit  {\n  loadingIndicator = true;\n  tagRows: TagInterface;\n  //Sends chartData to ReportingRevenueChartComponent\n  chartData: ChartDataInterface;\n  selectedCompany: any;\n  selectedAdvertiser: any;\n  allChart: any;\n  range = {\n    startDate: '',\n    endDate: '',\n  };\n\n  constructor(\n    private route: ActivatedRoute,\n    private tagManagementService: TagManagementService,\n    private cdr: ChangeDetectorRef,\n    private userService: UsersService,\n    private perionService: PerionService,\n    private lyonService: LyonService,\n  ) {}\n  \n  async ngAfterViewInit(){\n    this.route.params.subscribe(async routeParams => {\n      //console.log(\"routeParams===>\", routeParams)\n      this.tagRows = await this.getTagInformation(routeParams.tagId);\n      this.selectedAdvertiser = this.tagRows.advertiser;\n      this.selectedCompany = this.tagRows.company;\n     \n      if(this.selectedAdvertiser == \"lyons\") {\n        this.chartData = await this.getLyonChartMetrics(\n          this.selectedCompany,\n          this.range.startDate,\n          this.range.endDate\n        );\n        \n      } else if (this.selectedAdvertiser == \"perion\") {\n        this.chartData = await this.getPerionChartMetrics(\n          this.selectedCompany,\n          this.range.startDate,\n          this.range.endDate\n        );\n      }\n      this.refreshTable();\n    });\n    \n  }\n\n  getTagInformation(id: any) {\n    return this.tagManagementService.getOneTag(id).toPromise().then((response) => {\n      return response;\n    }).catch((error) => {\n      return error;\n    })\n  }\n\n  public async updateReportingFiltering(range) {\n    // console.log('Update report filtering....');\n    this.range = range;\n    if(this.selectedAdvertiser == \"lyons\") {\n      this.chartData = await this.getLyonChartMetrics(\n        this.selectedCompany,\n        this.range.startDate,\n        this.range.endDate\n      );\n    } else if (this.selectedAdvertiser == \"perion\") {\n      this.chartData = await this.getPerionChartMetrics(\n        this.selectedCompany,\n        this.range.startDate,\n        this.range.endDate\n      );\n    }\n    \n    this.refreshTable();\n  }\n\n  getLyonChartMetrics(company, startDate, endDate) {\n    return this.lyonService.getAllStats(startDate, endDate).toPromise().then((response) => {\n      this.allChart = response;\n      var chartAllLyonStat = [];\n      for(var tagSub of this.tagRows.subids) {\n        if(tagSub['filterTag'] ==\"Contains\") {\n              \n          chartAllLyonStat = chartAllLyonStat.concat(this.allChart.filter(stat => stat.subid.includes(tagSub['subid'])))\n        } else if (tagSub['filterTag'] ==\"StartsWith\") {\n          chartAllLyonStat = chartAllLyonStat.concat(this.allChart.filter(stat => stat.subid.startsWith(tagSub['subid'])))\n        } else if (tagSub['filterTag'] ==\"EndsWith\") {\n          chartAllLyonStat = chartAllLyonStat.concat(this.allChart.filter(stat => stat.subid.endsWith(tagSub['subid'])))\n        } else if (tagSub['filterTag'] ==\"ExactValue\") {\n          chartAllLyonStat = chartAllLyonStat.concat(this.allChart.filter(stat => stat.subid == tagSub['subid'] ))\n        }\n      }\n\n      //duplicated remove\n      let filter_data = chartAllLyonStat.filter((obj, pos, arr) => {\n        return arr\n          .map(mapObj => mapObj._id)\n          .indexOf(obj._id) == pos;\n      });\n      var helperChart = {};\n      filter_data.map(f =>{\n        f.revenue = parseFloat(f.revenue);\n        f.ctr = parseFloat(f.ctr);\n        f.biddedCtr = parseFloat(f.biddedCTR);\n      })\n      var resultChart = filter_data.reduce(function(r, o) {\n        var key = o.rptDate;\n        if(!helperChart[key]) {\n          helperChart[key] = Object.assign({}, o); // create a copy of o\n          r.push(helperChart[key]);\n        } else {\n          helperChart[key].searches += parseInt(o.searches);\n          if(o.revenue) {\n            helperChart[key].revenue += o.revenue;\n          }\n        } \n        return r;\n      }, []);\n      var revenuePerDayVal = [];\n      var datesOfRevenueVal = [];\n      var searchesPerDayVal = [];\n      var chartDataValue = {};\n      for(var resVal of resultChart) {\n        revenuePerDayVal.push(resVal.revenue);\n        datesOfRevenueVal.push(resVal.rptDate);\n        searchesPerDayVal.push(resVal.searches);\n      }\n      chartDataValue['revenuePerDay'] = revenuePerDayVal;\n      chartDataValue['datesOfRevenue'] = datesOfRevenueVal;\n      chartDataValue['searchesPerDay'] = searchesPerDayVal;\n      return chartDataValue;\n    })\n    .catch((error) => {\n      return error;\n    });\n\n  }\n  refreshTable() {\n    this.cdr.markForCheck();\n  }\n\n  getPerionChartMetrics(company, startDate, endDate) {\n    return this.perionService\n      .getChartMetrics(company, startDate, endDate)\n      .toPromise()\n      .then((response) => {\n        return response;\n      })\n      .catch((error) => {\n        return error;\n      });\n  }\n}\n"]}